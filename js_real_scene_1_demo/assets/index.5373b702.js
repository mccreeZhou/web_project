(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))o(h);new MutationObserver(h=>{for(const g of h)if(g.type==="childList")for(const _ of g.addedNodes)_.tagName==="LINK"&&_.rel==="modulepreload"&&o(_)}).observe(document,{childList:!0,subtree:!0});function n(h){const g={};return h.integrity&&(g.integrity=h.integrity),h.referrerpolicy&&(g.referrerPolicy=h.referrerpolicy),h.crossorigin==="use-credentials"?g.credentials="include":h.crossorigin==="anonymous"?g.credentials="omit":g.credentials="same-origin",g}function o(h){if(h.ep)return;h.ep=!0;const g=n(h);fetch(h.href,g)}})();function cr(e,t){const n=Object.create(null),o=e.split(",");for(let h=0;h<o.length;h++)n[o[h]]=!0;return t?h=>!!n[h.toLowerCase()]:h=>!!n[h]}function hr(e){if(ye(e)){const t={};for(let n=0;n<e.length;n++){const o=e[n],h=Be(o)?Ja(o):hr(o);if(h)for(const g in h)t[g]=h[g]}return t}else{if(Be(e))return e;if(Re(e))return e}}const Xa=/;(?![^(]*\))/g,za=/:([^]+)/,qa=/\/\*.*?\*\//gs;function Ja(e){const t={};return e.replace(qa,"").split(Xa).forEach(n=>{if(n){const o=n.split(za);o.length>1&&(t[o[0].trim()]=o[1].trim())}}),t}function ur(e){let t="";if(Be(e))t=e;else if(ye(e))for(let n=0;n<e.length;n++){const o=ur(e[n]);o&&(t+=o+" ")}else if(Re(e))for(const n in e)e[n]&&(t+=n+" ");return t.trim()}const $a="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",Ka=cr($a);function mo(e){return!!e||e===""}const ni=e=>Be(e)?e:e==null?"":ye(e)||Re(e)&&(e.toString===bo||!Se(e.toString))?JSON.stringify(e,vo,2):String(e),vo=(e,t)=>t&&t.__v_isRef?vo(e,t.value):si(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[o,h])=>(n[`${o} =>`]=h,n),{})}:yo(t)?{[`Set(${t.size})`]:[...t.values()]}:Re(t)&&!ye(t)&&!Co(t)?String(t):t,Me={},ri=[],lt=()=>{},Qa=()=>!1,Za=/^on[^a-z]/,mn=e=>Za.test(e),dr=e=>e.startsWith("onUpdate:"),Ve=Object.assign,fr=(e,t)=>{const n=e.indexOf(t);n>-1&&e.splice(n,1)},el=Object.prototype.hasOwnProperty,Ce=(e,t)=>el.call(e,t),ye=Array.isArray,si=e=>vn(e)==="[object Map]",yo=e=>vn(e)==="[object Set]",Se=e=>typeof e=="function",Be=e=>typeof e=="string",gr=e=>typeof e=="symbol",Re=e=>e!==null&&typeof e=="object",So=e=>Re(e)&&Se(e.then)&&Se(e.catch),bo=Object.prototype.toString,vn=e=>bo.call(e),tl=e=>vn(e).slice(8,-1),Co=e=>vn(e)==="[object Object]",pr=e=>Be(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Qi=cr(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),yn=e=>{const t=Object.create(null);return n=>t[n]||(t[n]=e(n))},il=/-(\w)/g,pt=yn(e=>e.replace(il,(t,n)=>n?n.toUpperCase():"")),nl=/\B([A-Z])/g,fi=yn(e=>e.replace(nl,"-$1").toLowerCase()),Sn=yn(e=>e.charAt(0).toUpperCase()+e.slice(1)),Pn=yn(e=>e?`on${Sn(e)}`:""),Mi=(e,t)=>!Object.is(e,t),Fn=(e,t)=>{for(let n=0;n<e.length;n++)e[n](t)},rn=(e,t,n)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:n})},_r=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let Nr;const rl=()=>Nr||(Nr=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});let Qe;class wo{constructor(t=!1){this.detached=t,this.active=!0,this.effects=[],this.cleanups=[],this.parent=Qe,!t&&Qe&&(this.index=(Qe.scopes||(Qe.scopes=[])).push(this)-1)}run(t){if(this.active){const n=Qe;try{return Qe=this,t()}finally{Qe=n}}}on(){Qe=this}off(){Qe=this.parent}stop(t){if(this.active){let n,o;for(n=0,o=this.effects.length;n<o;n++)this.effects[n].stop();for(n=0,o=this.cleanups.length;n<o;n++)this.cleanups[n]();if(this.scopes)for(n=0,o=this.scopes.length;n<o;n++)this.scopes[n].stop(!0);if(!this.detached&&this.parent&&!t){const h=this.parent.scopes.pop();h&&h!==this&&(this.parent.scopes[this.index]=h,h.index=this.index)}this.parent=void 0,this.active=!1}}}function To(e){return new wo(e)}function sl(e,t=Qe){t&&t.active&&t.effects.push(e)}function ol(){return Qe}function al(e){Qe&&Qe.cleanups.push(e)}const mr=e=>{const t=new Set(e);return t.w=0,t.n=0,t},xo=e=>(e.w&Pt)>0,Eo=e=>(e.n&Pt)>0,ll=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=Pt},cl=e=>{const{deps:t}=e;if(t.length){let n=0;for(let o=0;o<t.length;o++){const h=t[o];xo(h)&&!Eo(h)?h.delete(e):t[n++]=h,h.w&=~Pt,h.n&=~Pt}t.length=n}},Yn=new WeakMap;let Ti=0,Pt=1;const Xn=30;let st;const Yt=Symbol(""),zn=Symbol("");class vr{constructor(t,n=null,o){this.fn=t,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,sl(this,o)}run(){if(!this.active)return this.fn();let t=st,n=Dt;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=st,st=this,Dt=!0,Pt=1<<++Ti,Ti<=Xn?ll(this):jr(this),this.fn()}finally{Ti<=Xn&&cl(this),Pt=1<<--Ti,st=this.parent,Dt=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){st===this?this.deferStop=!0:this.active&&(jr(this),this.onStop&&this.onStop(),this.active=!1)}}function jr(e){const{deps:t}=e;if(t.length){for(let n=0;n<t.length;n++)t[n].delete(e);t.length=0}}let Dt=!0;const Ao=[];function gi(){Ao.push(Dt),Dt=!1}function pi(){const e=Ao.pop();Dt=e===void 0?!0:e}function Ze(e,t,n){if(Dt&&st){let o=Yn.get(e);o||Yn.set(e,o=new Map);let h=o.get(n);h||o.set(n,h=mr()),Io(h)}}function Io(e,t){let n=!1;Ti<=Xn?Eo(e)||(e.n|=Pt,n=!xo(e)):n=!e.has(st),n&&(e.add(st),st.deps.push(e))}function bt(e,t,n,o,h,g){const _=Yn.get(e);if(!_)return;let v=[];if(t==="clear")v=[..._.values()];else if(n==="length"&&ye(e)){const b=_r(o);_.forEach((C,w)=>{(w==="length"||w>=b)&&v.push(C)})}else switch(n!==void 0&&v.push(_.get(n)),t){case"add":ye(e)?pr(n)&&v.push(_.get("length")):(v.push(_.get(Yt)),si(e)&&v.push(_.get(zn)));break;case"delete":ye(e)||(v.push(_.get(Yt)),si(e)&&v.push(_.get(zn)));break;case"set":si(e)&&v.push(_.get(Yt));break}if(v.length===1)v[0]&&qn(v[0]);else{const b=[];for(const C of v)C&&b.push(...C);qn(mr(b))}}function qn(e,t){const n=ye(e)?e:[...e];for(const o of n)o.computed&&Vr(o);for(const o of n)o.computed||Vr(o)}function Vr(e,t){(e!==st||e.allowRecurse)&&(e.scheduler?e.scheduler():e.run())}const hl=cr("__proto__,__v_isRef,__isVue"),Oo=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(gr)),ul=yr(),dl=yr(!1,!0),fl=yr(!0),Ur=gl();function gl(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...n){const o=we(this);for(let g=0,_=this.length;g<_;g++)Ze(o,"get",g+"");const h=o[t](...n);return h===-1||h===!1?o[t](...n.map(we)):h}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...n){gi();const o=we(this)[t].apply(this,n);return pi(),o}}),e}function yr(e=!1,t=!1){return function(o,h,g){if(h==="__v_isReactive")return!e;if(h==="__v_isReadonly")return e;if(h==="__v_isShallow")return t;if(h==="__v_raw"&&g===(e?t?Rl:Po:t?Lo:Mo).get(o))return o;const _=ye(o);if(!e&&_&&Ce(Ur,h))return Reflect.get(Ur,h,g);const v=Reflect.get(o,h,g);return(gr(h)?Oo.has(h):hl(h))||(e||Ze(o,"get",h),t)?v:Pe(v)?_&&pr(h)?v:v.value:Re(v)?e?Fo(v):ot(v):v}}const pl=Ro(),_l=Ro(!0);function Ro(e=!1){return function(n,o,h,g){let _=n[o];if(ai(_)&&Pe(_)&&!Pe(h))return!1;if(!e&&(!sn(h)&&!ai(h)&&(_=we(_),h=we(h)),!ye(n)&&Pe(_)&&!Pe(h)))return _.value=h,!0;const v=ye(n)&&pr(o)?Number(o)<n.length:Ce(n,o),b=Reflect.set(n,o,h,g);return n===we(g)&&(v?Mi(h,_)&&bt(n,"set",o,h):bt(n,"add",o,h)),b}}function ml(e,t){const n=Ce(e,t);e[t];const o=Reflect.deleteProperty(e,t);return o&&n&&bt(e,"delete",t,void 0),o}function vl(e,t){const n=Reflect.has(e,t);return(!gr(t)||!Oo.has(t))&&Ze(e,"has",t),n}function yl(e){return Ze(e,"iterate",ye(e)?"length":Yt),Reflect.ownKeys(e)}const Do={get:ul,set:pl,deleteProperty:ml,has:vl,ownKeys:yl},Sl={get:fl,set(e,t){return!0},deleteProperty(e,t){return!0}},bl=Ve({},Do,{get:dl,set:_l}),Sr=e=>e,bn=e=>Reflect.getPrototypeOf(e);function Hi(e,t,n=!1,o=!1){e=e.__v_raw;const h=we(e),g=we(t);n||(t!==g&&Ze(h,"get",t),Ze(h,"get",g));const{has:_}=bn(h),v=o?Sr:n?wr:Li;if(_.call(h,t))return v(e.get(t));if(_.call(h,g))return v(e.get(g));e!==h&&e.get(t)}function Yi(e,t=!1){const n=this.__v_raw,o=we(n),h=we(e);return t||(e!==h&&Ze(o,"has",e),Ze(o,"has",h)),e===h?n.has(e):n.has(e)||n.has(h)}function Xi(e,t=!1){return e=e.__v_raw,!t&&Ze(we(e),"iterate",Yt),Reflect.get(e,"size",e)}function Gr(e){e=we(e);const t=we(this);return bn(t).has.call(t,e)||(t.add(e),bt(t,"add",e,e)),this}function Wr(e,t){t=we(t);const n=we(this),{has:o,get:h}=bn(n);let g=o.call(n,e);g||(e=we(e),g=o.call(n,e));const _=h.call(n,e);return n.set(e,t),g?Mi(t,_)&&bt(n,"set",e,t):bt(n,"add",e,t),this}function Hr(e){const t=we(this),{has:n,get:o}=bn(t);let h=n.call(t,e);h||(e=we(e),h=n.call(t,e)),o&&o.call(t,e);const g=t.delete(e);return h&&bt(t,"delete",e,void 0),g}function Yr(){const e=we(this),t=e.size!==0,n=e.clear();return t&&bt(e,"clear",void 0,void 0),n}function zi(e,t){return function(o,h){const g=this,_=g.__v_raw,v=we(_),b=t?Sr:e?wr:Li;return!e&&Ze(v,"iterate",Yt),_.forEach((C,w)=>o.call(h,b(C),b(w),g))}}function qi(e,t,n){return function(...o){const h=this.__v_raw,g=we(h),_=si(g),v=e==="entries"||e===Symbol.iterator&&_,b=e==="keys"&&_,C=h[e](...o),w=n?Sr:t?wr:Li;return!t&&Ze(g,"iterate",b?zn:Yt),{next(){const{value:I,done:A}=C.next();return A?{value:I,done:A}:{value:v?[w(I[0]),w(I[1])]:w(I),done:A}},[Symbol.iterator](){return this}}}}function Tt(e){return function(...t){return e==="delete"?!1:this}}function Cl(){const e={get(g){return Hi(this,g)},get size(){return Xi(this)},has:Yi,add:Gr,set:Wr,delete:Hr,clear:Yr,forEach:zi(!1,!1)},t={get(g){return Hi(this,g,!1,!0)},get size(){return Xi(this)},has:Yi,add:Gr,set:Wr,delete:Hr,clear:Yr,forEach:zi(!1,!0)},n={get(g){return Hi(this,g,!0)},get size(){return Xi(this,!0)},has(g){return Yi.call(this,g,!0)},add:Tt("add"),set:Tt("set"),delete:Tt("delete"),clear:Tt("clear"),forEach:zi(!0,!1)},o={get(g){return Hi(this,g,!0,!0)},get size(){return Xi(this,!0)},has(g){return Yi.call(this,g,!0)},add:Tt("add"),set:Tt("set"),delete:Tt("delete"),clear:Tt("clear"),forEach:zi(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(g=>{e[g]=qi(g,!1,!1),n[g]=qi(g,!0,!1),t[g]=qi(g,!1,!0),o[g]=qi(g,!0,!0)}),[e,n,t,o]}const[wl,Tl,xl,El]=Cl();function br(e,t){const n=t?e?El:xl:e?Tl:wl;return(o,h,g)=>h==="__v_isReactive"?!e:h==="__v_isReadonly"?e:h==="__v_raw"?o:Reflect.get(Ce(n,h)&&h in o?n:o,h,g)}const Al={get:br(!1,!1)},Il={get:br(!1,!0)},Ol={get:br(!0,!1)},Mo=new WeakMap,Lo=new WeakMap,Po=new WeakMap,Rl=new WeakMap;function Dl(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Ml(e){return e.__v_skip||!Object.isExtensible(e)?0:Dl(tl(e))}function ot(e){return ai(e)?e:Cr(e,!1,Do,Al,Mo)}function Ll(e){return Cr(e,!1,bl,Il,Lo)}function Fo(e){return Cr(e,!0,Sl,Ol,Po)}function Cr(e,t,n,o,h){if(!Re(e)||e.__v_raw&&!(t&&e.__v_isReactive))return e;const g=h.get(e);if(g)return g;const _=Ml(e);if(_===0)return e;const v=new Proxy(e,_===2?o:n);return h.set(e,v),v}function Mt(e){return ai(e)?Mt(e.__v_raw):!!(e&&e.__v_isReactive)}function ai(e){return!!(e&&e.__v_isReadonly)}function sn(e){return!!(e&&e.__v_isShallow)}function ko(e){return Mt(e)||ai(e)}function we(e){const t=e&&e.__v_raw;return t?we(t):e}function li(e){return rn(e,"__v_skip",!0),e}const Li=e=>Re(e)?ot(e):e,wr=e=>Re(e)?Fo(e):e;function Bo(e){Dt&&st&&(e=we(e),Io(e.dep||(e.dep=mr())))}function No(e,t){e=we(e),e.dep&&qn(e.dep)}function Pe(e){return!!(e&&e.__v_isRef===!0)}function Cn(e){return jo(e,!1)}function Pl(e){return jo(e,!0)}function jo(e,t){return Pe(e)?e:new Fl(e,t)}class Fl{constructor(t,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?t:we(t),this._value=n?t:Li(t)}get value(){return Bo(this),this._value}set value(t){const n=this.__v_isShallow||sn(t)||ai(t);t=n?t:we(t),Mi(t,this._rawValue)&&(this._rawValue=t,this._value=n?t:Li(t),No(this))}}function Je(e){return Pe(e)?e.value:e}const kl={get:(e,t,n)=>Je(Reflect.get(e,t,n)),set:(e,t,n,o)=>{const h=e[t];return Pe(h)&&!Pe(n)?(h.value=n,!0):Reflect.set(e,t,n,o)}};function Vo(e){return Mt(e)?e:new Proxy(e,kl)}function Bl(e){const t=ye(e)?new Array(e.length):{};for(const n in e)t[n]=jl(e,n);return t}class Nl{constructor(t,n,o){this._object=t,this._key=n,this._defaultValue=o,this.__v_isRef=!0}get value(){const t=this._object[this._key];return t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}}function jl(e,t,n){const o=e[t];return Pe(o)?o:new Nl(e,t,n)}var Uo;class Vl{constructor(t,n,o,h){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this[Uo]=!1,this._dirty=!0,this.effect=new vr(t,()=>{this._dirty||(this._dirty=!0,No(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!h,this.__v_isReadonly=o}get value(){const t=we(this);return Bo(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}Uo="__v_isReadonly";function Ul(e,t,n=!1){let o,h;const g=Se(e);return g?(o=e,h=lt):(o=e.get,h=e.set),new Vl(o,h,g||!h,n)}function Lt(e,t,n,o){let h;try{h=o?e(...o):e()}catch(g){wn(g,t,n)}return h}function it(e,t,n,o){if(Se(e)){const g=Lt(e,t,n,o);return g&&So(g)&&g.catch(_=>{wn(_,t,n)}),g}const h=[];for(let g=0;g<e.length;g++)h.push(it(e[g],t,n,o));return h}function wn(e,t,n,o=!0){const h=t?t.vnode:null;if(t){let g=t.parent;const _=t.proxy,v=n;for(;g;){const C=g.ec;if(C){for(let w=0;w<C.length;w++)if(C[w](e,_,v)===!1)return}g=g.parent}const b=t.appContext.config.errorHandler;if(b){Lt(b,null,10,[e,_,v]);return}}Gl(e,n,h,o)}function Gl(e,t,n,o=!0){console.error(e)}let Pi=!1,Jn=!1;const We=[];let dt=0;const oi=[];let yt=null,Ut=0;const Go=Promise.resolve();let Tr=null;function xr(e){const t=Tr||Go;return e?t.then(this?e.bind(this):e):t}function Wl(e){let t=dt+1,n=We.length;for(;t<n;){const o=t+n>>>1;Fi(We[o])<e?t=o+1:n=o}return t}function Er(e){(!We.length||!We.includes(e,Pi&&e.allowRecurse?dt+1:dt))&&(e.id==null?We.push(e):We.splice(Wl(e.id),0,e),Wo())}function Wo(){!Pi&&!Jn&&(Jn=!0,Tr=Go.then(Yo))}function Hl(e){const t=We.indexOf(e);t>dt&&We.splice(t,1)}function Yl(e){ye(e)?oi.push(...e):(!yt||!yt.includes(e,e.allowRecurse?Ut+1:Ut))&&oi.push(e),Wo()}function Xr(e,t=Pi?dt+1:0){for(;t<We.length;t++){const n=We[t];n&&n.pre&&(We.splice(t,1),t--,n())}}function Ho(e){if(oi.length){const t=[...new Set(oi)];if(oi.length=0,yt){yt.push(...t);return}for(yt=t,yt.sort((n,o)=>Fi(n)-Fi(o)),Ut=0;Ut<yt.length;Ut++)yt[Ut]();yt=null,Ut=0}}const Fi=e=>e.id==null?1/0:e.id,Xl=(e,t)=>{const n=Fi(e)-Fi(t);if(n===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return n};function Yo(e){Jn=!1,Pi=!0,We.sort(Xl);const t=lt;try{for(dt=0;dt<We.length;dt++){const n=We[dt];n&&n.active!==!1&&Lt(n,null,14)}}finally{dt=0,We.length=0,Ho(),Pi=!1,Tr=null,(We.length||oi.length)&&Yo()}}function zl(e,t,...n){if(e.isUnmounted)return;const o=e.vnode.props||Me;let h=n;const g=t.startsWith("update:"),_=g&&t.slice(7);if(_&&_ in o){const w=`${_==="modelValue"?"model":_}Modifiers`,{number:I,trim:A}=o[w]||Me;A&&(h=n.map(V=>Be(V)?V.trim():V)),I&&(h=n.map(_r))}let v,b=o[v=Pn(t)]||o[v=Pn(pt(t))];!b&&g&&(b=o[v=Pn(fi(t))]),b&&it(b,e,6,h);const C=o[v+"Once"];if(C){if(!e.emitted)e.emitted={};else if(e.emitted[v])return;e.emitted[v]=!0,it(C,e,6,h)}}function Xo(e,t,n=!1){const o=t.emitsCache,h=o.get(e);if(h!==void 0)return h;const g=e.emits;let _={},v=!1;if(!Se(e)){const b=C=>{const w=Xo(C,t,!0);w&&(v=!0,Ve(_,w))};!n&&t.mixins.length&&t.mixins.forEach(b),e.extends&&b(e.extends),e.mixins&&e.mixins.forEach(b)}return!g&&!v?(Re(e)&&o.set(e,null),null):(ye(g)?g.forEach(b=>_[b]=null):Ve(_,g),Re(e)&&o.set(e,_),_)}function Tn(e,t){return!e||!mn(t)?!1:(t=t.slice(2).replace(/Once$/,""),Ce(e,t[0].toLowerCase()+t.slice(1))||Ce(e,fi(t))||Ce(e,t))}let Ye=null,xn=null;function on(e){const t=Ye;return Ye=e,xn=e&&e.type.__scopeId||null,t}function zo(e){xn=e}function qo(){xn=null}function ci(e,t=Ye,n){if(!t||e._n)return e;const o=(...h)=>{o._d&&is(-1);const g=on(t);let _;try{_=e(...h)}finally{on(g),o._d&&is(1)}return _};return o._n=!0,o._c=!0,o._d=!0,o}function kn(e){const{type:t,vnode:n,proxy:o,withProxy:h,props:g,propsOptions:[_],slots:v,attrs:b,emit:C,render:w,renderCache:I,data:A,setupState:V,ctx:J,inheritAttrs:q}=e;let K,Z;const ne=on(e);try{if(n.shapeFlag&4){const re=h||o;K=ut(w.call(re,re,I,g,V,A,J)),Z=b}else{const re=t;K=ut(re.length>1?re(g,{attrs:b,slots:v,emit:C}):re(g,null)),Z=t.props?b:ql(b)}}catch(re){Ii.length=0,wn(re,e,1),K=Oe(nt)}let $=K;if(Z&&q!==!1){const re=Object.keys(Z),{shapeFlag:le}=$;re.length&&le&7&&(_&&re.some(dr)&&(Z=Jl(Z,_)),$=Ft($,Z))}return n.dirs&&($=Ft($),$.dirs=$.dirs?$.dirs.concat(n.dirs):n.dirs),n.transition&&($.transition=n.transition),K=$,on(ne),K}const ql=e=>{let t;for(const n in e)(n==="class"||n==="style"||mn(n))&&((t||(t={}))[n]=e[n]);return t},Jl=(e,t)=>{const n={};for(const o in e)(!dr(o)||!(o.slice(9)in t))&&(n[o]=e[o]);return n};function $l(e,t,n){const{props:o,children:h,component:g}=e,{props:_,children:v,patchFlag:b}=t,C=g.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&b>=0){if(b&1024)return!0;if(b&16)return o?zr(o,_,C):!!_;if(b&8){const w=t.dynamicProps;for(let I=0;I<w.length;I++){const A=w[I];if(_[A]!==o[A]&&!Tn(C,A))return!0}}}else return(h||v)&&(!v||!v.$stable)?!0:o===_?!1:o?_?zr(o,_,C):!0:!!_;return!1}function zr(e,t,n){const o=Object.keys(t);if(o.length!==Object.keys(e).length)return!0;for(let h=0;h<o.length;h++){const g=o[h];if(t[g]!==e[g]&&!Tn(n,g))return!0}return!1}function Kl({vnode:e,parent:t},n){for(;t&&t.subTree===e;)(e=t.vnode).el=n,t=t.parent}const Ql=e=>e.__isSuspense;function Zl(e,t){t&&t.pendingBranch?ye(e)?t.effects.push(...e):t.effects.push(e):Yl(e)}function Zi(e,t){if(je){let n=je.provides;const o=je.parent&&je.parent.provides;o===n&&(n=je.provides=Object.create(o)),n[e]=t}}function gt(e,t,n=!1){const o=je||Ye;if(o){const h=o.parent==null?o.vnode.appContext&&o.vnode.appContext.provides:o.parent.provides;if(h&&e in h)return h[e];if(arguments.length>1)return n&&Se(t)?t.call(o.proxy):t}}const Ji={};function xi(e,t,n){return Jo(e,t,n)}function Jo(e,t,{immediate:n,deep:o,flush:h,onTrack:g,onTrigger:_}=Me){const v=je;let b,C=!1,w=!1;if(Pe(e)?(b=()=>e.value,C=sn(e)):Mt(e)?(b=()=>e,o=!0):ye(e)?(w=!0,C=e.some($=>Mt($)||sn($)),b=()=>e.map($=>{if(Pe($))return $.value;if(Mt($))return ii($);if(Se($))return Lt($,v,2)})):Se(e)?t?b=()=>Lt(e,v,2):b=()=>{if(!(v&&v.isUnmounted))return I&&I(),it(e,v,3,[A])}:b=lt,t&&o){const $=b;b=()=>ii($())}let I,A=$=>{I=Z.onStop=()=>{Lt($,v,4)}},V;if(ji)if(A=lt,t?n&&it(t,v,3,[b(),w?[]:void 0,A]):b(),h==="sync"){const $=zc();V=$.__watcherHandles||($.__watcherHandles=[])}else return lt;let J=w?new Array(e.length).fill(Ji):Ji;const q=()=>{if(!!Z.active)if(t){const $=Z.run();(o||C||(w?$.some((re,le)=>Mi(re,J[le])):Mi($,J)))&&(I&&I(),it(t,v,3,[$,J===Ji?void 0:w&&J[0]===Ji?[]:J,A]),J=$)}else Z.run()};q.allowRecurse=!!t;let K;h==="sync"?K=q:h==="post"?K=()=>$e(q,v&&v.suspense):(q.pre=!0,v&&(q.id=v.uid),K=()=>Er(q));const Z=new vr(b,K);t?n?q():J=Z.run():h==="post"?$e(Z.run.bind(Z),v&&v.suspense):Z.run();const ne=()=>{Z.stop(),v&&v.scope&&fr(v.scope.effects,Z)};return V&&V.push(ne),ne}function ec(e,t,n){const o=this.proxy,h=Be(e)?e.includes(".")?$o(o,e):()=>o[e]:e.bind(o,o);let g;Se(t)?g=t:(g=t.handler,n=t);const _=je;hi(this);const v=Jo(h,g.bind(o),n);return _?hi(_):Xt(),v}function $o(e,t){const n=t.split(".");return()=>{let o=e;for(let h=0;h<n.length&&o;h++)o=o[n[h]];return o}}function ii(e,t){if(!Re(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),Pe(e))ii(e.value,t);else if(ye(e))for(let n=0;n<e.length;n++)ii(e[n],t);else if(yo(e)||si(e))e.forEach(n=>{ii(n,t)});else if(Co(e))for(const n in e)ii(e[n],t);return e}function Ko(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return an(()=>{e.isMounted=!0}),ta(()=>{e.isUnmounting=!0}),e}const tt=[Function,Array],tc={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:tt,onEnter:tt,onAfterEnter:tt,onEnterCancelled:tt,onBeforeLeave:tt,onLeave:tt,onAfterLeave:tt,onLeaveCancelled:tt,onBeforeAppear:tt,onAppear:tt,onAfterAppear:tt,onAppearCancelled:tt},setup(e,{slots:t}){const n=Dr(),o=Ko();let h;return()=>{const g=t.default&&Ar(t.default(),!0);if(!g||!g.length)return;let _=g[0];if(g.length>1){for(const q of g)if(q.type!==nt){_=q;break}}const v=we(e),{mode:b}=v;if(o.isLeaving)return Bn(_);const C=qr(_);if(!C)return Bn(_);const w=ki(C,v,o,n);Bi(C,w);const I=n.subTree,A=I&&qr(I);let V=!1;const{getTransitionKey:J}=C.type;if(J){const q=J();h===void 0?h=q:q!==h&&(h=q,V=!0)}if(A&&A.type!==nt&&(!Gt(C,A)||V)){const q=ki(A,v,o,n);if(Bi(A,q),b==="out-in")return o.isLeaving=!0,q.afterLeave=()=>{o.isLeaving=!1,n.update.active!==!1&&n.update()},Bn(_);b==="in-out"&&C.type!==nt&&(q.delayLeave=(K,Z,ne)=>{const $=Qo(o,A);$[String(A.key)]=A,K._leaveCb=()=>{Z(),K._leaveCb=void 0,delete w.delayedLeave},w.delayedLeave=ne})}return _}}},ic=tc;function Qo(e,t){const{leavingVNodes:n}=e;let o=n.get(t.type);return o||(o=Object.create(null),n.set(t.type,o)),o}function ki(e,t,n,o){const{appear:h,mode:g,persisted:_=!1,onBeforeEnter:v,onEnter:b,onAfterEnter:C,onEnterCancelled:w,onBeforeLeave:I,onLeave:A,onAfterLeave:V,onLeaveCancelled:J,onBeforeAppear:q,onAppear:K,onAfterAppear:Z,onAppearCancelled:ne}=t,$=String(e.key),re=Qo(n,e),le=(y,me)=>{y&&it(y,o,9,me)},pe=(y,me)=>{const ce=me[1];le(y,me),ye(y)?y.every(de=>de.length<=1)&&ce():y.length<=1&&ce()},ge={mode:g,persisted:_,beforeEnter(y){let me=v;if(!n.isMounted)if(h)me=q||v;else return;y._leaveCb&&y._leaveCb(!0);const ce=re[$];ce&&Gt(e,ce)&&ce.el._leaveCb&&ce.el._leaveCb(),le(me,[y])},enter(y){let me=b,ce=C,de=w;if(!n.isMounted)if(h)me=K||b,ce=Z||C,de=ne||w;else return;let a=!1;const s=y._enterCb=l=>{a||(a=!0,l?le(de,[y]):le(ce,[y]),ge.delayedLeave&&ge.delayedLeave(),y._enterCb=void 0)};me?pe(me,[y,s]):s()},leave(y,me){const ce=String(e.key);if(y._enterCb&&y._enterCb(!0),n.isUnmounting)return me();le(I,[y]);let de=!1;const a=y._leaveCb=s=>{de||(de=!0,me(),s?le(J,[y]):le(V,[y]),y._leaveCb=void 0,re[ce]===e&&delete re[ce])};re[ce]=e,A?pe(A,[y,a]):a()},clone(y){return ki(y,t,n,o)}};return ge}function Bn(e){if(En(e))return e=Ft(e),e.children=null,e}function qr(e){return En(e)?e.children?e.children[0]:void 0:e}function Bi(e,t){e.shapeFlag&6&&e.component?Bi(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function Ar(e,t=!1,n){let o=[],h=0;for(let g=0;g<e.length;g++){let _=e[g];const v=n==null?_.key:String(n)+String(_.key!=null?_.key:g);_.type===Ue?(_.patchFlag&128&&h++,o=o.concat(Ar(_.children,t,v))):(t||_.type!==nt)&&o.push(v!=null?Ft(_,{key:v}):_)}if(h>1)for(let g=0;g<o.length;g++)o[g].patchFlag=-2;return o}function Ct(e){return Se(e)?{setup:e,name:e.name}:e}const Ei=e=>!!e.type.__asyncLoader,En=e=>e.type.__isKeepAlive;function nc(e,t){Zo(e,"a",t)}function rc(e,t){Zo(e,"da",t)}function Zo(e,t,n=je){const o=e.__wdc||(e.__wdc=()=>{let h=n;for(;h;){if(h.isDeactivated)return;h=h.parent}return e()});if(An(t,o,n),n){let h=n.parent;for(;h&&h.parent;)En(h.parent.vnode)&&sc(o,t,n,h),h=h.parent}}function sc(e,t,n,o){const h=An(t,e,o,!0);ia(()=>{fr(o[t],h)},n)}function An(e,t,n=je,o=!1){if(n){const h=n[e]||(n[e]=[]),g=t.__weh||(t.__weh=(..._)=>{if(n.isUnmounted)return;gi(),hi(n);const v=it(t,n,e,_);return Xt(),pi(),v});return o?h.unshift(g):h.push(g),g}}const wt=e=>(t,n=je)=>(!ji||e==="sp")&&An(e,(...o)=>t(...o),n),oc=wt("bm"),an=wt("m"),ac=wt("bu"),ea=wt("u"),ta=wt("bum"),ia=wt("um"),lc=wt("sp"),cc=wt("rtg"),hc=wt("rtc");function uc(e,t=je){An("ec",e,t)}function Bt(e,t,n,o){const h=e.dirs,g=t&&t.dirs;for(let _=0;_<h.length;_++){const v=h[_];g&&(v.oldValue=g[_].value);let b=v.dir[o];b&&(gi(),it(b,n,8,[e.el,v,e,t]),pi())}}const na="components";function rf(e,t){return fc(na,e,!0,t)||e}const dc=Symbol();function fc(e,t,n=!0,o=!1){const h=Ye||je;if(h){const g=h.type;if(e===na){const v=Hc(g,!1);if(v&&(v===t||v===pt(t)||v===Sn(pt(t))))return g}const _=Jr(h[e]||g[e],t)||Jr(h.appContext[e],t);return!_&&o?g:_}}function Jr(e,t){return e&&(e[t]||e[pt(t)]||e[Sn(pt(t))])}function $n(e,t,n,o){let h;const g=n&&n[o];if(ye(e)||Be(e)){h=new Array(e.length);for(let _=0,v=e.length;_<v;_++)h[_]=t(e[_],_,void 0,g&&g[_])}else if(typeof e=="number"){h=new Array(e);for(let _=0;_<e;_++)h[_]=t(_+1,_,void 0,g&&g[_])}else if(Re(e))if(e[Symbol.iterator])h=Array.from(e,(_,v)=>t(_,v,void 0,g&&g[v]));else{const _=Object.keys(e);h=new Array(_.length);for(let v=0,b=_.length;v<b;v++){const C=_[v];h[v]=t(e[C],C,v,g&&g[v])}}else h=[];return n&&(n[o]=h),h}function sf(e,t,n={},o,h){if(Ye.isCE||Ye.parent&&Ei(Ye.parent)&&Ye.parent.isCE)return t!=="default"&&(n.name=t),Oe("slot",n,o&&o());let g=e[t];g&&g._c&&(g._d=!1),He();const _=g&&ra(g(n)),v=cn(Ue,{key:n.key||_&&_.key||`_${t}`},_||(o?o():[]),_&&e._===1?64:-2);return!h&&v.scopeId&&(v.slotScopeIds=[v.scopeId+"-s"]),g&&g._c&&(g._d=!0),v}function ra(e){return e.some(t=>hn(t)?!(t.type===nt||t.type===Ue&&!ra(t.children)):!0)?e:null}const Kn=e=>e?pa(e)?Mr(e)||e.proxy:Kn(e.parent):null,Ai=Ve(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>e.props,$attrs:e=>e.attrs,$slots:e=>e.slots,$refs:e=>e.refs,$parent:e=>Kn(e.parent),$root:e=>Kn(e.root),$emit:e=>e.emit,$options:e=>Ir(e),$forceUpdate:e=>e.f||(e.f=()=>Er(e.update)),$nextTick:e=>e.n||(e.n=xr.bind(e.proxy)),$watch:e=>ec.bind(e)}),Nn=(e,t)=>e!==Me&&!e.__isScriptSetup&&Ce(e,t),gc={get({_:e},t){const{ctx:n,setupState:o,data:h,props:g,accessCache:_,type:v,appContext:b}=e;let C;if(t[0]!=="$"){const V=_[t];if(V!==void 0)switch(V){case 1:return o[t];case 2:return h[t];case 4:return n[t];case 3:return g[t]}else{if(Nn(o,t))return _[t]=1,o[t];if(h!==Me&&Ce(h,t))return _[t]=2,h[t];if((C=e.propsOptions[0])&&Ce(C,t))return _[t]=3,g[t];if(n!==Me&&Ce(n,t))return _[t]=4,n[t];Qn&&(_[t]=0)}}const w=Ai[t];let I,A;if(w)return t==="$attrs"&&Ze(e,"get",t),w(e);if((I=v.__cssModules)&&(I=I[t]))return I;if(n!==Me&&Ce(n,t))return _[t]=4,n[t];if(A=b.config.globalProperties,Ce(A,t))return A[t]},set({_:e},t,n){const{data:o,setupState:h,ctx:g}=e;return Nn(h,t)?(h[t]=n,!0):o!==Me&&Ce(o,t)?(o[t]=n,!0):Ce(e.props,t)||t[0]==="$"&&t.slice(1)in e?!1:(g[t]=n,!0)},has({_:{data:e,setupState:t,accessCache:n,ctx:o,appContext:h,propsOptions:g}},_){let v;return!!n[_]||e!==Me&&Ce(e,_)||Nn(t,_)||(v=g[0])&&Ce(v,_)||Ce(o,_)||Ce(Ai,_)||Ce(h.config.globalProperties,_)},defineProperty(e,t,n){return n.get!=null?e._.accessCache[t]=0:Ce(n,"value")&&this.set(e,t,n.value,null),Reflect.defineProperty(e,t,n)}};let Qn=!0;function pc(e){const t=Ir(e),n=e.proxy,o=e.ctx;Qn=!1,t.beforeCreate&&$r(t.beforeCreate,e,"bc");const{data:h,computed:g,methods:_,watch:v,provide:b,inject:C,created:w,beforeMount:I,mounted:A,beforeUpdate:V,updated:J,activated:q,deactivated:K,beforeDestroy:Z,beforeUnmount:ne,destroyed:$,unmounted:re,render:le,renderTracked:pe,renderTriggered:ge,errorCaptured:y,serverPrefetch:me,expose:ce,inheritAttrs:de,components:a,directives:s,filters:l}=t;if(C&&_c(C,o,null,e.appContext.config.unwrapInjectedRef),_)for(const r in _){const c=_[r];Se(c)&&(o[r]=c.bind(n))}if(h){const r=h.call(n,n);Re(r)&&(e.data=ot(r))}if(Qn=!0,g)for(const r in g){const c=g[r],p=Se(c)?c.bind(n,n):Se(c.get)?c.get.bind(n,n):lt,d=!Se(c)&&Se(c.set)?c.set.bind(n):lt,f=Ke({get:p,set:d});Object.defineProperty(o,r,{enumerable:!0,configurable:!0,get:()=>f.value,set:m=>f.value=m})}if(v)for(const r in v)sa(v[r],o,n,r);if(b){const r=Se(b)?b.call(n):b;Reflect.ownKeys(r).forEach(c=>{Zi(c,r[c])})}w&&$r(w,e,"c");function i(r,c){ye(c)?c.forEach(p=>r(p.bind(n))):c&&r(c.bind(n))}if(i(oc,I),i(an,A),i(ac,V),i(ea,J),i(nc,q),i(rc,K),i(uc,y),i(hc,pe),i(cc,ge),i(ta,ne),i(ia,re),i(lc,me),ye(ce))if(ce.length){const r=e.exposed||(e.exposed={});ce.forEach(c=>{Object.defineProperty(r,c,{get:()=>n[c],set:p=>n[c]=p})})}else e.exposed||(e.exposed={});le&&e.render===lt&&(e.render=le),de!=null&&(e.inheritAttrs=de),a&&(e.components=a),s&&(e.directives=s)}function _c(e,t,n=lt,o=!1){ye(e)&&(e=Zn(e));for(const h in e){const g=e[h];let _;Re(g)?"default"in g?_=gt(g.from||h,g.default,!0):_=gt(g.from||h):_=gt(g),Pe(_)&&o?Object.defineProperty(t,h,{enumerable:!0,configurable:!0,get:()=>_.value,set:v=>_.value=v}):t[h]=_}}function $r(e,t,n){it(ye(e)?e.map(o=>o.bind(t.proxy)):e.bind(t.proxy),t,n)}function sa(e,t,n,o){const h=o.includes(".")?$o(n,o):()=>n[o];if(Be(e)){const g=t[e];Se(g)&&xi(h,g)}else if(Se(e))xi(h,e.bind(n));else if(Re(e))if(ye(e))e.forEach(g=>sa(g,t,n,o));else{const g=Se(e.handler)?e.handler.bind(n):t[e.handler];Se(g)&&xi(h,g,e)}}function Ir(e){const t=e.type,{mixins:n,extends:o}=t,{mixins:h,optionsCache:g,config:{optionMergeStrategies:_}}=e.appContext,v=g.get(t);let b;return v?b=v:!h.length&&!n&&!o?b=t:(b={},h.length&&h.forEach(C=>ln(b,C,_,!0)),ln(b,t,_)),Re(t)&&g.set(t,b),b}function ln(e,t,n,o=!1){const{mixins:h,extends:g}=t;g&&ln(e,g,n,!0),h&&h.forEach(_=>ln(e,_,n,!0));for(const _ in t)if(!(o&&_==="expose")){const v=mc[_]||n&&n[_];e[_]=v?v(e[_],t[_]):t[_]}return e}const mc={data:Kr,props:Vt,emits:Vt,methods:Vt,computed:Vt,beforeCreate:Xe,created:Xe,beforeMount:Xe,mounted:Xe,beforeUpdate:Xe,updated:Xe,beforeDestroy:Xe,beforeUnmount:Xe,destroyed:Xe,unmounted:Xe,activated:Xe,deactivated:Xe,errorCaptured:Xe,serverPrefetch:Xe,components:Vt,directives:Vt,watch:yc,provide:Kr,inject:vc};function Kr(e,t){return t?e?function(){return Ve(Se(e)?e.call(this,this):e,Se(t)?t.call(this,this):t)}:t:e}function vc(e,t){return Vt(Zn(e),Zn(t))}function Zn(e){if(ye(e)){const t={};for(let n=0;n<e.length;n++)t[e[n]]=e[n];return t}return e}function Xe(e,t){return e?[...new Set([].concat(e,t))]:t}function Vt(e,t){return e?Ve(Ve(Object.create(null),e),t):t}function yc(e,t){if(!e)return t;if(!t)return e;const n=Ve(Object.create(null),e);for(const o in t)n[o]=Xe(e[o],t[o]);return n}function Sc(e,t,n,o=!1){const h={},g={};rn(g,On,1),e.propsDefaults=Object.create(null),oa(e,t,h,g);for(const _ in e.propsOptions[0])_ in h||(h[_]=void 0);n?e.props=o?h:Ll(h):e.type.props?e.props=h:e.props=g,e.attrs=g}function bc(e,t,n,o){const{props:h,attrs:g,vnode:{patchFlag:_}}=e,v=we(h),[b]=e.propsOptions;let C=!1;if((o||_>0)&&!(_&16)){if(_&8){const w=e.vnode.dynamicProps;for(let I=0;I<w.length;I++){let A=w[I];if(Tn(e.emitsOptions,A))continue;const V=t[A];if(b)if(Ce(g,A))V!==g[A]&&(g[A]=V,C=!0);else{const J=pt(A);h[J]=er(b,v,J,V,e,!1)}else V!==g[A]&&(g[A]=V,C=!0)}}}else{oa(e,t,h,g)&&(C=!0);let w;for(const I in v)(!t||!Ce(t,I)&&((w=fi(I))===I||!Ce(t,w)))&&(b?n&&(n[I]!==void 0||n[w]!==void 0)&&(h[I]=er(b,v,I,void 0,e,!0)):delete h[I]);if(g!==v)for(const I in g)(!t||!Ce(t,I)&&!0)&&(delete g[I],C=!0)}C&&bt(e,"set","$attrs")}function oa(e,t,n,o){const[h,g]=e.propsOptions;let _=!1,v;if(t)for(let b in t){if(Qi(b))continue;const C=t[b];let w;h&&Ce(h,w=pt(b))?!g||!g.includes(w)?n[w]=C:(v||(v={}))[w]=C:Tn(e.emitsOptions,b)||(!(b in o)||C!==o[b])&&(o[b]=C,_=!0)}if(g){const b=we(n),C=v||Me;for(let w=0;w<g.length;w++){const I=g[w];n[I]=er(h,b,I,C[I],e,!Ce(C,I))}}return _}function er(e,t,n,o,h,g){const _=e[n];if(_!=null){const v=Ce(_,"default");if(v&&o===void 0){const b=_.default;if(_.type!==Function&&Se(b)){const{propsDefaults:C}=h;n in C?o=C[n]:(hi(h),o=C[n]=b.call(null,t),Xt())}else o=b}_[0]&&(g&&!v?o=!1:_[1]&&(o===""||o===fi(n))&&(o=!0))}return o}function aa(e,t,n=!1){const o=t.propsCache,h=o.get(e);if(h)return h;const g=e.props,_={},v=[];let b=!1;if(!Se(e)){const w=I=>{b=!0;const[A,V]=aa(I,t,!0);Ve(_,A),V&&v.push(...V)};!n&&t.mixins.length&&t.mixins.forEach(w),e.extends&&w(e.extends),e.mixins&&e.mixins.forEach(w)}if(!g&&!b)return Re(e)&&o.set(e,ri),ri;if(ye(g))for(let w=0;w<g.length;w++){const I=pt(g[w]);Qr(I)&&(_[I]=Me)}else if(g)for(const w in g){const I=pt(w);if(Qr(I)){const A=g[w],V=_[I]=ye(A)||Se(A)?{type:A}:Object.assign({},A);if(V){const J=ts(Boolean,V.type),q=ts(String,V.type);V[0]=J>-1,V[1]=q<0||J<q,(J>-1||Ce(V,"default"))&&v.push(I)}}}const C=[_,v];return Re(e)&&o.set(e,C),C}function Qr(e){return e[0]!=="$"}function Zr(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:e===null?"null":""}function es(e,t){return Zr(e)===Zr(t)}function ts(e,t){return ye(t)?t.findIndex(n=>es(n,e)):Se(t)&&es(t,e)?0:-1}const la=e=>e[0]==="_"||e==="$stable",Or=e=>ye(e)?e.map(ut):[ut(e)],Cc=(e,t,n)=>{if(t._n)return t;const o=ci((...h)=>Or(t(...h)),n);return o._c=!1,o},ca=(e,t,n)=>{const o=e._ctx;for(const h in e){if(la(h))continue;const g=e[h];if(Se(g))t[h]=Cc(h,g,o);else if(g!=null){const _=Or(g);t[h]=()=>_}}},ha=(e,t)=>{const n=Or(t);e.slots.default=()=>n},wc=(e,t)=>{if(e.vnode.shapeFlag&32){const n=t._;n?(e.slots=we(t),rn(t,"_",n)):ca(t,e.slots={})}else e.slots={},t&&ha(e,t);rn(e.slots,On,1)},Tc=(e,t,n)=>{const{vnode:o,slots:h}=e;let g=!0,_=Me;if(o.shapeFlag&32){const v=t._;v?n&&v===1?g=!1:(Ve(h,t),!n&&v===1&&delete h._):(g=!t.$stable,ca(t,h)),_=t}else t&&(ha(e,t),_={default:1});if(g)for(const v in h)!la(v)&&!(v in _)&&delete h[v]};function ua(){return{app:null,config:{isNativeTag:Qa,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let xc=0;function Ec(e,t){return function(o,h=null){Se(o)||(o=Object.assign({},o)),h!=null&&!Re(h)&&(h=null);const g=ua(),_=new Set;let v=!1;const b=g.app={_uid:xc++,_component:o,_props:h,_container:null,_context:g,_instance:null,version:qc,get config(){return g.config},set config(C){},use(C,...w){return _.has(C)||(C&&Se(C.install)?(_.add(C),C.install(b,...w)):Se(C)&&(_.add(C),C(b,...w))),b},mixin(C){return g.mixins.includes(C)||g.mixins.push(C),b},component(C,w){return w?(g.components[C]=w,b):g.components[C]},directive(C,w){return w?(g.directives[C]=w,b):g.directives[C]},mount(C,w,I){if(!v){const A=Oe(o,h);return A.appContext=g,w&&t?t(A,C):e(A,C,I),v=!0,b._container=C,C.__vue_app__=b,Mr(A.component)||A.component.proxy}},unmount(){v&&(e(null,b._container),delete b._container.__vue_app__)},provide(C,w){return g.provides[C]=w,b}};return b}}function tr(e,t,n,o,h=!1){if(ye(e)){e.forEach((A,V)=>tr(A,t&&(ye(t)?t[V]:t),n,o,h));return}if(Ei(o)&&!h)return;const g=o.shapeFlag&4?Mr(o.component)||o.component.proxy:o.el,_=h?null:g,{i:v,r:b}=e,C=t&&t.r,w=v.refs===Me?v.refs={}:v.refs,I=v.setupState;if(C!=null&&C!==b&&(Be(C)?(w[C]=null,Ce(I,C)&&(I[C]=null)):Pe(C)&&(C.value=null)),Se(b))Lt(b,v,12,[_,w]);else{const A=Be(b),V=Pe(b);if(A||V){const J=()=>{if(e.f){const q=A?Ce(I,b)?I[b]:w[b]:b.value;h?ye(q)&&fr(q,g):ye(q)?q.includes(g)||q.push(g):A?(w[b]=[g],Ce(I,b)&&(I[b]=w[b])):(b.value=[g],e.k&&(w[e.k]=b.value))}else A?(w[b]=_,Ce(I,b)&&(I[b]=_)):V&&(b.value=_,e.k&&(w[e.k]=_))};_?(J.id=-1,$e(J,n)):J()}}}const $e=Zl;function Ac(e){return Ic(e)}function Ic(e,t){const n=rl();n.__VUE__=!0;const{insert:o,remove:h,patchProp:g,createElement:_,createText:v,createComment:b,setText:C,setElementText:w,parentNode:I,nextSibling:A,setScopeId:V=lt,insertStaticContent:J}=e,q=(R,D,M,L=null,B=null,U=null,H=!1,k=null,F=!!D.dynamicChildren)=>{if(R===D)return;R&&!Gt(R,D)&&(L=O(R),m(R,B,U,!0),R=null),D.patchFlag===-2&&(F=!1,D.dynamicChildren=null);const{type:N,ref:X,shapeFlag:Y}=D;switch(N){case In:K(R,D,M,L);break;case nt:Z(R,D,M,L);break;case en:R==null&&ne(D,M,L,H);break;case Ue:a(R,D,M,L,B,U,H,k,F);break;default:Y&1?le(R,D,M,L,B,U,H,k,F):Y&6?s(R,D,M,L,B,U,H,k,F):(Y&64||Y&128)&&N.process(R,D,M,L,B,U,H,k,F,j)}X!=null&&B&&tr(X,R&&R.ref,U,D||R,!D)},K=(R,D,M,L)=>{if(R==null)o(D.el=v(D.children),M,L);else{const B=D.el=R.el;D.children!==R.children&&C(B,D.children)}},Z=(R,D,M,L)=>{R==null?o(D.el=b(D.children||""),M,L):D.el=R.el},ne=(R,D,M,L)=>{[R.el,R.anchor]=J(R.children,D,M,L,R.el,R.anchor)},$=({el:R,anchor:D},M,L)=>{let B;for(;R&&R!==D;)B=A(R),o(R,M,L),R=B;o(D,M,L)},re=({el:R,anchor:D})=>{let M;for(;R&&R!==D;)M=A(R),h(R),R=M;h(D)},le=(R,D,M,L,B,U,H,k,F)=>{H=H||D.type==="svg",R==null?pe(D,M,L,B,U,H,k,F):me(R,D,B,U,H,k,F)},pe=(R,D,M,L,B,U,H,k)=>{let F,N;const{type:X,props:Y,shapeFlag:Q,transition:ee,dirs:te}=R;if(F=R.el=_(R.type,U,Y&&Y.is,Y),Q&8?w(F,R.children):Q&16&&y(R.children,F,null,L,B,U&&X!=="foreignObject",H,k),te&&Bt(R,null,L,"created"),Y){for(const se in Y)se!=="value"&&!Qi(se)&&g(F,se,null,Y[se],U,R.children,L,B,E);"value"in Y&&g(F,"value",null,Y.value),(N=Y.onVnodeBeforeMount)&&ht(N,L,R)}ge(F,R,R.scopeId,H,L),te&&Bt(R,null,L,"beforeMount");const ie=(!B||B&&!B.pendingBranch)&&ee&&!ee.persisted;ie&&ee.beforeEnter(F),o(F,D,M),((N=Y&&Y.onVnodeMounted)||ie||te)&&$e(()=>{N&&ht(N,L,R),ie&&ee.enter(F),te&&Bt(R,null,L,"mounted")},B)},ge=(R,D,M,L,B)=>{if(M&&V(R,M),L)for(let U=0;U<L.length;U++)V(R,L[U]);if(B){let U=B.subTree;if(D===U){const H=B.vnode;ge(R,H,H.scopeId,H.slotScopeIds,B.parent)}}},y=(R,D,M,L,B,U,H,k,F=0)=>{for(let N=F;N<R.length;N++){const X=R[N]=k?It(R[N]):ut(R[N]);q(null,X,D,M,L,B,U,H,k)}},me=(R,D,M,L,B,U,H)=>{const k=D.el=R.el;let{patchFlag:F,dynamicChildren:N,dirs:X}=D;F|=R.patchFlag&16;const Y=R.props||Me,Q=D.props||Me;let ee;M&&Nt(M,!1),(ee=Q.onVnodeBeforeUpdate)&&ht(ee,M,D,R),X&&Bt(D,R,M,"beforeUpdate"),M&&Nt(M,!0);const te=B&&D.type!=="foreignObject";if(N?ce(R.dynamicChildren,N,k,M,L,te,U):H||c(R,D,k,null,M,L,te,U,!1),F>0){if(F&16)de(k,D,Y,Q,M,L,B);else if(F&2&&Y.class!==Q.class&&g(k,"class",null,Q.class,B),F&4&&g(k,"style",Y.style,Q.style,B),F&8){const ie=D.dynamicProps;for(let se=0;se<ie.length;se++){const oe=ie[se],ue=Y[oe],_e=Q[oe];(_e!==ue||oe==="value")&&g(k,oe,ue,_e,B,R.children,M,L,E)}}F&1&&R.children!==D.children&&w(k,D.children)}else!H&&N==null&&de(k,D,Y,Q,M,L,B);((ee=Q.onVnodeUpdated)||X)&&$e(()=>{ee&&ht(ee,M,D,R),X&&Bt(D,R,M,"updated")},L)},ce=(R,D,M,L,B,U,H)=>{for(let k=0;k<D.length;k++){const F=R[k],N=D[k],X=F.el&&(F.type===Ue||!Gt(F,N)||F.shapeFlag&70)?I(F.el):M;q(F,N,X,null,L,B,U,H,!0)}},de=(R,D,M,L,B,U,H)=>{if(M!==L){if(M!==Me)for(const k in M)!Qi(k)&&!(k in L)&&g(R,k,M[k],null,H,D.children,B,U,E);for(const k in L){if(Qi(k))continue;const F=L[k],N=M[k];F!==N&&k!=="value"&&g(R,k,N,F,H,D.children,B,U,E)}"value"in L&&g(R,"value",M.value,L.value)}},a=(R,D,M,L,B,U,H,k,F)=>{const N=D.el=R?R.el:v(""),X=D.anchor=R?R.anchor:v("");let{patchFlag:Y,dynamicChildren:Q,slotScopeIds:ee}=D;ee&&(k=k?k.concat(ee):ee),R==null?(o(N,M,L),o(X,M,L),y(D.children,M,X,B,U,H,k,F)):Y>0&&Y&64&&Q&&R.dynamicChildren?(ce(R.dynamicChildren,Q,M,B,U,H,k),(D.key!=null||B&&D===B.subTree)&&da(R,D,!0)):c(R,D,M,X,B,U,H,k,F)},s=(R,D,M,L,B,U,H,k,F)=>{D.slotScopeIds=k,R==null?D.shapeFlag&512?B.ctx.activate(D,M,L,H,F):l(D,M,L,B,U,H,F):u(R,D,F)},l=(R,D,M,L,B,U,H)=>{const k=R.component=jc(R,L,B);if(En(R)&&(k.ctx.renderer=j),Vc(k),k.asyncDep){if(B&&B.registerDep(k,i),!R.el){const F=k.subTree=Oe(nt);Z(null,F,D,M)}return}i(k,R,D,M,B,U,H)},u=(R,D,M)=>{const L=D.component=R.component;if($l(R,D,M))if(L.asyncDep&&!L.asyncResolved){r(L,D,M);return}else L.next=D,Hl(L.update),L.update();else D.el=R.el,L.vnode=D},i=(R,D,M,L,B,U,H)=>{const k=()=>{if(R.isMounted){let{next:X,bu:Y,u:Q,parent:ee,vnode:te}=R,ie=X,se;Nt(R,!1),X?(X.el=te.el,r(R,X,H)):X=te,Y&&Fn(Y),(se=X.props&&X.props.onVnodeBeforeUpdate)&&ht(se,ee,X,te),Nt(R,!0);const oe=kn(R),ue=R.subTree;R.subTree=oe,q(ue,oe,I(ue.el),O(ue),R,B,U),X.el=oe.el,ie===null&&Kl(R,oe.el),Q&&$e(Q,B),(se=X.props&&X.props.onVnodeUpdated)&&$e(()=>ht(se,ee,X,te),B)}else{let X;const{el:Y,props:Q}=D,{bm:ee,m:te,parent:ie}=R,se=Ei(D);if(Nt(R,!1),ee&&Fn(ee),!se&&(X=Q&&Q.onVnodeBeforeMount)&&ht(X,ie,D),Nt(R,!0),Y&&z){const oe=()=>{R.subTree=kn(R),z(Y,R.subTree,R,B,null)};se?D.type.__asyncLoader().then(()=>!R.isUnmounted&&oe()):oe()}else{const oe=R.subTree=kn(R);q(null,oe,M,L,R,B,U),D.el=oe.el}if(te&&$e(te,B),!se&&(X=Q&&Q.onVnodeMounted)){const oe=D;$e(()=>ht(X,ie,oe),B)}(D.shapeFlag&256||ie&&Ei(ie.vnode)&&ie.vnode.shapeFlag&256)&&R.a&&$e(R.a,B),R.isMounted=!0,D=M=L=null}},F=R.effect=new vr(k,()=>Er(N),R.scope),N=R.update=()=>F.run();N.id=R.uid,Nt(R,!0),N()},r=(R,D,M)=>{D.component=R;const L=R.vnode.props;R.vnode=D,R.next=null,bc(R,D.props,L,M),Tc(R,D.children,M),gi(),Xr(),pi()},c=(R,D,M,L,B,U,H,k,F=!1)=>{const N=R&&R.children,X=R?R.shapeFlag:0,Y=D.children,{patchFlag:Q,shapeFlag:ee}=D;if(Q>0){if(Q&128){d(N,Y,M,L,B,U,H,k,F);return}else if(Q&256){p(N,Y,M,L,B,U,H,k,F);return}}ee&8?(X&16&&E(N,B,U),Y!==N&&w(M,Y)):X&16?ee&16?d(N,Y,M,L,B,U,H,k,F):E(N,B,U,!0):(X&8&&w(M,""),ee&16&&y(Y,M,L,B,U,H,k,F))},p=(R,D,M,L,B,U,H,k,F)=>{R=R||ri,D=D||ri;const N=R.length,X=D.length,Y=Math.min(N,X);let Q;for(Q=0;Q<Y;Q++){const ee=D[Q]=F?It(D[Q]):ut(D[Q]);q(R[Q],ee,M,null,B,U,H,k,F)}N>X?E(R,B,U,!0,!1,Y):y(D,M,L,B,U,H,k,F,Y)},d=(R,D,M,L,B,U,H,k,F)=>{let N=0;const X=D.length;let Y=R.length-1,Q=X-1;for(;N<=Y&&N<=Q;){const ee=R[N],te=D[N]=F?It(D[N]):ut(D[N]);if(Gt(ee,te))q(ee,te,M,null,B,U,H,k,F);else break;N++}for(;N<=Y&&N<=Q;){const ee=R[Y],te=D[Q]=F?It(D[Q]):ut(D[Q]);if(Gt(ee,te))q(ee,te,M,null,B,U,H,k,F);else break;Y--,Q--}if(N>Y){if(N<=Q){const ee=Q+1,te=ee<X?D[ee].el:L;for(;N<=Q;)q(null,D[N]=F?It(D[N]):ut(D[N]),M,te,B,U,H,k,F),N++}}else if(N>Q)for(;N<=Y;)m(R[N],B,U,!0),N++;else{const ee=N,te=N,ie=new Map;for(N=te;N<=Q;N++){const Ae=D[N]=F?It(D[N]):ut(D[N]);Ae.key!=null&&ie.set(Ae.key,N)}let se,oe=0;const ue=Q-te+1;let _e=!1,fe=0;const ve=new Array(ue);for(N=0;N<ue;N++)ve[N]=0;for(N=ee;N<=Y;N++){const Ae=R[N];if(oe>=ue){m(Ae,B,U,!0);continue}let Fe;if(Ae.key!=null)Fe=ie.get(Ae.key);else for(se=te;se<=Q;se++)if(ve[se-te]===0&&Gt(Ae,D[se])){Fe=se;break}Fe===void 0?m(Ae,B,U,!0):(ve[Fe-te]=N+1,Fe>=fe?fe=Fe:_e=!0,q(Ae,D[Fe],M,null,B,U,H,k,F),oe++)}const be=_e?Oc(ve):ri;for(se=be.length-1,N=ue-1;N>=0;N--){const Ae=te+N,Fe=D[Ae],_t=Ae+1<X?D[Ae+1].el:L;ve[N]===0?q(null,Fe,M,_t,B,U,H,k,F):_e&&(se<0||N!==be[se]?f(Fe,M,_t,2):se--)}}},f=(R,D,M,L,B=null)=>{const{el:U,type:H,transition:k,children:F,shapeFlag:N}=R;if(N&6){f(R.component.subTree,D,M,L);return}if(N&128){R.suspense.move(D,M,L);return}if(N&64){H.move(R,D,M,j);return}if(H===Ue){o(U,D,M);for(let Y=0;Y<F.length;Y++)f(F[Y],D,M,L);o(R.anchor,D,M);return}if(H===en){$(R,D,M);return}if(L!==2&&N&1&&k)if(L===0)k.beforeEnter(U),o(U,D,M),$e(()=>k.enter(U),B);else{const{leave:Y,delayLeave:Q,afterLeave:ee}=k,te=()=>o(U,D,M),ie=()=>{Y(U,()=>{te(),ee&&ee()})};Q?Q(U,te,ie):ie()}else o(U,D,M)},m=(R,D,M,L=!1,B=!1)=>{const{type:U,props:H,ref:k,children:F,dynamicChildren:N,shapeFlag:X,patchFlag:Y,dirs:Q}=R;if(k!=null&&tr(k,null,M,R,!0),X&256){D.ctx.deactivate(R);return}const ee=X&1&&Q,te=!Ei(R);let ie;if(te&&(ie=H&&H.onVnodeBeforeUnmount)&&ht(ie,D,R),X&6)x(R.component,M,L);else{if(X&128){R.suspense.unmount(M,L);return}ee&&Bt(R,null,D,"beforeUnmount"),X&64?R.type.remove(R,D,M,B,j,L):N&&(U!==Ue||Y>0&&Y&64)?E(N,D,M,!1,!0):(U===Ue&&Y&384||!B&&X&16)&&E(F,D,M),L&&S(R)}(te&&(ie=H&&H.onVnodeUnmounted)||ee)&&$e(()=>{ie&&ht(ie,D,R),ee&&Bt(R,null,D,"unmounted")},M)},S=R=>{const{type:D,el:M,anchor:L,transition:B}=R;if(D===Ue){T(M,L);return}if(D===en){re(R);return}const U=()=>{h(M),B&&!B.persisted&&B.afterLeave&&B.afterLeave()};if(R.shapeFlag&1&&B&&!B.persisted){const{leave:H,delayLeave:k}=B,F=()=>H(M,U);k?k(R.el,U,F):F()}else U()},T=(R,D)=>{let M;for(;R!==D;)M=A(R),h(R),R=M;h(D)},x=(R,D,M)=>{const{bum:L,scope:B,update:U,subTree:H,um:k}=R;L&&Fn(L),B.stop(),U&&(U.active=!1,m(H,R,D,M)),k&&$e(k,D),$e(()=>{R.isUnmounted=!0},D),D&&D.pendingBranch&&!D.isUnmounted&&R.asyncDep&&!R.asyncResolved&&R.suspenseId===D.pendingId&&(D.deps--,D.deps===0&&D.resolve())},E=(R,D,M,L=!1,B=!1,U=0)=>{for(let H=U;H<R.length;H++)m(R[H],D,M,L,B)},O=R=>R.shapeFlag&6?O(R.component.subTree):R.shapeFlag&128?R.suspense.next():A(R.anchor||R.el),P=(R,D,M)=>{R==null?D._vnode&&m(D._vnode,null,null,!0):q(D._vnode||null,R,D,null,null,null,M),Xr(),Ho(),D._vnode=R},j={p:q,um:m,m:f,r:S,mt:l,mc:y,pc:c,pbc:ce,n:O,o:e};let W,z;return t&&([W,z]=t(j)),{render:P,hydrate:W,createApp:Ec(P,W)}}function Nt({effect:e,update:t},n){e.allowRecurse=t.allowRecurse=n}function da(e,t,n=!1){const o=e.children,h=t.children;if(ye(o)&&ye(h))for(let g=0;g<o.length;g++){const _=o[g];let v=h[g];v.shapeFlag&1&&!v.dynamicChildren&&((v.patchFlag<=0||v.patchFlag===32)&&(v=h[g]=It(h[g]),v.el=_.el),n||da(_,v)),v.type===In&&(v.el=_.el)}}function Oc(e){const t=e.slice(),n=[0];let o,h,g,_,v;const b=e.length;for(o=0;o<b;o++){const C=e[o];if(C!==0){if(h=n[n.length-1],e[h]<C){t[o]=h,n.push(o);continue}for(g=0,_=n.length-1;g<_;)v=g+_>>1,e[n[v]]<C?g=v+1:_=v;C<e[n[g]]&&(g>0&&(t[o]=n[g-1]),n[g]=o)}}for(g=n.length,_=n[g-1];g-- >0;)n[g]=_,_=t[_];return n}const Rc=e=>e.__isTeleport,Ue=Symbol(void 0),In=Symbol(void 0),nt=Symbol(void 0),en=Symbol(void 0),Ii=[];let at=null;function He(e=!1){Ii.push(at=e?null:[])}function Dc(){Ii.pop(),at=Ii[Ii.length-1]||null}let Ni=1;function is(e){Ni+=e}function fa(e){return e.dynamicChildren=Ni>0?at||ri:null,Dc(),Ni>0&&at&&at.push(e),e}function rt(e,t,n,o,h,g){return fa(Ie(e,t,n,o,h,g,!0))}function cn(e,t,n,o,h){return fa(Oe(e,t,n,o,h,!0))}function hn(e){return e?e.__v_isVNode===!0:!1}function Gt(e,t){return e.type===t.type&&e.key===t.key}const On="__vInternal",ga=({key:e})=>e!=null?e:null,tn=({ref:e,ref_key:t,ref_for:n})=>e!=null?Be(e)||Pe(e)||Se(e)?{i:Ye,r:e,k:t,f:!!n}:e:null;function Ie(e,t=null,n=null,o=0,h=null,g=e===Ue?0:1,_=!1,v=!1){const b={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&ga(t),ref:t&&tn(t),scopeId:xn,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:g,patchFlag:o,dynamicProps:h,dynamicChildren:null,appContext:null,ctx:Ye};return v?(Rr(b,n),g&128&&e.normalize(b)):n&&(b.shapeFlag|=Be(n)?8:16),Ni>0&&!_&&at&&(b.patchFlag>0||g&6)&&b.patchFlag!==32&&at.push(b),b}const Oe=Mc;function Mc(e,t=null,n=null,o=0,h=null,g=!1){if((!e||e===dc)&&(e=nt),hn(e)){const v=Ft(e,t,!0);return n&&Rr(v,n),Ni>0&&!g&&at&&(v.shapeFlag&6?at[at.indexOf(e)]=v:at.push(v)),v.patchFlag|=-2,v}if(Yc(e)&&(e=e.__vccOpts),t){t=Lc(t);let{class:v,style:b}=t;v&&!Be(v)&&(t.class=ur(v)),Re(b)&&(ko(b)&&!ye(b)&&(b=Ve({},b)),t.style=hr(b))}const _=Be(e)?1:Ql(e)?128:Rc(e)?64:Re(e)?4:Se(e)?2:0;return Ie(e,t,n,o,h,_,g,!0)}function Lc(e){return e?ko(e)||On in e?Ve({},e):e:null}function Ft(e,t,n=!1){const{props:o,ref:h,patchFlag:g,children:_}=e,v=t?kc(o||{},t):o;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:v,key:v&&ga(v),ref:t&&t.ref?n&&h?ye(h)?h.concat(tn(t)):[h,tn(t)]:tn(t):h,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:_,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==Ue?g===-1?16:g|16:g,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Ft(e.ssContent),ssFallback:e.ssFallback&&Ft(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx}}function Pc(e=" ",t=0){return Oe(In,null,e,t)}function of(e,t){const n=Oe(en,null,e);return n.staticCount=t,n}function Fc(e="",t=!1){return t?(He(),cn(nt,null,e)):Oe(nt,null,e)}function ut(e){return e==null||typeof e=="boolean"?Oe(nt):ye(e)?Oe(Ue,null,e.slice()):typeof e=="object"?It(e):Oe(In,null,String(e))}function It(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Ft(e)}function Rr(e,t){let n=0;const{shapeFlag:o}=e;if(t==null)t=null;else if(ye(t))n=16;else if(typeof t=="object")if(o&65){const h=t.default;h&&(h._c&&(h._d=!1),Rr(e,h()),h._c&&(h._d=!0));return}else{n=32;const h=t._;!h&&!(On in t)?t._ctx=Ye:h===3&&Ye&&(Ye.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else Se(t)?(t={default:t,_ctx:Ye},n=32):(t=String(t),o&64?(n=16,t=[Pc(t)]):n=8);e.children=t,e.shapeFlag|=n}function kc(...e){const t={};for(let n=0;n<e.length;n++){const o=e[n];for(const h in o)if(h==="class")t.class!==o.class&&(t.class=ur([t.class,o.class]));else if(h==="style")t.style=hr([t.style,o.style]);else if(mn(h)){const g=t[h],_=o[h];_&&g!==_&&!(ye(g)&&g.includes(_))&&(t[h]=g?[].concat(g,_):_)}else h!==""&&(t[h]=o[h])}return t}function ht(e,t,n,o=null){it(e,t,7,[n,o])}const Bc=ua();let Nc=0;function jc(e,t,n){const o=e.type,h=(t?t.appContext:e.appContext)||Bc,g={uid:Nc++,vnode:e,type:o,parent:t,appContext:h,root:null,next:null,subTree:null,effect:null,update:null,scope:new wo(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(h.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:aa(o,h),emitsOptions:Xo(o,h),emit:null,emitted:null,propsDefaults:Me,inheritAttrs:o.inheritAttrs,ctx:Me,data:Me,props:Me,attrs:Me,slots:Me,refs:Me,setupState:Me,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return g.ctx={_:g},g.root=t?t.root:g,g.emit=zl.bind(null,g),e.ce&&e.ce(g),g}let je=null;const Dr=()=>je||Ye,hi=e=>{je=e,e.scope.on()},Xt=()=>{je&&je.scope.off(),je=null};function pa(e){return e.vnode.shapeFlag&4}let ji=!1;function Vc(e,t=!1){ji=t;const{props:n,children:o}=e.vnode,h=pa(e);Sc(e,n,h,t),wc(e,o);const g=h?Uc(e,t):void 0;return ji=!1,g}function Uc(e,t){const n=e.type;e.accessCache=Object.create(null),e.proxy=li(new Proxy(e.ctx,gc));const{setup:o}=n;if(o){const h=e.setupContext=o.length>1?Wc(e):null;hi(e),gi();const g=Lt(o,e,0,[e.props,h]);if(pi(),Xt(),So(g)){if(g.then(Xt,Xt),t)return g.then(_=>{ns(e,_,t)}).catch(_=>{wn(_,e,0)});e.asyncDep=g}else ns(e,g,t)}else _a(e,t)}function ns(e,t,n){Se(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Re(t)&&(e.setupState=Vo(t)),_a(e,n)}let rs;function _a(e,t,n){const o=e.type;if(!e.render){if(!t&&rs&&!o.render){const h=o.template||Ir(e).template;if(h){const{isCustomElement:g,compilerOptions:_}=e.appContext.config,{delimiters:v,compilerOptions:b}=o,C=Ve(Ve({isCustomElement:g,delimiters:v},_),b);o.render=rs(h,C)}}e.render=o.render||lt}hi(e),gi(),pc(e),pi(),Xt()}function Gc(e){return new Proxy(e.attrs,{get(t,n){return Ze(e,"get","$attrs"),t[n]}})}function Wc(e){const t=o=>{e.exposed=o||{}};let n;return{get attrs(){return n||(n=Gc(e))},slots:e.slots,emit:e.emit,expose:t}}function Mr(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(Vo(li(e.exposed)),{get(t,n){if(n in t)return t[n];if(n in Ai)return Ai[n](e)},has(t,n){return n in t||n in Ai}}))}function Hc(e,t=!0){return Se(e)?e.displayName||e.name:e.name||t&&e.__name}function Yc(e){return Se(e)&&"__vccOpts"in e}const Ke=(e,t)=>Ul(e,t,ji);function ma(e,t,n){const o=arguments.length;return o===2?Re(t)&&!ye(t)?hn(t)?Oe(e,null,[t]):Oe(e,t):Oe(e,null,t):(o>3?n=Array.prototype.slice.call(arguments,2):o===3&&hn(n)&&(n=[n]),Oe(e,t,n))}const Xc=Symbol(""),zc=()=>gt(Xc),qc="3.2.45",Jc="http://www.w3.org/2000/svg",Wt=typeof document<"u"?document:null,ss=Wt&&Wt.createElement("template"),$c={insert:(e,t,n)=>{t.insertBefore(e,n||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,n,o)=>{const h=t?Wt.createElementNS(Jc,e):Wt.createElement(e,n?{is:n}:void 0);return e==="select"&&o&&o.multiple!=null&&h.setAttribute("multiple",o.multiple),h},createText:e=>Wt.createTextNode(e),createComment:e=>Wt.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>Wt.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,n,o,h,g){const _=n?n.previousSibling:t.lastChild;if(h&&(h===g||h.nextSibling))for(;t.insertBefore(h.cloneNode(!0),n),!(h===g||!(h=h.nextSibling)););else{ss.innerHTML=o?`<svg>${e}</svg>`:e;const v=ss.content;if(o){const b=v.firstChild;for(;b.firstChild;)v.appendChild(b.firstChild);v.removeChild(b)}t.insertBefore(v,n)}return[_?_.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}};function Kc(e,t,n){const o=e._vtc;o&&(t=(t?[t,...o]:[...o]).join(" ")),t==null?e.removeAttribute("class"):n?e.setAttribute("class",t):e.className=t}function Qc(e,t,n){const o=e.style,h=Be(n);if(n&&!h){for(const g in n)ir(o,g,n[g]);if(t&&!Be(t))for(const g in t)n[g]==null&&ir(o,g,"")}else{const g=o.display;h?t!==n&&(o.cssText=n):t&&e.removeAttribute("style"),"_vod"in e&&(o.display=g)}}const os=/\s*!important$/;function ir(e,t,n){if(ye(n))n.forEach(o=>ir(e,t,o));else if(n==null&&(n=""),t.startsWith("--"))e.setProperty(t,n);else{const o=Zc(e,t);os.test(n)?e.setProperty(fi(o),n.replace(os,""),"important"):e[o]=n}}const as=["Webkit","Moz","ms"],jn={};function Zc(e,t){const n=jn[t];if(n)return n;let o=pt(t);if(o!=="filter"&&o in e)return jn[t]=o;o=Sn(o);for(let h=0;h<as.length;h++){const g=as[h]+o;if(g in e)return jn[t]=g}return t}const ls="http://www.w3.org/1999/xlink";function eh(e,t,n,o,h){if(o&&t.startsWith("xlink:"))n==null?e.removeAttributeNS(ls,t.slice(6,t.length)):e.setAttributeNS(ls,t,n);else{const g=Ka(t);n==null||g&&!mo(n)?e.removeAttribute(t):e.setAttribute(t,g?"":n)}}function th(e,t,n,o,h,g,_){if(t==="innerHTML"||t==="textContent"){o&&_(o,h,g),e[t]=n==null?"":n;return}if(t==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=n;const b=n==null?"":n;(e.value!==b||e.tagName==="OPTION")&&(e.value=b),n==null&&e.removeAttribute(t);return}let v=!1;if(n===""||n==null){const b=typeof e[t];b==="boolean"?n=mo(n):n==null&&b==="string"?(n="",v=!0):b==="number"&&(n=0,v=!0)}try{e[t]=n}catch{}v&&e.removeAttribute(t)}function ih(e,t,n,o){e.addEventListener(t,n,o)}function nh(e,t,n,o){e.removeEventListener(t,n,o)}function rh(e,t,n,o,h=null){const g=e._vei||(e._vei={}),_=g[t];if(o&&_)_.value=o;else{const[v,b]=sh(t);if(o){const C=g[t]=lh(o,h);ih(e,v,C,b)}else _&&(nh(e,v,_,b),g[t]=void 0)}}const cs=/(?:Once|Passive|Capture)$/;function sh(e){let t;if(cs.test(e)){t={};let o;for(;o=e.match(cs);)e=e.slice(0,e.length-o[0].length),t[o[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):fi(e.slice(2)),t]}let Vn=0;const oh=Promise.resolve(),ah=()=>Vn||(oh.then(()=>Vn=0),Vn=Date.now());function lh(e,t){const n=o=>{if(!o._vts)o._vts=Date.now();else if(o._vts<=n.attached)return;it(ch(o,n.value),t,5,[o])};return n.value=e,n.attached=ah(),n}function ch(e,t){if(ye(t)){const n=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{n.call(e),e._stopped=!0},t.map(o=>h=>!h._stopped&&o&&o(h))}else return t}const hs=/^on[a-z]/,hh=(e,t,n,o,h=!1,g,_,v,b)=>{t==="class"?Kc(e,o,h):t==="style"?Qc(e,n,o):mn(t)?dr(t)||rh(e,t,n,o,_):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):uh(e,t,o,h))?th(e,t,o,g,_,v,b):(t==="true-value"?e._trueValue=o:t==="false-value"&&(e._falseValue=o),eh(e,t,o,h))};function uh(e,t,n,o){return o?!!(t==="innerHTML"||t==="textContent"||t in e&&hs.test(t)&&Se(n)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||hs.test(t)&&Be(n)?!1:t in e}const xt="transition",Si="animation",va={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},dh=Ve({},ic.props,va),jt=(e,t=[])=>{ye(e)?e.forEach(n=>n(...t)):e&&e(...t)},us=e=>e?ye(e)?e.some(t=>t.length>1):e.length>1:!1;function fh(e){const t={};for(const a in e)a in va||(t[a]=e[a]);if(e.css===!1)return t;const{name:n="v",type:o,duration:h,enterFromClass:g=`${n}-enter-from`,enterActiveClass:_=`${n}-enter-active`,enterToClass:v=`${n}-enter-to`,appearFromClass:b=g,appearActiveClass:C=_,appearToClass:w=v,leaveFromClass:I=`${n}-leave-from`,leaveActiveClass:A=`${n}-leave-active`,leaveToClass:V=`${n}-leave-to`}=e,J=gh(h),q=J&&J[0],K=J&&J[1],{onBeforeEnter:Z,onEnter:ne,onEnterCancelled:$,onLeave:re,onLeaveCancelled:le,onBeforeAppear:pe=Z,onAppear:ge=ne,onAppearCancelled:y=$}=t,me=(a,s,l)=>{At(a,s?w:v),At(a,s?C:_),l&&l()},ce=(a,s)=>{a._isLeaving=!1,At(a,I),At(a,V),At(a,A),s&&s()},de=a=>(s,l)=>{const u=a?ge:ne,i=()=>me(s,a,l);jt(u,[s,i]),ds(()=>{At(s,a?b:g),vt(s,a?w:v),us(u)||fs(s,o,q,i)})};return Ve(t,{onBeforeEnter(a){jt(Z,[a]),vt(a,g),vt(a,_)},onBeforeAppear(a){jt(pe,[a]),vt(a,b),vt(a,C)},onEnter:de(!1),onAppear:de(!0),onLeave(a,s){a._isLeaving=!0;const l=()=>ce(a,s);vt(a,I),Sa(),vt(a,A),ds(()=>{!a._isLeaving||(At(a,I),vt(a,V),us(re)||fs(a,o,K,l))}),jt(re,[a,l])},onEnterCancelled(a){me(a,!1),jt($,[a])},onAppearCancelled(a){me(a,!0),jt(y,[a])},onLeaveCancelled(a){ce(a),jt(le,[a])}})}function gh(e){if(e==null)return null;if(Re(e))return[Un(e.enter),Un(e.leave)];{const t=Un(e);return[t,t]}}function Un(e){return _r(e)}function vt(e,t){t.split(/\s+/).forEach(n=>n&&e.classList.add(n)),(e._vtc||(e._vtc=new Set)).add(t)}function At(e,t){t.split(/\s+/).forEach(o=>o&&e.classList.remove(o));const{_vtc:n}=e;n&&(n.delete(t),n.size||(e._vtc=void 0))}function ds(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let ph=0;function fs(e,t,n,o){const h=e._endId=++ph,g=()=>{h===e._endId&&o()};if(n)return setTimeout(g,n);const{type:_,timeout:v,propCount:b}=ya(e,t);if(!_)return o();const C=_+"end";let w=0;const I=()=>{e.removeEventListener(C,A),g()},A=V=>{V.target===e&&++w>=b&&I()};setTimeout(()=>{w<b&&I()},v+1),e.addEventListener(C,A)}function ya(e,t){const n=window.getComputedStyle(e),o=J=>(n[J]||"").split(", "),h=o(`${xt}Delay`),g=o(`${xt}Duration`),_=gs(h,g),v=o(`${Si}Delay`),b=o(`${Si}Duration`),C=gs(v,b);let w=null,I=0,A=0;t===xt?_>0&&(w=xt,I=_,A=g.length):t===Si?C>0&&(w=Si,I=C,A=b.length):(I=Math.max(_,C),w=I>0?_>C?xt:Si:null,A=w?w===xt?g.length:b.length:0);const V=w===xt&&/\b(transform|all)(,|$)/.test(o(`${xt}Property`).toString());return{type:w,timeout:I,propCount:A,hasTransform:V}}function gs(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((n,o)=>ps(n)+ps(e[o])))}function ps(e){return Number(e.slice(0,-1).replace(",","."))*1e3}function Sa(){return document.body.offsetHeight}const ba=new WeakMap,Ca=new WeakMap,_h={name:"TransitionGroup",props:Ve({},dh,{tag:String,moveClass:String}),setup(e,{slots:t}){const n=Dr(),o=Ko();let h,g;return ea(()=>{if(!h.length)return;const _=e.moveClass||`${e.name||"v"}-move`;if(!bh(h[0].el,n.vnode.el,_))return;h.forEach(vh),h.forEach(yh);const v=h.filter(Sh);Sa(),v.forEach(b=>{const C=b.el,w=C.style;vt(C,_),w.transform=w.webkitTransform=w.transitionDuration="";const I=C._moveCb=A=>{A&&A.target!==C||(!A||/transform$/.test(A.propertyName))&&(C.removeEventListener("transitionend",I),C._moveCb=null,At(C,_))};C.addEventListener("transitionend",I)})}),()=>{const _=we(e),v=fh(_);let b=_.tag||Ue;h=g,g=t.default?Ar(t.default()):[];for(let C=0;C<g.length;C++){const w=g[C];w.key!=null&&Bi(w,ki(w,v,o,n))}if(h)for(let C=0;C<h.length;C++){const w=h[C];Bi(w,ki(w,v,o,n)),ba.set(w,w.el.getBoundingClientRect())}return Oe(b,null,g)}}},mh=_h;function vh(e){const t=e.el;t._moveCb&&t._moveCb(),t._enterCb&&t._enterCb()}function yh(e){Ca.set(e,e.el.getBoundingClientRect())}function Sh(e){const t=ba.get(e),n=Ca.get(e),o=t.left-n.left,h=t.top-n.top;if(o||h){const g=e.el.style;return g.transform=g.webkitTransform=`translate(${o}px,${h}px)`,g.transitionDuration="0s",e}}function bh(e,t,n){const o=e.cloneNode();e._vtc&&e._vtc.forEach(_=>{_.split(/\s+/).forEach(v=>v&&o.classList.remove(v))}),n.split(/\s+/).forEach(_=>_&&o.classList.add(_)),o.style.display="none";const h=t.nodeType===1?t:t.parentNode;h.appendChild(o);const{hasTransform:g}=ya(o);return h.removeChild(o),g}const Ch=Ve({patchProp:hh},$c);let _s;function wh(){return _s||(_s=Ac(Ch))}const Th=(...e)=>{const t=wh().createApp(...e),{mount:n}=t;return t.mount=o=>{const h=xh(o);if(!h)return;const g=t._component;!Se(g)&&!g.render&&!g.template&&(g.template=h.innerHTML),h.innerHTML="";const _=n(h,!1,h instanceof SVGElement);return h instanceof Element&&(h.removeAttribute("v-cloak"),h.setAttribute("data-v-app","")),_},t};function xh(e){return Be(e)?document.querySelector(e):e}var Eh=!1;/*!
  * pinia v2.0.27
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */let wa;const Rn=e=>wa=e,Ta=Symbol();function nr(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var Oi;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(Oi||(Oi={}));function Ah(){const e=To(!0),t=e.run(()=>Cn({}));let n=[],o=[];const h=li({install(g){Rn(h),h._a=g,g.provide(Ta,h),g.config.globalProperties.$pinia=h,o.forEach(_=>n.push(_)),o=[]},use(g){return!this._a&&!Eh?o.push(g):n.push(g),this},_p:n,_a:null,_e:e,_s:new Map,state:t});return h}const xa=()=>{};function ms(e,t,n,o=xa){e.push(t);const h=()=>{const g=e.indexOf(t);g>-1&&(e.splice(g,1),o())};return!n&&ol()&&al(h),h}function Kt(e,...t){e.slice().forEach(n=>{n(...t)})}function rr(e,t){e instanceof Map&&t instanceof Map&&t.forEach((n,o)=>e.set(o,n)),e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const n in t){if(!t.hasOwnProperty(n))continue;const o=t[n],h=e[n];nr(h)&&nr(o)&&e.hasOwnProperty(n)&&!Pe(o)&&!Mt(o)?e[n]=rr(h,o):e[n]=o}return e}const Ih=Symbol();function Oh(e){return!nr(e)||!e.hasOwnProperty(Ih)}const{assign:Ot}=Object;function Rh(e){return!!(Pe(e)&&e.effect)}function Dh(e,t,n,o){const{state:h,actions:g,getters:_}=t,v=n.state.value[e];let b;function C(){v||(n.state.value[e]=h?h():{});const w=Bl(n.state.value[e]);return Ot(w,g,Object.keys(_||{}).reduce((I,A)=>(I[A]=li(Ke(()=>{Rn(n);const V=n._s.get(e);return _[A].call(V,V)})),I),{}))}return b=Ea(e,C,t,n,o,!0),b.$reset=function(){const I=h?h():{};this.$patch(A=>{Ot(A,I)})},b}function Ea(e,t,n={},o,h,g){let _;const v=Ot({actions:{}},n),b={deep:!0};let C,w,I=li([]),A=li([]),V;const J=o.state.value[e];!g&&!J&&(o.state.value[e]={}),Cn({});let q;function K(ge){let y;C=w=!1,typeof ge=="function"?(ge(o.state.value[e]),y={type:Oi.patchFunction,storeId:e,events:V}):(rr(o.state.value[e],ge),y={type:Oi.patchObject,payload:ge,storeId:e,events:V});const me=q=Symbol();xr().then(()=>{q===me&&(C=!0)}),w=!0,Kt(I,y,o.state.value[e])}const Z=xa;function ne(){_.stop(),I=[],A=[],o._s.delete(e)}function $(ge,y){return function(){Rn(o);const me=Array.from(arguments),ce=[],de=[];function a(u){ce.push(u)}function s(u){de.push(u)}Kt(A,{args:me,name:ge,store:le,after:a,onError:s});let l;try{l=y.apply(this&&this.$id===e?this:le,me)}catch(u){throw Kt(de,u),u}return l instanceof Promise?l.then(u=>(Kt(ce,u),u)).catch(u=>(Kt(de,u),Promise.reject(u))):(Kt(ce,l),l)}}const re={_p:o,$id:e,$onAction:ms.bind(null,A),$patch:K,$reset:Z,$subscribe(ge,y={}){const me=ms(I,ge,y.detached,()=>ce()),ce=_.run(()=>xi(()=>o.state.value[e],de=>{(y.flush==="sync"?w:C)&&ge({storeId:e,type:Oi.direct,events:V},de)},Ot({},b,y)));return me},$dispose:ne},le=ot(re);o._s.set(e,le);const pe=o._e.run(()=>(_=To(),_.run(()=>t())));for(const ge in pe){const y=pe[ge];if(Pe(y)&&!Rh(y)||Mt(y))g||(J&&Oh(y)&&(Pe(y)?y.value=J[ge]:rr(y,J[ge])),o.state.value[e][ge]=y);else if(typeof y=="function"){const me=$(ge,y);pe[ge]=me,v.actions[ge]=y}}return Ot(le,pe),Ot(we(le),pe),Object.defineProperty(le,"$state",{get:()=>o.state.value[e],set:ge=>{K(y=>{Ot(y,ge)})}}),o._p.forEach(ge=>{Ot(le,_.run(()=>ge({store:le,app:o._a,pinia:o,options:v})))}),J&&g&&n.hydrate&&n.hydrate(le.$state,J),C=!0,w=!0,le}function Mh(e,t,n){let o,h;const g=typeof t=="function";typeof e=="string"?(o=e,h=g?n:t):(h=e,o=e.id);function _(v,b){const C=Dr();return v=v||C&&gt(Ta),v&&Rn(v),v=wa,v._s.has(o)||(g?Ea(o,t,h,v):Dh(o,h,v)),v._s.get(o)}return _.$id=o,_}/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */function Lh(e,t,n,o){e.prototype._pos=[0,0,0],e.prototype._orientation=[0,0,-1,0,1,0],e.prototype.stereo=function(g){var _=this;if(!_.ctx||!_.ctx.listener)return _;for(var v=_._howls.length-1;v>=0;v--)_._howls[v].stereo(g);return _},e.prototype.pos=function(g,_,v){var b=this;if(!b.ctx||!b.ctx.listener)return b;if(_=typeof _!="number"?b._pos[1]:_,v=typeof v!="number"?b._pos[2]:v,typeof g=="number")b._pos=[g,_,v],typeof b.ctx.listener.positionX<"u"?(b.ctx.listener.positionX.setTargetAtTime(b._pos[0],t.ctx.currentTime,.1),b.ctx.listener.positionY.setTargetAtTime(b._pos[1],t.ctx.currentTime,.1),b.ctx.listener.positionZ.setTargetAtTime(b._pos[2],t.ctx.currentTime,.1)):b.ctx.listener.setPosition(b._pos[0],b._pos[1],b._pos[2]);else return b._pos;return b},e.prototype.orientation=function(g,_,v,b,C,w){var I=this;if(!I.ctx||!I.ctx.listener)return I;var A=I._orientation;if(_=typeof _!="number"?A[1]:_,v=typeof v!="number"?A[2]:v,b=typeof b!="number"?A[3]:b,C=typeof C!="number"?A[4]:C,w=typeof w!="number"?A[5]:w,typeof g=="number")I._orientation=[g,_,v,b,C,w],typeof I.ctx.listener.forwardX<"u"?(I.ctx.listener.forwardX.setTargetAtTime(g,t.ctx.currentTime,.1),I.ctx.listener.forwardY.setTargetAtTime(_,t.ctx.currentTime,.1),I.ctx.listener.forwardZ.setTargetAtTime(v,t.ctx.currentTime,.1),I.ctx.listener.upX.setTargetAtTime(b,t.ctx.currentTime,.1),I.ctx.listener.upY.setTargetAtTime(C,t.ctx.currentTime,.1),I.ctx.listener.upZ.setTargetAtTime(w,t.ctx.currentTime,.1)):I.ctx.listener.setOrientation(g,_,v,b,C,w);else return A;return I},n.prototype.init=function(g){return function(_){var v=this;return v._orientation=_.orientation||[1,0,0],v._stereo=_.stereo||null,v._pos=_.pos||null,v._pannerAttr={coneInnerAngle:typeof _.coneInnerAngle<"u"?_.coneInnerAngle:360,coneOuterAngle:typeof _.coneOuterAngle<"u"?_.coneOuterAngle:360,coneOuterGain:typeof _.coneOuterGain<"u"?_.coneOuterGain:0,distanceModel:typeof _.distanceModel<"u"?_.distanceModel:"inverse",maxDistance:typeof _.maxDistance<"u"?_.maxDistance:1e4,panningModel:typeof _.panningModel<"u"?_.panningModel:"HRTF",refDistance:typeof _.refDistance<"u"?_.refDistance:1,rolloffFactor:typeof _.rolloffFactor<"u"?_.rolloffFactor:1},v._onstereo=_.onstereo?[{fn:_.onstereo}]:[],v._onpos=_.onpos?[{fn:_.onpos}]:[],v._onorientation=_.onorientation?[{fn:_.onorientation}]:[],g.call(this,_)}}(n.prototype.init),n.prototype.stereo=function(g,_){var v=this;if(!v._webAudio)return v;if(v._state!=="loaded")return v._queue.push({event:"stereo",action:function(){v.stereo(g,_)}}),v;var b=typeof t.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof _>"u")if(typeof g=="number")v._stereo=g,v._pos=[g,0,0];else return v._stereo;for(var C=v._getSoundIds(_),w=0;w<C.length;w++){var I=v._soundById(C[w]);if(I)if(typeof g=="number")I._stereo=g,I._pos=[g,0,0],I._node&&(I._pannerAttr.panningModel="equalpower",(!I._panner||!I._panner.pan)&&h(I,b),b==="spatial"?typeof I._panner.positionX<"u"?(I._panner.positionX.setValueAtTime(g,t.ctx.currentTime),I._panner.positionY.setValueAtTime(0,t.ctx.currentTime),I._panner.positionZ.setValueAtTime(0,t.ctx.currentTime)):I._panner.setPosition(g,0,0):I._panner.pan.setValueAtTime(g,t.ctx.currentTime)),v._emit("stereo",I._id);else return I._stereo}return v},n.prototype.pos=function(g,_,v,b){var C=this;if(!C._webAudio)return C;if(C._state!=="loaded")return C._queue.push({event:"pos",action:function(){C.pos(g,_,v,b)}}),C;if(_=typeof _!="number"?0:_,v=typeof v!="number"?-.5:v,typeof b>"u")if(typeof g=="number")C._pos=[g,_,v];else return C._pos;for(var w=C._getSoundIds(b),I=0;I<w.length;I++){var A=C._soundById(w[I]);if(A)if(typeof g=="number")A._pos=[g,_,v],A._node&&((!A._panner||A._panner.pan)&&h(A,"spatial"),typeof A._panner.positionX<"u"?(A._panner.positionX.setValueAtTime(g,t.ctx.currentTime),A._panner.positionY.setValueAtTime(_,t.ctx.currentTime),A._panner.positionZ.setValueAtTime(v,t.ctx.currentTime)):A._panner.setPosition(g,_,v)),C._emit("pos",A._id);else return A._pos}return C},n.prototype.orientation=function(g,_,v,b){var C=this;if(!C._webAudio)return C;if(C._state!=="loaded")return C._queue.push({event:"orientation",action:function(){C.orientation(g,_,v,b)}}),C;if(_=typeof _!="number"?C._orientation[1]:_,v=typeof v!="number"?C._orientation[2]:v,typeof b>"u")if(typeof g=="number")C._orientation=[g,_,v];else return C._orientation;for(var w=C._getSoundIds(b),I=0;I<w.length;I++){var A=C._soundById(w[I]);if(A)if(typeof g=="number")A._orientation=[g,_,v],A._node&&(A._panner||(A._pos||(A._pos=C._pos||[0,0,-.5]),h(A,"spatial")),typeof A._panner.orientationX<"u"?(A._panner.orientationX.setValueAtTime(g,t.ctx.currentTime),A._panner.orientationY.setValueAtTime(_,t.ctx.currentTime),A._panner.orientationZ.setValueAtTime(v,t.ctx.currentTime)):A._panner.setOrientation(g,_,v)),C._emit("orientation",A._id);else return A._orientation}return C},n.prototype.pannerAttr=function(){var g=this,_=arguments,v,b,C;if(!g._webAudio)return g;if(_.length===0)return g._pannerAttr;if(_.length===1)if(typeof _[0]=="object")v=_[0],typeof b>"u"&&(v.pannerAttr||(v.pannerAttr={coneInnerAngle:v.coneInnerAngle,coneOuterAngle:v.coneOuterAngle,coneOuterGain:v.coneOuterGain,distanceModel:v.distanceModel,maxDistance:v.maxDistance,refDistance:v.refDistance,rolloffFactor:v.rolloffFactor,panningModel:v.panningModel}),g._pannerAttr={coneInnerAngle:typeof v.pannerAttr.coneInnerAngle<"u"?v.pannerAttr.coneInnerAngle:g._coneInnerAngle,coneOuterAngle:typeof v.pannerAttr.coneOuterAngle<"u"?v.pannerAttr.coneOuterAngle:g._coneOuterAngle,coneOuterGain:typeof v.pannerAttr.coneOuterGain<"u"?v.pannerAttr.coneOuterGain:g._coneOuterGain,distanceModel:typeof v.pannerAttr.distanceModel<"u"?v.pannerAttr.distanceModel:g._distanceModel,maxDistance:typeof v.pannerAttr.maxDistance<"u"?v.pannerAttr.maxDistance:g._maxDistance,refDistance:typeof v.pannerAttr.refDistance<"u"?v.pannerAttr.refDistance:g._refDistance,rolloffFactor:typeof v.pannerAttr.rolloffFactor<"u"?v.pannerAttr.rolloffFactor:g._rolloffFactor,panningModel:typeof v.pannerAttr.panningModel<"u"?v.pannerAttr.panningModel:g._panningModel});else return C=g._soundById(parseInt(_[0],10)),C?C._pannerAttr:g._pannerAttr;else _.length===2&&(v=_[0],b=parseInt(_[1],10));for(var w=g._getSoundIds(b),I=0;I<w.length;I++)if(C=g._soundById(w[I]),C){var A=C._pannerAttr;A={coneInnerAngle:typeof v.coneInnerAngle<"u"?v.coneInnerAngle:A.coneInnerAngle,coneOuterAngle:typeof v.coneOuterAngle<"u"?v.coneOuterAngle:A.coneOuterAngle,coneOuterGain:typeof v.coneOuterGain<"u"?v.coneOuterGain:A.coneOuterGain,distanceModel:typeof v.distanceModel<"u"?v.distanceModel:A.distanceModel,maxDistance:typeof v.maxDistance<"u"?v.maxDistance:A.maxDistance,refDistance:typeof v.refDistance<"u"?v.refDistance:A.refDistance,rolloffFactor:typeof v.rolloffFactor<"u"?v.rolloffFactor:A.rolloffFactor,panningModel:typeof v.panningModel<"u"?v.panningModel:A.panningModel};var V=C._panner;V||(C._pos||(C._pos=g._pos||[0,0,-.5]),h(C,"spatial"),V=C._panner),V.coneInnerAngle=A.coneInnerAngle,V.coneOuterAngle=A.coneOuterAngle,V.coneOuterGain=A.coneOuterGain,V.distanceModel=A.distanceModel,V.maxDistance=A.maxDistance,V.refDistance=A.refDistance,V.rolloffFactor=A.rolloffFactor,V.panningModel=A.panningModel}return g},o.prototype.init=function(g){return function(){var _=this,v=_._parent;_._orientation=v._orientation,_._stereo=v._stereo,_._pos=v._pos,_._pannerAttr=v._pannerAttr,g.call(this),_._stereo?v.stereo(_._stereo):_._pos&&v.pos(_._pos[0],_._pos[1],_._pos[2],_._id)}}(o.prototype.init),o.prototype.reset=function(g){return function(){var _=this,v=_._parent;return _._orientation=v._orientation,_._stereo=v._stereo,_._pos=v._pos,_._pannerAttr=v._pannerAttr,_._stereo?v.stereo(_._stereo):_._pos?v.pos(_._pos[0],_._pos[1],_._pos[2],_._id):_._panner&&(_._panner.disconnect(0),_._panner=void 0,v._refreshBuffer(_)),g.call(this)}}(o.prototype.reset);var h=function(g,_){_=_||"spatial",_==="spatial"?(g._panner=t.ctx.createPanner(),g._panner.coneInnerAngle=g._pannerAttr.coneInnerAngle,g._panner.coneOuterAngle=g._pannerAttr.coneOuterAngle,g._panner.coneOuterGain=g._pannerAttr.coneOuterGain,g._panner.distanceModel=g._pannerAttr.distanceModel,g._panner.maxDistance=g._pannerAttr.maxDistance,g._panner.refDistance=g._pannerAttr.refDistance,g._panner.rolloffFactor=g._pannerAttr.rolloffFactor,g._panner.panningModel=g._pannerAttr.panningModel,typeof g._panner.positionX<"u"?(g._panner.positionX.setValueAtTime(g._pos[0],t.ctx.currentTime),g._panner.positionY.setValueAtTime(g._pos[1],t.ctx.currentTime),g._panner.positionZ.setValueAtTime(g._pos[2],t.ctx.currentTime)):g._panner.setPosition(g._pos[0],g._pos[1],g._pos[2]),typeof g._panner.orientationX<"u"?(g._panner.orientationX.setValueAtTime(g._orientation[0],t.ctx.currentTime),g._panner.orientationY.setValueAtTime(g._orientation[1],t.ctx.currentTime),g._panner.orientationZ.setValueAtTime(g._orientation[2],t.ctx.currentTime)):g._panner.setOrientation(g._orientation[0],g._orientation[1],g._orientation[2])):(g._panner=t.ctx.createStereoPanner(),g._panner.pan.setValueAtTime(g._stereo,t.ctx.currentTime)),g._panner.connect(g._node),g._paused||g._parent.pause(g._id,!0).play(g._id,!0)}}/*!
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */var Lr=function(){this.init()};Lr.prototype={init:function(){var e=this||ae;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator=typeof window<"u"&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var t=this||ae;if(e=parseFloat(e),t.ctx||nn(),typeof e<"u"&&e>=0&&e<=1){if(t._volume=e,t._muted)return t;t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e,ae.ctx.currentTime);for(var n=0;n<t._howls.length;n++)if(!t._howls[n]._webAudio)for(var o=t._howls[n]._getSoundIds(),h=0;h<o.length;h++){var g=t._howls[n]._soundById(o[h]);g&&g._node&&(g._node.volume=g._volume*e)}return t}return t._volume},mute:function(e){var t=this||ae;t.ctx||nn(),t._muted=e,t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e?0:t._volume,ae.ctx.currentTime);for(var n=0;n<t._howls.length;n++)if(!t._howls[n]._webAudio)for(var o=t._howls[n]._getSoundIds(),h=0;h<o.length;h++){var g=t._howls[n]._soundById(o[h]);g&&g._node&&(g._node.muted=e?!0:g._muted)}return t},stop:function(){for(var e=this||ae,t=0;t<e._howls.length;t++)e._howls[t].stop();return e},unload:function(){for(var e=this||ae,t=e._howls.length-1;t>=0;t--)e._howls[t].unload();return e.usingWebAudio&&e.ctx&&typeof e.ctx.close<"u"&&(e.ctx.close(),e.ctx=null,nn()),e},codecs:function(e){return(this||ae)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||ae;if(e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio)if(typeof Audio<"u")try{var t=new Audio;typeof t.oncanplaythrough>"u"&&(e._canPlayEvent="canplay")}catch{e.noAudio=!0}else e.noAudio=!0;try{var t=new Audio;t.muted&&(e.noAudio=!0)}catch{}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||ae,t=null;try{t=typeof Audio<"u"?new Audio:null}catch{return e}if(!t||typeof t.canPlayType!="function")return e;var n=t.canPlayType("audio/mpeg;").replace(/^no$/,""),o=e._navigator?e._navigator.userAgent:"",h=o.match(/OPR\/([0-6].)/g),g=h&&parseInt(h[0].split("/")[1],10)<33,_=o.indexOf("Safari")!==-1&&o.indexOf("Chrome")===-1,v=o.match(/Version\/(.*?) /),b=_&&v&&parseInt(v[1],10)<15;return e._codecs={mp3:!!(!g&&(n||t.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!n,opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(t.canPlayType('audio/wav; codecs="1"')||t.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!t.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(t.canPlayType("audio/x-m4b;")||t.canPlayType("audio/m4b;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!b&&t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!b&&t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||ae;if(!(e._audioUnlocked||!e.ctx)){e._audioUnlocked=!1,e.autoUnlock=!1,!e._mobileUnloaded&&e.ctx.sampleRate!==44100&&(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var t=function(n){for(;e._html5AudioPool.length<e.html5PoolSize;)try{var o=new Audio;o._unlocked=!0,e._releaseHtml5Audio(o)}catch{e.noAudio=!0;break}for(var h=0;h<e._howls.length;h++)if(!e._howls[h]._webAudio)for(var g=e._howls[h]._getSoundIds(),_=0;_<g.length;_++){var v=e._howls[h]._soundById(g[_]);v&&v._node&&!v._node._unlocked&&(v._node._unlocked=!0,v._node.load())}e._autoResume();var b=e.ctx.createBufferSource();b.buffer=e._scratchBuffer,b.connect(e.ctx.destination),typeof b.start>"u"?b.noteOn(0):b.start(0),typeof e.ctx.resume=="function"&&e.ctx.resume(),b.onended=function(){b.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",t,!0),document.removeEventListener("touchend",t,!0),document.removeEventListener("click",t,!0),document.removeEventListener("keydown",t,!0);for(var C=0;C<e._howls.length;C++)e._howls[C]._emit("unlock")}};return document.addEventListener("touchstart",t,!0),document.addEventListener("touchend",t,!0),document.addEventListener("click",t,!0),document.addEventListener("keydown",t,!0),e}},_obtainHtml5Audio:function(){var e=this||ae;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var t=new Audio().play();return t&&typeof Promise<"u"&&(t instanceof Promise||typeof t.then=="function")&&t.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(e){var t=this||ae;return e._unlocked&&t._html5AudioPool.push(e),t},_autoSuspend:function(){var e=this;if(!(!e.autoSuspend||!e.ctx||typeof e.ctx.suspend>"u"||!ae.usingWebAudio)){for(var t=0;t<e._howls.length;t++)if(e._howls[t]._webAudio){for(var n=0;n<e._howls[t]._sounds.length;n++)if(!e._howls[t]._sounds[n]._paused)return e}return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout(function(){if(!!e.autoSuspend){e._suspendTimer=null,e.state="suspending";var o=function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())};e.ctx.suspend().then(o,o)}},3e4),e}},_autoResume:function(){var e=this;if(!(!e.ctx||typeof e.ctx.resume>"u"||!ae.usingWebAudio))return e.state==="running"&&e.ctx.state!=="interrupted"&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):e.state==="suspended"||e.state==="running"&&e.ctx.state==="interrupted"?(e.ctx.resume().then(function(){e.state="running";for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("resume")}),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):e.state==="suspending"&&(e._resumeAfterSuspend=!0),e}};var ae=new Lr,un=function(e){var t=this;if(!e.src||e.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}t.init(e)};un.prototype={init:function(e){var t=this;return ae.ctx||nn(),t._autoplay=e.autoplay||!1,t._format=typeof e.format!="string"?e.format:[e.format],t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload=typeof e.preload=="boolean"||e.preload==="metadata"?e.preload:!0,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src=typeof e.src!="string"?e.src:[e.src],t._volume=e.volume!==void 0?e.volume:1,t._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:"GET",headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:e.xhr&&e.xhr.withCredentials?e.xhr.withCredentials:!1},t._duration=0,t._state="unloaded",t._sounds=[],t._endTimers={},t._queue=[],t._playLock=!1,t._onend=e.onend?[{fn:e.onend}]:[],t._onfade=e.onfade?[{fn:e.onfade}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._onmute=e.onmute?[{fn:e.onmute}]:[],t._onvolume=e.onvolume?[{fn:e.onvolume}]:[],t._onrate=e.onrate?[{fn:e.onrate}]:[],t._onseek=e.onseek?[{fn:e.onseek}]:[],t._onunlock=e.onunlock?[{fn:e.onunlock}]:[],t._onresume=[],t._webAudio=ae.usingWebAudio&&!t._html5,typeof ae.ctx<"u"&&ae.ctx&&ae.autoUnlock&&ae._unlockAudio(),ae._howls.push(t),t._autoplay&&t._queue.push({event:"play",action:function(){t.play()}}),t._preload&&t._preload!=="none"&&t.load(),t},load:function(){var e=this,t=null;if(ae.noAudio){e._emit("loaderror",null,"No audio support.");return}typeof e._src=="string"&&(e._src=[e._src]);for(var n=0;n<e._src.length;n++){var o,h;if(e._format&&e._format[n])o=e._format[n];else{if(h=e._src[n],typeof h!="string"){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}o=/^data:audio\/([^;,]+);/i.exec(h),o||(o=/\.([^.]+)$/.exec(h.split("?",1)[0])),o&&(o=o[1].toLowerCase())}if(o||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),o&&ae.codecs(o)){t=e._src[n];break}}if(!t){e._emit("loaderror",null,"No codec support for selected audio sources.");return}return e._src=t,e._state="loading",window.location.protocol==="https:"&&t.slice(0,5)==="http:"&&(e._html5=!0,e._webAudio=!1),new dn(e),e._webAudio&&Ph(e),e},play:function(e,t){var n=this,o=null;if(typeof e=="number")o=e,e=null;else{if(typeof e=="string"&&n._state==="loaded"&&!n._sprite[e])return null;if(typeof e>"u"&&(e="__default",!n._playLock)){for(var h=0,g=0;g<n._sounds.length;g++)n._sounds[g]._paused&&!n._sounds[g]._ended&&(h++,o=n._sounds[g]._id);h===1?e=null:o=null}}var _=o?n._soundById(o):n._inactiveSound();if(!_)return null;if(o&&!e&&(e=_._sprite||"__default"),n._state!=="loaded"){_._sprite=e,_._ended=!1;var v=_._id;return n._queue.push({event:"play",action:function(){n.play(v)}}),v}if(o&&!_._paused)return t||n._loadQueue("play"),_._id;n._webAudio&&ae._autoResume();var b=Math.max(0,_._seek>0?_._seek:n._sprite[e][0]/1e3),C=Math.max(0,(n._sprite[e][0]+n._sprite[e][1])/1e3-b),w=C*1e3/Math.abs(_._rate),I=n._sprite[e][0]/1e3,A=(n._sprite[e][0]+n._sprite[e][1])/1e3;_._sprite=e,_._ended=!1;var V=function(){_._paused=!1,_._seek=b,_._start=I,_._stop=A,_._loop=!!(_._loop||n._sprite[e][2])};if(b>=A){n._ended(_);return}var J=_._node;if(n._webAudio){var q=function(){n._playLock=!1,V(),n._refreshBuffer(_);var $=_._muted||n._muted?0:_._volume;J.gain.setValueAtTime($,ae.ctx.currentTime),_._playStart=ae.ctx.currentTime,typeof J.bufferSource.start>"u"?_._loop?J.bufferSource.noteGrainOn(0,b,86400):J.bufferSource.noteGrainOn(0,b,C):_._loop?J.bufferSource.start(0,b,86400):J.bufferSource.start(0,b,C),w!==1/0&&(n._endTimers[_._id]=setTimeout(n._ended.bind(n,_),w)),t||setTimeout(function(){n._emit("play",_._id),n._loadQueue()},0)};ae.state==="running"&&ae.ctx.state!=="interrupted"?q():(n._playLock=!0,n.once("resume",q),n._clearTimer(_._id))}else{var K=function(){J.currentTime=b,J.muted=_._muted||n._muted||ae._muted||J.muted,J.volume=_._volume*ae.volume(),J.playbackRate=_._rate;try{var $=J.play();if($&&typeof Promise<"u"&&($ instanceof Promise||typeof $.then=="function")?(n._playLock=!0,V(),$.then(function(){n._playLock=!1,J._unlocked=!0,t?n._loadQueue():n._emit("play",_._id)}).catch(function(){n._playLock=!1,n._emit("playerror",_._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),_._ended=!0,_._paused=!0})):t||(n._playLock=!1,V(),n._emit("play",_._id)),J.playbackRate=_._rate,J.paused){n._emit("playerror",_._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}e!=="__default"||_._loop?n._endTimers[_._id]=setTimeout(n._ended.bind(n,_),w):(n._endTimers[_._id]=function(){n._ended(_),J.removeEventListener("ended",n._endTimers[_._id],!1)},J.addEventListener("ended",n._endTimers[_._id],!1))}catch(re){n._emit("playerror",_._id,re)}};J.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(J.src=n._src,J.load());var Z=window&&window.ejecta||!J.readyState&&ae._navigator.isCocoonJS;if(J.readyState>=3||Z)K();else{n._playLock=!0,n._state="loading";var ne=function(){n._state="loaded",K(),J.removeEventListener(ae._canPlayEvent,ne,!1)};J.addEventListener(ae._canPlayEvent,ne,!1),n._clearTimer(_._id)}}return _._id},pause:function(e){var t=this;if(t._state!=="loaded"||t._playLock)return t._queue.push({event:"pause",action:function(){t.pause(e)}}),t;for(var n=t._getSoundIds(e),o=0;o<n.length;o++){t._clearTimer(n[o]);var h=t._soundById(n[o]);if(h&&!h._paused&&(h._seek=t.seek(n[o]),h._rateSeek=0,h._paused=!0,t._stopFade(n[o]),h._node))if(t._webAudio){if(!h._node.bufferSource)continue;typeof h._node.bufferSource.stop>"u"?h._node.bufferSource.noteOff(0):h._node.bufferSource.stop(0),t._cleanBuffer(h._node)}else(!isNaN(h._node.duration)||h._node.duration===1/0)&&h._node.pause();arguments[1]||t._emit("pause",h?h._id:null)}return t},stop:function(e,t){var n=this;if(n._state!=="loaded"||n._playLock)return n._queue.push({event:"stop",action:function(){n.stop(e)}}),n;for(var o=n._getSoundIds(e),h=0;h<o.length;h++){n._clearTimer(o[h]);var g=n._soundById(o[h]);g&&(g._seek=g._start||0,g._rateSeek=0,g._paused=!0,g._ended=!0,n._stopFade(o[h]),g._node&&(n._webAudio?g._node.bufferSource&&(typeof g._node.bufferSource.stop>"u"?g._node.bufferSource.noteOff(0):g._node.bufferSource.stop(0),n._cleanBuffer(g._node)):(!isNaN(g._node.duration)||g._node.duration===1/0)&&(g._node.currentTime=g._start||0,g._node.pause(),g._node.duration===1/0&&n._clearSound(g._node))),t||n._emit("stop",g._id))}return n},mute:function(e,t){var n=this;if(n._state!=="loaded"||n._playLock)return n._queue.push({event:"mute",action:function(){n.mute(e,t)}}),n;if(typeof t>"u")if(typeof e=="boolean")n._muted=e;else return n._muted;for(var o=n._getSoundIds(t),h=0;h<o.length;h++){var g=n._soundById(o[h]);g&&(g._muted=e,g._interval&&n._stopFade(g._id),n._webAudio&&g._node?g._node.gain.setValueAtTime(e?0:g._volume,ae.ctx.currentTime):g._node&&(g._node.muted=ae._muted?!0:e),n._emit("mute",g._id))}return n},volume:function(){var e=this,t=arguments,n,o;if(t.length===0)return e._volume;if(t.length===1||t.length===2&&typeof t[1]>"u"){var h=e._getSoundIds(),g=h.indexOf(t[0]);g>=0?o=parseInt(t[0],10):n=parseFloat(t[0])}else t.length>=2&&(n=parseFloat(t[0]),o=parseInt(t[1],10));var _;if(typeof n<"u"&&n>=0&&n<=1){if(e._state!=="loaded"||e._playLock)return e._queue.push({event:"volume",action:function(){e.volume.apply(e,t)}}),e;typeof o>"u"&&(e._volume=n),o=e._getSoundIds(o);for(var v=0;v<o.length;v++)_=e._soundById(o[v]),_&&(_._volume=n,t[2]||e._stopFade(o[v]),e._webAudio&&_._node&&!_._muted?_._node.gain.setValueAtTime(n,ae.ctx.currentTime):_._node&&!_._muted&&(_._node.volume=n*ae.volume()),e._emit("volume",_._id))}else return _=o?e._soundById(o):e._sounds[0],_?_._volume:0;return e},fade:function(e,t,n,o){var h=this;if(h._state!=="loaded"||h._playLock)return h._queue.push({event:"fade",action:function(){h.fade(e,t,n,o)}}),h;e=Math.min(Math.max(0,parseFloat(e)),1),t=Math.min(Math.max(0,parseFloat(t)),1),n=parseFloat(n),h.volume(e,o);for(var g=h._getSoundIds(o),_=0;_<g.length;_++){var v=h._soundById(g[_]);if(v){if(o||h._stopFade(g[_]),h._webAudio&&!v._muted){var b=ae.ctx.currentTime,C=b+n/1e3;v._volume=e,v._node.gain.setValueAtTime(e,b),v._node.gain.linearRampToValueAtTime(t,C)}h._startFadeInterval(v,e,t,n,g[_],typeof o>"u")}}return h},_startFadeInterval:function(e,t,n,o,h,g){var _=this,v=t,b=n-t,C=Math.abs(b/.01),w=Math.max(4,C>0?o/C:o),I=Date.now();e._fadeTo=n,e._interval=setInterval(function(){var A=(Date.now()-I)/o;I=Date.now(),v+=b*A,v=Math.round(v*100)/100,b<0?v=Math.max(n,v):v=Math.min(n,v),_._webAudio?e._volume=v:_.volume(v,e._id,!0),g&&(_._volume=v),(n<t&&v<=n||n>t&&v>=n)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,_.volume(n,e._id),_._emit("fade",e._id))},w)},_stopFade:function(e){var t=this,n=t._soundById(e);return n&&n._interval&&(t._webAudio&&n._node.gain.cancelScheduledValues(ae.ctx.currentTime),clearInterval(n._interval),n._interval=null,t.volume(n._fadeTo,e),n._fadeTo=null,t._emit("fade",e)),t},loop:function(){var e=this,t=arguments,n,o,h;if(t.length===0)return e._loop;if(t.length===1)if(typeof t[0]=="boolean")n=t[0],e._loop=n;else return h=e._soundById(parseInt(t[0],10)),h?h._loop:!1;else t.length===2&&(n=t[0],o=parseInt(t[1],10));for(var g=e._getSoundIds(o),_=0;_<g.length;_++)h=e._soundById(g[_]),h&&(h._loop=n,e._webAudio&&h._node&&h._node.bufferSource&&(h._node.bufferSource.loop=n,n&&(h._node.bufferSource.loopStart=h._start||0,h._node.bufferSource.loopEnd=h._stop,e.playing(g[_])&&(e.pause(g[_],!0),e.play(g[_],!0)))));return e},rate:function(){var e=this,t=arguments,n,o;if(t.length===0)o=e._sounds[0]._id;else if(t.length===1){var h=e._getSoundIds(),g=h.indexOf(t[0]);g>=0?o=parseInt(t[0],10):n=parseFloat(t[0])}else t.length===2&&(n=parseFloat(t[0]),o=parseInt(t[1],10));var _;if(typeof n=="number"){if(e._state!=="loaded"||e._playLock)return e._queue.push({event:"rate",action:function(){e.rate.apply(e,t)}}),e;typeof o>"u"&&(e._rate=n),o=e._getSoundIds(o);for(var v=0;v<o.length;v++)if(_=e._soundById(o[v]),_){e.playing(o[v])&&(_._rateSeek=e.seek(o[v]),_._playStart=e._webAudio?ae.ctx.currentTime:_._playStart),_._rate=n,e._webAudio&&_._node&&_._node.bufferSource?_._node.bufferSource.playbackRate.setValueAtTime(n,ae.ctx.currentTime):_._node&&(_._node.playbackRate=n);var b=e.seek(o[v]),C=(e._sprite[_._sprite][0]+e._sprite[_._sprite][1])/1e3-b,w=C*1e3/Math.abs(_._rate);(e._endTimers[o[v]]||!_._paused)&&(e._clearTimer(o[v]),e._endTimers[o[v]]=setTimeout(e._ended.bind(e,_),w)),e._emit("rate",_._id)}}else return _=e._soundById(o),_?_._rate:e._rate;return e},seek:function(){var e=this,t=arguments,n,o;if(t.length===0)e._sounds.length&&(o=e._sounds[0]._id);else if(t.length===1){var h=e._getSoundIds(),g=h.indexOf(t[0]);g>=0?o=parseInt(t[0],10):e._sounds.length&&(o=e._sounds[0]._id,n=parseFloat(t[0]))}else t.length===2&&(n=parseFloat(t[0]),o=parseInt(t[1],10));if(typeof o>"u")return 0;if(typeof n=="number"&&(e._state!=="loaded"||e._playLock))return e._queue.push({event:"seek",action:function(){e.seek.apply(e,t)}}),e;var _=e._soundById(o);if(_)if(typeof n=="number"&&n>=0){var v=e.playing(o);v&&e.pause(o,!0),_._seek=n,_._ended=!1,e._clearTimer(o),!e._webAudio&&_._node&&!isNaN(_._node.duration)&&(_._node.currentTime=n);var b=function(){v&&e.play(o,!0),e._emit("seek",o)};if(v&&!e._webAudio){var C=function(){e._playLock?setTimeout(C,0):b()};setTimeout(C,0)}else b()}else if(e._webAudio){var w=e.playing(o)?ae.ctx.currentTime-_._playStart:0,I=_._rateSeek?_._rateSeek-_._seek:0;return _._seek+(I+w*Math.abs(_._rate))}else return _._node.currentTime;return e},playing:function(e){var t=this;if(typeof e=="number"){var n=t._soundById(e);return n?!n._paused:!1}for(var o=0;o<t._sounds.length;o++)if(!t._sounds[o]._paused)return!0;return!1},duration:function(e){var t=this,n=t._duration,o=t._soundById(e);return o&&(n=t._sprite[o._sprite][1]/1e3),n},state:function(){return this._state},unload:function(){for(var e=this,t=e._sounds,n=0;n<t.length;n++)t[n]._paused||e.stop(t[n]._id),e._webAudio||(e._clearSound(t[n]._node),t[n]._node.removeEventListener("error",t[n]._errorFn,!1),t[n]._node.removeEventListener(ae._canPlayEvent,t[n]._loadFn,!1),t[n]._node.removeEventListener("ended",t[n]._endFn,!1),ae._releaseHtml5Audio(t[n]._node)),delete t[n]._node,e._clearTimer(t[n]._id);var o=ae._howls.indexOf(e);o>=0&&ae._howls.splice(o,1);var h=!0;for(n=0;n<ae._howls.length;n++)if(ae._howls[n]._src===e._src||e._src.indexOf(ae._howls[n]._src)>=0){h=!1;break}return zt&&h&&delete zt[e._src],ae.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,t,n,o){var h=this,g=h["_on"+e];return typeof t=="function"&&g.push(o?{id:n,fn:t,once:o}:{id:n,fn:t}),h},off:function(e,t,n){var o=this,h=o["_on"+e],g=0;if(typeof t=="number"&&(n=t,t=null),t||n)for(g=0;g<h.length;g++){var _=n===h[g].id;if(t===h[g].fn&&_||!t&&_){h.splice(g,1);break}}else if(e)o["_on"+e]=[];else{var v=Object.keys(o);for(g=0;g<v.length;g++)v[g].indexOf("_on")===0&&Array.isArray(o[v[g]])&&(o[v[g]]=[])}return o},once:function(e,t,n){var o=this;return o.on(e,t,n,1),o},_emit:function(e,t,n){for(var o=this,h=o["_on"+e],g=h.length-1;g>=0;g--)(!h[g].id||h[g].id===t||e==="load")&&(setTimeout(function(_){_.call(this,t,n)}.bind(o,h[g].fn),0),h[g].once&&o.off(e,h[g].fn,h[g].id));return o._loadQueue(e),o},_loadQueue:function(e){var t=this;if(t._queue.length>0){var n=t._queue[0];n.event===e&&(t._queue.shift(),t._loadQueue()),e||n.action()}return t},_ended:function(e){var t=this,n=e._sprite;if(!t._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(t._ended.bind(t,e),100),t;var o=!!(e._loop||t._sprite[n][2]);if(t._emit("end",e._id),!t._webAudio&&o&&t.stop(e._id,!0).play(e._id),t._webAudio&&o){t._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=ae.ctx.currentTime;var h=(e._stop-e._start)*1e3/Math.abs(e._rate);t._endTimers[e._id]=setTimeout(t._ended.bind(t,e),h)}return t._webAudio&&!o&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,t._clearTimer(e._id),t._cleanBuffer(e._node),ae._autoSuspend()),!t._webAudio&&!o&&t.stop(e._id,!0),t},_clearTimer:function(e){var t=this;if(t._endTimers[e]){if(typeof t._endTimers[e]!="function")clearTimeout(t._endTimers[e]);else{var n=t._soundById(e);n&&n._node&&n._node.removeEventListener("ended",t._endTimers[e],!1)}delete t._endTimers[e]}return t},_soundById:function(e){for(var t=this,n=0;n<t._sounds.length;n++)if(e===t._sounds[n]._id)return t._sounds[n];return null},_inactiveSound:function(){var e=this;e._drain();for(var t=0;t<e._sounds.length;t++)if(e._sounds[t]._ended)return e._sounds[t].reset();return new dn(e)},_drain:function(){var e=this,t=e._pool,n=0,o=0;if(!(e._sounds.length<t)){for(o=0;o<e._sounds.length;o++)e._sounds[o]._ended&&n++;for(o=e._sounds.length-1;o>=0;o--){if(n<=t)return;e._sounds[o]._ended&&(e._webAudio&&e._sounds[o]._node&&e._sounds[o]._node.disconnect(0),e._sounds.splice(o,1),n--)}}},_getSoundIds:function(e){var t=this;if(typeof e>"u"){for(var n=[],o=0;o<t._sounds.length;o++)n.push(t._sounds[o]._id);return n}else return[e]},_refreshBuffer:function(e){var t=this;return e._node.bufferSource=ae.ctx.createBufferSource(),e._node.bufferSource.buffer=zt[t._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,ae.ctx.currentTime),t},_cleanBuffer:function(e){var t=this,n=ae._navigator&&ae._navigator.vendor.indexOf("Apple")>=0;if(!e.bufferSource)return t;if(ae._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),n))try{e.bufferSource.buffer=ae._scratchBuffer}catch{}return e.bufferSource=null,t},_clearSound:function(e){var t=/MSIE |Trident\//.test(ae._navigator&&ae._navigator.userAgent);t||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var dn=function(e){this._parent=e,this.init()};dn.prototype={init:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++ae._counter,t._sounds.push(e),e.create(),e},create:function(){var e=this,t=e._parent,n=ae._muted||e._muted||e._parent._muted?0:e._volume;return t._webAudio?(e._node=typeof ae.ctx.createGain>"u"?ae.ctx.createGainNode():ae.ctx.createGain(),e._node.gain.setValueAtTime(n,ae.ctx.currentTime),e._node.paused=!0,e._node.connect(ae.masterGain)):ae.noAudio||(e._node=ae._obtainHtml5Audio(),e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(ae._canPlayEvent,e._loadFn,!1),e._endFn=e._endListener.bind(e),e._node.addEventListener("ended",e._endFn,!1),e._node.src=t._src,e._node.preload=t._preload===!0?"auto":t._preload,e._node.volume=n*ae.volume(),e._node.load()),e},reset:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++ae._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,t=e._parent;t._duration=Math.ceil(e._node.duration*10)/10,Object.keys(t._sprite).length===0&&(t._sprite={__default:[0,t._duration*1e3]}),t._state!=="loaded"&&(t._state="loaded",t._emit("load"),t._loadQueue()),e._node.removeEventListener(ae._canPlayEvent,e._loadFn,!1)},_endListener:function(){var e=this,t=e._parent;t._duration===1/0&&(t._duration=Math.ceil(e._node.duration*10)/10,t._sprite.__default[1]===1/0&&(t._sprite.__default[1]=t._duration*1e3),t._ended(e)),e._node.removeEventListener("ended",e._endFn,!1)}};var zt={},Ph=function(e){var t=e._src;if(zt[t]){e._duration=zt[t].duration,Aa(e);return}if(/^data:[^;]+;base64,/.test(t)){for(var n=atob(t.split(",")[1]),o=new Uint8Array(n.length),h=0;h<n.length;++h)o[h]=n.charCodeAt(h);vs(o.buffer,e)}else{var g=new XMLHttpRequest;g.open(e._xhr.method,t,!0),g.withCredentials=e._xhr.withCredentials,g.responseType="arraybuffer",e._xhr.headers&&Object.keys(e._xhr.headers).forEach(function(_){g.setRequestHeader(_,e._xhr.headers[_])}),g.onload=function(){var _=(g.status+"")[0];if(_!=="0"&&_!=="2"&&_!=="3"){e._emit("loaderror",null,"Failed loading audio file with status: "+g.status+".");return}vs(g.response,e)},g.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete zt[t],e.load())},Fh(g)}},Fh=function(e){try{e.send()}catch{e.onerror()}},vs=function(e,t){var n=function(){t._emit("loaderror",null,"Decoding audio data failed.")},o=function(h){h&&t._sounds.length>0?(zt[t._src]=h,Aa(t,h)):n()};typeof Promise<"u"&&ae.ctx.decodeAudioData.length===1?ae.ctx.decodeAudioData(e).then(o).catch(n):ae.ctx.decodeAudioData(e,o,n)},Aa=function(e,t){t&&!e._duration&&(e._duration=t.duration),Object.keys(e._sprite).length===0&&(e._sprite={__default:[0,e._duration*1e3]}),e._state!=="loaded"&&(e._state="loaded",e._emit("load"),e._loadQueue())},nn=function(){if(!!ae.usingWebAudio){try{typeof AudioContext<"u"?ae.ctx=new AudioContext:typeof webkitAudioContext<"u"?ae.ctx=new webkitAudioContext:ae.usingWebAudio=!1}catch{ae.usingWebAudio=!1}ae.ctx||(ae.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(ae._navigator&&ae._navigator.platform),t=ae._navigator&&ae._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),n=t?parseInt(t[1],10):null;if(e&&n&&n<9){var o=/safari/.test(ae._navigator&&ae._navigator.userAgent.toLowerCase());ae._navigator&&!o&&(ae.usingWebAudio=!1)}ae.usingWebAudio&&(ae.masterGain=typeof ae.ctx.createGain>"u"?ae.ctx.createGainNode():ae.ctx.createGain(),ae.masterGain.gain.setValueAtTime(ae._muted?0:ae._volume,ae.ctx.currentTime),ae.masterGain.connect(ae.ctx.destination)),ae._setup()}};Lh(Lr,ae,un,dn);/*!
 * Dynamsoft JavaScript Library
 * @product Dynamsoft Barcode Reader JS Edition
 * @website http://www.dynamsoft.com
 * @copyright Copyright 2022, Dynamsoft Corporation
 * @author Dynamsoft
 * @version 9.3.1 (js 20220930)
 * @fileoverview Dynamsoft JavaScript Library for Barcode Reader
 * More info on DBR JS: https://www.dynamsoft.com/barcode-reader/sdk-javascript/
 */const qt=typeof self>"u";let Qt,ze,$i,fn,Ne;if(typeof navigator<"u"&&(Qt=navigator,ze=Qt.userAgent,$i=Qt.platform,fn=Qt.mediaDevices),!qt){const e={init:function(){this.browser=this.searchString(this.dataBrowser)||"unknownBrowser",this.version=this.searchVersion(ze)||this.searchVersion(Qt.appVersion)||0,this.OS=this.searchString(this.dataOS)||"unknownOS",this.OS=="Linux"&&ze.indexOf("Windows NT")!=-1&&(this.OS="HarmonyOS")},searchString:function(t){for(let n=0;n<t.length;n++){let o=t[n].string,h=t[n].prop;if(this.versionSearchString=t[n].versionSearch||t[n].identity,o){if(o.indexOf(t[n].subString)!=-1)return t[n].identity}else if(h)return t[n].identity}},searchVersion:function(t){let n=t.indexOf(this.versionSearchString);if(n!=-1)return parseFloat(t.substring(n+this.versionSearchString.length+1))},dataBrowser:[{string:ze,subString:"Edge",identity:"Edge"},{string:ze,subString:"OPR",identity:"OPR"},{string:ze,subString:"Chrome",identity:"Chrome"},{string:Qt.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{string:ze,subString:"Firefox",identity:"Firefox"},{string:ze,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"}],dataOS:[{string:ze,subString:"HarmonyOS",identity:"HarmonyOS"},{string:ze,subString:"Android",identity:"Android"},{string:ze,subString:"iPhone",identity:"iPhone"},{string:$i,subString:"Win",identity:"Windows"},{string:$i,subString:"Mac",identity:"Mac"},{string:$i,subString:"Linux",identity:"Linux"}]};e.init(),Ne={browser:e.browser,version:e.version,OS:e.OS}}qt&&(Ne={browser:"ssr",version:0,OS:"ssr"});const kh=typeof WebAssembly<"u"&&ze&&!(/Safari/.test(ze)&&!/Chrome/.test(ze)&&/\(.+\s11_2_([2-6]).*\)/.test(ze)),Bh=!(typeof Worker>"u"),Ia=!(!fn||!fn.getUserMedia),Nh=async()=>{let e=!1;if(Ia)try{(await fn.getUserMedia({video:!0})).getTracks().forEach(t=>{t.stop()}),e=!0}catch{}return e};Ne.browser==="Chrome"&&Ne.version>66||Ne.browser==="Safari"&&Ne.version>13||Ne.browser==="OPR"&&Ne.version>43||Ne.browser==="Edge"&&Ne.version;const jh=(()=>{if(!qt&&document.currentScript){let e=document.currentScript.src,t=e.indexOf("?");if(t!=-1)e=e.substring(0,t);else{let n=e.indexOf("#");n!=-1&&(e=e.substring(0,n))}return e.substring(0,e.lastIndexOf("/")+1)}return"./"})(),bi=" is not allowed to change after `createInstance` or `loadWasm` is called.",Vh=!qt&&document.currentScript&&(document.currentScript.getAttribute("data-license")||document.currentScript.getAttribute("data-productKeys")||document.currentScript.getAttribute("data-licenseKey")||document.currentScript.getAttribute("data-handshakeCode")||document.currentScript.getAttribute("data-organizationID"))||"",Uh=!qt&&document.currentScript&&document.currentScript.getAttribute("data-sessionPassword")||"",ys=e=>{if(e==null)e=[];else{e=e instanceof Array?[...e]:[e];for(let t=0;t<e.length;++t){if(!qt){let n=document.createElement("a");n.href=e[t],e[t]=n.href}e[t].endsWith("/")||(e[t]+="/")}}return e};var Le,gn,sr,ft;(function(e){e[e.IPF_Binary=0]="IPF_Binary",e[e.IPF_BinaryInverted=1]="IPF_BinaryInverted",e[e.IPF_GrayScaled=2]="IPF_GrayScaled",e[e.IPF_NV21=3]="IPF_NV21",e[e.IPF_RGB_565=4]="IPF_RGB_565",e[e.IPF_RGB_555=5]="IPF_RGB_555",e[e.IPF_RGB_888=6]="IPF_RGB_888",e[e.IPF_ARGB_8888=7]="IPF_ARGB_8888",e[e.IPF_RGB_161616=8]="IPF_RGB_161616",e[e.IPF_ARGB_16161616=9]="IPF_ARGB_16161616",e[e.IPF_ABGR_8888=10]="IPF_ABGR_8888",e[e.IPF_ABGR_16161616=11]="IPF_ABGR_16161616",e[e.IPF_BGR_888=12]="IPF_BGR_888"})(Le||(Le={})),function(e){e[e.DBR_SYSTEM_EXCEPTION=1]="DBR_SYSTEM_EXCEPTION",e[e.DBR_SUCCESS=0]="DBR_SUCCESS",e[e.DBR_UNKNOWN=-1e4]="DBR_UNKNOWN",e[e.DBR_NO_MEMORY=-10001]="DBR_NO_MEMORY",e[e.DBR_NULL_REFERENCE=-10002]="DBR_NULL_REFERENCE",e[e.DBR_LICENSE_INVALID=-10003]="DBR_LICENSE_INVALID",e[e.DBR_LICENSE_EXPIRED=-10004]="DBR_LICENSE_EXPIRED",e[e.DBR_FILE_NOT_FOUND=-10005]="DBR_FILE_NOT_FOUND",e[e.DBR_FILETYPE_NOT_SUPPORTED=-10006]="DBR_FILETYPE_NOT_SUPPORTED",e[e.DBR_BPP_NOT_SUPPORTED=-10007]="DBR_BPP_NOT_SUPPORTED",e[e.DBR_INDEX_INVALID=-10008]="DBR_INDEX_INVALID",e[e.DBR_BARCODE_FORMAT_INVALID=-10009]="DBR_BARCODE_FORMAT_INVALID",e[e.DBR_CUSTOM_REGION_INVALID=-10010]="DBR_CUSTOM_REGION_INVALID",e[e.DBR_MAX_BARCODE_NUMBER_INVALID=-10011]="DBR_MAX_BARCODE_NUMBER_INVALID",e[e.DBR_IMAGE_READ_FAILED=-10012]="DBR_IMAGE_READ_FAILED",e[e.DBR_TIFF_READ_FAILED=-10013]="DBR_TIFF_READ_FAILED",e[e.DBR_QR_LICENSE_INVALID=-10016]="DBR_QR_LICENSE_INVALID",e[e.DBR_1D_LICENSE_INVALID=-10017]="DBR_1D_LICENSE_INVALID",e[e.DBR_DIB_BUFFER_INVALID=-10018]="DBR_DIB_BUFFER_INVALID",e[e.DBR_PDF417_LICENSE_INVALID=-10019]="DBR_PDF417_LICENSE_INVALID",e[e.DBR_DATAMATRIX_LICENSE_INVALID=-10020]="DBR_DATAMATRIX_LICENSE_INVALID",e[e.DBR_PDF_READ_FAILED=-10021]="DBR_PDF_READ_FAILED",e[e.DBR_PDF_DLL_MISSING=-10022]="DBR_PDF_DLL_MISSING",e[e.DBR_PAGE_NUMBER_INVALID=-10023]="DBR_PAGE_NUMBER_INVALID",e[e.DBR_CUSTOM_SIZE_INVALID=-10024]="DBR_CUSTOM_SIZE_INVALID",e[e.DBR_CUSTOM_MODULESIZE_INVALID=-10025]="DBR_CUSTOM_MODULESIZE_INVALID",e[e.DBR_RECOGNITION_TIMEOUT=-10026]="DBR_RECOGNITION_TIMEOUT",e[e.DBR_JSON_PARSE_FAILED=-10030]="DBR_JSON_PARSE_FAILED",e[e.DBR_JSON_TYPE_INVALID=-10031]="DBR_JSON_TYPE_INVALID",e[e.DBR_JSON_KEY_INVALID=-10032]="DBR_JSON_KEY_INVALID",e[e.DBR_JSON_VALUE_INVALID=-10033]="DBR_JSON_VALUE_INVALID",e[e.DBR_JSON_NAME_KEY_MISSING=-10034]="DBR_JSON_NAME_KEY_MISSING",e[e.DBR_JSON_NAME_VALUE_DUPLICATED=-10035]="DBR_JSON_NAME_VALUE_DUPLICATED",e[e.DBR_TEMPLATE_NAME_INVALID=-10036]="DBR_TEMPLATE_NAME_INVALID",e[e.DBR_JSON_NAME_REFERENCE_INVALID=-10037]="DBR_JSON_NAME_REFERENCE_INVALID",e[e.DBR_PARAMETER_VALUE_INVALID=-10038]="DBR_PARAMETER_VALUE_INVALID",e[e.DBR_DOMAIN_NOT_MATCHED=-10039]="DBR_DOMAIN_NOT_MATCHED",e[e.DBR_RESERVEDINFO_NOT_MATCHED=-10040]="DBR_RESERVEDINFO_NOT_MATCHED",e[e.DBR_AZTEC_LICENSE_INVALID=-10041]="DBR_AZTEC_LICENSE_INVALID",e[e.DBR_LICENSE_DLL_MISSING=-10042]="DBR_LICENSE_DLL_MISSING",e[e.DBR_LICENSEKEY_NOT_MATCHED=-10043]="DBR_LICENSEKEY_NOT_MATCHED",e[e.DBR_REQUESTED_FAILED=-10044]="DBR_REQUESTED_FAILED",e[e.DBR_LICENSE_INIT_FAILED=-10045]="DBR_LICENSE_INIT_FAILED",e[e.DBR_PATCHCODE_LICENSE_INVALID=-10046]="DBR_PATCHCODE_LICENSE_INVALID",e[e.DBR_POSTALCODE_LICENSE_INVALID=-10047]="DBR_POSTALCODE_LICENSE_INVALID",e[e.DBR_DPM_LICENSE_INVALID=-10048]="DBR_DPM_LICENSE_INVALID",e[e.DBR_FRAME_DECODING_THREAD_EXISTS=-10049]="DBR_FRAME_DECODING_THREAD_EXISTS",e[e.DBR_STOP_DECODING_THREAD_FAILED=-10050]="DBR_STOP_DECODING_THREAD_FAILED",e[e.DBR_SET_MODE_ARGUMENT_ERROR=-10051]="DBR_SET_MODE_ARGUMENT_ERROR",e[e.DBR_LICENSE_CONTENT_INVALID=-10052]="DBR_LICENSE_CONTENT_INVALID",e[e.DBR_LICENSE_KEY_INVALID=-10053]="DBR_LICENSE_KEY_INVALID",e[e.DBR_LICENSE_DEVICE_RUNS_OUT=-10054]="DBR_LICENSE_DEVICE_RUNS_OUT",e[e.DBR_GET_MODE_ARGUMENT_ERROR=-10055]="DBR_GET_MODE_ARGUMENT_ERROR",e[e.DBR_IRT_LICENSE_INVALID=-10056]="DBR_IRT_LICENSE_INVALID",e[e.DBR_MAXICODE_LICENSE_INVALID=-10057]="DBR_MAXICODE_LICENSE_INVALID",e[e.DBR_GS1_DATABAR_LICENSE_INVALID=-10058]="DBR_GS1_DATABAR_LICENSE_INVALID",e[e.DBR_GS1_COMPOSITE_LICENSE_INVALID=-10059]="DBR_GS1_COMPOSITE_LICENSE_INVALID",e[e.DBR_DOTCODE_LICENSE_INVALID=-10061]="DBR_DOTCODE_LICENSE_INVALID",e[e.DMERR_NO_LICENSE=-2e4]="DMERR_NO_LICENSE",e[e.DMERR_LICENSE_SYNC_FAILED=-20003]="DMERR_LICENSE_SYNC_FAILED",e[e.DMERR_TRIAL_LICENSE=-20010]="DMERR_TRIAL_LICENSE",e[e.DMERR_FAILED_TO_REACH_LTS=-20200]="DMERR_FAILED_TO_REACH_LTS"}(gn||(gn={})),function(e){e[e.IMRDT_IMAGE=1]="IMRDT_IMAGE",e[e.IMRDT_CONTOUR=2]="IMRDT_CONTOUR",e[e.IMRDT_LINESEGMENT=4]="IMRDT_LINESEGMENT",e[e.IMRDT_LOCALIZATIONRESULT=8]="IMRDT_LOCALIZATIONRESULT",e[e.IMRDT_REGIONOFINTEREST=16]="IMRDT_REGIONOFINTEREST",e[e.IMRDT_QUADRILATERAL=32]="IMRDT_QUADRILATERAL"}(sr||(sr={})),function(e){e[e.BF_ALL=4265607167]="BF_ALL",e[e.BF_ONED=3147775]="BF_ONED",e[e.BF_GS1_DATABAR=260096]="BF_GS1_DATABAR",e[e.BF_CODE_39=1]="BF_CODE_39",e[e.BF_CODE_128=2]="BF_CODE_128",e[e.BF_CODE_93=4]="BF_CODE_93",e[e.BF_CODABAR=8]="BF_CODABAR",e[e.BF_ITF=16]="BF_ITF",e[e.BF_EAN_13=32]="BF_EAN_13",e[e.BF_EAN_8=64]="BF_EAN_8",e[e.BF_UPC_A=128]="BF_UPC_A",e[e.BF_UPC_E=256]="BF_UPC_E",e[e.BF_INDUSTRIAL_25=512]="BF_INDUSTRIAL_25",e[e.BF_CODE_39_EXTENDED=1024]="BF_CODE_39_EXTENDED",e[e.BF_GS1_DATABAR_OMNIDIRECTIONAL=2048]="BF_GS1_DATABAR_OMNIDIRECTIONAL",e[e.BF_GS1_DATABAR_TRUNCATED=4096]="BF_GS1_DATABAR_TRUNCATED",e[e.BF_GS1_DATABAR_STACKED=8192]="BF_GS1_DATABAR_STACKED",e[e.BF_GS1_DATABAR_STACKED_OMNIDIRECTIONAL=16384]="BF_GS1_DATABAR_STACKED_OMNIDIRECTIONAL",e[e.BF_GS1_DATABAR_EXPANDED=32768]="BF_GS1_DATABAR_EXPANDED",e[e.BF_GS1_DATABAR_EXPANDED_STACKED=65536]="BF_GS1_DATABAR_EXPANDED_STACKED",e[e.BF_GS1_DATABAR_LIMITED=131072]="BF_GS1_DATABAR_LIMITED",e[e.BF_PATCHCODE=262144]="BF_PATCHCODE",e[e.BF_PDF417=33554432]="BF_PDF417",e[e.BF_QR_CODE=67108864]="BF_QR_CODE",e[e.BF_DATAMATRIX=134217728]="BF_DATAMATRIX",e[e.BF_AZTEC=268435456]="BF_AZTEC",e[e.BF_MAXICODE=536870912]="BF_MAXICODE",e[e.BF_MICRO_QR=1073741824]="BF_MICRO_QR",e[e.BF_MICRO_PDF417=524288]="BF_MICRO_PDF417",e[e.BF_GS1_COMPOSITE=2147483648]="BF_GS1_COMPOSITE",e[e.BF_MSI_CODE=1048576]="BF_MSI_CODE",e[e.BF_CODE_11=2097152]="BF_CODE_11",e[e.BF_NULL=0]="BF_NULL"}(ft||(ft={}));const Ss=e=>e&&typeof e=="object"&&typeof e.then=="function",bs=Ne.OS=="iPhone"||Ne.OS=="Android"||Ne.OS=="HarmonyOS"?2048:4096;class G{constructor(){this._instanceID=void 0,this._ifSaveOriginalImageInACanvas=!1,this.oriCanvas=null,this.oriCanvasData=null,this.canvas=null,this.bFilterRegionInJs=!1,this._region=null,this._timeStartDecode=null,this._timeEnterInnerDBR=null,this._timeGetMessage=null,this.decodeRecords={},this.bDestroyed=!1,this._lastErrorCode=0,this._lastErrorString="",this._lastInnerDecodeDuration=0,this.intervalTime=0,this._intervalGetVideoFrame=0,this.array_getFrameTimeCost=[],this.array_decodeFrameTimeCost=[],this._indexCurrentDecodingFrame=0,this._arrPolygons=[],this._bPauseScan=!1,this._intervalDetectVideoPause=1e3,this._soundSource="data:audio/mpeg;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjI5LjEwMAAAAAAAAAAAAAAA/+M4wAAAAAAAAAAAAEluZm8AAAAPAAAABQAAAkAAgICAgICAgICAgICAgICAgICAgKCgoKCgoKCgoKCgoKCgoKCgoKCgwMDAwMDAwMDAwMDAwMDAwMDAwMDg4ODg4ODg4ODg4ODg4ODg4ODg4P//////////////////////////AAAAAExhdmM1OC41NAAAAAAAAAAAAAAAACQEUQAAAAAAAAJAk0uXRQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+MYxAANQAbGeUEQAAHZYZ3fASqD4P5TKBgocg+Bw/8+CAYBA4XB9/4EBAEP4nB9+UOf/6gfUCAIKyjgQ/Kf//wfswAAAwQA/+MYxAYOqrbdkZGQAMA7DJLCsQxNOij///////////+tv///3RWiZGBEhsf/FO/+LoCSFs1dFVS/g8f/4Mhv0nhqAieHleLy/+MYxAYOOrbMAY2gABf/////////////////usPJ66R0wI4boY9/8jQYg//g2SPx1M0N3Z0kVJLIs///Uw4aMyvHJJYmPBYG/+MYxAgPMALBucAQAoGgaBoFQVBUFQWDv6gZBUFQVBUGgaBr5YSgqCoKhIGg7+IQVBUFQVBoGga//SsFSoKnf/iVTEFNRTMu/+MYxAYAAANIAAAAADEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV",this.beepSound=new un({src:["data:audio/mpeg;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjI5LjEwMAAAAAAAAAAAAAAA/+M4wAAAAAAAAAAAAEluZm8AAAAPAAAABQAAAkAAgICAgICAgICAgICAgICAgICAgKCgoKCgoKCgoKCgoKCgoKCgoKCgwMDAwMDAwMDAwMDAwMDAwMDAwMDg4ODg4ODg4ODg4ODg4ODg4ODg4P//////////////////////////AAAAAExhdmM1OC41NAAAAAAAAAAAAAAAACQEUQAAAAAAAAJAk0uXRQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+MYxAANQAbGeUEQAAHZYZ3fASqD4P5TKBgocg+Bw/8+CAYBA4XB9/4EBAEP4nB9+UOf/6gfUCAIKyjgQ/Kf//wfswAAAwQA/+MYxAYOqrbdkZGQAMA7DJLCsQxNOij///////////+tv///3RWiZGBEhsf/FO/+LoCSFs1dFVS/g8f/4Mhv0nhqAieHleLy/+MYxAYOOrbMAY2gABf/////////////////usPJ66R0wI4boY9/8jQYg//g2SPx1M0N3Z0kVJLIs///Uw4aMyvHJJYmPBYG/+MYxAgPMALBucAQAoGgaBoFQVBUFQWDv6gZBUFQVBUGgaBr5YSgqCoKhIGg7+IQVBUFQVBoGga//SsFSoKnf/iVTEFNRTMu/+MYxAYAAANIAAAAADEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV"],onplayerror:(t,n)=>{console.warn(`Sound '${t}' playback failure: ${n}`)}}),this.bPlaySoundOnSuccessfulRead=!1,this.bVibrateOnSuccessfulRead=!1,this.vibrateDuration=300,this.captureAndDecodeInParallel=!0,this._dce=null,this._imgSource=null,this._maxCvsSideLength=bs,this._tempSolutionStatus="closed"}static get version(){return this._version}static get license(){return this._license}static set license(t){((n,o)=>{const h=n;if(!h._pLoad.isEmpty)throw new Error("`license`"+bi);h._license=o})(G,t)}static get productKeys(){return this._license}static set productKeys(t){G.license=t}static get handshakeCode(){return this._license}static set handshakeCode(t){G.license=t}static get organizationID(){return this._license}static set organizationID(t){G.license=t}static set sessionPassword(t){((n,o)=>{const h=n;if(!h._pLoad.isEmpty)throw new Error("`sessionPassword`"+bi);h._sessionPassword=o})(G,t)}static get sessionPassword(){return this._sessionPassword}static async detectEnvironment(){return await(async()=>({wasm:kh,worker:Bh,getUserMedia:Ia,camera:await Nh(),browser:Ne.browser,version:Ne.version,OS:Ne.OS}))()}static get engineResourcePath(){return this._engineResourcePath}static set engineResourcePath(t){if(!this._pLoad.isEmpty)throw new Error("`engineResourcePath` is not allowed to change after `createInstance` or `loadWasm` is called.");G._engineResourcePath=(n=>{if(n==null&&(n="./"),!qt){let o=document.createElement("a");o.href=n,n=o.href}return n.endsWith("/")||(n+="/"),n})(t)}static get licenseServer(){return this._licenseServer}static set licenseServer(t){((n,o)=>{const h=n;if(!h._pLoad.isEmpty)throw new Error("`licenseServer`"+bi);h._licenseServer=ys(o)})(G,t)}static get deviceFriendlyName(){return this._deviceFriendlyName}static set deviceFriendlyName(t){((n,o)=>{const h=n;if(!h._pLoad.isEmpty)throw new Error("`deviceFriendlyName`"+bi);h._deviceFriendlyName=o||""})(G,t)}static get _bUseFullFeature(){return this.__bUseFullFeature}static set _bUseFullFeature(t){if(!this._pLoad.isEmpty)throw new Error("`_bUseFullFeature` is not allowed to change after `createInstance` or `loadWasm` is called.");G.__bUseFullFeature=t}static isImageSource(t){return!(!t||typeof t!="object"||Array.isArray(t))&&"getImage"in t}static isDSImage(t){return!(!t||typeof t!="object"||Array.isArray(t))&&"data"in t&&"width"in t&&"height"in t&&"pixelFormat"in t}static isDCEFrame(t){return!(!t||typeof t!="object"||Array.isArray(t))&&"data"in t&&"region"in t&&"sx"in t&&"sy"in t&&"width"in t&&"height"in t&&"colorMode"in t&&"timeSpent"in t&&"timeStamp"in t&&"isCropped"in t&&"toCanvas"in t&&"_sWidth"in t&&"_sHeight"in t&&"_bUseWebGL"in t}get ifSaveOriginalImageInACanvas(){return this._ifSaveOriginalImageInACanvas}set ifSaveOriginalImageInACanvas(t){this._ifSaveOriginalImageInACanvas=t}getOriginalImageInACanvas(){return!this.oriCanvas&&this.oriCanvasData?this.oriCanvasData.toCanvas():this.oriCanvas}set region(t){this._region=t,this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0}get region(){return this._region}static isWasmLoaded(){return this._pLoad.isFulfilled}isContextDestroyed(){return this.bDestroyed}static get lastErrorCode(){return this._lastErrorCode}static get lastErrorString(){return this._lastErrorString}get lastErrorCode(){return this._lastErrorCode}get lastErrorString(){return this._lastErrorString}static get defaultUIElementURL(){var t;return(t=G._defaultUIElementURL)===null||t===void 0?void 0:t.replace("@engineResourcePath/",G.engineResourcePath)}static set defaultUIElementURL(t){G._defaultUIElementURL=t}static _fireHTTPSWarnning(){G.onWarning&&location&&location.protocol!=="https:"&&setTimeout(()=>{G.onWarning&&G.onWarning({id:2,message:"Not connected via SSL (HTTPS), the SDK may not work correctly."})},0)}get soundSource(){return this._soundSource}set soundSource(t){this._soundSource=t,this.beepSound=new un({src:[this._soundSource],onplayerror:(n,o)=>{console.warn(`Sound '${n}' playback failure: ${o}`)}})}get whenToPlaySoundforSuccessfulRead(){return this.bPlaySoundOnSuccessfulRead===!0?"frame":this.bPlaySoundOnSuccessfulRead?this.bPlaySoundOnSuccessfulRead:"never"}set whenToPlaySoundforSuccessfulRead(t){this.bPlaySoundOnSuccessfulRead=t!=="never"&&t}get whenToVibrateforSuccessfulRead(){return this.bVibrateOnSuccessfulRead===!0?"frame":this.bVibrateOnSuccessfulRead?this.bVibrateOnSuccessfulRead:"never"}set whenToVibrateforSuccessfulRead(t){this.bVibrateOnSuccessfulRead=t!=="never"&&t}set dce(t){this._dce=t}get dce(){return!this._dce||this._dce.isDisposed?null:this._dce}set maxCvsSideLength(t){this._maxCvsSideLength=t,this._dceControler&&this._dceControler.setDisiredValue(this,"maxCvsSideLength",t)}get maxCvsSideLength(){return this._maxCvsSideLength}async _registerDCEControler(){if(!this.dce)return;G._onLog&&G._onLog("_registerDCEControler()");const t=this.dce;this._dceControler=t._createControler();const n=this._dceControler;n.register(this),n.setDisiredValue(this,"refreshInterval",200),n.setDisiredValue(this,"maxCvsSideLength",this._maxCvsSideLength),this._styleIdBeforeVerification=this.dce.createDrawingStyle({fillStyle:"rgba(248,252,0,0.2)",strokeStyle:"transparent",paintMode:"strokeAndFill"});try{}catch(g){g.name==="ReferenceError"&&window&&(window.ResizeObserver=void 0)}const o=t.getUIElement(),h=this.dce.constructor;if(h._defaultUIElementURL==="@engineResourcePath/dce.ui.html")try{o?o===n._innerSetUI&&(await t.setUIElement(`${h.engineResourcePath}dce.ui.html`),n._innerSetUI=t.getUIElement()):(await t.setUIElement(`${h.engineResourcePath}dbr.ui.html`),n._innerSetUI=t.getUIElement())}catch{await t.setUIElement(h.defaultUIElementURL)}else o||await t.setUIElement(h.defaultUIElementURL);this.callbackCameraChange=()=>{this._drawResults(null),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0},this.callbackResolutionChange=()=>{this._drawResults(null),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0},this.callbackCameraClose=()=>{this.stopScanning(!0),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0,this._bPauseScan=!1},this.callbackSingleFrameAcquired=async g=>{let _=await this._decode_DCEFrame(g,{bCopyData:!1}),v=null;if(_&&_.length){const{sx:b,sy:C,width:w,height:I,_sWidth:A,_sHeight:V}=g;v=_.map(J=>({localizationResult:JSON.parse(JSON.stringify(J.localizationResult))})),G.recalculateResultLocation(v,b,C,A,V,w,I)}if(this._drawResults(v),await this.clearMapDecodeRecord(),this.onImageRead&&this.dce.isOpen()&&!this._bPauseScan){let b=this._cloneDecodeResults(_);this.onImageRead(b)}if(this.onUniqueRead&&this.dce.isOpen()&&!this._bPauseScan)for(let b of _)this.onUniqueRead(b.barcodeText,this._cloneDecodeResults(b))},t.on("cameraChange",this.callbackCameraChange),t.on("resolutionChange",this.callbackResolutionChange),t.on("cameraClose",this.callbackCameraClose),t.on("singleFrameAcquired",this.callbackSingleFrameAcquired)}_logoutDCEControler(){this.dce&&this._dceControler&&(G._onLog&&G._onLog("_logoutDCEControler()"),this._dceControler.logout(this),this.dce.off("cameraChange",this.callbackCameraChange),this.dce.off("resolutionChange",this.callbackResolutionChange),this.dce.off("cameraClose",this.callbackCameraClose),this.dce.off("singleFrameAcquired",this.callbackSingleFrameAcquired),this._dceControler=null,this.dce=null)}async setImageSource(t,n){if(t==null)return this._imgSource=null,this._logoutDCEControler(),void(this._drawingItemNamespace=null);if(t&&t.isCameraEnhancer)this.dce=t,await this._registerDCEControler(),this._imgSource=null;else{if(!G.isImageSource(t))throw new Error("Invalid value.");this._logoutDCEControler(),this._imgSource=t}n&&n.resultsHighlightBaseShapes&&(this._drawingItemNamespace=n.resultsHighlightBaseShapes)}static async loadWasm(){if(this._pLoad.isEmpty){let{lt:t,l:n,ls:o,sp:h,rmk:g}=(_=>{const v=_;if(v._pLoad.isEmpty){let b,C,w=v._license||"",I=JSON.parse(JSON.stringify(v._licenseServer)),A=v._sessionPassword,V=0;if(w.startsWith("t")||w.startsWith("f"))V=0;else if(w.length===0||w.startsWith("P")||w.startsWith("L")||w.startsWith("Y")||w.startsWith("A"))V=1;else{V=2;const J=w.indexOf(":");if(J!=-1&&(w=w.substring(J+1)),w.startsWith("DLS2")){let q=w.substring(4);try{q=atob(q)}catch{throw new Error("Format Error: The license string you specified is invalid, please check to make sure it is correct.")}const K=JSON.parse(q);if(w=K.handshakeCode?K.handshakeCode:K.organizationID?K.organizationID:"",typeof w=="number"&&(w=JSON.stringify(w)),I.length===0){let Z=[];K.mainServerURL&&(Z[0]=K.mainServerURL),K.standbyServerURL&&(Z[1]=K.standbyServerURL),I=ys(Z)}!A&&K.sessionPassword&&(A=K.sessionPassword),b=K.remark}(w==="200001"||w.startsWith("200001-"))&&(I&&I.length||(w="")),w||(V=1)}if(V&&(globalThis.crypto||(C="Please upgrade your browser to support online key."),globalThis.crypto.subtle||(C="Require https to use online key in this browser.")),C){if(V!==1)throw new Error(C);V=0,console.warn(C),v._lastErrorCode=-1,v._lastErrorString=C}return V===1&&(w="",console.warn("Applying for a public trial license ...")),{lt:V,l:w,ls:I,sp:A,rmk:b}}throw new Error("Can't preprocess license again"+bi)})(G);this._pLoad.task=async(_,v)=>{let b=G.engineResourcePath+G._workerName;G.engineResourcePath.startsWith(location.origin)||(b=await fetch(b).then(C=>C.blob()).then(C=>URL.createObjectURL(C))),G._dbrWorker=new Worker(b),G._dbrWorker.onerror=C=>{let w=new Error(C.message);v(w)},G._dbrWorker.onmessage=async C=>{let w=C.data?C.data:C;switch(w.type){case"log":G._onLog&&G._onLog(w.message);break;case"load":{w.message&&(w.message=w.message.replace("(https://www.dynamsoft.com/purchase-center/)","(https://www.dynamsoft.com/store/dynamsoft-barcode-reader/#javascript)"));let I,A=!1;t===1&&(A=!0),w.success?(G._dbrWorker.onerror=null,G._version=w.version+"(JS "+G._jsVersion+"."+G._jsEditVersion+")",G._onLog&&G._onLog("load dbr worker success"),w.message&&console.warn(w.message)):(I=new Error(w.message),I.stack=w.stack+`
`+I.stack,A||w.ltsErrorCode==111&&w.message.toLowerCase().indexOf("trial license")!=-1&&(A=!0)),A&&G.showDialog(w.success?"warn":"error",w.message),w.success?_():v(I);break}case"task":{let I=w.id,A=w.body;try{G._taskCallbackMap.get(I)(A),G._taskCallbackMap.delete(I)}catch(V){throw G._taskCallbackMap.delete(I),V}break}default:G._onLog&&G._onLog(C)}},G._dbrWorker.postMessage({type:"loadWasm",engineResourcePath:G.engineResourcePath,bUseFullFeature:G._bUseFullFeature,bd:G._bWasmDebug,v:G._jsVersion,brtk:!!t,bptk:t===1,l:n,dm:location.origin.startsWith("http")?location.origin:"https://localhost",os:Ne,fn:G.deviceFriendlyName,ls:o,sp:h,rmk:g})}}await this._pLoad}static async showDialog(t,n){await(async(o,h,g)=>{if(!o._bNeverShowDialog)try{let _=await fetch(o.engineResourcePath+"dls.license.dialog.html");if(!_.ok)throw Error("Get license dialog fail. Network Error: "+_.statusText);let v=await _.text();if(!v.trim().startsWith("<"))throw Error("Get license dialog fail. Can't get valid HTMLElement.");let b=document.createElement("div");b.innerHTML=v;let C=[];for(let ne=0;ne<b.childElementCount;++ne){let $=b.children[ne];$ instanceof HTMLStyleElement&&(C.push($),document.head.append($))}let w=b.childElementCount==1?b.children[0]:b;w.remove();let I,A,V,J,q,K=[w],Z=w.children;for(let ne of Z)K.push(ne);for(let ne=0;ne<K.length;++ne)for(let $ of K[ne].children)K.push($);for(let ne of K)if(!I&&ne.classList.contains("dls-license-mask"))I=ne,ne.addEventListener("click",$=>{if(ne==$.target){w.remove();for(let re of C)re.remove()}});else if(!A&&ne.classList.contains("dls-license-icon-close"))A=ne,ne.addEventListener("click",()=>{w.remove();for(let $ of C)$.remove()});else if(!V&&ne.classList.contains("dls-license-icon-error"))V=ne,h!="error"&&ne.remove();else if(!J&&ne.classList.contains("dls-license-icon-warn"))J=ne,h!="warn"&&ne.remove();else if(!q&&ne.classList.contains("dls-license-msg-content")){q=ne;let $=g;for(;$;){let re=$.indexOf("["),le=$.indexOf("]",re),pe=$.indexOf("(",le),ge=$.indexOf(")",pe);if(re==-1||le==-1||pe==-1||ge==-1){ne.appendChild(new Text($));break}re>0&&ne.appendChild(new Text($.substring(0,re)));let y=document.createElement("a"),me=$.substring(re+1,le);y.innerText=me;let ce=$.substring(pe+1,ge);y.setAttribute("href",ce),y.setAttribute("target","_blank"),ne.appendChild(y),$=$.substring(ge+1)}}document.body.appendChild(w)}catch(_){o._onLog&&o._onLog(_.message||_)}})(this,t,n)}static async createInstanceInWorker(t=!1){return await G.loadWasm(),await new Promise((n,o)=>{let h=G._nextTaskID++;G._taskCallbackMap.set(h,g=>{if(g.success)return n(g.instanceID);{let _=new Error(g.message);return _.stack=g.stack+`
`+_.stack,o(_)}}),G._dbrWorker.postMessage({type:"createInstance",id:h,bScanner:t})})}static async createInstance(){let t=new G;return t._instanceID=await G.createInstanceInWorker(),G._fireHTTPSWarnning(),t}async clearMapDecodeRecord(){return await new Promise((t,n)=>{let o=G._nextTaskID++;G._taskCallbackMap.set(o,h=>{if(h.success)return t();{let g=new Error(h.message);return g.stack=h.stack+`
`+g.stack,n(g)}}),G._dbrWorker.postMessage({type:"clearMapDecodeRecord",id:o,instanceID:this._instanceID})})}async decode(t){G._onLog&&G._onLog("decode(source: any)"),G._onLog&&(this._timeStartDecode=Date.now());{let n={};return!this.region||this.region instanceof Array||(n.region=JSON.parse(JSON.stringify(this.region))),t instanceof Blob?await this._decode_Blob(t,n):t instanceof ArrayBuffer?await this._decode_ArrayBuffer(t,n):t instanceof Uint8Array||t instanceof Uint8ClampedArray?await this._decode_Uint8Array(t,n):t instanceof HTMLImageElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?await this._decode_Image(t,n):t instanceof HTMLCanvasElement?await this._decode_Canvas(t,n):t instanceof HTMLVideoElement?await this._decode_Video(t,n):typeof t=="string"?t.substring(0,11)=="data:image/"?await this._decode_Base64(t,n):await this._decode_Url(t,n):G.isDCEFrame(t)?(n.bCopyData=!0,await this._decode_DCEFrame(t,n)):G.isDSImage(t)?(n.bCopyData=!0,await this._decode_DSImage(t,n)):await Promise.reject(TypeError("'_decode(source, config)': Type of 'source' should be 'Blob', 'ArrayBuffer', 'Uint8Array', 'HTMLImageElement', 'HTMLCanvasElement', 'HTMLVideoElement', 'String(base64 with image mime)' or 'String(url)'."))}}async decodeBase64String(t){let n={};return!this.region||this.region instanceof Array||(n.region=JSON.parse(JSON.stringify(this.region))),this._decode_Base64(t,n)}async decodeUrl(t){let n={};return!this.region||this.region instanceof Array||(n.region=JSON.parse(JSON.stringify(this.region))),this._decode_Url(t,n)}async _decodeBuffer_Uint8Array(t,n,o,h,g,_){return await new Promise((v,b)=>{let C=G._nextTaskID++;G._taskCallbackMap.set(C,w=>{if(w.success){let I,A=G._onLog?Date.now():0;G._onLog&&G._onLog("worker return result: "+A),this._lastInnerDecodeDuration=w.duration;try{I=this._handleRetJsonString(w.decodeReturn)}catch(V){return b(V)}if(G._onLog){let V=Date.now();G._onLog("DBR getting message from worker timestamp: "+A),G._onLog("From DBR staring decoding to entering worker costs: "+(this._timeEnterInnerDBR-this._timeStartDecode)),G._onLog("From DBR entering worker to returning message from worker costs: "+(A-this._timeEnterInnerDBR)),G._onLog("Handling results from DBR worker costs: "+(V-A)),G._onLog("Total decoding image costs: "+(V-this._timeStartDecode))}return v(I)}{let I=new Error(w.message);return I.stack=w.stack+`
`+I.stack,b(I)}}),this._timeEnterInnerDBR=Date.now(),G._onLog&&G._onLog("Sending buffer to worker timestamp:"+this._timeEnterInnerDBR),G._dbrWorker.postMessage({type:"decodeBuffer",id:C,instanceID:this._instanceID,body:{buffer:t,width:n,height:o,stride:h,format:g,config:_}},[t.buffer]),G._onLog&&_&&_.timeStamp&&G._onLog("Delay of decoding image: "+(this._timeEnterInnerDBR-_.timeStamp))})}async _decodeBuffer_Blob(t,n,o,h,g,_){G._onLog&&G._onLog("_decodeBuffer_Blob(buffer,width,height,stride,format)");const v=t.arrayBuffer?await t.arrayBuffer():await new Promise((b,C)=>{let w=new FileReader;w.readAsArrayBuffer(t),w.onload=()=>{b(w.result)},w.onerror=()=>{C(w.error)}});return await this._decodeBuffer_Uint8Array(new Uint8Array(v),n,o,h,g,_)}async decodeBuffer(t,n,o,h,g,_){let v;return G._onLog&&G._onLog("decodeBuffer(buffer,width,height,stride,format)"),G._onLog&&(this._timeStartDecode=Date.now()),t instanceof Uint8Array||t instanceof Uint8ClampedArray?v=await this._decodeBuffer_Uint8Array(t,n,o,h,g,_):t instanceof ArrayBuffer?v=await this._decodeBuffer_Uint8Array(new Uint8Array(t),n,o,h,g,_):t instanceof Blob&&(v=await this._decodeBuffer_Blob(t,n,o,h,g,_)),v}async _decodeFileInMemory_Uint8Array(t){return await new Promise((n,o)=>{let h=G._nextTaskID++;G._taskCallbackMap.set(h,g=>{if(g.success){let _;this._lastInnerDecodeDuration=g.duration;try{_=this._handleRetJsonString(g.decodeReturn)}catch(v){return o(v)}return n(_)}{let _=new Error(g.message);return _.stack=g.stack+`
`+_.stack,o(_)}}),G._dbrWorker.postMessage({type:"decodeFileInMemory",id:h,instanceID:this._instanceID,body:{bytes:t}})})}async getRuntimeSettings(){return await new Promise((t,n)=>{let o=G._nextTaskID++;G._taskCallbackMap.set(o,h=>{if(h.success){let g=JSON.parse(h.results);return this.userDefinedRegion!=null&&(g.region=JSON.parse(JSON.stringify(this.userDefinedRegion))),t(g)}{let g=new Error(h.message);return g.stack=h.stack+`
`+g.stack,n(g)}}),G._dbrWorker.postMessage({type:"getRuntimeSettings",id:o,instanceID:this._instanceID})})}async updateRuntimeSettings(t){let n;if(typeof t=="string")if(t=="speed"){let o=await this.getRuntimeSettings();await this.resetRuntimeSettings(),n=await this.getRuntimeSettings(),n.barcodeFormatIds=o.barcodeFormatIds,n.barcodeFormatIds_2=o.barcodeFormatIds_2,n.region=o.region,n.deblurLevel=3,n.expectedBarcodesCount=0,n.localizationModes=[2,0,0,0,0,0,0,0]}else if(t=="balance"){let o=await this.getRuntimeSettings();await this.resetRuntimeSettings(),n=await this.getRuntimeSettings(),n.barcodeFormatIds=o.barcodeFormatIds,n.barcodeFormatIds_2=o.barcodeFormatIds_2,n.region=o.region,n.deblurLevel=5,n.expectedBarcodesCount=512,n.localizationModes=[2,16,0,0,0,0,0,0]}else if(t=="coverage"){let o=await this.getRuntimeSettings();await this.resetRuntimeSettings(),n=await this.getRuntimeSettings(),n.barcodeFormatIds=o.barcodeFormatIds,n.barcodeFormatIds_2=o.barcodeFormatIds_2,n.region=o.region}else if(t=="dense"){let o=await this.getRuntimeSettings();await this.resetRuntimeSettings(),this.maxCvsSideLength=4096,n=await this.getRuntimeSettings(),n.barcodeFormatIds=o.barcodeFormatIds,n.barcodeFormatIds_2=o.barcodeFormatIds_2,n.region=o.region,n.deblurLevel=9,n.expectedBarcodesCount=0,n.localizationModes=[2,8,0,0,0,0,0,0]}else if(t=="distance"){let o=await this.getRuntimeSettings();await this.resetRuntimeSettings(),this.maxCvsSideLength=4096,n=await this.getRuntimeSettings(),n.barcodeFormatIds=o.barcodeFormatIds,n.barcodeFormatIds_2=o.barcodeFormatIds_2,n.region=o.region,n.deblurLevel=3,n.expectedBarcodesCount=0,n.localizationModes=[2,8,0,0,0,0,0,0]}else n=JSON.parse(t);else{if(typeof t!="object")throw TypeError("'UpdateRuntimeSettings(settings)': Type of 'settings' should be 'string' or 'PlainObject'.");if(n=JSON.parse(JSON.stringify(t)),n.region instanceof Array){let o=n.region;[o.regionLeft,o.regionTop,o.regionLeft,o.regionBottom,o.regionMeasuredByPercentage].some(h=>h!==void 0)&&(n.region={regionLeft:o.regionLeft||0,regionTop:o.regionTop||0,regionRight:o.regionRight||0,regionBottom:o.regionBottom||0,regionMeasuredByPercentage:o.regionMeasuredByPercentage||0})}}if(!G._bUseFullFeature){if((n.barcodeFormatIds&~(ft.BF_ONED|ft.BF_QR_CODE|ft.BF_PDF417|ft.BF_DATAMATRIX))!=0||n.barcodeFormatIds_2!=0)throw Error("Some of the specified barcode formats are not supported in the compact version. Please try the full-featured version.");if(n.intermediateResultTypes!=0)throw Error("Intermediate results is not supported in the compact version. Please try the full-featured version.")}if(this.bFilterRegionInJs){let o=n.region;if(o instanceof Array)throw Error("The `region` of type `Array` is only allowed in `BarcodeScanner`.");this.userDefinedRegion=JSON.parse(JSON.stringify(o)),(o.regionLeft||o.regionTop||o.regionRight||o.regionBottom||o.regionMeasuredByPercentage)&&(o.regionLeft||o.regionTop||o.regionRight!=100||o.regionBottom!=100||!o.regionMeasuredByPercentage)?this.region=o:this.region=null,n.region={regionLeft:0,regionTop:0,regionRight:0,regionBottom:0,regionMeasuredByPercentage:0}}else this.userDefinedRegion=null,this.region=null;return await new Promise((o,h)=>{let g=G._nextTaskID++;G._taskCallbackMap.set(g,_=>{if(_.success){try{this._handleRetJsonString(_.updateReturn)}catch(v){h(v)}return o()}{let v=new Error(_.message);return v.stack=_.stack+`
`+v.stack,h(v)}}),G._dbrWorker.postMessage({type:"updateRuntimeSettings",id:g,instanceID:this._instanceID,body:{settings:JSON.stringify(n)}})})}async resetRuntimeSettings(){return this.userDefinedRegion=null,this.region=null,this.maxCvsSideLength=bs,await new Promise((t,n)=>{let o=G._nextTaskID++;G._taskCallbackMap.set(o,h=>{if(h.success)return t();{let g=new Error(h.message);return g.stack=h.stack+`
`+g.stack,n(g)}}),G._dbrWorker.postMessage({type:"resetRuntimeSettings",id:o,instanceID:this._instanceID})})}async outputRuntimeSettingsToString(){if(!G._bUseFullFeature)throw Error("outputRuntimeSettingsToString() is not supported in the compact version. Please try the full-featured version.");return await new Promise((t,n)=>{let o=G._nextTaskID++;G._taskCallbackMap.set(o,h=>{if(h.success)return t(h.results);{let g=new Error(h.message);return g.stack=h.stack+`
`+g.stack,n(g)}}),G._dbrWorker.postMessage({type:"outputRuntimeSettingsToString",id:o,instanceID:this._instanceID})})}async initRuntimeSettingsWithString(t){if(!G._bUseFullFeature)throw Error("initRuntimeSettingsWithString() is not supported in the compact version. Please try the full-featured version.");if(typeof t=="string")t=t;else{if(typeof t!="object")throw TypeError("'initRuntimeSettingstWithString(settings)': Type of 'settings' should be 'string' or 'PlainObject'.");t=JSON.stringify(t)}return await new Promise((n,o)=>{let h=G._nextTaskID++;G._taskCallbackMap.set(h,g=>{if(g.success){try{this._handleRetJsonString(g.initReturn)}catch(_){o(_)}return n()}{let _=new Error(g.message);return _.stack=g.stack+`
`+_.stack,o(_)}}),G._dbrWorker.postMessage({type:"initRuntimeSettingsWithString",id:h,instanceID:this._instanceID,body:{settings:t}})})}async _decode_Blob(t,n){G._onLog&&G._onLog("_decode_Blob(blob: Blob)");let o=null,h=null;if(typeof createImageBitmap<"u")try{o=await createImageBitmap(t)}catch{}o||(h=await function(_){return new Promise((v,b)=>{let C=URL.createObjectURL(_),w=new Image;w.dbrObjUrl=C,w.src=C,w.onload=()=>{v(w)},w.onerror=I=>{b(new Error("Can't convert blob to image : "+(I instanceof Event?I.type:I)))}})}(t));let g=await this._decode_Image(o||h,n);return o&&o.close(),g}async _decode_ArrayBuffer(t,n){return await this._decode_Blob(new Blob([t]),n)}async _decode_Uint8Array(t,n){return await this._decode_Blob(new Blob([t]),n)}async _decode_Image(t,n){G._onLog&&G._onLog("_decode_Image(image: HTMLImageElement|ImageBitmap)"),n=n||{};let o,h,g=t instanceof HTMLImageElement?t.naturalWidth:t.width,_=t instanceof HTMLImageElement?t.naturalHeight:t.height,v=Math.max(g,_);if(v>this._maxCvsSideLength){let C=this._maxCvsSideLength/v;o=Math.round(g*C),h=Math.round(_*C)}else o=g,h=_;this.canvas||(this.canvas=document.createElement("canvas"));const b=this.canvas;return b.width===o&&b.height===h||(b.width=o,b.height=h),b.ctx2d||(b.ctx2d=b.getContext("2d")),b.ctx2d.drawImage(t,0,0,g,_,0,0,o,h),t.dbrObjUrl&&URL.revokeObjectURL(t.dbrObjUrl),await this._decode_Canvas(b,n)}async _decode_Canvas(t,n){if(G._onLog&&G._onLog("_decode_Canvas(canvas:HTMLCanvasElement)"),t.crossOrigin&&t.crossOrigin!="anonymous")throw"cors";if(t.width===0||t.height===0)throw Error("The width or height of the 'canvas' is 0.");this.ifSaveOriginalImageInACanvas&&(this.oriCanvas=t,this.oriCanvasData=null);let o=(t.ctx2d||t.getContext("2d")).getImageData(0,0,t.width,t.height).data;return await this._decodeBuffer_Uint8Array(o,t.width,t.height,4*t.width,Le.IPF_ABGR_8888,n)}async _decode_Video(t,n){if(G._onLog&&G._onLog("_decode_Video(video)"),!(t instanceof HTMLVideoElement))throw TypeError("'_decode_Video(video [, config] )': Type of 'video' should be 'HTMLVideoElement'.");if(t.crossOrigin&&t.crossOrigin!="anonymous")throw"cors";n=n||{};let o,h,g=t.videoWidth,_=t.videoHeight,v=Math.max(g,_);if(v>this._maxCvsSideLength){let C=this._maxCvsSideLength/v;o=Math.round(g*C),h=Math.round(_*C)}else o=g,h=_;this.canvas||(this.canvas=document.createElement("canvas"));const b=this.canvas;return b.width===o&&b.height===h||(b.width=o,b.height=h),b.ctx2d||(b.ctx2d=b.getContext("2d")),b.ctx2d.drawImage(t,0,0,g,_,0,0,o,h),await this._decode_Canvas(b,n)}async _decode_DCEFrame(t,n){if(G._onLog&&G._onLog("_decode_DCEFrame(dceFrame)"),!G.isDCEFrame(t))return[];let o=[];this.ifSaveOriginalImageInACanvas&&(this.oriCanvas=null,this.oriCanvasData={width:t.width,height:t.height,colorMode:t.colorMode,data:new Uint8Array(t.data),toCanvas:t.toCanvas});const{width:h,height:g,colorMode:_,timeStamp:v}=t;let b;b=n&&n.bCopyData?new Uint8Array(t.data):t.data;let C=null;if(n?(C=JSON.parse(JSON.stringify(n)),C.timeStamp=v):C={timeStamp:v},_==="grey")o=await this._decodeBuffer_Uint8Array(b,h,g,h,Le.IPF_GrayScaled,C);else if(_==="rgba")o=await this._decodeBuffer_Uint8Array(b,h,g,4*h,Le.IPF_ABGR_8888,C);else{if(_!=="bgra")throw new Error(`Color mode '${_}' is not supported to decode.`);o=await this._decodeBuffer_Uint8Array(b,h,g,4*h,Le.IPF_ARGB_8888,C)}return o}async _decode_DSImage(t,n){if(G._onLog&&G._onLog("_decode_DSImage(dsImage)"),!G.isDSImage(t))return null;this.ifSaveOriginalImageInACanvas&&(this.oriCanvas=null,this.oriCanvasData={width:t.width,height:t.height,pixelFormat:t.pixelFormat.toLowerCase(),data:new Uint8Array(t.data),toCanvas:function(){const C=document.createElement("canvas");let w;switch(C.width=this.width,C.height=this.height,this.pixelFormat){case"grey":w=new Uint8ClampedArray(this.width*this.height*4);for(let A=0;A<w.length;A+=4)w[A]=this.data[A/4],w[A+1]=this.data[A/4],w[A+2]=this.data[A/4],w[A+3]=255;break;case"rgb":w=new Uint8ClampedArray(this.width*this.height*4);for(let A=0;A<w.length;A+=4)w[A]=this.data[A],w[A+1]=this.data[A+1],w[A+2]=this.data[A+2],w[A+3]=255;break;case"bgr":w=new Uint8ClampedArray(this.width*this.height*4);for(let A=0;A<w.length;A+=4)w[A]=this.data[A],w[A+1]=this.data[A+1],w[A+2]=this.data[A+2],w[A+3]=255;break;case"rgba":case"bgra":w=new Uint8ClampedArray(this.data);break;default:throw new Error("The content of 2D Canvas is currently limited to the sRGB color space.")}const I=new ImageData(w,this.width,this.height);return C.getContext("2d").putImageData(I,0,0),C}});const{width:o,height:h}=t;let g,_,v,b=t.pixelFormat.toLowerCase();switch(g=n&&n.bCopyData?new Uint8Array(t.data):t.data,b){case"grey":v=Le.IPF_GrayScaled,_=o;break;case"rgb":v=Le.IPF_BGR_888,_=3*o;break;case"bgr":v=Le.IPF_RGB_888,_=3*o;break;case"rgba":v=Le.IPF_ABGR_8888,_=4*o;break;case"bgra":v=Le.IPF_ARGB_8888,_=4*o;break;default:throw new Error("The pixel format is not supported to decode.")}return await this._decodeBuffer_Uint8Array(g,o,h,_,v,n)}async _decode_Base64(t,n){if(G._onLog&&G._onLog("_decode_Base64(base64Str)"),typeof t!="string")return Promise.reject("'_decode_Base64(base64Str, config)': Type of 'base64Str' should be 'string'.");t.substring(0,11)=="data:image/"&&(t=t.substring(t.indexOf(",")+1));{let o=atob(t),h=o.length,g=new Uint8Array(h);for(;h--;)g[h]=o.charCodeAt(h);return await this._decode_Blob(new Blob([g]),n)}}async _decode_Url(t,n){if(G._onLog&&G._onLog("_decode_Url(url)"),typeof t!="string")throw TypeError("'_decode_Url(url, config)': Type of 'url' should be 'string'.");t=t;{let o=await new Promise((h,g)=>{let _=new XMLHttpRequest;_.open("GET",t,!0),_.responseType="blob",_.send(),_.onloadend=async()=>{h(_.response)},_.onerror=()=>{g(new Error("Network Error: "+_.statusText))}});return await this._decode_Blob(o,n)}}async _decode_FilePath(t,n){throw G._onLog&&G._onLog("_decode_FilePath(path)"),Error("'_decode_FilePath(path, config)': The method is only supported in node environment.")}static recalculateResultLocation(t,n,o,h,g,_,v){if(t.length>0)for(let b of t){let C=b.localizationResult;C.resultCoordinateType==2&&(C.x1*=.01*_,C.x2*=.01*_,C.x3*=.01*_,C.x4*=.01*_,C.y1*=.01*v,C.y2*=.01*v,C.y3*=.01*v,C.y4*=.01*v);let w=_/h,I=v/g;C.x1=C.x1/w+n,C.x2=C.x2/w+n,C.x3=C.x3/w+n,C.x4=C.x4/w+n,C.y1=C.y1/I+o,C.y2=C.y2/I+o,C.y3=C.y3/I+o,C.y4=C.y4/I+o,C.resultCoordinateType==2&&(C.x1*=100/h,C.x2*=100/h,C.x3*=100/h,C.x4*=100/h,C.y1*=100/g,C.y2*=100/g,C.y3*=100/g,C.y4*=100/g)}}static BarcodeReaderException(t,n){let o,h=gn.DBR_UNKNOWN;return typeof t=="number"?(h=t,o=new Error(n)):o=new Error(t),o.code=h,o}_handleRetJsonString(t){let n=gn;if(t.textResults){for(let o=0;o<t.textResults.length;o++){let h=t.textResults[o];try{let g=h.barcodeText,_="";for(let v=0;v<g.length;v++)_+=String.fromCharCode(g[v]);try{h.barcodeText=decodeURIComponent(escape(_))}catch{h.barcodeText=_}}catch{h.barcodeText=""}if(h.exception!=null){G._setWarnnedEx.has(h.exception)||(G._setWarnnedEx.add(h.exception),console.warn(h.exception));let g={};h.exception.split(";").forEach(_=>{let v=_.indexOf(":");g[_.substring(0,v)]=_.substring(v+1)}),h.exception=g}}return t.decodeRecords?this.decodeRecords=t.decodeRecords:this.decodeRecords={},this._lastErrorCode=t.exception,this._lastErrorString=t.description,t.exception&&!G._setWarnnedEx.has(t.description)&&(G._setWarnnedEx.add(t.description),console.warn(t.description)),t.textResults}if(t.exception==n.DBR_SUCCESS)return t.data;throw G.BarcodeReaderException(t.exception,t.description)}async setModeArgument(t,n,o,h){return await new Promise((g,_)=>{let v=G._nextTaskID++;G._taskCallbackMap.set(v,b=>{if(b.success){try{this._handleRetJsonString(b.setReturn)}catch(C){return _(C)}return g()}{let C=new Error(b.message);return C.stack=b.stack+`
`+C.stack,_(C)}}),G._dbrWorker.postMessage({type:"setModeArgument",id:v,instanceID:this._instanceID,body:{modeName:t,index:n,argumentName:o,argumentValue:h}})})}async getModeArgument(t,n,o){return await new Promise((h,g)=>{let _=G._nextTaskID++;G._taskCallbackMap.set(_,v=>{if(v.success){let b;try{b=this._handleRetJsonString(v.getReturn)}catch(C){return g(C)}return h(b)}{let b=new Error(v.message);return b.stack=v.stack+`
`+b.stack,g(b)}}),G._dbrWorker.postMessage({type:"getModeArgument",id:_,instanceID:this._instanceID,body:{modeName:t,index:n,argumentName:o}})})}async getIntermediateResults(){return await new Promise((t,n)=>{let o=G._nextTaskID++;G._taskCallbackMap.set(o,h=>{if(h.success)return t(h.results);{let g=new Error(h.message);return g.stack=h.stack+`
`+g.stack,n(g)}}),G._dbrWorker.postMessage({type:"getIntermediateResults",id:o,instanceID:this._instanceID})})}async getIntermediateCanvas(){let t=await this.getIntermediateResults(),n=[];for(let o of t)if(o.dataType==sr.IMRDT_IMAGE)for(let h of o.results){const g=h.bytes;let _;switch(G._onLog&&G._onLog(" "+g.length+" "+g.byteLength+" "+h.width+" "+h.height+" "+h.stride+" "+h.format),h.format){case Le.IPF_ABGR_8888:_=new Uint8ClampedArray(g);break;case Le.IPF_RGB_888:{const C=g.length/3;_=new Uint8ClampedArray(4*C);for(let w=0;w<C;++w)_[4*w]=g[3*w+2],_[4*w+1]=g[3*w+1],_[4*w+2]=g[3*w],_[4*w+3]=255;break}case Le.IPF_GrayScaled:{const C=g.length;_=new Uint8ClampedArray(4*C);for(let w=0;w<C;w++)_[4*w]=_[4*w+1]=_[4*w+2]=g[w],_[4*w+3]=255;break}case Le.IPF_Binary:case Le.IPF_BinaryInverted:{h.width=8*h.stride,h.height=g.length/h.stride;const C=g.length;_=new Uint8ClampedArray(8*C*4);for(let w=0;w<C;w++){let I=g[w];for(let A=0;A<8;++A)_[4*(8*w+A)]=_[4*(8*w+A)+1]=_[4*(8*w+A)+2]=(128&I)/128*255,_[4*(8*w+A)+3]=255,I<<=1}break}default:console.warn("unknow intermediate image",h)}if(!_)continue;let v=new ImageData(_,h.width,h.height),b=document.createElement("canvas");b.width=h.width,b.height=h.height,b.getContext("2d").putImageData(v,0,0),n.push(b)}return n}async keepAlive(){G._dbrWorker.postMessage({type:"keepAlive"})}async getScanSettings(){return await new Promise((t,n)=>{let o=G._nextTaskID++;G._taskCallbackMap.set(o,h=>{if(h.success){let g=h.results;return g.intervalTime=this.intervalTime,g.whenToPlaySoundforSuccessfulRead=this.whenToPlaySoundforSuccessfulRead,g.soundOnSuccessfullRead=this.soundSource,g.whenToVibrateforSuccessfulRead=this.whenToVibrateforSuccessfulRead,g.vibrateDuration=this.vibrateDuration,g.captureAndDecodeInParallel=this.captureAndDecodeInParallel,t(g)}{let g=new Error(h.message);return g.stack+=`
`+h.stack,n(g)}}),G._dbrWorker.postMessage({type:"getScanSettings",id:o,instanceID:this._instanceID})})}async updateScanSettings(t){if(!t)return;const n=JSON.parse(JSON.stringify(t));return n.hasOwnProperty("intervalTime")&&(this.intervalTime=Math.max(n.intervalTime,0),delete n.intervalTime),n.hasOwnProperty("whenToPlaySoundforSuccessfulRead")&&(this.whenToPlaySoundforSuccessfulRead=n.whenToPlaySoundforSuccessfulRead,delete n.whenToPlaySoundforSuccessfulRead),n.hasOwnProperty("soundOnSuccessfullRead")&&(this.soundSource=n.soundOnSuccessfullRead,delete n.soundOnSuccessfullRead),n.hasOwnProperty("whenToVibrateforSuccessfulRead")&&(this.whenToVibrateforSuccessfulRead=n.whenToVibrateforSuccessfulRead,delete n.whenToVibrateforSuccessfulRead),n.hasOwnProperty("vibrateDuration")&&(this.vibrateDuration=n.vibrateDuration,delete n.vibrateDuration),n.hasOwnProperty("captureAndDecodeInParallel")&&(this.captureAndDecodeInParallel=n.captureAndDecodeInParallel,delete n.captureAndDecodeInParallel),await new Promise((o,h)=>{let g=G._nextTaskID++;G._taskCallbackMap.set(g,_=>{if(_.success)return o();{let v=new Error(_.message);return v.stack+=`
`+_.stack,h(v)}}),G._dbrWorker.postMessage({type:"updateScanSettings",id:g,instanceID:this._instanceID,body:{settings:n}})})}_cloneDecodeResults(t){if(t instanceof Array){let n=[];for(let o of t)n.push(this._cloneDecodeResults(o));return n}{let n=t;return JSON.parse(JSON.stringify(n,(h,g)=>h=="oriVideoCanvas"||h=="searchRegionCanvas"?void 0:g))}}async _loopReadVideo(){if(this.bDestroyed)return this.dce&&this._dceControler&&this._dceControler.setDisiredAction(this,"stopFetchingLoop"),void this._drawResults(null);if(this.dce&&!this.dce.isOpen())return this._drawResults(null),void await this.clearMapDecodeRecord();if(!this.dce&&!this._imgSource||this._bPauseScan)return G._onLog&&G._onLog("Scan is paused, or imageSource is not set. Ask in 1s."),await this.clearMapDecodeRecord(),this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),void(this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},this._intervalDetectVideoPause));G._onLog&&G._onLog("======= once read ======="),G._onLog&&(this._timeStartDecode=Date.now());let t=null,n=null;if(this.dce)t=this._getVideoFrame();else if(this._imgSource&&(n=await this._imgSource.getImage(),!G.isDSImage(n)))throw new Error("Invalid DSImage.");if(!t&&!n)return G._onLog&&G._onLog("Get invalid frame."),this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),void(this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},0));(async()=>{let o=[];if(t){o=await this._decode_DCEFrame(t,{bScanner:!0,bCopyData:!1});let h=null;if(o&&o.length){const{sx:g,sy:_,width:v,height:b,_sWidth:C,_sHeight:w}=t;h=o.map(I=>({resultState:I.resultState,localizationResult:JSON.parse(JSON.stringify(I.localizationResult))})),G.recalculateResultLocation(h,g,_,C,w,v,b)}this._drawResults(h)}else n&&(o=await this._decode_DSImage(n,{bScanner:!0,bCopyData:!1}));return o})().then(o=>{if(G._onLog&&G._onLog(o),this.dce&&this.captureAndDecodeInParallel){let h=this.array_decodeFrameTimeCost,g=this.array_getFrameTimeCost;const _=()=>{let v=0;if(g&&g.length){let b=Math.min(...h),C=Math.max(...g);b&&C&&(v=b-C)}else v=0;return v>0?v:0};(()=>{for(;h.length>=5;)h.shift();h.push(this._lastInnerDecodeDuration)})(),this._intervalGetVideoFrame=_()+this.intervalTime}if((this.dce&&this.dce.isOpen()||this._imgSource)&&!this._bPauseScan){if(this.bPlaySoundOnSuccessfulRead&&o.length){let h=!1;this.bPlaySoundOnSuccessfulRead===!0||this.bPlaySoundOnSuccessfulRead==="frame"?h=!0:this.bPlaySoundOnSuccessfulRead==="unique"&&(h=o.some(g=>g.resultState===0)),h&&(this.beepSound.stop(),this.beepSound.play())}if(navigator.vibrate&&this.bVibrateOnSuccessfulRead&&o.length){let h=!1;if(this.bVibrateOnSuccessfulRead===!0||this.bVibrateOnSuccessfulRead==="frame"?h=!0:this.bVibrateOnSuccessfulRead==="unique"&&(h=o.some(g=>g.resultState===0)),h)try{navigator.vibrate(this.vibrateDuration)}catch(g){console.warn("Vibration not allowed. User interaction required: "+(g.message||g))}}if(this.onImageRead){o=o.filter(g=>g.resultState>=0);const h=this._cloneDecodeResults(o);this.onImageRead(h)}if(this.onUniqueRead){o=o.filter(g=>g.resultState==0);const h=this._cloneDecodeResults(o);for(let g of h)this.onUniqueRead(g.barcodeText,g)}}this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this.intervalTime?this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},this.intervalTime):this._loopReadVideo()}).catch(o=>{this.dce&&this._dceControler&&this._dceControler.setDisiredAction(this,"stopFetchingLoop"),G._onLog&&G._onLog(o.message||o),this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this._loopReadVideoTimeoutId=setTimeout(()=>{this.dce&&(this.dce.startFetchingLoop(),this._dceControler&&this._dceControler.clearUserDisiredAction({user:this,actionName:"stopFetchingLoop"})),this._loopReadVideo()},Math.max(this.intervalTime,1e3)),o.message=="platform error"||console.warn(o.message)})}_getVideoFrame(){if(!this.dce)return null;let t;if(this.captureAndDecodeInParallel){if(G._onLog&&G._onLog("Get frame in parallel."),this._dceControler&&this._dceControler.setDisiredValue(this,"loopInterval",this._intervalGetVideoFrame),!this.dce.numberOfFramesInBuffer)return this._dceControler&&this._dceControler.setDisiredValue(this,"loopInterval",0),null;t=this.dce.getFrameFromBuffer(),(o=>{if(!o)return;let h=o.timeSpent,g=this.array_getFrameTimeCost;for(;g.length>=5;)g.shift();g.push(h)})(t)}else G._onLog&&G._onLog("Get frame in serial."),this._dceControler&&this._dceControler.setDisiredAction(this,"stopFetchingLoop"),t=this.dce.getFrame();return t}_drawResults(t){if(!this.dce||this._bPauseScan||!this._drawingItemNamespace||!this._drawingItemNamespace.DT_Polygon)return;if(!this._dbrDrawingLayer){if(!this.dce.isOpen())return;this._dbrDrawingLayer=this.dce.getDrawingLayer(3)}const n=this._dbrDrawingLayer;t||(t=[]);let o=this._arrPolygons;for(let h=0;h<t.length;h++){let g,_=t[h].localizationResult;o[h]?(g=o[h],n.hasDrawingItem(g)||n.addDrawingItem(g),g.set("vertices",[{x:_.x1,y:_.y1},{x:_.x2,y:_.y2},{x:_.x3,y:_.y3},{x:_.x4,y:_.y4}])):(g=new this._drawingItemNamespace.DT_Polygon([{x:_.x1,y:_.y1},{x:_.x2,y:_.y2},{x:_.x3,y:_.y3},{x:_.x4,y:_.y4}]),n.addDrawingItem(g),o[h]=g),t[h].resultState===-1?(g.styleId=this._styleIdBeforeVerification,g._mapStyle.set("default",this.dce.getDrawingStyle(this._styleIdBeforeVerification)),g._mapStyle.set("selected",this.dce.getDrawingStyle(this._styleIdBeforeVerification))):(g.styleId=null,g._mapStyle.set("default",this.dce.getDrawingStyle(3)),g._mapStyle.set("selected",this.dce.getDrawingStyle(7))),g.tag=t[h]}for(let h=t.length;h<o.length;h++)n.removeDrawingItem(o[h]);n.renderAll()}async startScanning(t){if(!this.dce&&!this._imgSource)throw new Error("'imageSource' is not set. call 'setImageSource()' before 'startScanning()'.");if(this._tempSolutionStatus!="closed"||(this._tempSolutionStatus="opening",this._tempSolutionStatus!="opening"))return;let n=null;return this.dce&&(this.dce.isOpen()?(t&&this.dce.appendAndShowUI(),n=JSON.parse(JSON.stringify(this.dce.playCallbackInfo))):n=await this.dce.open(t),this._dceControler&&(this._dceControler.clearUserDisiredAction({user:this,actionName:"close"}),this._dceControler.clearUserDisiredValue({property:"ifShowScanRegionLaser"}),this._dceControler.setDisiredValue(this,"ifShowScanRegionLaser",!0),this.dce.ifShowScanRegionLaser&&this.dce.showScanRegionLaser())),this._tempSolutionStatus=="opening"?(this._bPauseScan=!1,this.dce&&this.dce.singleFrameMode||(this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this._loopReadVideoTimeoutId=setTimeout(()=>{this.dce&&(this.dce.startFetchingLoop(),this._dceControler&&this._dceControler.clearUserDisiredAction({user:this,actionName:"stopFetchingLoop"})),this._loopReadVideo()},0)),this._tempSolutionStatus="opened",this.keepAlive(),n):void 0}stopScanning(t){this.dce&&(this._drawResults(null),this._dceControler&&(this._dceControler.setDisiredValue(this,"ifShowScanRegionLaser",!1),this.dce.ifShowScanRegionLaser||this.dce.hideScanRegionLaser(),this._dceControler.setDisiredAction(this,"close",[t]))),this._bPauseScan=!0,this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0,this._tempSolutionStatus="closed"}pauseScanning(t){if(t&&t.keepResultsHighlighted||this._drawResults(null),this._bPauseScan=!0,this.dce){if(this.dce.singleFrameMode)throw new Error("'pauseScanning()' is unavailable when property 'singleFrameMode' of the 'CameraEnhancer' instance is true.");this._dceControler&&(this._dceControler.setDisiredValue(this,"ifShowScanRegionLaser",!1),this.dce.ifShowScanRegionLaser||this.dce.hideScanRegionLaser(),this._dceControler.setDisiredAction(this,"stopFetchingLoop"))}}resumeScanning(){if(this._bPauseScan=!1,this.dce){if(this.dce.singleFrameMode)throw new Error("'resumeScanning()' is unavailable when property 'singleFrameMode' of the 'CameraEnhancer' instance is true.");this.dce.startFetchingLoop(),this._dceControler&&(this._dceControler.clearUserDisiredAction({user:this,actionName:"stopFetchingLoop"}),this._dceControler.clearUserDisiredValue({property:"ifShowScanRegionLaser"}),this._dceControler.setDisiredValue(this,"ifShowScanRegionLaser",!0),this.dce.ifShowScanRegionLaser&&this.dce.showScanRegionLaser())}}destroyContext(){if(G._onLog&&G._onLog("destroyContext()"),this.bDestroyed)return;this.bDestroyed=!0,(this.dce||this._tempSolutionStatus==="opening")&&this.stopScanning(),this.setImageSource(null);let t=G._nextTaskID++;G._taskCallbackMap.set(t,n=>{if(!n.success){let o=new Error(n.message);throw o.stack=n.stack+`
`+o.stack,o}}),G._dbrWorker.postMessage({type:"destroyContext",id:t,instanceID:this._instanceID})}}G._jsVersion="9.3.1",G._jsEditVersion="20220930",G._version=`loading...(JS ${G._jsVersion}.${G._jsEditVersion})`,G._license=Vh,G._sessionPassword=Uh,G.browserInfo=Ne,G._workerName=`dbr-${G._jsVersion}.browser.worker.js`,G._engineResourcePath=jh,G._licenseServer=[],G._deviceFriendlyName="",G._isShowRelDecodeTimeInResults=!1,G._bWasmDebug=!1,G._bNeverShowDialog=!1,G.__bUseFullFeature=!0,G._nextTaskID=0,G._taskCallbackMap=new Map,G._pLoad=new class extends Promise{constructor(e){let t,n;super((o,h)=>{t=o,n=h}),this._s="pending",this.resolve=o=>{this.isPending&&(Ss(o)?this.task=o:(this._s="fulfilled",t(o)))},this.reject=o=>{this.isPending&&(this._s="rejected",n(o))},this.task=e}get status(){return this._s}get isPending(){return this._s==="pending"}get isFulfilled(){return this._s==="fulfilled"}get isRejected(){return this._s==="rejected"}get task(){return this._task}set task(e){let t;this._task=e,Ss(e)?t=e:typeof e=="function"&&(t=new Promise(e)),t&&(async()=>{try{const n=await t;e===this._task&&this.resolve(n)}catch(n){e===this._task&&this.reject(n)}})()}get isEmpty(){return this._task==null}},G._lastErrorCode=0,G._lastErrorString="",G._setWarnnedEx=new Set,G._defaultUIElementURL="@engineResourcePath/dbr.ui.html";var Gh={653:(e,t,n)=>{var o,h,g,_,v,b,C,w,I,A,V,J,q,K,Z,ne,$,re,le,pe,ge,y=y||{version:"5.2.1"};if(t.fabric=y,typeof document<"u"&&typeof window<"u")document instanceof(typeof HTMLDocument<"u"?HTMLDocument:Document)?y.document=document:y.document=document.implementation.createHTMLDocument(""),y.window=window;else{var me=new(n(192)).JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;y.document=me.document,y.jsdomImplForWrapper=n(898).implForWrapper,y.nodeCanvas=n(245).Canvas,y.window=me,DOMParser=y.window.DOMParser}function ce(a,s){var l=a.canvas,u=s.targetCanvas,i=u.getContext("2d");i.translate(0,u.height),i.scale(1,-1);var r=l.height-u.height;i.drawImage(l,0,r,u.width,u.height,0,0,u.width,u.height)}function de(a,s){var l=s.targetCanvas.getContext("2d"),u=s.destinationWidth,i=s.destinationHeight,r=u*i*4,c=new Uint8Array(this.imageBuffer,0,r),p=new Uint8ClampedArray(this.imageBuffer,0,r);a.readPixels(0,0,u,i,a.RGBA,a.UNSIGNED_BYTE,c);var d=new ImageData(p,u,i);l.putImageData(d,0,0)}y.isTouchSupported="ontouchstart"in y.window||"ontouchstart"in y.document||y.window&&y.window.navigator&&y.window.navigator.maxTouchPoints>0,y.isLikelyNode=typeof Buffer<"u"&&typeof window>"u",y.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],y.DPI=96,y.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",y.commaWsp="(?:\\s+,?\\s*|,\\s*)",y.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/gi,y.reNonWord=/[ \n\.,;!\?\-]/,y.fontPaths={},y.iMatrix=[1,0,0,1,0,0],y.svgNS="http://www.w3.org/2000/svg",y.perfLimitSizeTotal=2097152,y.maxCacheSideLimit=4096,y.minCacheSideLimit=256,y.charWidthsCache={},y.textureSize=2048,y.disableStyleCopyPaste=!1,y.enableGLFiltering=!0,y.devicePixelRatio=y.window.devicePixelRatio||y.window.webkitDevicePixelRatio||y.window.mozDevicePixelRatio||1,y.browserShadowBlurConstant=1,y.arcToSegmentsCache={},y.boundsOfCurveCache={},y.cachesBoundsOfCurve=!0,y.forceGLPutImageData=!1,y.initFilterBackend=function(){return y.enableGLFiltering&&y.isWebglSupported&&y.isWebglSupported(y.textureSize)?(console.log("max texture size: "+y.maxTextureSize),new y.WebglFilterBackend({tileSize:y.textureSize})):y.Canvas2dFilterBackend?new y.Canvas2dFilterBackend:void 0},typeof document<"u"&&typeof window<"u"&&(window.fabric=y),function(){function a(l,u){if(this.__eventListeners[l]){var i=this.__eventListeners[l];u?i[i.indexOf(u)]=!1:y.util.array.fill(i,!1)}}function s(l,u){var i=function(){u.apply(this,arguments),this.off(l,i)}.bind(this);this.on(l,i)}y.Observable={fire:function(l,u){if(!this.__eventListeners)return this;var i=this.__eventListeners[l];if(!i)return this;for(var r=0,c=i.length;r<c;r++)i[r]&&i[r].call(this,u||{});return this.__eventListeners[l]=i.filter(function(p){return p!==!1}),this},on:function(l,u){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var i in l)this.on(i,l[i]);else this.__eventListeners[l]||(this.__eventListeners[l]=[]),this.__eventListeners[l].push(u);return this},once:function(l,u){if(arguments.length===1)for(var i in l)s.call(this,i,l[i]);else s.call(this,l,u);return this},off:function(l,u){if(!this.__eventListeners)return this;if(arguments.length===0)for(l in this.__eventListeners)a.call(this,l);else if(arguments.length===1&&typeof arguments[0]=="object")for(var i in l)a.call(this,i,l[i]);else a.call(this,l,u);return this}}}(),y.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var a=0,s=arguments.length;a<s;a++)this._onObjectAdded(arguments[a]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(a,s,l){var u=this._objects;return l?u[s]=a:u.splice(s,0,a),this._onObjectAdded&&this._onObjectAdded(a),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var a,s=this._objects,l=!1,u=0,i=arguments.length;u<i;u++)(a=s.indexOf(arguments[u]))!==-1&&(l=!0,s.splice(a,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[u]));return this.renderOnAddRemove&&l&&this.requestRenderAll(),this},forEachObject:function(a,s){for(var l=this.getObjects(),u=0,i=l.length;u<i;u++)a.call(s,l[u],u,l);return this},getObjects:function(a){return a===void 0?this._objects.concat():this._objects.filter(function(s){return s.type===a})},item:function(a){return this._objects[a]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(a,s){return this._objects.indexOf(a)>-1||!!s&&this._objects.some(function(l){return typeof l.contains=="function"&&l.contains(a,!0)})},complexity:function(){return this._objects.reduce(function(a,s){return a+(s.complexity?s.complexity():0)},0)}},y.CommonMethods={_setOptions:function(a){for(var s in a)this.set(s,a[s])},_initGradient:function(a,s){!a||!a.colorStops||a instanceof y.Gradient||this.set(s,new y.Gradient(a))},_initPattern:function(a,s,l){!a||!a.source||a instanceof y.Pattern?l&&l():this.set(s,new y.Pattern(a,l))},_setObject:function(a){for(var s in a)this._set(s,a[s])},set:function(a,s){return typeof a=="object"?this._setObject(a):this._set(a,s),this},_set:function(a,s){this[a]=s},toggle:function(a){var s=this.get(a);return typeof s=="boolean"&&this.set(a,!s),this},get:function(a){return this[a]}},o=t,h=Math.sqrt,g=Math.atan2,_=Math.pow,v=Math.PI/180,b=Math.PI/2,y.util={cos:function(a){if(a===0)return 1;switch(a<0&&(a=-a),a/b){case 1:case 3:return 0;case 2:return-1}return Math.cos(a)},sin:function(a){if(a===0)return 0;var s=1;switch(a<0&&(s=-1),a/b){case 1:return s;case 2:return 0;case 3:return-s}return Math.sin(a)},removeFromArray:function(a,s){var l=a.indexOf(s);return l!==-1&&a.splice(l,1),a},getRandomInt:function(a,s){return Math.floor(Math.random()*(s-a+1))+a},degreesToRadians:function(a){return a*v},radiansToDegrees:function(a){return a/v},rotatePoint:function(a,s,l){var u=new y.Point(a.x-s.x,a.y-s.y),i=y.util.rotateVector(u,l);return new y.Point(i.x,i.y).addEquals(s)},rotateVector:function(a,s){var l=y.util.sin(s),u=y.util.cos(s);return{x:a.x*u-a.y*l,y:a.x*l+a.y*u}},createVector:function(a,s){return new y.Point(s.x-a.x,s.y-a.y)},calcAngleBetweenVectors:function(a,s){return Math.acos((a.x*s.x+a.y*s.y)/(Math.hypot(a.x,a.y)*Math.hypot(s.x,s.y)))},getHatVector:function(a){return new y.Point(a.x,a.y).multiply(1/Math.hypot(a.x,a.y))},getBisector:function(a,s,l){var u=y.util.createVector(a,s),i=y.util.createVector(a,l),r=y.util.calcAngleBetweenVectors(u,i),c=r*(y.util.calcAngleBetweenVectors(y.util.rotateVector(u,r),i)===0?1:-1)/2;return{vector:y.util.getHatVector(y.util.rotateVector(u,c)),angle:r}},projectStrokeOnPoints:function(a,s,l){var u=[],i=s.strokeWidth/2,r=s.strokeUniform?new y.Point(1/s.scaleX,1/s.scaleY):new y.Point(1,1),c=function(p){var d=i/Math.hypot(p.x,p.y);return new y.Point(p.x*d*r.x,p.y*d*r.y)};return a.length<=1||a.forEach(function(p,d){var f,m,S=new y.Point(p.x,p.y);d===0?(m=a[d+1],f=l?c(y.util.createVector(m,S)).addEquals(S):a[a.length-1]):d===a.length-1?(f=a[d-1],m=l?c(y.util.createVector(f,S)).addEquals(S):a[0]):(f=a[d-1],m=a[d+1]);var T,x,E=y.util.getBisector(S,f,m),O=E.vector,P=E.angle;if(s.strokeLineJoin==="miter"&&(T=-i/Math.sin(P/2),x=new y.Point(O.x*T*r.x,O.y*T*r.y),Math.hypot(x.x,x.y)/i<=s.strokeMiterLimit))return u.push(S.add(x)),void u.push(S.subtract(x));T=-i*Math.SQRT2,x=new y.Point(O.x*T*r.x,O.y*T*r.y),u.push(S.add(x)),u.push(S.subtract(x))}),u},transformPoint:function(a,s,l){return l?new y.Point(s[0]*a.x+s[2]*a.y,s[1]*a.x+s[3]*a.y):new y.Point(s[0]*a.x+s[2]*a.y+s[4],s[1]*a.x+s[3]*a.y+s[5])},makeBoundingBoxFromPoints:function(a,s){if(s)for(var l=0;l<a.length;l++)a[l]=y.util.transformPoint(a[l],s);var u=[a[0].x,a[1].x,a[2].x,a[3].x],i=y.util.array.min(u),r=y.util.array.max(u)-i,c=[a[0].y,a[1].y,a[2].y,a[3].y],p=y.util.array.min(c);return{left:i,top:p,width:r,height:y.util.array.max(c)-p}},invertTransform:function(a){var s=1/(a[0]*a[3]-a[1]*a[2]),l=[s*a[3],-s*a[1],-s*a[2],s*a[0]],u=y.util.transformPoint({x:a[4],y:a[5]},l,!0);return l[4]=-u.x,l[5]=-u.y,l},toFixed:function(a,s){return parseFloat(Number(a).toFixed(s))},parseUnit:function(a,s){var l=/\D{0,2}$/.exec(a),u=parseFloat(a);switch(s||(s=y.Text.DEFAULT_SVG_FONT_SIZE),l[0]){case"mm":return u*y.DPI/25.4;case"cm":return u*y.DPI/2.54;case"in":return u*y.DPI;case"pt":return u*y.DPI/72;case"pc":return u*y.DPI/72*12;case"em":return u*s;default:return u}},falseFunction:function(){return!1},getKlass:function(a,s){return a=y.util.string.camelize(a.charAt(0).toUpperCase()+a.slice(1)),y.util.resolveNamespace(s)[a]},getSvgAttributes:function(a){var s=["instantiated_by_use","style","id","class"];switch(a){case"linearGradient":s=s.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":s=s.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":s=s.concat(["offset","stop-color","stop-opacity"])}return s},resolveNamespace:function(a){if(!a)return y;var s,l=a.split("."),u=l.length,i=o||y.window;for(s=0;s<u;++s)i=i[l[s]];return i},loadImage:function(a,s,l,u){if(a){var i=y.util.createImage(),r=function(){s&&s.call(l,i,!1),i=i.onload=i.onerror=null};i.onload=r,i.onerror=function(){y.log("Error loading "+i.src),s&&s.call(l,null,!0),i=i.onload=i.onerror=null},a.indexOf("data")!==0&&u!=null&&(i.crossOrigin=u),a.substring(0,14)==="data:image/svg"&&(i.onload=null,y.util.loadImageInDom(i,r)),i.src=a}else s&&s.call(l,a)},loadImageInDom:function(a,s){var l=y.document.createElement("div");l.style.width=l.style.height="1px",l.style.left=l.style.top="-100%",l.style.position="absolute",l.appendChild(a),y.document.querySelector("body").appendChild(l),a.onload=function(){s(),l.parentNode.removeChild(l),l=null}},enlivenObjects:function(a,s,l,u){var i=[],r=0,c=(a=a||[]).length;function p(){++r===c&&s&&s(i.filter(function(d){return d}))}c?a.forEach(function(d,f){d&&d.type?y.util.getKlass(d.type,l).fromObject(d,function(m,S){S||(i[f]=m),u&&u(d,m,S),p()}):p()}):s&&s(i)},enlivenObjectEnlivables:function(a,s,l){var u=y.Object.ENLIVEN_PROPS.filter(function(i){return!!a[i]});y.util.enlivenObjects(u.map(function(i){return a[i]}),function(i){var r={};u.forEach(function(c,p){r[c]=i[p],s&&(s[c]=i[p])}),l&&l(r)})},enlivenPatterns:function(a,s){function l(){++i===r&&s&&s(u)}var u=[],i=0,r=(a=a||[]).length;r?a.forEach(function(c,p){c&&c.source?new y.Pattern(c,function(d){u[p]=d,l()}):(u[p]=c,l())}):s&&s(u)},groupSVGElements:function(a,s,l){var u;return a&&a.length===1?a[0]:(s&&(s.width&&s.height?s.centerPoint={x:s.width/2,y:s.height/2}:(delete s.width,delete s.height)),u=new y.Group(a,s),l!==void 0&&(u.sourcePath=l),u)},populateWithProperties:function(a,s,l){if(l&&Array.isArray(l))for(var u=0,i=l.length;u<i;u++)l[u]in a&&(s[l[u]]=a[l[u]])},createCanvasElement:function(){return y.document.createElement("canvas")},copyCanvasElement:function(a){var s=y.util.createCanvasElement();return s.width=a.width,s.height=a.height,s.getContext("2d").drawImage(a,0,0),s},toDataURL:function(a,s,l){return a.toDataURL("image/"+s,l)},createImage:function(){return y.document.createElement("img")},multiplyTransformMatrices:function(a,s,l){return[a[0]*s[0]+a[2]*s[1],a[1]*s[0]+a[3]*s[1],a[0]*s[2]+a[2]*s[3],a[1]*s[2]+a[3]*s[3],l?0:a[0]*s[4]+a[2]*s[5]+a[4],l?0:a[1]*s[4]+a[3]*s[5]+a[5]]},qrDecompose:function(a){var s=g(a[1],a[0]),l=_(a[0],2)+_(a[1],2),u=h(l),i=(a[0]*a[3]-a[2]*a[1])/u,r=g(a[0]*a[2]+a[1]*a[3],l);return{angle:s/v,scaleX:u,scaleY:i,skewX:r/v,skewY:0,translateX:a[4],translateY:a[5]}},calcRotateMatrix:function(a){if(!a.angle)return y.iMatrix.concat();var s=y.util.degreesToRadians(a.angle),l=y.util.cos(s),u=y.util.sin(s);return[l,u,-u,l,0,0]},calcDimensionsMatrix:function(a){var s=a.scaleX===void 0?1:a.scaleX,l=a.scaleY===void 0?1:a.scaleY,u=[a.flipX?-s:s,0,0,a.flipY?-l:l,0,0],i=y.util.multiplyTransformMatrices,r=y.util.degreesToRadians;return a.skewX&&(u=i(u,[1,0,Math.tan(r(a.skewX)),1],!0)),a.skewY&&(u=i(u,[1,Math.tan(r(a.skewY)),0,1],!0)),u},composeMatrix:function(a){var s=[1,0,0,1,a.translateX||0,a.translateY||0],l=y.util.multiplyTransformMatrices;return a.angle&&(s=l(s,y.util.calcRotateMatrix(a))),(a.scaleX!==1||a.scaleY!==1||a.skewX||a.skewY||a.flipX||a.flipY)&&(s=l(s,y.util.calcDimensionsMatrix(a))),s},resetObjectTransform:function(a){a.scaleX=1,a.scaleY=1,a.skewX=0,a.skewY=0,a.flipX=!1,a.flipY=!1,a.rotate(0)},saveObjectTransform:function(a){return{scaleX:a.scaleX,scaleY:a.scaleY,skewX:a.skewX,skewY:a.skewY,angle:a.angle,left:a.left,flipX:a.flipX,flipY:a.flipY,top:a.top}},isTransparent:function(a,s,l,u){u>0&&(s>u?s-=u:s=0,l>u?l-=u:l=0);var i,r=!0,c=a.getImageData(s,l,2*u||1,2*u||1),p=c.data.length;for(i=3;i<p&&(r=c.data[i]<=0)!=0;i+=4);return c=null,r},parsePreserveAspectRatioAttribute:function(a){var s,l="meet",u=a.split(" ");return u&&u.length&&((l=u.pop())!=="meet"&&l!=="slice"?(s=l,l="meet"):u.length&&(s=u.pop())),{meetOrSlice:l,alignX:s!=="none"?s.slice(1,4):"none",alignY:s!=="none"?s.slice(5,8):"none"}},clearFabricFontCache:function(a){(a=(a||"").toLowerCase())?y.charWidthsCache[a]&&delete y.charWidthsCache[a]:y.charWidthsCache={}},limitDimsByArea:function(a,s){var l=Math.sqrt(s*a),u=Math.floor(s/l);return{x:Math.floor(l),y:u}},capValue:function(a,s,l){return Math.max(a,Math.min(s,l))},findScaleToFit:function(a,s){return Math.min(s.width/a.width,s.height/a.height)},findScaleToCover:function(a,s){return Math.max(s.width/a.width,s.height/a.height)},matrixToSVG:function(a){return"matrix("+a.map(function(s){return y.util.toFixed(s,y.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(a,s){var l=y.util.invertTransform(s),u=y.util.multiplyTransformMatrices(l,a.calcOwnMatrix());y.util.applyTransformToObject(a,u)},addTransformToObject:function(a,s){y.util.applyTransformToObject(a,y.util.multiplyTransformMatrices(s,a.calcOwnMatrix()))},applyTransformToObject:function(a,s){var l=y.util.qrDecompose(s),u=new y.Point(l.translateX,l.translateY);a.flipX=!1,a.flipY=!1,a.set("scaleX",l.scaleX),a.set("scaleY",l.scaleY),a.skewX=l.skewX,a.skewY=l.skewY,a.angle=l.angle,a.setPositionByOrigin(u,"center","center")},sizeAfterTransform:function(a,s,l){var u=a/2,i=s/2,r=[{x:-u,y:-i},{x:u,y:-i},{x:-u,y:i},{x:u,y:i}],c=y.util.calcDimensionsMatrix(l),p=y.util.makeBoundingBoxFromPoints(r,c);return{x:p.width,y:p.height}},mergeClipPaths:function(a,s){var l=a,u=s;l.inverted&&!u.inverted&&(l=s,u=a),y.util.applyTransformToObject(u,y.util.multiplyTransformMatrices(y.util.invertTransform(l.calcTransformMatrix()),u.calcTransformMatrix()));var i=l.inverted&&u.inverted;return i&&(l.inverted=u.inverted=!1),new y.Group([l],{clipPath:u,inverted:i})}},function(){var a=Array.prototype.join,s={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},l={m:"l",M:"L"};function u(x,E,O,P,j,W,z,R,D,M,L){var B=y.util.cos(x),U=y.util.sin(x),H=y.util.cos(E),k=y.util.sin(E),F=O*j*H-P*W*k+z,N=P*j*H+O*W*k+R;return["C",M+D*(-O*j*U-P*W*B),L+D*(-P*j*U+O*W*B),F+D*(O*j*k+P*W*H),N+D*(P*j*k-O*W*H),F,N]}function i(x,E,O,P){var j=Math.atan2(E,x),W=Math.atan2(P,O);return W>=j?W-j:2*Math.PI-(j-W)}function r(x,E,O){for(var P=O[1],j=O[2],W=O[3],z=O[4],R=O[5],D=function(B,U,H,k,F,N,X){var Y=Math.PI,Q=X*Y/180,ee=y.util.sin(Q),te=y.util.cos(Q),ie=0,se=0,oe=-te*B*.5-ee*U*.5,ue=-te*U*.5+ee*B*.5,_e=(H=Math.abs(H))*H,fe=(k=Math.abs(k))*k,ve=ue*ue,be=oe*oe,Ae=_e*fe-_e*ve-fe*be,Fe=0;if(Ae<0){var _t=Math.sqrt(1-Ae/(_e*fe));H*=_t,k*=_t}else Fe=(F===N?-1:1)*Math.sqrt(Ae/(_e*ve+fe*be));var De=Fe*H*ue/k,et=-Fe*k*oe/H,mi=te*De-ee*et+.5*B,Jt=ee*De+te*et+.5*U,kt=i(1,0,(oe-De)/H,(ue-et)/k),$t=i((oe-De)/H,(ue-et)/k,(-oe-De)/H,(-ue-et)/k);N===0&&$t>0?$t-=2*Y:N===1&&$t<0&&($t+=2*Y);for(var Br=Math.ceil(Math.abs($t/Y*2)),Wi=[],vi=$t/Br,Ya=8/3*Math.sin(vi/4)*Math.sin(vi/4)/Math.sin(vi/2),Ln=kt+vi,yi=0;yi<Br;yi++)Wi[yi]=u(kt,Ln,te,ee,H,k,mi,Jt,Ya,ie,se),ie=Wi[yi][5],se=Wi[yi][6],kt=Ln,Ln+=vi;return Wi}(O[6]-x,O[7]-E,P,j,z,R,W),M=0,L=D.length;M<L;M++)D[M][1]+=x,D[M][2]+=E,D[M][3]+=x,D[M][4]+=E,D[M][5]+=x,D[M][6]+=E;return D}function c(x,E,O,P){return Math.sqrt((O-x)*(O-x)+(P-E)*(P-E))}function p(x,E,O,P,j,W,z,R){return function(D){var M,L=(M=D)*M*M,B=function(k){return 3*k*k*(1-k)}(D),U=function(k){return 3*k*(1-k)*(1-k)}(D),H=function(k){return(1-k)*(1-k)*(1-k)}(D);return{x:z*L+j*B+O*U+x*H,y:R*L+W*B+P*U+E*H}}}function d(x,E,O,P,j,W,z,R){return function(D){var M=1-D,L=3*M*M*(O-x)+6*M*D*(j-O)+3*D*D*(z-j),B=3*M*M*(P-E)+6*M*D*(W-P)+3*D*D*(R-W);return Math.atan2(B,L)}}function f(x,E,O,P,j,W){return function(z){var R,D=(R=z)*R,M=function(B){return 2*B*(1-B)}(z),L=function(B){return(1-B)*(1-B)}(z);return{x:j*D+O*M+x*L,y:W*D+P*M+E*L}}}function m(x,E,O,P,j,W){return function(z){var R=1-z,D=2*R*(O-x)+2*z*(j-O),M=2*R*(P-E)+2*z*(W-P);return Math.atan2(M,D)}}function S(x,E,O){var P,j,W={x:E,y:O},z=0;for(j=1;j<=100;j+=1)P=x(j/100),z+=c(W.x,W.y,P.x,P.y),W=P;return z}function T(x){for(var E,O,P,j,W=0,z=x.length,R=0,D=0,M=0,L=0,B=[],U=0;U<z;U++){switch(P={x:R,y:D,command:(E=x[U])[0]},E[0]){case"M":P.length=0,M=R=E[1],L=D=E[2];break;case"L":P.length=c(R,D,E[1],E[2]),R=E[1],D=E[2];break;case"C":O=p(R,D,E[1],E[2],E[3],E[4],E[5],E[6]),j=d(R,D,E[1],E[2],E[3],E[4],E[5],E[6]),P.iterator=O,P.angleFinder=j,P.length=S(O,R,D),R=E[5],D=E[6];break;case"Q":O=f(R,D,E[1],E[2],E[3],E[4]),j=m(R,D,E[1],E[2],E[3],E[4]),P.iterator=O,P.angleFinder=j,P.length=S(O,R,D),R=E[3],D=E[4];break;case"Z":case"z":P.destX=M,P.destY=L,P.length=c(R,D,M,L),R=M,D=L}W+=P.length,B.push(P)}return B.push({length:W,x:R,y:D}),B}y.util.joinPath=function(x){return x.map(function(E){return E.join(" ")}).join(" ")},y.util.parsePath=function(x){var E,O,P,j,W,z=[],R=[],D=y.rePathCommand,M="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",L="("+M+")"+y.commaWsp,B="([01])"+y.commaWsp+"?",U=new RegExp(L+"?"+L+"?"+L+B+B+L+"?("+M+")","g");if(!x||!x.match)return z;for(var H,k=0,F=(W=x.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi)).length;k<F;k++){j=(E=W[k]).slice(1).trim(),R.length=0;var N=E.charAt(0);if(H=[N],N.toLowerCase()==="a")for(var X;X=U.exec(j);)for(var Y=1;Y<X.length;Y++)R.push(X[Y]);else for(;P=D.exec(j);)R.push(P[0]);Y=0;for(var Q=R.length;Y<Q;Y++)O=parseFloat(R[Y]),isNaN(O)||H.push(O);var ee=s[N.toLowerCase()],te=l[N]||N;if(H.length-1>ee)for(var ie=1,se=H.length;ie<se;ie+=ee)z.push([N].concat(H.slice(ie,ie+ee))),N=te;else z.push(H)}return z},y.util.makePathSimpler=function(x){var E,O,P,j,W,z,R=0,D=0,M=x.length,L=0,B=0,U=[];for(O=0;O<M;++O){switch(P=!1,(E=x[O].slice(0))[0]){case"l":E[0]="L",E[1]+=R,E[2]+=D;case"L":R=E[1],D=E[2];break;case"h":E[1]+=R;case"H":E[0]="L",E[2]=D,R=E[1];break;case"v":E[1]+=D;case"V":E[0]="L",D=E[1],E[1]=R,E[2]=D;break;case"m":E[0]="M",E[1]+=R,E[2]+=D;case"M":R=E[1],D=E[2],L=E[1],B=E[2];break;case"c":E[0]="C",E[1]+=R,E[2]+=D,E[3]+=R,E[4]+=D,E[5]+=R,E[6]+=D;case"C":W=E[3],z=E[4],R=E[5],D=E[6];break;case"s":E[0]="S",E[1]+=R,E[2]+=D,E[3]+=R,E[4]+=D;case"S":j==="C"?(W=2*R-W,z=2*D-z):(W=R,z=D),R=E[3],D=E[4],E[0]="C",E[5]=E[3],E[6]=E[4],E[3]=E[1],E[4]=E[2],E[1]=W,E[2]=z,W=E[3],z=E[4];break;case"q":E[0]="Q",E[1]+=R,E[2]+=D,E[3]+=R,E[4]+=D;case"Q":W=E[1],z=E[2],R=E[3],D=E[4];break;case"t":E[0]="T",E[1]+=R,E[2]+=D;case"T":j==="Q"?(W=2*R-W,z=2*D-z):(W=R,z=D),E[0]="Q",R=E[1],D=E[2],E[1]=W,E[2]=z,E[3]=R,E[4]=D;break;case"a":E[0]="A",E[6]+=R,E[7]+=D;case"A":P=!0,U=U.concat(r(R,D,E)),R=E[6],D=E[7];break;case"z":case"Z":R=L,D=B}P||U.push(E),j=E[0]}return U},y.util.getSmoothPathFromPoints=function(x,E){var O,P=[],j=new y.Point(x[0].x,x[0].y),W=new y.Point(x[1].x,x[1].y),z=x.length,R=1,D=0,M=z>2;for(E=E||0,M&&(R=x[2].x<W.x?-1:x[2].x===W.x?0:1,D=x[2].y<W.y?-1:x[2].y===W.y?0:1),P.push(["M",j.x-R*E,j.y-D*E]),O=1;O<z;O++){if(!j.eq(W)){var L=j.midPointFrom(W);P.push(["Q",j.x,j.y,L.x,L.y])}j=x[O],O+1<x.length&&(W=x[O+1])}return M&&(R=j.x>x[O-2].x?1:j.x===x[O-2].x?0:-1,D=j.y>x[O-2].y?1:j.y===x[O-2].y?0:-1),P.push(["L",j.x+R*E,j.y+D*E]),P},y.util.getPathSegmentsInfo=T,y.util.getBoundsOfCurve=function(x,E,O,P,j,W,z,R){var D;if(y.cachesBoundsOfCurve&&(D=a.call(arguments),y.boundsOfCurveCache[D]))return y.boundsOfCurveCache[D];var M,L,B,U,H,k,F,N,X=Math.sqrt,Y=Math.min,Q=Math.max,ee=Math.abs,te=[],ie=[[],[]];L=6*x-12*O+6*j,M=-3*x+9*O-9*j+3*z,B=3*O-3*x;for(var se=0;se<2;++se)if(se>0&&(L=6*E-12*P+6*W,M=-3*E+9*P-9*W+3*R,B=3*P-3*E),ee(M)<1e-12){if(ee(L)<1e-12)continue;0<(U=-B/L)&&U<1&&te.push(U)}else(F=L*L-4*B*M)<0||(0<(H=(-L+(N=X(F)))/(2*M))&&H<1&&te.push(H),0<(k=(-L-N)/(2*M))&&k<1&&te.push(k));for(var oe,ue,_e,fe=te.length,ve=fe;fe--;)oe=(_e=1-(U=te[fe]))*_e*_e*x+3*_e*_e*U*O+3*_e*U*U*j+U*U*U*z,ie[0][fe]=oe,ue=_e*_e*_e*E+3*_e*_e*U*P+3*_e*U*U*W+U*U*U*R,ie[1][fe]=ue;ie[0][ve]=x,ie[1][ve]=E,ie[0][ve+1]=z,ie[1][ve+1]=R;var be=[{x:Y.apply(null,ie[0]),y:Y.apply(null,ie[1])},{x:Q.apply(null,ie[0]),y:Q.apply(null,ie[1])}];return y.cachesBoundsOfCurve&&(y.boundsOfCurveCache[D]=be),be},y.util.getPointOnPath=function(x,E,O){O||(O=T(x));for(var P=0;E-O[P].length>0&&P<O.length-2;)E-=O[P].length,P++;var j,W=O[P],z=E/W.length,R=W.command,D=x[P];switch(R){case"M":return{x:W.x,y:W.y,angle:0};case"Z":case"z":return(j=new y.Point(W.x,W.y).lerp(new y.Point(W.destX,W.destY),z)).angle=Math.atan2(W.destY-W.y,W.destX-W.x),j;case"L":return(j=new y.Point(W.x,W.y).lerp(new y.Point(D[1],D[2]),z)).angle=Math.atan2(D[2]-W.y,D[1]-W.x),j;case"C":case"Q":return function(M,L){for(var B,U,H,k=0,F=0,N=M.iterator,X={x:M.x,y:M.y},Y=.01,Q=M.angleFinder;F<L&&Y>1e-4;)B=N(k),H=k,(U=c(X.x,X.y,B.x,B.y))+F>L?(k-=Y,Y/=2):(X=B,k+=Y,F+=U);return B.angle=Q(H),B}(W,E)}},y.util.transformPath=function(x,E,O){return O&&(E=y.util.multiplyTransformMatrices(E,[1,0,0,1,-O.x,-O.y])),x.map(function(P){for(var j=P.slice(0),W={},z=1;z<P.length-1;z+=2)W.x=P[z],W.y=P[z+1],W=y.util.transformPoint(W,E),j[z]=W.x,j[z+1]=W.y;return j})}}(),function(){var a=Array.prototype.slice;function s(l,u,i){if(l&&l.length!==0){var r=l.length-1,c=u?l[r][u]:l[r];if(u)for(;r--;)i(l[r][u],c)&&(c=l[r][u]);else for(;r--;)i(l[r],c)&&(c=l[r]);return c}}y.util.array={fill:function(l,u){for(var i=l.length;i--;)l[i]=u;return l},invoke:function(l,u){for(var i=a.call(arguments,2),r=[],c=0,p=l.length;c<p;c++)r[c]=i.length?l[c][u].apply(l[c],i):l[c][u].call(l[c]);return r},min:function(l,u){return s(l,u,function(i,r){return i<r})},max:function(l,u){return s(l,u,function(i,r){return i>=r})}}}(),function(){function a(s,l,u){if(u)if(!y.isLikelyNode&&l instanceof Element)s=l;else if(l instanceof Array){s=[];for(var i=0,r=l.length;i<r;i++)s[i]=a({},l[i],u)}else if(l&&typeof l=="object")for(var c in l)c==="canvas"||c==="group"?s[c]=null:l.hasOwnProperty(c)&&(s[c]=a({},l[c],u));else s=l;else for(var c in l)s[c]=l[c];return s}y.util.object={extend:a,clone:function(s,l){return a({},s,l)}},y.util.object.extend(y.util,y.Observable)}(),function(){function a(s,l){var u=s.charCodeAt(l);if(isNaN(u))return"";if(u<55296||u>57343)return s.charAt(l);if(55296<=u&&u<=56319){if(s.length<=l+1)throw"High surrogate without following low surrogate";var i=s.charCodeAt(l+1);if(56320>i||i>57343)throw"High surrogate without following low surrogate";return s.charAt(l)+s.charAt(l+1)}if(l===0)throw"Low surrogate without preceding high surrogate";var r=s.charCodeAt(l-1);if(55296>r||r>56319)throw"Low surrogate without preceding high surrogate";return!1}y.util.string={camelize:function(s){return s.replace(/-+(.)?/g,function(l,u){return u?u.toUpperCase():""})},capitalize:function(s,l){return s.charAt(0).toUpperCase()+(l?s.slice(1):s.slice(1).toLowerCase())},escapeXml:function(s){return s.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},graphemeSplit:function(s){var l,u=0,i=[];for(u=0;u<s.length;u++)(l=a(s,u))!==!1&&i.push(l);return i}}}(),function(){var a=Array.prototype.slice,s=function(){},l=function(){for(var c in{toString:1})if(c==="toString")return!1;return!0}(),u=function(c,p,d){for(var f in p)f in c.prototype&&typeof c.prototype[f]=="function"&&(p[f]+"").indexOf("callSuper")>-1?c.prototype[f]=function(m){return function(){var S=this.constructor.superclass;this.constructor.superclass=d;var T=p[m].apply(this,arguments);if(this.constructor.superclass=S,m!=="initialize")return T}}(f):c.prototype[f]=p[f],l&&(p.toString!==Object.prototype.toString&&(c.prototype.toString=p.toString),p.valueOf!==Object.prototype.valueOf&&(c.prototype.valueOf=p.valueOf))};function i(){}function r(c){for(var p=null,d=this;d.constructor.superclass;){var f=d.constructor.superclass.prototype[c];if(d[c]!==f){p=f;break}d=d.constructor.superclass.prototype}return p?arguments.length>1?p.apply(this,a.call(arguments,1)):p.call(this):console.log("tried to callSuper "+c+", method not found in prototype chain",this)}y.util.createClass=function(){var c=null,p=a.call(arguments,0);function d(){this.initialize.apply(this,arguments)}typeof p[0]=="function"&&(c=p.shift()),d.superclass=c,d.subclasses=[],c&&(i.prototype=c.prototype,d.prototype=new i,c.subclasses.push(d));for(var f=0,m=p.length;f<m;f++)u(d,p[f],c);return d.prototype.initialize||(d.prototype.initialize=s),d.prototype.constructor=d,d.prototype.callSuper=r,d}}(),C=!!y.document.createElement("div").attachEvent,w=["touchstart","touchmove","touchend"],y.util.addListener=function(a,s,l,u){a&&a.addEventListener(s,l,!C&&u)},y.util.removeListener=function(a,s,l,u){a&&a.removeEventListener(s,l,!C&&u)},y.util.getPointer=function(a){var s=a.target,l=y.util.getScrollLeftTop(s),u=function(i){var r=i.changedTouches;return r&&r[0]?r[0]:i}(a);return{x:u.clientX+l.left,y:u.clientY+l.top}},y.util.isTouchEvent=function(a){return w.indexOf(a.type)>-1||a.pointerType==="touch"},A=typeof(I=y.document.createElement("div")).style.opacity=="string",V=typeof I.style.filter=="string",J=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,q=function(a){return a},A?q=function(a,s){return a.style.opacity=s,a}:V&&(q=function(a,s){var l=a.style;return a.currentStyle&&!a.currentStyle.hasLayout&&(l.zoom=1),J.test(l.filter)?(s=s>=.9999?"":"alpha(opacity="+100*s+")",l.filter=l.filter.replace(J,s)):l.filter+=" alpha(opacity="+100*s+")",a}),y.util.setStyle=function(a,s){var l=a.style;if(!l)return a;if(typeof s=="string")return a.style.cssText+=";"+s,s.indexOf("opacity")>-1?q(a,s.match(/opacity:\s*(\d?\.?\d*)/)[1]):a;for(var u in s)u==="opacity"?q(a,s[u]):l[u==="float"||u==="cssFloat"?l.styleFloat===void 0?"cssFloat":"styleFloat":u]=s[u];return a},function(){var a,s,l,u,i=Array.prototype.slice,r=function(d){return i.call(d,0)};try{a=r(y.document.childNodes)instanceof Array}catch{}function c(d,f){var m=y.document.createElement(d);for(var S in f)S==="class"?m.className=f[S]:S==="for"?m.htmlFor=f[S]:m.setAttribute(S,f[S]);return m}function p(d){for(var f=0,m=0,S=y.document.documentElement,T=y.document.body||{scrollLeft:0,scrollTop:0};d&&(d.parentNode||d.host)&&((d=d.parentNode||d.host)===y.document?(f=T.scrollLeft||S.scrollLeft||0,m=T.scrollTop||S.scrollTop||0):(f+=d.scrollLeft||0,m+=d.scrollTop||0),d.nodeType!==1||d.style.position!=="fixed"););return{left:f,top:m}}a||(r=function(d){for(var f=new Array(d.length),m=d.length;m--;)f[m]=d[m];return f}),s=y.document.defaultView&&y.document.defaultView.getComputedStyle?function(d,f){var m=y.document.defaultView.getComputedStyle(d,null);return m?m[f]:void 0}:function(d,f){var m=d.style[f];return!m&&d.currentStyle&&(m=d.currentStyle[f]),m},l=y.document.documentElement.style,u="userSelect"in l?"userSelect":"MozUserSelect"in l?"MozUserSelect":"WebkitUserSelect"in l?"WebkitUserSelect":"KhtmlUserSelect"in l?"KhtmlUserSelect":"",y.util.makeElementUnselectable=function(d){return d.onselectstart!==void 0&&(d.onselectstart=y.util.falseFunction),u?d.style[u]="none":typeof d.unselectable=="string"&&(d.unselectable="on"),d},y.util.makeElementSelectable=function(d){return d.onselectstart!==void 0&&(d.onselectstart=null),u?d.style[u]="":typeof d.unselectable=="string"&&(d.unselectable=""),d},y.util.setImageSmoothing=function(d,f){d.imageSmoothingEnabled=d.imageSmoothingEnabled||d.webkitImageSmoothingEnabled||d.mozImageSmoothingEnabled||d.msImageSmoothingEnabled||d.oImageSmoothingEnabled,d.imageSmoothingEnabled=f},y.util.getById=function(d){return typeof d=="string"?y.document.getElementById(d):d},y.util.toArray=r,y.util.addClass=function(d,f){d&&(" "+d.className+" ").indexOf(" "+f+" ")===-1&&(d.className+=(d.className?" ":"")+f)},y.util.makeElement=c,y.util.wrapElement=function(d,f,m){return typeof f=="string"&&(f=c(f,m)),d.parentNode&&d.parentNode.replaceChild(f,d),f.appendChild(d),f},y.util.getScrollLeftTop=p,y.util.getElementOffset=function(d){var f,m,S=d&&d.ownerDocument,T={left:0,top:0},x={left:0,top:0},E={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!S)return x;for(var O in E)x[E[O]]+=parseInt(s(d,O),10)||0;return f=S.documentElement,d.getBoundingClientRect!==void 0&&(T=d.getBoundingClientRect()),m=p(d),{left:T.left+m.left-(f.clientLeft||0)+x.left,top:T.top+m.top-(f.clientTop||0)+x.top}},y.util.getNodeCanvas=function(d){var f=y.jsdomImplForWrapper(d);return f._canvas||f._image},y.util.cleanUpJsdomNode=function(d){if(y.isLikelyNode){var f=y.jsdomImplForWrapper(d);f&&(f._image=null,f._canvas=null,f._currentSrc=null,f._attributes=null,f._classList=null)}}}(),function(){function a(){}y.util.request=function(s,l){l||(l={});var u=l.method?l.method.toUpperCase():"GET",i=l.onComplete||function(){},r=new y.window.XMLHttpRequest,c=l.body||l.parameters;return r.onreadystatechange=function(){r.readyState===4&&(i(r),r.onreadystatechange=a)},u==="GET"&&(c=null,typeof l.parameters=="string"&&(s=function(p,d){return p+(/\?/.test(p)?"&":"?")+d}(s,l.parameters))),r.open(u,s,!0),u!=="POST"&&u!=="PUT"||r.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),r.send(c),r}}(),y.log=console.log,y.warn=console.warn,function(){var a=y.util.object.extend,s=y.util.object.clone,l=[];function u(){return!1}function i(d,f,m,S){return-m*Math.cos(d/S*(Math.PI/2))+m+f}y.util.object.extend(l,{cancelAll:function(){var d=this.splice(0);return d.forEach(function(f){f.cancel()}),d},cancelByCanvas:function(d){if(!d)return[];var f=this.filter(function(m){return typeof m.target=="object"&&m.target.canvas===d});return f.forEach(function(m){m.cancel()}),f},cancelByTarget:function(d){var f=this.findAnimationsByTarget(d);return f.forEach(function(m){m.cancel()}),f},findAnimationIndex:function(d){return this.indexOf(this.findAnimation(d))},findAnimation:function(d){return this.find(function(f){return f.cancel===d})},findAnimationsByTarget:function(d){return d?this.filter(function(f){return f.target===d}):[]}});var r=y.window.requestAnimationFrame||y.window.webkitRequestAnimationFrame||y.window.mozRequestAnimationFrame||y.window.oRequestAnimationFrame||y.window.msRequestAnimationFrame||function(d){return y.window.setTimeout(d,1e3/60)},c=y.window.cancelAnimationFrame||y.window.clearTimeout;function p(){return r.apply(y.window,arguments)}y.util.animate=function(d){d||(d={});var f,m=!1,S=function(){var T=y.runningAnimations.indexOf(f);return T>-1&&y.runningAnimations.splice(T,1)[0]};return f=a(s(d),{cancel:function(){return m=!0,S()},currentValue:"startValue"in d?d.startValue:0,completionRate:0,durationRate:0}),y.runningAnimations.push(f),p(function(T){var x,E=T||+new Date,O=d.duration||500,P=E+O,j=d.onChange||u,W=d.abort||u,z=d.onComplete||u,R=d.easing||i,D="startValue"in d&&d.startValue.length>0,M="startValue"in d?d.startValue:0,L="endValue"in d?d.endValue:100,B=d.byValue||(D?M.map(function(U,H){return L[H]-M[H]}):L-M);d.onStart&&d.onStart(),function U(H){var k=(x=H||+new Date)>P?O:x-E,F=k/O,N=D?M.map(function(Y,Q){return R(k,M[Q],B[Q],O)}):R(k,M,B,O),X=Math.abs(D?(N[0]-M[0])/B[0]:(N-M)/B);if(f.currentValue=D?N.slice():N,f.completionRate=X,f.durationRate=F,!m){if(!W(N,X,F))return x>P?(f.currentValue=D?L.slice():L,f.completionRate=1,f.durationRate=1,j(D?L.slice():L,1,1),z(L,1,1),void S()):(j(N,X,F),void p(U));S()}}(E)}),f.cancel},y.util.requestAnimFrame=p,y.util.cancelAnimFrame=function(){return c.apply(y.window,arguments)},y.runningAnimations=l}(),function(){function a(s,l,u){var i="rgba("+parseInt(s[0]+u*(l[0]-s[0]),10)+","+parseInt(s[1]+u*(l[1]-s[1]),10)+","+parseInt(s[2]+u*(l[2]-s[2]),10);return(i+=","+(s&&l?parseFloat(s[3]+u*(l[3]-s[3])):1))+")"}y.util.animateColor=function(s,l,u,i){var r=new y.Color(s).getSource(),c=new y.Color(l).getSource(),p=i.onComplete,d=i.onChange;return i=i||{},y.util.animate(y.util.object.extend(i,{duration:u||500,startValue:r,endValue:c,byValue:c,easing:function(f,m,S,T){return a(m,S,i.colorEasing?i.colorEasing(f,T):1-Math.cos(f/T*(Math.PI/2)))},onComplete:function(f,m,S){if(p)return p(a(c,c,0),m,S)},onChange:function(f,m,S){if(d){if(Array.isArray(f))return d(a(f,f,0),m,S);d(f,m,S)}}}))}}(),function(){function a(i,r,c,p){return i<Math.abs(r)?(i=r,p=c/4):p=r===0&&i===0?c/(2*Math.PI)*Math.asin(1):c/(2*Math.PI)*Math.asin(r/i),{a:i,c:r,p:c,s:p}}function s(i,r,c){return i.a*Math.pow(2,10*(r-=1))*Math.sin((r*c-i.s)*(2*Math.PI)/i.p)}function l(i,r,c,p){return c-u(p-i,0,c,p)+r}function u(i,r,c,p){return(i/=p)<1/2.75?c*(7.5625*i*i)+r:i<2/2.75?c*(7.5625*(i-=1.5/2.75)*i+.75)+r:i<2.5/2.75?c*(7.5625*(i-=2.25/2.75)*i+.9375)+r:c*(7.5625*(i-=2.625/2.75)*i+.984375)+r}y.util.ease={easeInQuad:function(i,r,c,p){return c*(i/=p)*i+r},easeOutQuad:function(i,r,c,p){return-c*(i/=p)*(i-2)+r},easeInOutQuad:function(i,r,c,p){return(i/=p/2)<1?c/2*i*i+r:-c/2*(--i*(i-2)-1)+r},easeInCubic:function(i,r,c,p){return c*(i/=p)*i*i+r},easeOutCubic:function(i,r,c,p){return c*((i=i/p-1)*i*i+1)+r},easeInOutCubic:function(i,r,c,p){return(i/=p/2)<1?c/2*i*i*i+r:c/2*((i-=2)*i*i+2)+r},easeInQuart:function(i,r,c,p){return c*(i/=p)*i*i*i+r},easeOutQuart:function(i,r,c,p){return-c*((i=i/p-1)*i*i*i-1)+r},easeInOutQuart:function(i,r,c,p){return(i/=p/2)<1?c/2*i*i*i*i+r:-c/2*((i-=2)*i*i*i-2)+r},easeInQuint:function(i,r,c,p){return c*(i/=p)*i*i*i*i+r},easeOutQuint:function(i,r,c,p){return c*((i=i/p-1)*i*i*i*i+1)+r},easeInOutQuint:function(i,r,c,p){return(i/=p/2)<1?c/2*i*i*i*i*i+r:c/2*((i-=2)*i*i*i*i+2)+r},easeInSine:function(i,r,c,p){return-c*Math.cos(i/p*(Math.PI/2))+c+r},easeOutSine:function(i,r,c,p){return c*Math.sin(i/p*(Math.PI/2))+r},easeInOutSine:function(i,r,c,p){return-c/2*(Math.cos(Math.PI*i/p)-1)+r},easeInExpo:function(i,r,c,p){return i===0?r:c*Math.pow(2,10*(i/p-1))+r},easeOutExpo:function(i,r,c,p){return i===p?r+c:c*(1-Math.pow(2,-10*i/p))+r},easeInOutExpo:function(i,r,c,p){return i===0?r:i===p?r+c:(i/=p/2)<1?c/2*Math.pow(2,10*(i-1))+r:c/2*(2-Math.pow(2,-10*--i))+r},easeInCirc:function(i,r,c,p){return-c*(Math.sqrt(1-(i/=p)*i)-1)+r},easeOutCirc:function(i,r,c,p){return c*Math.sqrt(1-(i=i/p-1)*i)+r},easeInOutCirc:function(i,r,c,p){return(i/=p/2)<1?-c/2*(Math.sqrt(1-i*i)-1)+r:c/2*(Math.sqrt(1-(i-=2)*i)+1)+r},easeInElastic:function(i,r,c,p){var d=0;return i===0?r:(i/=p)==1?r+c:(d||(d=.3*p),-s(a(c,c,d,1.70158),i,p)+r)},easeOutElastic:function(i,r,c,p){var d=0;if(i===0)return r;if((i/=p)==1)return r+c;d||(d=.3*p);var f=a(c,c,d,1.70158);return f.a*Math.pow(2,-10*i)*Math.sin((i*p-f.s)*(2*Math.PI)/f.p)+f.c+r},easeInOutElastic:function(i,r,c,p){var d=0;if(i===0)return r;if((i/=p/2)==2)return r+c;d||(d=p*(.3*1.5));var f=a(c,c,d,1.70158);return i<1?-.5*s(f,i,p)+r:f.a*Math.pow(2,-10*(i-=1))*Math.sin((i*p-f.s)*(2*Math.PI)/f.p)*.5+f.c+r},easeInBack:function(i,r,c,p,d){return d===void 0&&(d=1.70158),c*(i/=p)*i*((d+1)*i-d)+r},easeOutBack:function(i,r,c,p,d){return d===void 0&&(d=1.70158),c*((i=i/p-1)*i*((d+1)*i+d)+1)+r},easeInOutBack:function(i,r,c,p,d){return d===void 0&&(d=1.70158),(i/=p/2)<1?c/2*(i*i*((1+(d*=1.525))*i-d))+r:c/2*((i-=2)*i*((1+(d*=1.525))*i+d)+2)+r},easeInBounce:l,easeOutBounce:u,easeInOutBounce:function(i,r,c,p){return i<p/2?.5*l(2*i,0,c,p)+r:.5*u(2*i-p,0,c,p)+.5*c+r}}}(),function(a){var s=a.fabric||(a.fabric={}),l=s.util.object.extend,u=s.util.object.clone,i=s.util.toFixed,r=s.util.parseUnit,c=s.util.multiplyTransformMatrices,p={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},d={stroke:"strokeOpacity",fill:"fillOpacity"},f="font-size",m="clip-path";function S(M){return M in p?p[M]:M}function T(M,L,B,U){var H,k=Array.isArray(L);if(M!=="fill"&&M!=="stroke"||L!=="none"){if(M==="strokeUniform")return L==="non-scaling-stroke";if(M==="strokeDashArray")L=L==="none"?null:L.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(M==="transformMatrix")L=B&&B.transformMatrix?c(B.transformMatrix,s.parseTransformAttribute(L)):s.parseTransformAttribute(L);else if(M==="visible")L=L!=="none"&&L!=="hidden",B&&B.visible===!1&&(L=!1);else if(M==="opacity")L=parseFloat(L),B&&B.opacity!==void 0&&(L*=B.opacity);else if(M==="textAnchor")L=L==="start"?"left":L==="end"?"right":"center";else if(M==="charSpacing")H=r(L,U)/U*1e3;else if(M==="paintFirst"){var F=L.indexOf("fill"),N=L.indexOf("stroke");L="fill",(F>-1&&N>-1&&N<F||F===-1&&N>-1)&&(L="stroke")}else{if(M==="href"||M==="xlink:href"||M==="font")return L;if(M==="imageSmoothing")return L==="optimizeQuality";H=k?L.map(r):r(L,U)}}else L="";return!k&&isNaN(H)?L:H}function x(M){return new RegExp("^("+M.join("|")+")\\b","i")}function E(M,L){var B,U,H,k,F=[];for(H=0,k=L.length;H<k;H++)B=L[H],U=M.getElementsByTagName(B),F=F.concat(Array.prototype.slice.call(U));return F}function O(M,L){var B,U=!0;return(B=P(M,L.pop()))&&L.length&&(U=function(H,k){for(var F,N=!0;H.parentNode&&H.parentNode.nodeType===1&&k.length;)N&&(F=k.pop()),N=P(H=H.parentNode,F);return k.length===0}(M,L)),B&&U&&L.length===0}function P(M,L){var B,U,H=M.nodeName,k=M.getAttribute("class"),F=M.getAttribute("id");if(B=new RegExp("^"+H,"i"),L=L.replace(B,""),F&&L.length&&(B=new RegExp("#"+F+"(?![a-zA-Z\\-]+)","i"),L=L.replace(B,"")),k&&L.length)for(U=(k=k.split(" ")).length;U--;)B=new RegExp("\\."+k[U]+"(?![a-zA-Z\\-]+)","i"),L=L.replace(B,"");return L.length===0}function j(M,L){var B;if(M.getElementById&&(B=M.getElementById(L)),B)return B;var U,H,k,F=M.getElementsByTagName("*");for(H=0,k=F.length;H<k;H++)if(L===(U=F[H]).getAttribute("id"))return U}s.svgValidTagNamesRegEx=x(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),s.svgViewBoxElementsRegEx=x(["symbol","image","marker","pattern","view","svg"]),s.svgInvalidAncestorsRegEx=x(["pattern","defs","symbol","metadata","clipPath","mask","desc"]),s.svgValidParentsRegEx=x(["symbol","g","a","svg","clipPath","defs"]),s.cssRules={},s.gradientDefs={},s.clipPaths={},s.parseTransformAttribute=function(){function M(N,X,Y){N[Y]=Math.tan(s.util.degreesToRadians(X[0]))}var L=s.iMatrix,B=s.reNum,U=s.commaWsp,H="(?:(?:(matrix)\\s*\\(\\s*("+B+")"+U+"("+B+")"+U+"("+B+")"+U+"("+B+")"+U+"("+B+")"+U+"("+B+")\\s*\\))|(?:(translate)\\s*\\(\\s*("+B+")(?:"+U+"("+B+"))?\\s*\\))|(?:(scale)\\s*\\(\\s*("+B+")(?:"+U+"("+B+"))?\\s*\\))|(?:(rotate)\\s*\\(\\s*("+B+")(?:"+U+"("+B+")"+U+"("+B+"))?\\s*\\))|(?:(skewX)\\s*\\(\\s*("+B+")\\s*\\))|(?:(skewY)\\s*\\(\\s*("+B+")\\s*\\)))",k=new RegExp("^\\s*(?:(?:"+H+"(?:"+U+"*"+H+")*)?)\\s*$"),F=new RegExp(H,"g");return function(N){var X=L.concat(),Y=[];if(!N||N&&!k.test(N))return X;N.replace(F,function(ee){var te=new RegExp(H).exec(ee).filter(function(oe){return!!oe}),ie=te[1],se=te.slice(2).map(parseFloat);switch(ie){case"translate":(function(oe,ue){oe[4]=ue[0],ue.length===2&&(oe[5]=ue[1])})(X,se);break;case"rotate":se[0]=s.util.degreesToRadians(se[0]),function(oe,ue){var _e=s.util.cos(ue[0]),fe=s.util.sin(ue[0]),ve=0,be=0;ue.length===3&&(ve=ue[1],be=ue[2]),oe[0]=_e,oe[1]=fe,oe[2]=-fe,oe[3]=_e,oe[4]=ve-(_e*ve-fe*be),oe[5]=be-(fe*ve+_e*be)}(X,se);break;case"scale":(function(oe,ue){var _e=ue[0],fe=ue.length===2?ue[1]:ue[0];oe[0]=_e,oe[3]=fe})(X,se);break;case"skewX":M(X,se,2);break;case"skewY":M(X,se,1);break;case"matrix":X=se}Y.push(X.concat()),X=L.concat()});for(var Q=Y[0];Y.length>1;)Y.shift(),Q=s.util.multiplyTransformMatrices(Q,Y[0]);return Q}}();var W=new RegExp("^\\s*("+s.reNum+"+)\\s*,?\\s*("+s.reNum+"+)\\s*,?\\s*("+s.reNum+"+)\\s*,?\\s*("+s.reNum+"+)\\s*$");function z(M){if(!s.svgViewBoxElementsRegEx.test(M.nodeName))return{};var L,B,U,H,k,F,N=M.getAttribute("viewBox"),X=1,Y=1,Q=M.getAttribute("width"),ee=M.getAttribute("height"),te=M.getAttribute("x")||0,ie=M.getAttribute("y")||0,se=M.getAttribute("preserveAspectRatio")||"",oe=!N||!(N=N.match(W)),ue=!Q||!ee||Q==="100%"||ee==="100%",_e=oe&&ue,fe={},ve="",be=0,Ae=0;if(fe.width=0,fe.height=0,fe.toBeParsed=_e,oe&&(te||ie)&&M.parentNode&&M.parentNode.nodeName!=="#document"&&(ve=" translate("+r(te)+" "+r(ie)+") ",k=(M.getAttribute("transform")||"")+ve,M.setAttribute("transform",k),M.removeAttribute("x"),M.removeAttribute("y")),_e)return fe;if(oe)return fe.width=r(Q),fe.height=r(ee),fe;if(L=-parseFloat(N[1]),B=-parseFloat(N[2]),U=parseFloat(N[3]),H=parseFloat(N[4]),fe.minX=L,fe.minY=B,fe.viewBoxWidth=U,fe.viewBoxHeight=H,ue?(fe.width=U,fe.height=H):(fe.width=r(Q),fe.height=r(ee),X=fe.width/U,Y=fe.height/H),(se=s.util.parsePreserveAspectRatioAttribute(se)).alignX!=="none"&&(se.meetOrSlice==="meet"&&(Y=X=X>Y?Y:X),se.meetOrSlice==="slice"&&(Y=X=X>Y?X:Y),be=fe.width-U*X,Ae=fe.height-H*X,se.alignX==="Mid"&&(be/=2),se.alignY==="Mid"&&(Ae/=2),se.alignX==="Min"&&(be=0),se.alignY==="Min"&&(Ae=0)),X===1&&Y===1&&L===0&&B===0&&te===0&&ie===0)return fe;if((te||ie)&&M.parentNode.nodeName!=="#document"&&(ve=" translate("+r(te)+" "+r(ie)+") "),k=ve+" matrix("+X+" 0 0 "+Y+" "+(L*X+be)+" "+(B*Y+Ae)+") ",M.nodeName==="svg"){for(F=M.ownerDocument.createElementNS(s.svgNS,"g");M.firstChild;)F.appendChild(M.firstChild);M.appendChild(F)}else(F=M).removeAttribute("x"),F.removeAttribute("y"),k=F.getAttribute("transform")+k;return F.setAttribute("transform",k),fe}function R(M,L){var B="xlink:href",U=j(M,L.getAttribute(B).slice(1));if(U&&U.getAttribute(B)&&R(M,U),["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"].forEach(function(k){U&&!L.hasAttribute(k)&&U.hasAttribute(k)&&L.setAttribute(k,U.getAttribute(k))}),!L.children.length)for(var H=U.cloneNode(!0);H.firstChild;)L.appendChild(H.firstChild);L.removeAttribute(B)}s.parseSVGDocument=function(M,L,B,U){if(M){(function(te){for(var ie=E(te,["use","svg:use"]),se=0;ie.length&&se<ie.length;){var oe=ie[se],ue=oe.getAttribute("xlink:href")||oe.getAttribute("href");if(ue===null)return;var _e,fe,ve,be,Ae=ue.slice(1),Fe=oe.getAttribute("x")||0,_t=oe.getAttribute("y")||0,De=j(te,Ae).cloneNode(!0),et=(De.getAttribute("transform")||"")+" translate("+Fe+", "+_t+")",mi=ie.length,Jt=s.svgNS;if(z(De),/^svg$/i.test(De.nodeName)){var kt=De.ownerDocument.createElementNS(Jt,"g");for(fe=0,be=(ve=De.attributes).length;fe<be;fe++)_e=ve.item(fe),kt.setAttributeNS(Jt,_e.nodeName,_e.nodeValue);for(;De.firstChild;)kt.appendChild(De.firstChild);De=kt}for(fe=0,be=(ve=oe.attributes).length;fe<be;fe++)(_e=ve.item(fe)).nodeName!=="x"&&_e.nodeName!=="y"&&_e.nodeName!=="xlink:href"&&_e.nodeName!=="href"&&(_e.nodeName==="transform"?et=_e.nodeValue+" "+et:De.setAttribute(_e.nodeName,_e.nodeValue));De.setAttribute("transform",et),De.setAttribute("instantiated_by_use","1"),De.removeAttribute("id"),oe.parentNode.replaceChild(De,oe),ie.length===mi&&se++}})(M);var H,k,F=s.Object.__uid++,N=z(M),X=s.util.toArray(M.getElementsByTagName("*"));if(N.crossOrigin=U&&U.crossOrigin,N.svgUid=F,X.length===0&&s.isLikelyNode){var Y=[];for(H=0,k=(X=M.selectNodes('//*[name(.)!="svg"]')).length;H<k;H++)Y[H]=X[H];X=Y}var Q=X.filter(function(te){return z(te),s.svgValidTagNamesRegEx.test(te.nodeName.replace("svg:",""))&&!function(ie,se){for(;ie&&(ie=ie.parentNode);)if(ie.nodeName&&se.test(ie.nodeName.replace("svg:",""))&&!ie.getAttribute("instantiated_by_use"))return!0;return!1}(te,s.svgInvalidAncestorsRegEx)});if(!Q||Q&&!Q.length)L&&L([],{});else{var ee={};X.filter(function(te){return te.nodeName.replace("svg:","")==="clipPath"}).forEach(function(te){var ie=te.getAttribute("id");ee[ie]=s.util.toArray(te.getElementsByTagName("*")).filter(function(se){return s.svgValidTagNamesRegEx.test(se.nodeName.replace("svg:",""))})}),s.gradientDefs[F]=s.getGradientDefs(M),s.cssRules[F]=s.getCSSRules(M),s.clipPaths[F]=ee,s.parseElements(Q,function(te,ie){L&&(L(te,N,ie,X),delete s.gradientDefs[F],delete s.cssRules[F],delete s.clipPaths[F])},u(N),B,U)}}};var D=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+s.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+s.reNum+"))?\\s+(.*)");l(s,{parseFontDeclaration:function(M,L){var B=M.match(D);if(B){var U=B[1],H=B[3],k=B[4],F=B[5],N=B[6];U&&(L.fontStyle=U),H&&(L.fontWeight=isNaN(parseFloat(H))?H:parseFloat(H)),k&&(L.fontSize=r(k)),N&&(L.fontFamily=N),F&&(L.lineHeight=F==="normal"?1:F)}},getGradientDefs:function(M){var L,B=E(M,["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"]),U=0,H={};for(U=B.length;U--;)(L=B[U]).getAttribute("xlink:href")&&R(M,L),H[L.getAttribute("id")]=L;return H},parseAttributes:function(M,L,B){if(M){var U,H,k,F={};B===void 0&&(B=M.getAttribute("svgUid")),M.parentNode&&s.svgValidParentsRegEx.test(M.parentNode.nodeName)&&(F=s.parseAttributes(M.parentNode,L,B));var N=L.reduce(function(se,oe){return(U=M.getAttribute(oe))&&(se[oe]=U),se},{}),X=l(function(se,oe){var ue={};for(var _e in s.cssRules[oe])if(O(se,_e.split(" ")))for(var fe in s.cssRules[oe][_e])ue[fe]=s.cssRules[oe][_e][fe];return ue}(M,B),s.parseStyleAttribute(M));N=l(N,X),X[m]&&M.setAttribute(m,X[m]),H=k=F.fontSize||s.Text.DEFAULT_SVG_FONT_SIZE,N[f]&&(N[f]=H=r(N[f],k));var Y,Q,ee={};for(var te in N)Q=T(Y=S(te),N[te],F,H),ee[Y]=Q;ee&&ee.font&&s.parseFontDeclaration(ee.font,ee);var ie=l(F,ee);return s.svgValidParentsRegEx.test(M.nodeName)?ie:function(se){for(var oe in d)if(se[d[oe]]!==void 0&&se[oe]!==""){if(se[oe]===void 0){if(!s.Object.prototype[oe])continue;se[oe]=s.Object.prototype[oe]}if(se[oe].indexOf("url(")!==0){var ue=new s.Color(se[oe]);se[oe]=ue.setAlpha(i(ue.getAlpha()*se[d[oe]],2)).toRgba()}}return se}(ie)}},parseElements:function(M,L,B,U,H){new s.ElementsParser(M,L,B,U,H).parse()},parseStyleAttribute:function(M){var L={},B=M.getAttribute("style");return B&&(typeof B=="string"?function(U,H){var k,F;U.replace(/;\s*$/,"").split(";").forEach(function(N){var X=N.split(":");k=X[0].trim().toLowerCase(),F=X[1].trim(),H[k]=F})}(B,L):function(U,H){var k,F;for(var N in U)U[N]!==void 0&&(k=N.toLowerCase(),F=U[N],H[k]=F)}(B,L)),L},parsePointsAttribute:function(M){if(!M)return null;var L,B,U=[];for(L=0,B=(M=(M=M.replace(/,/g," ").trim()).split(/\s+/)).length;L<B;L+=2)U.push({x:parseFloat(M[L]),y:parseFloat(M[L+1])});return U},getCSSRules:function(M){var L,B,U=M.getElementsByTagName("style"),H={};for(L=0,B=U.length;L<B;L++){var k=U[L].textContent;(k=k.replace(/\/\*[\s\S]*?\*\//g,"")).trim()!==""&&k.split("}").filter(function(F){return F.trim()}).forEach(function(F){var N=F.split("{"),X={},Y=N[1].trim().split(";").filter(function(ie){return ie.trim()});for(L=0,B=Y.length;L<B;L++){var Q=Y[L].split(":"),ee=Q[0].trim(),te=Q[1].trim();X[ee]=te}(F=N[0].trim()).split(",").forEach(function(ie){(ie=ie.replace(/^svg/i,"").trim())!==""&&(H[ie]?s.util.object.extend(H[ie],X):H[ie]=s.util.object.clone(X))})})}return H},loadSVGFromURL:function(M,L,B,U){M=M.replace(/^\n\s*/,"").trim(),new s.util.request(M,{method:"get",onComplete:function(H){var k=H.responseXML;if(!k||!k.documentElement)return L&&L(null),!1;s.parseSVGDocument(k.documentElement,function(F,N,X,Y){L&&L(F,N,X,Y)},B,U)}})},loadSVGFromString:function(M,L,B,U){var H=new s.window.DOMParser().parseFromString(M.trim(),"text/xml");s.parseSVGDocument(H.documentElement,function(k,F,N,X){L(k,F,N,X)},B,U)}})}(t),y.ElementsParser=function(a,s,l,u,i,r){this.elements=a,this.callback=s,this.options=l,this.reviver=u,this.svgUid=l&&l.svgUid||0,this.parsingOptions=i,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=r},(K=y.ElementsParser.prototype).parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},K.createObjects=function(){var a=this;this.elements.forEach(function(s,l){s.setAttribute("svgUid",a.svgUid),a.createObject(s,l)})},K.findTag=function(a){return y[y.util.string.capitalize(a.tagName.replace("svg:",""))]},K.createObject=function(a,s){var l=this.findTag(a);if(l&&l.fromElement)try{l.fromElement(a,this.createCallback(s,a),this.options)}catch(u){y.log(u)}else this.checkIfDone()},K.createCallback=function(a,s){var l=this;return function(u){var i;l.resolveGradient(u,s,"fill"),l.resolveGradient(u,s,"stroke"),u instanceof y.Image&&u._originalElement&&(i=u.parsePreserveAspectRatioAttribute(s)),u._removeTransformMatrix(i),l.resolveClipPath(u,s),l.reviver&&l.reviver(s,u),l.instances[a]=u,l.checkIfDone()}},K.extractPropertyDefinition=function(a,s,l){var u=a[s],i=this.regexUrl;if(i.test(u)){i.lastIndex=0;var r=i.exec(u)[1];return i.lastIndex=0,y[l][this.svgUid][r]}},K.resolveGradient=function(a,s,l){var u=this.extractPropertyDefinition(a,l,"gradientDefs");if(u){var i=s.getAttribute(l+"-opacity"),r=y.Gradient.fromElement(u,a,i,this.options);a.set(l,r)}},K.createClipPathCallback=function(a,s){return function(l){l._removeTransformMatrix(),l.fillRule=l.clipRule,s.push(l)}},K.resolveClipPath=function(a,s){var l,u,i,r,c=this.extractPropertyDefinition(a,"clipPath","clipPaths");if(c){i=[],u=y.util.invertTransform(a.calcTransformMatrix());for(var p=c[0].parentNode,d=s;d.parentNode&&d.getAttribute("clip-path")!==a.clipPath;)d=d.parentNode;d.parentNode.appendChild(p);for(var f=0;f<c.length;f++)l=c[f],this.findTag(l).fromElement(l,this.createClipPathCallback(a,i),this.options);c=i.length===1?i[0]:new y.Group(i),r=y.util.multiplyTransformMatrices(u,c.calcTransformMatrix()),c.clipPath&&this.resolveClipPath(c,d);var m=y.util.qrDecompose(r);c.flipX=!1,c.flipY=!1,c.set("scaleX",m.scaleX),c.set("scaleY",m.scaleY),c.angle=m.angle,c.skewX=m.skewX,c.skewY=0,c.setPositionByOrigin({x:m.translateX,y:m.translateY},"center","center"),a.clipPath=c}else delete a.clipPath},K.checkIfDone=function(){--this.numElements==0&&(this.instances=this.instances.filter(function(a){return a!=null}),this.callback(this.instances,this.elements))},function(a){var s=a.fabric||(a.fabric={});function l(u,i){this.x=u,this.y=i}s.Point?s.warn("fabric.Point is already defined"):(s.Point=l,l.prototype={type:"point",constructor:l,add:function(u){return new l(this.x+u.x,this.y+u.y)},addEquals:function(u){return this.x+=u.x,this.y+=u.y,this},scalarAdd:function(u){return new l(this.x+u,this.y+u)},scalarAddEquals:function(u){return this.x+=u,this.y+=u,this},subtract:function(u){return new l(this.x-u.x,this.y-u.y)},subtractEquals:function(u){return this.x-=u.x,this.y-=u.y,this},scalarSubtract:function(u){return new l(this.x-u,this.y-u)},scalarSubtractEquals:function(u){return this.x-=u,this.y-=u,this},multiply:function(u){return new l(this.x*u,this.y*u)},multiplyEquals:function(u){return this.x*=u,this.y*=u,this},divide:function(u){return new l(this.x/u,this.y/u)},divideEquals:function(u){return this.x/=u,this.y/=u,this},eq:function(u){return this.x===u.x&&this.y===u.y},lt:function(u){return this.x<u.x&&this.y<u.y},lte:function(u){return this.x<=u.x&&this.y<=u.y},gt:function(u){return this.x>u.x&&this.y>u.y},gte:function(u){return this.x>=u.x&&this.y>=u.y},lerp:function(u,i){return i===void 0&&(i=.5),i=Math.max(Math.min(1,i),0),new l(this.x+(u.x-this.x)*i,this.y+(u.y-this.y)*i)},distanceFrom:function(u){var i=this.x-u.x,r=this.y-u.y;return Math.sqrt(i*i+r*r)},midPointFrom:function(u){return this.lerp(u)},min:function(u){return new l(Math.min(this.x,u.x),Math.min(this.y,u.y))},max:function(u){return new l(Math.max(this.x,u.x),Math.max(this.y,u.y))},toString:function(){return this.x+","+this.y},setXY:function(u,i){return this.x=u,this.y=i,this},setX:function(u){return this.x=u,this},setY:function(u){return this.y=u,this},setFromPoint:function(u){return this.x=u.x,this.y=u.y,this},swap:function(u){var i=this.x,r=this.y;this.x=u.x,this.y=u.y,u.x=i,u.y=r},clone:function(){return new l(this.x,this.y)}})}(t),function(a){var s=a.fabric||(a.fabric={});function l(u){this.status=u,this.points=[]}s.Intersection?s.warn("fabric.Intersection is already defined"):(s.Intersection=l,s.Intersection.prototype={constructor:l,appendPoint:function(u){return this.points.push(u),this},appendPoints:function(u){return this.points=this.points.concat(u),this}},s.Intersection.intersectLineLine=function(u,i,r,c){var p,d=(c.x-r.x)*(u.y-r.y)-(c.y-r.y)*(u.x-r.x),f=(i.x-u.x)*(u.y-r.y)-(i.y-u.y)*(u.x-r.x),m=(c.y-r.y)*(i.x-u.x)-(c.x-r.x)*(i.y-u.y);if(m!==0){var S=d/m,T=f/m;0<=S&&S<=1&&0<=T&&T<=1?(p=new l("Intersection")).appendPoint(new s.Point(u.x+S*(i.x-u.x),u.y+S*(i.y-u.y))):p=new l}else p=new l(d===0||f===0?"Coincident":"Parallel");return p},s.Intersection.intersectLinePolygon=function(u,i,r){var c,p,d,f,m=new l,S=r.length;for(f=0;f<S;f++)c=r[f],p=r[(f+1)%S],d=l.intersectLineLine(u,i,c,p),m.appendPoints(d.points);return m.points.length>0&&(m.status="Intersection"),m},s.Intersection.intersectPolygonPolygon=function(u,i){var r,c=new l,p=u.length;for(r=0;r<p;r++){var d=u[r],f=u[(r+1)%p],m=l.intersectLinePolygon(d,f,i);c.appendPoints(m.points)}return c.points.length>0&&(c.status="Intersection"),c},s.Intersection.intersectPolygonRectangle=function(u,i,r){var c=i.min(r),p=i.max(r),d=new s.Point(p.x,c.y),f=new s.Point(c.x,p.y),m=l.intersectLinePolygon(c,d,u),S=l.intersectLinePolygon(d,p,u),T=l.intersectLinePolygon(p,f,u),x=l.intersectLinePolygon(f,c,u),E=new l;return E.appendPoints(m.points),E.appendPoints(S.points),E.appendPoints(T.points),E.appendPoints(x.points),E.points.length>0&&(E.status="Intersection"),E})}(t),function(a){var s=a.fabric||(a.fabric={});function l(i){i?this._tryParsingColor(i):this.setSource([0,0,0,1])}function u(i,r,c){return c<0&&(c+=1),c>1&&(c-=1),c<1/6?i+6*(r-i)*c:c<.5?r:c<2/3?i+(r-i)*(2/3-c)*6:i}s.Color?s.warn("fabric.Color is already defined."):(s.Color=l,s.Color.prototype={_tryParsingColor:function(i){var r;i in l.colorNameMap&&(i=l.colorNameMap[i]),i==="transparent"&&(r=[255,255,255,0]),r||(r=l.sourceFromHex(i)),r||(r=l.sourceFromRgb(i)),r||(r=l.sourceFromHsl(i)),r||(r=[0,0,0,1]),r&&this.setSource(r)},_rgbToHsl:function(i,r,c){i/=255,r/=255,c/=255;var p,d,f,m=s.util.array.max([i,r,c]),S=s.util.array.min([i,r,c]);if(f=(m+S)/2,m===S)p=d=0;else{var T=m-S;switch(d=f>.5?T/(2-m-S):T/(m+S),m){case i:p=(r-c)/T+(r<c?6:0);break;case r:p=(c-i)/T+2;break;case c:p=(i-r)/T+4}p/=6}return[Math.round(360*p),Math.round(100*d),Math.round(100*f)]},getSource:function(){return this._source},setSource:function(i){this._source=i},toRgb:function(){var i=this.getSource();return"rgb("+i[0]+","+i[1]+","+i[2]+")"},toRgba:function(){var i=this.getSource();return"rgba("+i[0]+","+i[1]+","+i[2]+","+i[3]+")"},toHsl:function(){var i=this.getSource(),r=this._rgbToHsl(i[0],i[1],i[2]);return"hsl("+r[0]+","+r[1]+"%,"+r[2]+"%)"},toHsla:function(){var i=this.getSource(),r=this._rgbToHsl(i[0],i[1],i[2]);return"hsla("+r[0]+","+r[1]+"%,"+r[2]+"%,"+i[3]+")"},toHex:function(){var i,r,c,p=this.getSource();return i=(i=p[0].toString(16)).length===1?"0"+i:i,r=(r=p[1].toString(16)).length===1?"0"+r:r,c=(c=p[2].toString(16)).length===1?"0"+c:c,i.toUpperCase()+r.toUpperCase()+c.toUpperCase()},toHexa:function(){var i,r=this.getSource();return i=(i=(i=Math.round(255*r[3])).toString(16)).length===1?"0"+i:i,this.toHex()+i.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(i){var r=this.getSource();return r[3]=i,this.setSource(r),this},toGrayscale:function(){var i=this.getSource(),r=parseInt((.3*i[0]+.59*i[1]+.11*i[2]).toFixed(0),10),c=i[3];return this.setSource([r,r,r,c]),this},toBlackWhite:function(i){var r=this.getSource(),c=(.3*r[0]+.59*r[1]+.11*r[2]).toFixed(0),p=r[3];return i=i||127,c=Number(c)<Number(i)?0:255,this.setSource([c,c,c,p]),this},overlayWith:function(i){i instanceof l||(i=new l(i));var r,c=[],p=this.getAlpha(),d=this.getSource(),f=i.getSource();for(r=0;r<3;r++)c.push(Math.round(.5*d[r]+.5*f[r]));return c[3]=p,this.setSource(c),this}},s.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,s.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,s.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,s.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"},s.Color.fromRgb=function(i){return l.fromSource(l.sourceFromRgb(i))},s.Color.sourceFromRgb=function(i){var r=i.match(l.reRGBa);if(r){var c=parseInt(r[1],10)/(/%$/.test(r[1])?100:1)*(/%$/.test(r[1])?255:1),p=parseInt(r[2],10)/(/%$/.test(r[2])?100:1)*(/%$/.test(r[2])?255:1),d=parseInt(r[3],10)/(/%$/.test(r[3])?100:1)*(/%$/.test(r[3])?255:1);return[parseInt(c,10),parseInt(p,10),parseInt(d,10),r[4]?parseFloat(r[4]):1]}},s.Color.fromRgba=l.fromRgb,s.Color.fromHsl=function(i){return l.fromSource(l.sourceFromHsl(i))},s.Color.sourceFromHsl=function(i){var r=i.match(l.reHSLa);if(r){var c,p,d,f=(parseFloat(r[1])%360+360)%360/360,m=parseFloat(r[2])/(/%$/.test(r[2])?100:1),S=parseFloat(r[3])/(/%$/.test(r[3])?100:1);if(m===0)c=p=d=S;else{var T=S<=.5?S*(m+1):S+m-S*m,x=2*S-T;c=u(x,T,f+1/3),p=u(x,T,f),d=u(x,T,f-1/3)}return[Math.round(255*c),Math.round(255*p),Math.round(255*d),r[4]?parseFloat(r[4]):1]}},s.Color.fromHsla=l.fromHsl,s.Color.fromHex=function(i){return l.fromSource(l.sourceFromHex(i))},s.Color.sourceFromHex=function(i){if(i.match(l.reHex)){var r=i.slice(i.indexOf("#")+1),c=r.length===3||r.length===4,p=r.length===8||r.length===4,d=c?r.charAt(0)+r.charAt(0):r.substring(0,2),f=c?r.charAt(1)+r.charAt(1):r.substring(2,4),m=c?r.charAt(2)+r.charAt(2):r.substring(4,6),S=p?c?r.charAt(3)+r.charAt(3):r.substring(6,8):"FF";return[parseInt(d,16),parseInt(f,16),parseInt(m,16),parseFloat((parseInt(S,16)/255).toFixed(2))]}},s.Color.fromSource=function(i){var r=new l;return r.setSource(i),r})}(t),function(a){var s=a.fabric||(a.fabric={}),l=["e","se","s","sw","w","nw","n","ne","e"],u=["ns","nesw","ew","nwse"],i={},r="left",c="top",p="right",d="bottom",f="center",m={top:d,bottom:c,left:p,right:r,center:f},S=s.util.radiansToDegrees,T=Math.sign||function(k){return(k>0)-(k<0)||+k};function x(k,F){var N=k.angle+S(Math.atan2(F.y,F.x))+360;return Math.round(N%360/45)}function E(k,F){var N=F.transform.target,X=N.canvas,Y=s.util.object.clone(F);Y.target=N,X&&X.fire("object:"+k,Y),N.fire(k,F)}function O(k,F){var N=F.canvas,X=k[N.uniScaleKey];return N.uniformScaling&&!X||!N.uniformScaling&&X}function P(k){return k.originX===f&&k.originY===f}function j(k,F,N){var X=k.lockScalingX,Y=k.lockScalingY;return!((!X||!Y)&&(F||!X&&!Y||!N)&&(!X||F!=="x")&&(!Y||F!=="y"))}function W(k,F,N,X){return{e:k,transform:F,pointer:{x:N,y:X}}}function z(k){return function(F,N,X,Y){var Q=N.target,ee=Q.getCenterPoint(),te=Q.translateToOriginPoint(ee,N.originX,N.originY),ie=k(F,N,X,Y);return Q.setPositionByOrigin(te,N.originX,N.originY),ie}}function R(k,F){return function(N,X,Y,Q){var ee=F(N,X,Y,Q);return ee&&E(k,W(N,X,Y,Q)),ee}}function D(k,F,N,X,Y){var Q=k.target,ee=Q.controls[k.corner],te=Q.canvas.getZoom(),ie=Q.padding/te,se=Q.toLocalPoint(new s.Point(X,Y),F,N);return se.x>=ie&&(se.x-=ie),se.x<=-ie&&(se.x+=ie),se.y>=ie&&(se.y-=ie),se.y<=ie&&(se.y+=ie),se.x-=ee.offsetX,se.y-=ee.offsetY,se}function M(k){return k.flipX!==k.flipY}function L(k,F,N,X,Y){if(k[F]!==0){var Q=Y/k._getTransformedDimensions()[X]*k[N];k.set(N,Q)}}function B(k,F,N,X){var Y,Q=F.target,ee=Q._getTransformedDimensions(0,Q.skewY),te=D(F,F.originX,F.originY,N,X),ie=Math.abs(2*te.x)-ee.x,se=Q.skewX;ie<2?Y=0:(Y=S(Math.atan2(ie/Q.scaleX,ee.y/Q.scaleY)),F.originX===r&&F.originY===d&&(Y=-Y),F.originX===p&&F.originY===c&&(Y=-Y),M(Q)&&(Y=-Y));var oe=se!==Y;if(oe){var ue=Q._getTransformedDimensions().y;Q.set("skewX",Y),L(Q,"skewY","scaleY","y",ue)}return oe}function U(k,F,N,X){var Y,Q=F.target,ee=Q._getTransformedDimensions(Q.skewX,0),te=D(F,F.originX,F.originY,N,X),ie=Math.abs(2*te.y)-ee.y,se=Q.skewY;ie<2?Y=0:(Y=S(Math.atan2(ie/Q.scaleY,ee.x/Q.scaleX)),F.originX===r&&F.originY===d&&(Y=-Y),F.originX===p&&F.originY===c&&(Y=-Y),M(Q)&&(Y=-Y));var oe=se!==Y;if(oe){var ue=Q._getTransformedDimensions().x;Q.set("skewY",Y),L(Q,"skewX","scaleX","x",ue)}return oe}function H(k,F,N,X,Y){Y=Y||{};var Q,ee,te,ie,se,oe,ue=F.target,_e=ue.lockScalingX,fe=ue.lockScalingY,ve=Y.by,be=O(k,ue),Ae=j(ue,ve,be),Fe=F.gestureScale;if(Ae)return!1;if(Fe)ee=F.scaleX*Fe,te=F.scaleY*Fe;else{if(Q=D(F,F.originX,F.originY,N,X),se=ve!=="y"?T(Q.x):1,oe=ve!=="x"?T(Q.y):1,F.signX||(F.signX=se),F.signY||(F.signY=oe),ue.lockScalingFlip&&(F.signX!==se||F.signY!==oe))return!1;if(ie=ue._getTransformedDimensions(),be&&!ve){var _t=Math.abs(Q.x)+Math.abs(Q.y),De=F.original,et=_t/(Math.abs(ie.x*De.scaleX/ue.scaleX)+Math.abs(ie.y*De.scaleY/ue.scaleY));ee=De.scaleX*et,te=De.scaleY*et}else ee=Math.abs(Q.x*ue.scaleX/ie.x),te=Math.abs(Q.y*ue.scaleY/ie.y);P(F)&&(ee*=2,te*=2),F.signX!==se&&ve!=="y"&&(F.originX=m[F.originX],ee*=-1,F.signX=se),F.signY!==oe&&ve!=="x"&&(F.originY=m[F.originY],te*=-1,F.signY=oe)}var mi=ue.scaleX,Jt=ue.scaleY;return ve?(ve==="x"&&ue.set("scaleX",ee),ve==="y"&&ue.set("scaleY",te)):(!_e&&ue.set("scaleX",ee),!fe&&ue.set("scaleY",te)),mi!==ue.scaleX||Jt!==ue.scaleY}i.scaleCursorStyleHandler=function(k,F,N){var X=O(k,N),Y="";if(F.x!==0&&F.y===0?Y="x":F.x===0&&F.y!==0&&(Y="y"),j(N,Y,X))return"not-allowed";var Q=x(N,F);return l[Q]+"-resize"},i.skewCursorStyleHandler=function(k,F,N){var X="not-allowed";if(F.x!==0&&N.lockSkewingY||F.y!==0&&N.lockSkewingX)return X;var Y=x(N,F)%4;return u[Y]+"-resize"},i.scaleSkewCursorStyleHandler=function(k,F,N){return k[N.canvas.altActionKey]?i.skewCursorStyleHandler(k,F,N):i.scaleCursorStyleHandler(k,F,N)},i.rotationWithSnapping=R("rotating",z(function(k,F,N,X){var Y=F,Q=Y.target,ee=Q.translateToOriginPoint(Q.getCenterPoint(),Y.originX,Y.originY);if(Q.lockRotation)return!1;var te,ie=Math.atan2(Y.ey-ee.y,Y.ex-ee.x),se=Math.atan2(X-ee.y,N-ee.x),oe=S(se-ie+Y.theta);if(Q.snapAngle>0){var ue=Q.snapAngle,_e=Q.snapThreshold||ue,fe=Math.ceil(oe/ue)*ue,ve=Math.floor(oe/ue)*ue;Math.abs(oe-ve)<_e?oe=ve:Math.abs(oe-fe)<_e&&(oe=fe)}return oe<0&&(oe=360+oe),oe%=360,te=Q.angle!==oe,Q.angle=oe,te})),i.scalingEqually=R("scaling",z(function(k,F,N,X){return H(k,F,N,X)})),i.scalingX=R("scaling",z(function(k,F,N,X){return H(k,F,N,X,{by:"x"})})),i.scalingY=R("scaling",z(function(k,F,N,X){return H(k,F,N,X,{by:"y"})})),i.scalingYOrSkewingX=function(k,F,N,X){return k[F.target.canvas.altActionKey]?i.skewHandlerX(k,F,N,X):i.scalingY(k,F,N,X)},i.scalingXOrSkewingY=function(k,F,N,X){return k[F.target.canvas.altActionKey]?i.skewHandlerY(k,F,N,X):i.scalingX(k,F,N,X)},i.changeWidth=R("resizing",z(function(k,F,N,X){var Y=F.target,Q=D(F,F.originX,F.originY,N,X),ee=Y.strokeWidth/(Y.strokeUniform?Y.scaleX:1),te=P(F)?2:1,ie=Y.width,se=Math.abs(Q.x*te/Y.scaleX)-ee;return Y.set("width",Math.max(se,0)),ie!==se})),i.skewHandlerX=function(k,F,N,X){var Y,Q=F.target,ee=Q.skewX,te=F.originY;return!Q.lockSkewingX&&(ee===0?Y=D(F,f,f,N,X).x>0?r:p:(ee>0&&(Y=te===c?r:p),ee<0&&(Y=te===c?p:r),M(Q)&&(Y=Y===r?p:r)),F.originX=Y,R("skewing",z(B))(k,F,N,X))},i.skewHandlerY=function(k,F,N,X){var Y,Q=F.target,ee=Q.skewY,te=F.originX;return!Q.lockSkewingY&&(ee===0?Y=D(F,f,f,N,X).y>0?c:d:(ee>0&&(Y=te===r?c:d),ee<0&&(Y=te===r?d:c),M(Q)&&(Y=Y===c?d:c)),F.originY=Y,R("skewing",z(U))(k,F,N,X))},i.dragHandler=function(k,F,N,X){var Y=F.target,Q=N-F.offsetX,ee=X-F.offsetY,te=!Y.get("lockMovementX")&&Y.left!==Q,ie=!Y.get("lockMovementY")&&Y.top!==ee;return te&&Y.set("left",Q),ie&&Y.set("top",ee),(te||ie)&&E("moving",W(k,F,N,X)),te||ie},i.scaleOrSkewActionName=function(k,F,N){var X=k[N.canvas.altActionKey];return F.x===0?X?"skewX":"scaleY":F.y===0?X?"skewY":"scaleX":void 0},i.rotationStyleHandler=function(k,F,N){return N.lockRotation?"not-allowed":F.cursorStyle},i.fireEvent=E,i.wrapWithFixedAnchor=z,i.wrapWithFireEvent=R,i.getLocalPoint=D,s.controlsUtils=i}(t),function(a){var s=a.fabric||(a.fabric={}),l=s.util.degreesToRadians,u=s.controlsUtils;u.renderCircleControl=function(i,r,c,p,d){p=p||{};var f,m=this.sizeX||p.cornerSize||d.cornerSize,S=this.sizeY||p.cornerSize||d.cornerSize,T=p.transparentCorners!==void 0?p.transparentCorners:d.transparentCorners,x=T?"stroke":"fill",E=!T&&(p.cornerStrokeColor||d.cornerStrokeColor),O=r,P=c;i.save(),i.fillStyle=p.cornerColor||d.cornerColor,i.strokeStyle=p.cornerStrokeColor||d.cornerStrokeColor,m>S?(f=m,i.scale(1,S/m),P=c*m/S):S>m?(f=S,i.scale(m/S,1),O=r*S/m):f=m,i.lineWidth=1,i.beginPath(),i.arc(O,P,f/2,0,2*Math.PI,!1),i[x](),E&&i.stroke(),i.restore()},u.renderSquareControl=function(i,r,c,p,d){p=p||{};var f=this.sizeX||p.cornerSize||d.cornerSize,m=this.sizeY||p.cornerSize||d.cornerSize,S=p.transparentCorners!==void 0?p.transparentCorners:d.transparentCorners,T=S?"stroke":"fill",x=!S&&(p.cornerStrokeColor||d.cornerStrokeColor),E=f/2,O=m/2;i.save(),i.fillStyle=p.cornerColor||d.cornerColor,i.strokeStyle=p.cornerStrokeColor||d.cornerStrokeColor,i.lineWidth=1,i.translate(r,c),i.rotate(l(d.angle)),i[T+"Rect"](-E,-O,f,m),x&&i.strokeRect(-E,-O,f,m),i.restore()}}(t),function(a){var s=a.fabric||(a.fabric={});s.Control=function(l){for(var u in l)this[u]=l[u]},s.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(l,u){return u.cursorStyle},getActionName:function(l,u){return u.actionName},getVisibility:function(l,u){var i=l._controlsVisibility;return i&&i[u]!==void 0?i[u]:this.visible},setVisibility:function(l){this.visible=l},positionHandler:function(l,u){return s.util.transformPoint({x:this.x*l.x+this.offsetX,y:this.y*l.y+this.offsetY},u)},calcCornerCoords:function(l,u,i,r,c){var p,d,f,m,S=c?this.touchSizeX:this.sizeX,T=c?this.touchSizeY:this.sizeY;if(S&&T&&S!==T){var x=Math.atan2(T,S),E=Math.sqrt(S*S+T*T)/2,O=x-s.util.degreesToRadians(l),P=Math.PI/2-x-s.util.degreesToRadians(l);p=E*s.util.cos(O),d=E*s.util.sin(O),f=E*s.util.cos(P),m=E*s.util.sin(P)}else E=.7071067812*(S&&T?S:u),O=s.util.degreesToRadians(45-l),p=f=E*s.util.cos(O),d=m=E*s.util.sin(O);return{tl:{x:i-m,y:r-f},tr:{x:i+p,y:r-d},bl:{x:i-p,y:r+d},br:{x:i+m,y:r+f}}},render:function(l,u,i,r,c){((r=r||{}).cornerStyle||c.cornerStyle)==="circle"?s.controlsUtils.renderCircleControl.call(this,l,u,i,r,c):s.controlsUtils.renderSquareControl.call(this,l,u,i,r,c)}}}(t),function(){function a(l,u){var i,r,c,p,d=l.getAttribute("style"),f=l.getAttribute("offset")||0;if(f=(f=parseFloat(f)/(/%$/.test(f)?100:1))<0?0:f>1?1:f,d){var m=d.split(/\s*;\s*/);for(m[m.length-1]===""&&m.pop(),p=m.length;p--;){var S=m[p].split(/\s*:\s*/),T=S[0].trim(),x=S[1].trim();T==="stop-color"?i=x:T==="stop-opacity"&&(c=x)}}return i||(i=l.getAttribute("stop-color")||"rgb(0,0,0)"),c||(c=l.getAttribute("stop-opacity")),r=(i=new y.Color(i)).getAlpha(),c=isNaN(parseFloat(c))?1:parseFloat(c),c*=r*u,{offset:f,color:i.toRgb(),opacity:c}}var s=y.util.object.clone;y.Gradient=y.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(l){l||(l={}),l.coords||(l.coords={});var u,i=this;Object.keys(l).forEach(function(r){i[r]=l[r]}),this.id?this.id+="_"+y.Object.__uid++:this.id=y.Object.__uid++,u={x1:l.coords.x1||0,y1:l.coords.y1||0,x2:l.coords.x2||0,y2:l.coords.y2||0},this.type==="radial"&&(u.r1=l.coords.r1||0,u.r2=l.coords.r2||0),this.coords=u,this.colorStops=l.colorStops.slice()},addColorStop:function(l){for(var u in l){var i=new y.Color(l[u]);this.colorStops.push({offset:parseFloat(u),color:i.toRgb(),opacity:i.getAlpha()})}return this},toObject:function(l){var u={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return y.util.populateWithProperties(this,u,l),u},toSVG:function(l,u){var i,r,c,p,d=s(this.coords,!0),f=(u=u||{},s(this.colorStops,!0)),m=d.r1>d.r2,S=this.gradientTransform?this.gradientTransform.concat():y.iMatrix.concat(),T=-this.offsetX,x=-this.offsetY,E=!!u.additionalTransform,O=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(f.sort(function(z,R){return z.offset-R.offset}),O==="objectBoundingBox"?(T/=l.width,x/=l.height):(T+=l.width/2,x+=l.height/2),l.type==="path"&&this.gradientUnits!=="percentage"&&(T-=l.pathOffset.x,x-=l.pathOffset.y),S[4]-=T,S[5]-=x,p='id="SVGID_'+this.id+'" gradientUnits="'+O+'"',p+=' gradientTransform="'+(E?u.additionalTransform+" ":"")+y.util.matrixToSVG(S)+'" ',this.type==="linear"?c=["<linearGradient ",p,' x1="',d.x1,'" y1="',d.y1,'" x2="',d.x2,'" y2="',d.y2,`">
`]:this.type==="radial"&&(c=["<radialGradient ",p,' cx="',m?d.x1:d.x2,'" cy="',m?d.y1:d.y2,'" r="',m?d.r1:d.r2,'" fx="',m?d.x2:d.x1,'" fy="',m?d.y2:d.y1,`">
`]),this.type==="radial"){if(m)for((f=f.concat()).reverse(),i=0,r=f.length;i<r;i++)f[i].offset=1-f[i].offset;var P=Math.min(d.r1,d.r2);if(P>0){var j=P/Math.max(d.r1,d.r2);for(i=0,r=f.length;i<r;i++)f[i].offset+=j*(1-f[i].offset)}}for(i=0,r=f.length;i<r;i++){var W=f[i];c.push("<stop ",'offset="',100*W.offset+"%",'" style="stop-color:',W.color,W.opacity!==void 0?";stop-opacity: "+W.opacity:";",`"/>
`)}return c.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),c.join("")},toLive:function(l){var u,i,r,c=y.util.object.clone(this.coords);if(this.type){for(this.type==="linear"?u=l.createLinearGradient(c.x1,c.y1,c.x2,c.y2):this.type==="radial"&&(u=l.createRadialGradient(c.x1,c.y1,c.r1,c.x2,c.y2,c.r2)),i=0,r=this.colorStops.length;i<r;i++){var p=this.colorStops[i].color,d=this.colorStops[i].opacity,f=this.colorStops[i].offset;d!==void 0&&(p=new y.Color(p).setAlpha(d).toRgba()),u.addColorStop(f,p)}return u}}}),y.util.object.extend(y.Gradient,{fromElement:function(l,u,i,r){var c=parseFloat(i)/(/%$/.test(i)?100:1);c=c<0?0:c>1?1:c,isNaN(c)&&(c=1);var p,d,f,m,S=l.getElementsByTagName("stop"),T=l.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",x=l.getAttribute("gradientTransform")||"",E=[],O=0,P=0;for(l.nodeName==="linearGradient"||l.nodeName==="LINEARGRADIENT"?(p="linear",d=function(j){return{x1:j.getAttribute("x1")||0,y1:j.getAttribute("y1")||0,x2:j.getAttribute("x2")||"100%",y2:j.getAttribute("y2")||0}}(l)):(p="radial",d=function(j){return{x1:j.getAttribute("fx")||j.getAttribute("cx")||"50%",y1:j.getAttribute("fy")||j.getAttribute("cy")||"50%",r1:0,x2:j.getAttribute("cx")||"50%",y2:j.getAttribute("cy")||"50%",r2:j.getAttribute("r")||"50%"}}(l)),f=S.length;f--;)E.push(a(S[f],c));return m=y.parseTransformAttribute(x),function(j,W,z,R){var D,M;Object.keys(W).forEach(function(L){(D=W[L])==="Infinity"?M=1:D==="-Infinity"?M=0:(M=parseFloat(W[L],10),typeof D=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(D)&&(M*=.01,R==="pixels"&&(L!=="x1"&&L!=="x2"&&L!=="r2"||(M*=z.viewBoxWidth||z.width),L!=="y1"&&L!=="y2"||(M*=z.viewBoxHeight||z.height)))),W[L]=M})}(0,d,r,T),T==="pixels"&&(O=-u.left,P=-u.top),new y.Gradient({id:l.getAttribute("id"),type:p,coords:d,colorStops:E,gradientUnits:T,gradientTransform:m,offsetX:O,offsetY:P})}})}(),Z=y.util.toFixed,y.Pattern=y.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(a,s){if(a||(a={}),this.id=y.Object.__uid++,this.setOptions(a),!a.source||a.source&&typeof a.source!="string")s&&s(this);else{var l=this;this.source=y.util.createImage(),y.util.loadImage(a.source,function(u,i){l.source=u,s&&s(l,i)},null,this.crossOrigin)}},toObject:function(a){var s,l,u=y.Object.NUM_FRACTION_DIGITS;return typeof this.source.src=="string"?s=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(s=this.source.toDataURL()),l={type:"pattern",source:s,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:Z(this.offsetX,u),offsetY:Z(this.offsetY,u),patternTransform:this.patternTransform?this.patternTransform.concat():null},y.util.populateWithProperties(this,l,a),l},toSVG:function(a){var s=typeof this.source=="function"?this.source():this.source,l=s.width/a.width,u=s.height/a.height,i=this.offsetX/a.width,r=this.offsetY/a.height,c="";return this.repeat!=="repeat-x"&&this.repeat!=="no-repeat"||(u=1,r&&(u+=Math.abs(r))),this.repeat!=="repeat-y"&&this.repeat!=="no-repeat"||(l=1,i&&(l+=Math.abs(i))),s.src?c=s.src:s.toDataURL&&(c=s.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+i+'" y="'+r+'" width="'+l+'" height="'+u+`">
<image x="0" y="0" width="`+s.width+'" height="'+s.height+'" xlink:href="'+c+`"></image>
</pattern>
`},setOptions:function(a){for(var s in a)this[s]=a[s]},toLive:function(a){var s=this.source;return!s||s.src!==void 0&&(!s.complete||s.naturalWidth===0||s.naturalHeight===0)?"":a.createPattern(s,this.repeat)}}),function(a){var s=a.fabric||(a.fabric={}),l=s.util.toFixed;s.Shadow?s.warn("fabric.Shadow is already defined."):(s.Shadow=s.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(u){for(var i in typeof u=="string"&&(u=this._parseShadow(u)),u)this[i]=u[i];this.id=s.Object.__uid++},_parseShadow:function(u){var i=u.trim(),r=s.Shadow.reOffsetsAndBlur.exec(i)||[];return{color:(i.replace(s.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)").trim(),offsetX:parseFloat(r[1],10)||0,offsetY:parseFloat(r[2],10)||0,blur:parseFloat(r[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(u){var i=40,r=40,c=s.Object.NUM_FRACTION_DIGITS,p=s.util.rotateVector({x:this.offsetX,y:this.offsetY},s.util.degreesToRadians(-u.angle)),d=new s.Color(this.color);return u.width&&u.height&&(i=100*l((Math.abs(p.x)+this.blur)/u.width,c)+20,r=100*l((Math.abs(p.y)+this.blur)/u.height,c)+20),u.flipX&&(p.x*=-1),u.flipY&&(p.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+r+'%" height="'+(100+2*r)+'%" x="-'+i+'%" width="'+(100+2*i)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+l(this.blur?this.blur/2:0,c)+`"></feGaussianBlur>
	<feOffset dx="`+l(p.x,c)+'" dy="'+l(p.y,c)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+d.toRgb()+'" flood-opacity="'+d.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var u={},i=s.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(r){this[r]!==i[r]&&(u[r]=this[r])},this),u}}),s.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/)}(t),function(){if(y.StaticCanvas)y.warn("fabric.StaticCanvas is already defined.");else{var a=y.util.object.extend,s=y.util.getElementOffset,l=y.util.removeFromArray,u=y.util.toFixed,i=y.util.transformPoint,r=y.util.invertTransform,c=y.util.getNodeCanvas,p=y.util.createCanvasElement,d=new Error("Could not initialize `canvas` element");y.StaticCanvas=y.util.createClass(y.CommonMethods,{initialize:function(f,m){m||(m={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(f,m)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:y.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(f,m){var S=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(f),this._initOptions(m),this.interactive||this._initRetinaScaling(),m.overlayImage&&this.setOverlayImage(m.overlayImage,S),m.backgroundImage&&this.setBackgroundImage(m.backgroundImage,S),m.backgroundColor&&this.setBackgroundColor(m.backgroundColor,S),m.overlayColor&&this.setOverlayColor(m.overlayColor,S),this.calcOffset()},_isRetinaScaling:function(){return y.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,y.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var f=y.devicePixelRatio;this.__initRetinaScaling(f,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(f,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(f,m,S){m.setAttribute("width",this.width*f),m.setAttribute("height",this.height*f),S.scale(f,f)},calcOffset:function(){return this._offset=s(this.lowerCanvasEl),this},setOverlayImage:function(f,m,S){return this.__setBgOverlayImage("overlayImage",f,m,S)},setBackgroundImage:function(f,m,S){return this.__setBgOverlayImage("backgroundImage",f,m,S)},setOverlayColor:function(f,m){return this.__setBgOverlayColor("overlayColor",f,m)},setBackgroundColor:function(f,m){return this.__setBgOverlayColor("backgroundColor",f,m)},__setBgOverlayImage:function(f,m,S,T){return typeof m=="string"?y.util.loadImage(m,function(x,E){if(x){var O=new y.Image(x,T);this[f]=O,O.canvas=this}S&&S(x,E)},this,T&&T.crossOrigin):(T&&m.setOptions(T),this[f]=m,m&&(m.canvas=this),S&&S(m,!1)),this},__setBgOverlayColor:function(f,m,S){return this[f]=m,this._initGradient(m,f),this._initPattern(m,f,S),this},_createCanvasElement:function(){var f=p();if(!f||(f.style||(f.style={}),f.getContext===void 0))throw d;return f},_initOptions:function(f){var m=this.lowerCanvasEl;this._setOptions(f),this.width=this.width||parseInt(m.width,10)||0,this.height=this.height||parseInt(m.height,10)||0,this.lowerCanvasEl.style&&(m.width=this.width,m.height=this.height,m.style.width=this.width+"px",m.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(f){f&&f.getContext?this.lowerCanvasEl=f:this.lowerCanvasEl=y.util.getById(f)||this._createCanvasElement(),y.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(f,m){return this.setDimensions({width:f},m)},setHeight:function(f,m){return this.setDimensions({height:f},m)},setDimensions:function(f,m){var S;for(var T in m=m||{},f)S=f[T],m.cssOnly||(this._setBackstoreDimension(T,f[T]),S+="px",this.hasLostContext=!0),m.backstoreOnly||this._setCssDimension(T,S);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),m.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(f,m){return this.lowerCanvasEl[f]=m,this.upperCanvasEl&&(this.upperCanvasEl[f]=m),this.cacheCanvasEl&&(this.cacheCanvasEl[f]=m),this[f]=m,this},_setCssDimension:function(f,m){return this.lowerCanvasEl.style[f]=m,this.upperCanvasEl&&(this.upperCanvasEl.style[f]=m),this.wrapperEl&&(this.wrapperEl.style[f]=m),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(f){var m,S,T,x=this._activeObject,E=this.backgroundImage,O=this.overlayImage;for(this.viewportTransform=f,S=0,T=this._objects.length;S<T;S++)(m=this._objects[S]).group||m.setCoords(!0);return x&&x.setCoords(),E&&E.setCoords(!0),O&&O.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(f,m){var S=f,T=this.viewportTransform.slice(0);f=i(f,r(this.viewportTransform)),T[0]=m,T[3]=m;var x=i(f,T);return T[4]+=S.x-x.x,T[5]+=S.y-x.y,this.setViewportTransform(T)},setZoom:function(f){return this.zoomToPoint(new y.Point(0,0),f),this},absolutePan:function(f){var m=this.viewportTransform.slice(0);return m[4]=-f.x,m[5]=-f.y,this.setViewportTransform(m)},relativePan:function(f){return this.absolutePan(new y.Point(-f.x-this.viewportTransform[4],-f.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(f){this.stateful&&f.setupState(),f._set("canvas",this),f.setCoords(),this.fire("object:added",{target:f}),f.fire("added")},_onObjectRemoved:function(f){this.fire("object:removed",{target:f}),f.fire("removed"),delete f.canvas},clearContext:function(f){return f.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var f=this.contextContainer;return this.renderCanvas(f,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=y.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var f={},m=this.width,S=this.height,T=r(this.viewportTransform);return f.tl=i({x:0,y:0},T),f.br=i({x:m,y:S},T),f.tr=new y.Point(f.br.x,f.tl.y),f.bl=new y.Point(f.tl.x,f.br.y),this.vptCoords=f,f},cancelRequestedRender:function(){this.isRendering&&(y.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(f,m){var S=this.viewportTransform,T=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(f),y.util.setImageSmoothing(f,this.imageSmoothingEnabled),this.fire("before:render",{ctx:f}),this._renderBackground(f),f.save(),f.transform(S[0],S[1],S[2],S[3],S[4],S[5]),this._renderObjects(f,m),f.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(f),T&&(T.canvas=this,T.shouldCache(),T._transformDone=!0,T.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(f)),this._renderOverlay(f),this.controlsAboveOverlay&&this.interactive&&this.drawControls(f),this.fire("after:render",{ctx:f})},drawClipPathOnCanvas:function(f){var m=this.viewportTransform,S=this.clipPath;f.save(),f.transform(m[0],m[1],m[2],m[3],m[4],m[5]),f.globalCompositeOperation="destination-in",S.transform(f),f.scale(1/S.zoomX,1/S.zoomY),f.drawImage(S._cacheCanvas,-S.cacheTranslationX,-S.cacheTranslationY),f.restore()},_renderObjects:function(f,m){var S,T;for(S=0,T=m.length;S<T;++S)m[S]&&m[S].render(f)},_renderBackgroundOrOverlay:function(f,m){var S=this[m+"Color"],T=this[m+"Image"],x=this.viewportTransform,E=this[m+"Vpt"];if(S||T){if(S){f.save(),f.beginPath(),f.moveTo(0,0),f.lineTo(this.width,0),f.lineTo(this.width,this.height),f.lineTo(0,this.height),f.closePath(),f.fillStyle=S.toLive?S.toLive(f,this):S,E&&f.transform(x[0],x[1],x[2],x[3],x[4],x[5]),f.transform(1,0,0,1,S.offsetX||0,S.offsetY||0);var O=S.gradientTransform||S.patternTransform;O&&f.transform(O[0],O[1],O[2],O[3],O[4],O[5]),f.fill(),f.restore()}T&&(f.save(),E&&f.transform(x[0],x[1],x[2],x[3],x[4],x[5]),T.render(f),f.restore())}},_renderBackground:function(f){this._renderBackgroundOrOverlay(f,"background")},_renderOverlay:function(f){this._renderBackgroundOrOverlay(f,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new y.Point(this.width/2,this.height/2)},centerObjectH:function(f){return this._centerObject(f,new y.Point(this.getCenterPoint().x,f.getCenterPoint().y))},centerObjectV:function(f){return this._centerObject(f,new y.Point(f.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(f){var m=this.getCenterPoint();return this._centerObject(f,m)},viewportCenterObject:function(f){var m=this.getVpCenter();return this._centerObject(f,m)},viewportCenterObjectH:function(f){var m=this.getVpCenter();return this._centerObject(f,new y.Point(m.x,f.getCenterPoint().y)),this},viewportCenterObjectV:function(f){var m=this.getVpCenter();return this._centerObject(f,new y.Point(f.getCenterPoint().x,m.y))},getVpCenter:function(){var f=this.getCenterPoint(),m=r(this.viewportTransform);return i(f,m)},_centerObject:function(f,m){return f.setPositionByOrigin(m,"center","center"),f.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(f){return this.toDatalessObject(f)},toObject:function(f){return this._toObjectMethod("toObject",f)},toDatalessObject:function(f){return this._toObjectMethod("toDatalessObject",f)},_toObjectMethod:function(f,m){var S=this.clipPath,T={version:y.version,objects:this._toObjects(f,m)};return S&&!S.excludeFromExport&&(T.clipPath=this._toObject(this.clipPath,f,m)),a(T,this.__serializeBgOverlay(f,m)),y.util.populateWithProperties(this,T,m),T},_toObjects:function(f,m){return this._objects.filter(function(S){return!S.excludeFromExport}).map(function(S){return this._toObject(S,f,m)},this)},_toObject:function(f,m,S){var T;this.includeDefaultValues||(T=f.includeDefaultValues,f.includeDefaultValues=!1);var x=f[m](S);return this.includeDefaultValues||(f.includeDefaultValues=T),x},__serializeBgOverlay:function(f,m){var S={},T=this.backgroundImage,x=this.overlayImage,E=this.backgroundColor,O=this.overlayColor;return E&&E.toObject?E.excludeFromExport||(S.background=E.toObject(m)):E&&(S.background=E),O&&O.toObject?O.excludeFromExport||(S.overlay=O.toObject(m)):O&&(S.overlay=O),T&&!T.excludeFromExport&&(S.backgroundImage=this._toObject(T,f,m)),x&&!x.excludeFromExport&&(S.overlayImage=this._toObject(x,f,m)),S},svgViewportTransformation:!0,toSVG:function(f,m){f||(f={}),f.reviver=m;var S=[];return this._setSVGPreamble(S,f),this._setSVGHeader(S,f),this.clipPath&&S.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(S,"background"),this._setSVGBgOverlayImage(S,"backgroundImage",m),this._setSVGObjects(S,m),this.clipPath&&S.push(`</g>
`),this._setSVGBgOverlayColor(S,"overlay"),this._setSVGBgOverlayImage(S,"overlayImage",m),S.push("</svg>"),S.join("")},_setSVGPreamble:function(f,m){m.suppressPreamble||f.push('<?xml version="1.0" encoding="',m.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(f,m){var S,T=m.width||this.width,x=m.height||this.height,E='viewBox="0 0 '+this.width+" "+this.height+'" ',O=y.Object.NUM_FRACTION_DIGITS;m.viewBox?E='viewBox="'+m.viewBox.x+" "+m.viewBox.y+" "+m.viewBox.width+" "+m.viewBox.height+'" ':this.svgViewportTransformation&&(S=this.viewportTransform,E='viewBox="'+u(-S[4]/S[0],O)+" "+u(-S[5]/S[3],O)+" "+u(this.width/S[0],O)+" "+u(this.height/S[3],O)+'" '),f.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',T,'" ','height="',x,'" ',E,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",y.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(m),`</defs>
`)},createSVGClipPathMarkup:function(f){var m=this.clipPath;return m?(m.clipPathId="CLIPPATH_"+y.Object.__uid++,'<clipPath id="'+m.clipPathId+`" >
`+this.clipPath.toClipPathSVG(f.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var f=this;return["background","overlay"].map(function(m){var S=f[m+"Color"];if(S&&S.toLive){var T=f[m+"Vpt"],x=f.viewportTransform,E={width:f.width/(T?x[0]:1),height:f.height/(T?x[3]:1)};return S.toSVG(E,{additionalTransform:T?y.util.matrixToSVG(x):""})}}).join("")},createSVGFontFacesMarkup:function(){var f,m,S,T,x,E,O,P,j="",W={},z=y.fontPaths,R=[];for(this._objects.forEach(function M(L){R.push(L),L._objects&&L._objects.forEach(M)}),O=0,P=R.length;O<P;O++)if(m=(f=R[O]).fontFamily,f.type.indexOf("text")!==-1&&!W[m]&&z[m]&&(W[m]=!0,f.styles))for(x in S=f.styles)for(E in T=S[x])!W[m=T[E].fontFamily]&&z[m]&&(W[m]=!0);for(var D in W)j+=[`		@font-face {
`,"			font-family: '",D,`';
`,"			src: url('",z[D],`');
`,`		}
`].join("");return j&&(j=['	<style type="text/css">',`<![CDATA[
`,j,"]]>",`</style>
`].join("")),j},_setSVGObjects:function(f,m){var S,T,x,E=this._objects;for(T=0,x=E.length;T<x;T++)(S=E[T]).excludeFromExport||this._setSVGObject(f,S,m)},_setSVGObject:function(f,m,S){f.push(m.toSVG(S))},_setSVGBgOverlayImage:function(f,m,S){this[m]&&!this[m].excludeFromExport&&this[m].toSVG&&f.push(this[m].toSVG(S))},_setSVGBgOverlayColor:function(f,m){var S=this[m+"Color"],T=this.viewportTransform,x=this.width,E=this.height;if(S)if(S.toLive){var O=S.repeat,P=y.util.invertTransform(T),j=this[m+"Vpt"]?y.util.matrixToSVG(P):"";f.push('<rect transform="'+j+" translate(",x/2,",",E/2,')"',' x="',S.offsetX-x/2,'" y="',S.offsetY-E/2,'" ','width="',O==="repeat-y"||O==="no-repeat"?S.source.width:x,'" height="',O==="repeat-x"||O==="no-repeat"?S.source.height:E,'" fill="url(#SVGID_'+S.id+')"',`></rect>
`)}else f.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',S,'"',`></rect>
`)},sendToBack:function(f){if(!f)return this;var m,S,T,x=this._activeObject;if(f===x&&f.type==="activeSelection")for(m=(T=x._objects).length;m--;)S=T[m],l(this._objects,S),this._objects.unshift(S);else l(this._objects,f),this._objects.unshift(f);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(f){if(!f)return this;var m,S,T,x=this._activeObject;if(f===x&&f.type==="activeSelection")for(T=x._objects,m=0;m<T.length;m++)S=T[m],l(this._objects,S),this._objects.push(S);else l(this._objects,f),this._objects.push(f);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(f,m){if(!f)return this;var S,T,x,E,O,P=this._activeObject,j=0;if(f===P&&f.type==="activeSelection")for(O=P._objects,S=0;S<O.length;S++)T=O[S],(x=this._objects.indexOf(T))>0+j&&(E=x-1,l(this._objects,T),this._objects.splice(E,0,T)),j++;else(x=this._objects.indexOf(f))!==0&&(E=this._findNewLowerIndex(f,x,m),l(this._objects,f),this._objects.splice(E,0,f));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(f,m,S){var T,x;if(S){for(T=m,x=m-1;x>=0;--x)if(f.intersectsWithObject(this._objects[x])||f.isContainedWithinObject(this._objects[x])||this._objects[x].isContainedWithinObject(f)){T=x;break}}else T=m-1;return T},bringForward:function(f,m){if(!f)return this;var S,T,x,E,O,P=this._activeObject,j=0;if(f===P&&f.type==="activeSelection")for(S=(O=P._objects).length;S--;)T=O[S],(x=this._objects.indexOf(T))<this._objects.length-1-j&&(E=x+1,l(this._objects,T),this._objects.splice(E,0,T)),j++;else(x=this._objects.indexOf(f))!==this._objects.length-1&&(E=this._findNewUpperIndex(f,x,m),l(this._objects,f),this._objects.splice(E,0,f));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(f,m,S){var T,x,E;if(S){for(T=m,x=m+1,E=this._objects.length;x<E;++x)if(f.intersectsWithObject(this._objects[x])||f.isContainedWithinObject(this._objects[x])||this._objects[x].isContainedWithinObject(f)){T=x;break}}else T=m+1;return T},moveTo:function(f,m){return l(this._objects,f),this._objects.splice(m,0,f),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(y.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(f){f.dispose&&f.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),y.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),y.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),a(y.StaticCanvas.prototype,y.Observable),a(y.StaticCanvas.prototype,y.Collection),a(y.StaticCanvas.prototype,y.DataURLExporter),a(y.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(f){var m=p();if(!m||!m.getContext)return null;var S=m.getContext("2d");return S&&f==="setLineDash"?S.setLineDash!==void 0:null}}),y.StaticCanvas.prototype.toJSON=y.StaticCanvas.prototype.toObject,y.isLikelyNode&&(y.StaticCanvas.prototype.createPNGStream=function(){var f=c(this.lowerCanvasEl);return f&&f.createPNGStream()},y.StaticCanvas.prototype.createJPEGStream=function(f){var m=c(this.lowerCanvasEl);return m&&m.createJPEGStream(f)})}}(),y.BaseBrush=y.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(a){a.strokeStyle=this.color,a.lineWidth=this.width,a.lineCap=this.strokeLineCap,a.miterLimit=this.strokeMiterLimit,a.lineJoin=this.strokeLineJoin,a.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(a){var s=this.canvas.viewportTransform;a.save(),a.transform(s[0],s[1],s[2],s[3],s[4],s[5])},_setShadow:function(){if(this.shadow){var a=this.canvas,s=this.shadow,l=a.contextTop,u=a.getZoom();a&&a._isRetinaScaling()&&(u*=y.devicePixelRatio),l.shadowColor=s.color,l.shadowBlur=s.blur*u,l.shadowOffsetX=s.offsetX*u,l.shadowOffsetY=s.offsetY*u}},needsFullRender:function(){return new y.Color(this.color).getAlpha()<1||!!this.shadow},_resetShadow:function(){var a=this.canvas.contextTop;a.shadowColor="",a.shadowBlur=a.shadowOffsetX=a.shadowOffsetY=0},_isOutSideCanvas:function(a){return a.x<0||a.x>this.canvas.getWidth()||a.y<0||a.y>this.canvas.getHeight()}}),y.PencilBrush=y.util.createClass(y.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(a){this.canvas=a,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(a,s,l){var u=s.midPointFrom(l);return a.quadraticCurveTo(s.x,s.y,u.x,u.y),u},onMouseDown:function(a,s){this.canvas._isMainEvent(s.e)&&(this.drawStraightLine=s.e[this.straightLineKey],this._prepareForDrawing(a),this._captureDrawingPath(a),this._render())},onMouseMove:function(a,s){if(this.canvas._isMainEvent(s.e)&&(this.drawStraightLine=s.e[this.straightLineKey],(this.limitedToCanvasSize!==!0||!this._isOutSideCanvas(a))&&this._captureDrawingPath(a)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var l=this._points,u=l.length,i=this.canvas.contextTop;this._saveAndTransform(i),this.oldEnd&&(i.beginPath(),i.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(i,l[u-2],l[u-1],!0),i.stroke(),i.restore()}},onMouseUp:function(a){return!this.canvas._isMainEvent(a.e)||(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1)},_prepareForDrawing:function(a){var s=new y.Point(a.x,a.y);this._reset(),this._addPoint(s),this.canvas.contextTop.moveTo(s.x,s.y)},_addPoint:function(a){return!(this._points.length>1&&a.eq(this._points[this._points.length-1])||(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(a),0))},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(a){var s=new y.Point(a.x,a.y);return this._addPoint(s)},_render:function(a){var s,l,u=this._points[0],i=this._points[1];if(a=a||this.canvas.contextTop,this._saveAndTransform(a),a.beginPath(),this._points.length===2&&u.x===i.x&&u.y===i.y){var r=this.width/1e3;u=new y.Point(u.x,u.y),i=new y.Point(i.x,i.y),u.x-=r,i.x+=r}for(a.moveTo(u.x,u.y),s=1,l=this._points.length;s<l;s++)this._drawSegment(a,u,i),u=this._points[s],i=this._points[s+1];a.lineTo(u.x,u.y),a.stroke(),a.restore()},convertPointsToSVGPath:function(a){var s=this.width/1e3;return y.util.getSmoothPathFromPoints(a,s)},_isEmptySVGPath:function(a){return y.util.joinPath(a)==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(a){var s=new y.Path(a,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,s.shadow=new y.Shadow(this.shadow)),s},decimatePoints:function(a,s){if(a.length<=2)return a;var l,u=this.canvas.getZoom(),i=Math.pow(s/u,2),r=a.length-1,c=a[0],p=[c];for(l=1;l<r-1;l++)Math.pow(c.x-a[l].x,2)+Math.pow(c.y-a[l].y,2)>=i&&(c=a[l],p.push(c));return p.push(a[r]),p},_finalizeAndAddPath:function(){this.canvas.contextTop.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var a=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(a))this.canvas.requestRenderAll();else{var s=this.createPath(a);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:s}),this.canvas.add(s),this.canvas.requestRenderAll(),s.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:s})}}}),y.CircleBrush=y.util.createClass(y.BaseBrush,{width:10,initialize:function(a){this.canvas=a,this.points=[]},drawDot:function(a){var s=this.addPoint(a),l=this.canvas.contextTop;this._saveAndTransform(l),this.dot(l,s),l.restore()},dot:function(a,s){a.fillStyle=s.fill,a.beginPath(),a.arc(s.x,s.y,s.radius,0,2*Math.PI,!1),a.closePath(),a.fill()},onMouseDown:function(a){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(a)},_render:function(){var a,s,l=this.canvas.contextTop,u=this.points;for(this._saveAndTransform(l),a=0,s=u.length;a<s;a++)this.dot(l,u[a]);l.restore()},onMouseMove:function(a){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(a)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(a),this._render()):this.drawDot(a))},onMouseUp:function(){var a,s,l=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;var u=[];for(a=0,s=this.points.length;a<s;a++){var i=this.points[a],r=new y.Circle({radius:i.radius,left:i.x,top:i.y,originX:"center",originY:"center",fill:i.fill});this.shadow&&(r.shadow=new y.Shadow(this.shadow)),u.push(r)}var c=new y.Group(u);c.canvas=this.canvas,this.canvas.fire("before:path:created",{path:c}),this.canvas.add(c),this.canvas.fire("path:created",{path:c}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=l,this.canvas.requestRenderAll()},addPoint:function(a){var s=new y.Point(a.x,a.y),l=y.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,u=new y.Color(this.color).setAlpha(y.util.getRandomInt(0,100)/100).toRgba();return s.radius=l,s.fill=u,this.points.push(s),s}}),y.SprayBrush=y.util.createClass(y.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(a){this.canvas=a,this.sprayChunks=[]},onMouseDown:function(a){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(a),this.render(this.sprayChunkPoints)},onMouseMove:function(a){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(a)||(this.addSprayChunk(a),this.render(this.sprayChunkPoints))},onMouseUp:function(){var a=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var s=[],l=0,u=this.sprayChunks.length;l<u;l++)for(var i=this.sprayChunks[l],r=0,c=i.length;r<c;r++){var p=new y.Rect({width:i[r].width,height:i[r].width,left:i[r].x+1,top:i[r].y+1,originX:"center",originY:"center",fill:this.color});s.push(p)}this.optimizeOverlapping&&(s=this._getOptimizedRects(s));var d=new y.Group(s);this.shadow&&d.set("shadow",new y.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:d}),this.canvas.add(d),this.canvas.fire("path:created",{path:d}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=a,this.canvas.requestRenderAll()},_getOptimizedRects:function(a){var s,l,u,i={};for(l=0,u=a.length;l<u;l++)i[s=a[l].left+""+a[l].top]||(i[s]=a[l]);var r=[];for(s in i)r.push(i[s]);return r},render:function(a){var s,l,u=this.canvas.contextTop;for(u.fillStyle=this.color,this._saveAndTransform(u),s=0,l=a.length;s<l;s++){var i=a[s];i.opacity!==void 0&&(u.globalAlpha=i.opacity),u.fillRect(i.x,i.y,i.width,i.width)}u.restore()},_render:function(){var a,s,l=this.canvas.contextTop;for(l.fillStyle=this.color,this._saveAndTransform(l),a=0,s=this.sprayChunks.length;a<s;a++)this.render(this.sprayChunks[a]);l.restore()},addSprayChunk:function(a){this.sprayChunkPoints=[];var s,l,u,i,r=this.width/2;for(i=0;i<this.density;i++){s=y.util.getRandomInt(a.x-r,a.x+r),l=y.util.getRandomInt(a.y-r,a.y+r),u=this.dotWidthVariance?y.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):this.dotWidth;var c=new y.Point(s,l);c.width=u,this.randomOpacity&&(c.opacity=y.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(c)}this.sprayChunks.push(this.sprayChunkPoints)}}),y.PatternBrush=y.util.createClass(y.PencilBrush,{getPatternSrc:function(){var a=y.util.createCanvasElement(),s=a.getContext("2d");return a.width=a.height=25,s.fillStyle=this.color,s.beginPath(),s.arc(10,10,10,0,2*Math.PI,!1),s.closePath(),s.fill(),a},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(a){return a.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(a){this.callSuper("_setBrushStyles",a),a.strokeStyle=this.getPattern(a)},createPath:function(a){var s=this.callSuper("createPath",a),l=s._getLeftTopCoords().scalarAdd(s.strokeWidth/2);return s.stroke=new y.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-l.x,offsetY:-l.y}),s}}),function(){var a=y.util.getPointer,s=y.util.degreesToRadians,l=y.util.isTouchEvent;for(var u in y.Canvas=y.util.createClass(y.StaticCanvas,{initialize:function(i,r){r||(r={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(i,r),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=y.PencilBrush&&new y.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var i,r,c,p=this.getActiveObjects();if(p.length>0&&!this.preserveObjectStacking){r=[],c=[];for(var d=0,f=this._objects.length;d<f;d++)i=this._objects[d],p.indexOf(i)===-1?r.push(i):c.push(i);p.length>1&&(this._activeObject._objects=c),r.push.apply(r,c)}else r=this._objects;return r},renderAll:function(){!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var i=this.contextContainer;return this.renderCanvas(i,this._chooseObjectsToRender()),this},renderTopLayer:function(i){i.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(i),this.contextTopDirty=!0),i.restore()},renderTop:function(){var i=this.contextTop;return this.clearContext(i),this.renderTopLayer(i),this.fire("after:render"),this},_normalizePointer:function(i,r){var c=i.calcTransformMatrix(),p=y.util.invertTransform(c),d=this.restorePointerVpt(r);return y.util.transformPoint(d,p)},isTargetTransparent:function(i,r,c){if(i.shouldCache()&&i._cacheCanvas&&i!==this._activeObject){var p=this._normalizePointer(i,{x:r,y:c}),d=Math.max(i.cacheTranslationX+p.x*i.zoomX,0),f=Math.max(i.cacheTranslationY+p.y*i.zoomY,0);return y.util.isTransparent(i._cacheContext,Math.round(d),Math.round(f),this.targetFindTolerance)}var m=this.contextCache,S=i.selectionBackgroundColor,T=this.viewportTransform;return i.selectionBackgroundColor="",this.clearContext(m),m.save(),m.transform(T[0],T[1],T[2],T[3],T[4],T[5]),i.render(m),m.restore(),i.selectionBackgroundColor=S,y.util.isTransparent(m,r,c,this.targetFindTolerance)},_isSelectionKeyPressed:function(i){return Array.isArray(this.selectionKey)?!!this.selectionKey.find(function(r){return i[r]===!0}):i[this.selectionKey]},_shouldClearSelection:function(i,r){var c=this.getActiveObjects(),p=this._activeObject;return!r||r&&p&&c.length>1&&c.indexOf(r)===-1&&p!==r&&!this._isSelectionKeyPressed(i)||r&&!r.evented||r&&!r.selectable&&p&&p!==r},_shouldCenterTransform:function(i,r,c){var p;if(i)return r==="scale"||r==="scaleX"||r==="scaleY"||r==="resizing"?p=this.centeredScaling||i.centeredScaling:r==="rotate"&&(p=this.centeredRotation||i.centeredRotation),p?!c:c},_getOriginFromCorner:function(i,r){var c={x:i.originX,y:i.originY};return r==="ml"||r==="tl"||r==="bl"?c.x="right":r!=="mr"&&r!=="tr"&&r!=="br"||(c.x="left"),r==="tl"||r==="mt"||r==="tr"?c.y="bottom":r!=="bl"&&r!=="mb"&&r!=="br"||(c.y="top"),c},_getActionFromCorner:function(i,r,c,p){if(!r||!i)return"drag";var d=p.controls[r];return d.getActionName(c,d,p)},_setupCurrentTransform:function(i,r,c){if(r){var p=this.getPointer(i),d=r.__corner,f=r.controls[d],m=c&&d?f.getActionHandler(i,r,f):y.controlsUtils.dragHandler,S=this._getActionFromCorner(c,d,i,r),T=this._getOriginFromCorner(r,d),x=i[this.centeredKey],E={target:r,action:S,actionHandler:m,corner:d,scaleX:r.scaleX,scaleY:r.scaleY,skewX:r.skewX,skewY:r.skewY,offsetX:p.x-r.left,offsetY:p.y-r.top,originX:T.x,originY:T.y,ex:p.x,ey:p.y,lastX:p.x,lastY:p.y,theta:s(r.angle),width:r.width*r.scaleX,shiftKey:i.shiftKey,altKey:x,original:y.util.saveObjectTransform(r)};this._shouldCenterTransform(r,S,x)&&(E.originX="center",E.originY="center"),E.original.originX=T.x,E.original.originY=T.y,this._currentTransform=E,this._beforeTransform(i)}},setCursor:function(i){this.upperCanvasEl.style.cursor=i},_drawSelection:function(i){var r=this._groupSelector,c=new y.Point(r.ex,r.ey),p=y.util.transformPoint(c,this.viewportTransform),d=new y.Point(r.ex+r.left,r.ey+r.top),f=y.util.transformPoint(d,this.viewportTransform),m=Math.min(p.x,f.x),S=Math.min(p.y,f.y),T=Math.max(p.x,f.x),x=Math.max(p.y,f.y),E=this.selectionLineWidth/2;this.selectionColor&&(i.fillStyle=this.selectionColor,i.fillRect(m,S,T-m,x-S)),this.selectionLineWidth&&this.selectionBorderColor&&(i.lineWidth=this.selectionLineWidth,i.strokeStyle=this.selectionBorderColor,m+=E,S+=E,T-=E,x-=E,y.Object.prototype._setLineDash.call(this,i,this.selectionDashArray),i.strokeRect(m,S,T-m,x-S))},findTarget:function(i,r){if(!this.skipTargetFind){var c,p,d=this.getPointer(i,!0),f=this._activeObject,m=this.getActiveObjects(),S=l(i),T=m.length>1&&!r||m.length===1;if(this.targets=[],T&&f._findTargetCorner(d,S)||m.length>1&&!r&&f===this._searchPossibleTargets([f],d))return f;if(m.length===1&&f===this._searchPossibleTargets([f],d)){if(!this.preserveObjectStacking)return f;c=f,p=this.targets,this.targets=[]}var x=this._searchPossibleTargets(this._objects,d);return i[this.altSelectionKey]&&x&&c&&x!==c&&(x=c,this.targets=p),x}},_checkTarget:function(i,r,c){if(r&&r.visible&&r.evented&&r.containsPoint(i)&&(!this.perPixelTargetFind&&!r.perPixelTargetFind||r.isEditing||!this.isTargetTransparent(r,c.x,c.y)))return!0},_searchPossibleTargets:function(i,r){for(var c,p,d=i.length;d--;){var f=i[d],m=f.group?this._normalizePointer(f.group,r):r;if(this._checkTarget(m,f,r)){(c=i[d]).subTargetCheck&&c instanceof y.Group&&(p=this._searchPossibleTargets(c._objects,r))&&this.targets.push(p);break}}return c},restorePointerVpt:function(i){return y.util.transformPoint(i,y.util.invertTransform(this.viewportTransform))},getPointer:function(i,r){if(this._absolutePointer&&!r)return this._absolutePointer;if(this._pointer&&r)return this._pointer;var c,p=a(i),d=this.upperCanvasEl,f=d.getBoundingClientRect(),m=f.width||0,S=f.height||0;m&&S||("top"in f&&"bottom"in f&&(S=Math.abs(f.top-f.bottom)),"right"in f&&"left"in f&&(m=Math.abs(f.right-f.left))),this.calcOffset(),p.x=p.x-this._offset.left,p.y=p.y-this._offset.top,r||(p=this.restorePointerVpt(p));var T=this.getRetinaScaling();return T!==1&&(p.x/=T,p.y/=T),c=m===0||S===0?{width:1,height:1}:{width:d.width/m,height:d.height/S},{x:p.x*c.width,y:p.y*c.height}},_createUpperCanvas:function(){var i=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),r=this.lowerCanvasEl,c=this.upperCanvasEl;c?c.className="":(c=this._createCanvasElement(),this.upperCanvasEl=c),y.util.addClass(c,"upper-canvas "+i),this.wrapperEl.appendChild(c),this._copyCanvasStyle(r,c),this._applyCanvasStyle(c),this.contextTop=c.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=y.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),y.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),y.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(i){var r=this.width||i.width,c=this.height||i.height;y.util.setStyle(i,{position:"absolute",width:r+"px",height:c+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),i.width=r,i.height=c,y.util.makeElementUnselectable(i)},_copyCanvasStyle:function(i,r){r.style.cssText=i.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var i=this._activeObject;return i?i.type==="activeSelection"&&i._objects?i._objects.slice(0):[i]:[]},_onObjectRemoved:function(i){i===this._activeObject&&(this.fire("before:selection:cleared",{target:i}),this._discardActiveObject(),this.fire("selection:cleared",{target:i}),i.fire("deselected")),i===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",i)},_fireSelectionEvents:function(i,r){var c=!1,p=this.getActiveObjects(),d=[],f=[];i.forEach(function(m){p.indexOf(m)===-1&&(c=!0,m.fire("deselected",{e:r,target:m}),f.push(m))}),p.forEach(function(m){i.indexOf(m)===-1&&(c=!0,m.fire("selected",{e:r,target:m}),d.push(m))}),i.length>0&&p.length>0?c&&this.fire("selection:updated",{e:r,selected:d,deselected:f}):p.length>0?this.fire("selection:created",{e:r,selected:d}):i.length>0&&this.fire("selection:cleared",{e:r,deselected:f})},setActiveObject:function(i,r){var c=this.getActiveObjects();return this._setActiveObject(i,r),this._fireSelectionEvents(c,r),this},_setActiveObject:function(i,r){return this._activeObject!==i&&!!this._discardActiveObject(r,i)&&!i.onSelect({e:r})&&(this._activeObject=i,!0)},_discardActiveObject:function(i,r){var c=this._activeObject;if(c){if(c.onDeselect({e:i,object:r}))return!1;this._activeObject=null}return!0},discardActiveObject:function(i){var r=this.getActiveObjects(),c=this.getActiveObject();return r.length&&this.fire("before:selection:cleared",{target:c,e:i}),this._discardActiveObject(i),this._fireSelectionEvents(r,i),this},dispose:function(){var i=this.wrapperEl;return this.removeListeners(),i.removeChild(this.upperCanvasEl),i.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(r){y.util.cleanUpJsdomNode(this[r]),this[r]=void 0}.bind(this)),i.parentNode&&i.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,y.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(i){var r=this._activeObject;r&&r._renderControls(i)},_toObject:function(i,r,c){var p=this._realizeGroupTransformOnObject(i),d=this.callSuper("_toObject",i,r,c);return this._unwindGroupTransformOnObject(i,p),d},_realizeGroupTransformOnObject:function(i){if(i.group&&i.group.type==="activeSelection"&&this._activeObject===i.group){var r={};return["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"].forEach(function(c){r[c]=i[c]}),y.util.addTransformToObject(i,this._activeObject.calcOwnMatrix()),r}return null},_unwindGroupTransformOnObject:function(i,r){r&&i.set(r)},_setSVGObject:function(i,r,c){var p=this._realizeGroupTransformOnObject(r);this.callSuper("_setSVGObject",i,r,c),this._unwindGroupTransformOnObject(r,p)},setViewportTransform:function(i){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),y.StaticCanvas.prototype.setViewportTransform.call(this,i)}}),y.StaticCanvas)u!=="prototype"&&(y.Canvas[u]=y.StaticCanvas[u])}(),function(){var a=y.util.addListener,s=y.util.removeListener,l={passive:!1};function u(i,r){return i.button&&i.button===r-1}y.util.object.extend(y.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(a,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(i,r){var c=this.upperCanvasEl,p=this._getEventPrefix();i(y.window,"resize",this._onResize),i(c,p+"down",this._onMouseDown),i(c,p+"move",this._onMouseMove,l),i(c,p+"out",this._onMouseOut),i(c,p+"enter",this._onMouseEnter),i(c,"wheel",this._onMouseWheel),i(c,"contextmenu",this._onContextMenu),i(c,"dblclick",this._onDoubleClick),i(c,"dragover",this._onDragOver),i(c,"dragenter",this._onDragEnter),i(c,"dragleave",this._onDragLeave),i(c,"drop",this._onDrop),this.enablePointerEvents||i(c,"touchstart",this._onTouchStart,l),typeof eventjs<"u"&&r in eventjs&&(eventjs[r](c,"gesture",this._onGesture),eventjs[r](c,"drag",this._onDrag),eventjs[r](c,"orientation",this._onOrientationChange),eventjs[r](c,"shake",this._onShake),eventjs[r](c,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(s,"remove");var i=this._getEventPrefix();s(y.document,i+"up",this._onMouseUp),s(y.document,"touchend",this._onTouchEnd,l),s(y.document,i+"move",this._onMouseMove,l),s(y.document,"touchmove",this._onMouseMove,l)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(i,r){this.__onTransformGesture&&this.__onTransformGesture(i,r)},_onDrag:function(i,r){this.__onDrag&&this.__onDrag(i,r)},_onMouseWheel:function(i){this.__onMouseWheel(i)},_onMouseOut:function(i){var r=this._hoveredTarget;this.fire("mouse:out",{target:r,e:i}),this._hoveredTarget=null,r&&r.fire("mouseout",{e:i});var c=this;this._hoveredTargets.forEach(function(p){c.fire("mouse:out",{target:r,e:i}),p&&r.fire("mouseout",{e:i})}),this._hoveredTargets=[],this._iTextInstances&&this._iTextInstances.forEach(function(p){p.isEditing&&p.hiddenTextarea.focus()})},_onMouseEnter:function(i){this._currentTransform||this.findTarget(i)||(this.fire("mouse:over",{target:null,e:i}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(i,r){this.__onOrientationChange&&this.__onOrientationChange(i,r)},_onShake:function(i,r){this.__onShake&&this.__onShake(i,r)},_onLongPress:function(i,r){this.__onLongPress&&this.__onLongPress(i,r)},_onDragOver:function(i){i.preventDefault();var r=this._simpleEventHandler("dragover",i);this._fireEnterLeaveEvents(r,i)},_onDrop:function(i){return this._simpleEventHandler("drop:before",i),this._simpleEventHandler("drop",i)},_onContextMenu:function(i){return this.stopContextMenu&&(i.stopPropagation(),i.preventDefault()),!1},_onDoubleClick:function(i){this._cacheTransformEventData(i),this._handleEvent(i,"dblclick"),this._resetTransformEventData(i)},getPointerId:function(i){var r=i.changedTouches;return r?r[0]&&r[0].identifier:this.enablePointerEvents?i.pointerId:-1},_isMainEvent:function(i){return i.isPrimary===!0||i.isPrimary!==!1&&(i.type==="touchend"&&i.touches.length===0||!i.changedTouches||i.changedTouches[0].identifier===this.mainTouchId)},_onTouchStart:function(i){i.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(i)),this.__onMouseDown(i),this._resetTransformEventData();var r=this.upperCanvasEl,c=this._getEventPrefix();a(y.document,"touchend",this._onTouchEnd,l),a(y.document,"touchmove",this._onMouseMove,l),s(r,c+"down",this._onMouseDown)},_onMouseDown:function(i){this.__onMouseDown(i),this._resetTransformEventData();var r=this.upperCanvasEl,c=this._getEventPrefix();s(r,c+"move",this._onMouseMove,l),a(y.document,c+"up",this._onMouseUp),a(y.document,c+"move",this._onMouseMove,l)},_onTouchEnd:function(i){if(!(i.touches.length>0)){this.__onMouseUp(i),this._resetTransformEventData(),this.mainTouchId=null;var r=this._getEventPrefix();s(y.document,"touchend",this._onTouchEnd,l),s(y.document,"touchmove",this._onMouseMove,l);var c=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){a(c.upperCanvasEl,r+"down",c._onMouseDown),c._willAddMouseDown=0},400)}},_onMouseUp:function(i){this.__onMouseUp(i),this._resetTransformEventData();var r=this.upperCanvasEl,c=this._getEventPrefix();this._isMainEvent(i)&&(s(y.document,c+"up",this._onMouseUp),s(y.document,c+"move",this._onMouseMove,l),a(r,c+"move",this._onMouseMove,l))},_onMouseMove:function(i){!this.allowTouchScrolling&&i.preventDefault&&i.preventDefault(),this.__onMouseMove(i)},_onResize:function(){this.calcOffset()},_shouldRender:function(i){var r=this._activeObject;return!!(!!r!=!!i||r&&i&&r!==i)||(r&&r.isEditing,!1)},__onMouseUp:function(i){var r,c=this._currentTransform,p=this._groupSelector,d=!1,f=!p||p.left===0&&p.top===0;if(this._cacheTransformEventData(i),r=this._target,this._handleEvent(i,"up:before"),u(i,3))this.fireRightClick&&this._handleEvent(i,"up",3,f);else{if(u(i,2))return this.fireMiddleClick&&this._handleEvent(i,"up",2,f),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)this._onMouseUpInDrawingMode(i);else if(this._isMainEvent(i)){if(c&&(this._finalizeCurrentTransform(i),d=c.actionPerformed),!f){var m=r===this._activeObject;this._maybeGroupObjects(i),d||(d=this._shouldRender(r)||!m&&r===this._activeObject)}var S,T;if(r){if(S=r._findTargetCorner(this.getPointer(i,!0),y.util.isTouchEvent(i)),r.selectable&&r!==this._activeObject&&r.activeOn==="up")this.setActiveObject(r,i),d=!0;else{var x=r.controls[S],E=x&&x.getMouseUpHandler(i,r,x);E&&E(i,c,(T=this.getPointer(i)).x,T.y)}r.isMoving=!1}if(c&&(c.target!==r||c.corner!==S)){var O=c.target&&c.target.controls[c.corner],P=O&&O.getMouseUpHandler(i,r,x);T=T||this.getPointer(i),P&&P(i,c,T.x,T.y)}this._setCursorFromEvent(i,r),this._handleEvent(i,"up",1,f),this._groupSelector=null,this._currentTransform=null,r&&(r.__corner=0),d?this.requestRenderAll():f||this.renderTop()}}},_simpleEventHandler:function(i,r){var c=this.findTarget(r),p=this.targets,d={e:r,target:c,subTargets:p};if(this.fire(i,d),c&&c.fire(i,d),!p)return c;for(var f=0;f<p.length;f++)p[f].fire(i,d);return c},_handleEvent:function(i,r,c,p){var d=this._target,f=this.targets||[],m={e:i,target:d,subTargets:f,button:c||1,isClick:p||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};r==="up"&&(m.currentTarget=this.findTarget(i),m.currentSubTargets=this.targets),this.fire("mouse:"+r,m),d&&d.fire("mouse"+r,m);for(var S=0;S<f.length;S++)f[S].fire("mouse"+r,m)},_finalizeCurrentTransform:function(i){var r=this._currentTransform,c=r.target,p={e:i,target:c,transform:r,action:r.action};c._scaling&&(c._scaling=!1),c.setCoords(),(r.actionPerformed||this.stateful&&c.hasStateChanged())&&this._fire("modified",p)},_onMouseDownInDrawingMode:function(i){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(i).requestRenderAll();var r=this.getPointer(i);this.freeDrawingBrush.onMouseDown(r,{e:i,pointer:r}),this._handleEvent(i,"down")},_onMouseMoveInDrawingMode:function(i){if(this._isCurrentlyDrawing){var r=this.getPointer(i);this.freeDrawingBrush.onMouseMove(r,{e:i,pointer:r})}this.setCursor(this.freeDrawingCursor),this._handleEvent(i,"move")},_onMouseUpInDrawingMode:function(i){var r=this.getPointer(i);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:i,pointer:r}),this._handleEvent(i,"up")},__onMouseDown:function(i){this._cacheTransformEventData(i),this._handleEvent(i,"down:before");var r=this._target;if(u(i,3))this.fireRightClick&&this._handleEvent(i,"down",3);else if(u(i,2))this.fireMiddleClick&&this._handleEvent(i,"down",2);else if(this.isDrawingMode)this._onMouseDownInDrawingMode(i);else if(this._isMainEvent(i)&&!this._currentTransform){var c=this._pointer;this._previousPointer=c;var p=this._shouldRender(r),d=this._shouldGroup(i,r);if(this._shouldClearSelection(i,r)?this.discardActiveObject(i):d&&(this._handleGrouping(i,r),r=this._activeObject),!this.selection||r&&(r.selectable||r.isEditing||r===this._activeObject)||(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),r){var f=r===this._activeObject;r.selectable&&r.activeOn==="down"&&this.setActiveObject(r,i);var m=r._findTargetCorner(this.getPointer(i,!0),y.util.isTouchEvent(i));if(r.__corner=m,r===this._activeObject&&(m||!d)){this._setupCurrentTransform(i,r,f);var S=r.controls[m],T=(c=this.getPointer(i),S&&S.getMouseDownHandler(i,r,S));T&&T(i,this._currentTransform,c.x,c.y)}}this._handleEvent(i,"down"),(p||d)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(i){this._resetTransformEventData(),this._pointer=this.getPointer(i,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(i)||null},_beforeTransform:function(i){var r=this._currentTransform;this.stateful&&r.target.saveState(),this.fire("before:transform",{e:i,transform:r})},__onMouseMove:function(i){var r,c;if(this._handleEvent(i,"move:before"),this._cacheTransformEventData(i),this.isDrawingMode)this._onMouseMoveInDrawingMode(i);else if(this._isMainEvent(i)){var p=this._groupSelector;p?(c=this._absolutePointer,p.left=c.x-p.ex,p.top=c.y-p.ey,this.renderTop()):this._currentTransform?this._transformObject(i):(r=this.findTarget(i)||null,this._setCursorFromEvent(i,r),this._fireOverOutEvents(r,i)),this._handleEvent(i,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(i,r){var c=this._hoveredTarget,p=this._hoveredTargets,d=this.targets,f=Math.max(p.length,d.length);this.fireSyntheticInOutEvents(i,r,{oldTarget:c,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var m=0;m<f;m++)this.fireSyntheticInOutEvents(d[m],r,{oldTarget:p[m],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=i,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(i,r){var c=this._draggedoverTarget,p=this._hoveredTargets,d=this.targets,f=Math.max(p.length,d.length);this.fireSyntheticInOutEvents(i,r,{oldTarget:c,evtOut:"dragleave",evtIn:"dragenter"});for(var m=0;m<f;m++)this.fireSyntheticInOutEvents(d[m],r,{oldTarget:p[m],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=i},fireSyntheticInOutEvents:function(i,r,c){var p,d,f,m=c.oldTarget,S=m!==i,T=c.canvasEvtIn,x=c.canvasEvtOut;S&&(p={e:r,target:i,previousTarget:m},d={e:r,target:m,nextTarget:i}),f=i&&S,m&&S&&(x&&this.fire(x,d),m.fire(c.evtOut,d)),f&&(T&&this.fire(T,p),i.fire(c.evtIn,p))},__onMouseWheel:function(i){this._cacheTransformEventData(i),this._handleEvent(i,"wheel"),this._resetTransformEventData()},_transformObject:function(i){var r=this.getPointer(i),c=this._currentTransform;c.reset=!1,c.shiftKey=i.shiftKey,c.altKey=i[this.centeredKey],this._performTransformAction(i,c,r),c.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(i,r,c){var p=c.x,d=c.y,f=r.action,m=!1,S=r.actionHandler;S&&(m=S(i,r,p,d)),f==="drag"&&m&&(r.target.isMoving=!0,this.setCursor(r.target.moveCursor||this.moveCursor)),r.actionPerformed=r.actionPerformed||m},_fire:y.controlsUtils.fireEvent,_setCursorFromEvent:function(i,r){if(!r)return this.setCursor(this.defaultCursor),!1;var c=r.hoverCursor||this.hoverCursor,p=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,d=(!p||!p.contains(r))&&r._findTargetCorner(this.getPointer(i,!0));d?this.setCursor(this.getCornerCursor(d,r,i)):(r.subTargetCheck&&this.targets.concat().reverse().map(function(f){c=f.hoverCursor||c}),this.setCursor(c))},getCornerCursor:function(i,r,c){var p=r.controls[i];return p.cursorStyleHandler(c,p,r)}})}(),ne=Math.min,$=Math.max,y.util.object.extend(y.Canvas.prototype,{_shouldGroup:function(a,s){var l=this._activeObject;return l&&this._isSelectionKeyPressed(a)&&s&&s.selectable&&this.selection&&(l!==s||l.type==="activeSelection")&&!s.onSelect({e:a})},_handleGrouping:function(a,s){var l=this._activeObject;l.__corner||(s!==l||(s=this.findTarget(a,!0))&&s.selectable)&&(l&&l.type==="activeSelection"?this._updateActiveSelection(s,a):this._createActiveSelection(s,a))},_updateActiveSelection:function(a,s){var l=this._activeObject,u=l._objects.slice(0);l.contains(a)?(l.removeWithUpdate(a),this._hoveredTarget=a,this._hoveredTargets=this.targets.concat(),l.size()===1&&this._setActiveObject(l.item(0),s)):(l.addWithUpdate(a),this._hoveredTarget=l,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(u,s)},_createActiveSelection:function(a,s){var l=this.getActiveObjects(),u=this._createGroup(a);this._hoveredTarget=u,this._setActiveObject(u,s),this._fireSelectionEvents(l,s)},_createGroup:function(a){var s=this._objects,l=s.indexOf(this._activeObject)<s.indexOf(a)?[this._activeObject,a]:[a,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new y.ActiveSelection(l,{canvas:this})},_groupSelectedObjects:function(a){var s,l=this._collectObjects(a);l.length===1?this.setActiveObject(l[0],a):l.length>1&&(s=new y.ActiveSelection(l.reverse(),{canvas:this}),this.setActiveObject(s,a))},_collectObjects:function(a){for(var s,l=[],u=this._groupSelector.ex,i=this._groupSelector.ey,r=u+this._groupSelector.left,c=i+this._groupSelector.top,p=new y.Point(ne(u,r),ne(i,c)),d=new y.Point($(u,r),$(i,c)),f=!this.selectionFullyContained,m=u===r&&i===c,S=this._objects.length;S--&&!((s=this._objects[S])&&s.selectable&&s.visible&&(f&&s.intersectsWithRect(p,d,!0)||s.isContainedWithinRect(p,d,!0)||f&&s.containsPoint(p,null,!0)||f&&s.containsPoint(d,null,!0))&&(l.push(s),m)););return l.length>1&&(l=l.filter(function(T){return!T.onSelect({e:a})})),l},_maybeGroupObjects:function(a){this.selection&&this._groupSelector&&this._groupSelectedObjects(a),this.setCursor(this.defaultCursor),this._groupSelector=null}}),y.util.object.extend(y.StaticCanvas.prototype,{toDataURL:function(a){a||(a={});var s=a.format||"png",l=a.quality||1,u=(a.multiplier||1)*(a.enableRetinaScaling?this.getRetinaScaling():1),i=this.toCanvasElement(u,a);return y.util.toDataURL(i,s,l)},toCanvasElement:function(a,s){a=a||1;var l=((s=s||{}).width||this.width)*a,u=(s.height||this.height)*a,i=this.getZoom(),r=this.width,c=this.height,p=i*a,d=this.viewportTransform,f=(d[4]-(s.left||0))*a,m=(d[5]-(s.top||0))*a,S=this.interactive,T=[p,0,0,p,f,m],x=this.enableRetinaScaling,E=y.util.createCanvasElement(),O=this.contextTop;return E.width=l,E.height=u,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=T,this.width=l,this.height=u,this.calcViewportBoundaries(),this.renderCanvas(E.getContext("2d"),this._objects),this.viewportTransform=d,this.width=r,this.height=c,this.calcViewportBoundaries(),this.interactive=S,this.enableRetinaScaling=x,this.contextTop=O,E}}),y.util.object.extend(y.StaticCanvas.prototype,{loadFromJSON:function(a,s,l){if(a){var u=typeof a=="string"?JSON.parse(a):y.util.object.clone(a),i=this,r=u.clipPath,c=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete u.clipPath,this._enlivenObjects(u.objects,function(p){i.clear(),i._setBgOverlay(u,function(){r?i._enlivenObjects([r],function(d){i.clipPath=d[0],i.__setupCanvas.call(i,u,p,c,s)}):i.__setupCanvas.call(i,u,p,c,s)})},l),this}},__setupCanvas:function(a,s,l,u){var i=this;s.forEach(function(r,c){i.insertAt(r,c)}),this.renderOnAddRemove=l,delete a.objects,delete a.backgroundImage,delete a.overlayImage,delete a.background,delete a.overlay,this._setOptions(a),this.renderAll(),u&&u()},_setBgOverlay:function(a,s){var l={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(a.backgroundImage||a.overlayImage||a.background||a.overlay){var u=function(){l.backgroundImage&&l.overlayImage&&l.backgroundColor&&l.overlayColor&&s&&s()};this.__setBgOverlay("backgroundImage",a.backgroundImage,l,u),this.__setBgOverlay("overlayImage",a.overlayImage,l,u),this.__setBgOverlay("backgroundColor",a.background,l,u),this.__setBgOverlay("overlayColor",a.overlay,l,u)}else s&&s()},__setBgOverlay:function(a,s,l,u){var i=this;if(!s)return l[a]=!0,void(u&&u());a==="backgroundImage"||a==="overlayImage"?y.util.enlivenObjects([s],function(r){i[a]=r[0],l[a]=!0,u&&u()}):this["set"+y.util.string.capitalize(a,!0)](s,function(){l[a]=!0,u&&u()})},_enlivenObjects:function(a,s,l){a&&a.length!==0?y.util.enlivenObjects(a,function(u){s&&s(u)},null,l):s&&s([])},_toDataURL:function(a,s){this.clone(function(l){s(l.toDataURL(a))})},_toDataURLWithMultiplier:function(a,s,l){this.clone(function(u){l(u.toDataURLWithMultiplier(a,s))})},clone:function(a,s){var l=JSON.stringify(this.toJSON(s));this.cloneWithoutData(function(u){u.loadFromJSON(l,function(){a&&a(u)})})},cloneWithoutData:function(a){var s=y.util.createCanvasElement();s.width=this.width,s.height=this.height;var l=new y.Canvas(s);this.backgroundImage?(l.setBackgroundImage(this.backgroundImage.src,function(){l.renderAll(),a&&a(l)}),l.backgroundImageOpacity=this.backgroundImageOpacity,l.backgroundImageStretch=this.backgroundImageStretch):a&&a(l)}}),function(a){var s=a.fabric||(a.fabric={}),l=s.util.object.extend,u=s.util.object.clone,i=s.util.toFixed,r=s.util.string.capitalize,c=s.util.degreesToRadians,p=!s.isLikelyNode;s.Object||(s.Object=s.util.createClass(s.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:p,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(d){d&&this.setOptions(d)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=s.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(d){var f=s.perfLimitSizeTotal,m=d.width,S=d.height,T=s.maxCacheSideLimit,x=s.minCacheSideLimit;if(m<=T&&S<=T&&m*S<=f)return m<x&&(d.width=x),S<x&&(d.height=x),d;var E=m/S,O=s.util.limitDimsByArea(E,f),P=s.util.capValue,j=P(x,O.x,T),W=P(x,O.y,T);return m>j&&(d.zoomX/=m/j,d.width=j,d.capped=!0),S>W&&(d.zoomY/=S/W,d.height=W,d.capped=!0),d},_getCacheCanvasDimensions:function(){var d=this.getTotalObjectScaling(),f=this._getTransformedDimensions(0,0),m=f.x*d.scaleX/this.scaleX,S=f.y*d.scaleY/this.scaleY;return{width:m+2,height:S+2,zoomX:d.scaleX,zoomY:d.scaleY,x:m,y:S}},_updateCacheCanvas:function(){var d=this.canvas;if(this.noScaleCache&&d&&d._currentTransform){var f=d._currentTransform.target,m=d._currentTransform.action;if(this===f&&m.slice&&m.slice(0,5)==="scale")return!1}var S,T,x=this._cacheCanvas,E=this._limitCacheSize(this._getCacheCanvasDimensions()),O=s.minCacheSideLimit,P=E.width,j=E.height,W=E.zoomX,z=E.zoomY,R=P!==this.cacheWidth||j!==this.cacheHeight,D=this.zoomX!==W||this.zoomY!==z,M=R||D,L=0,B=0,U=!1;if(R){var H=this._cacheCanvas.width,k=this._cacheCanvas.height,F=P>H||j>k;U=F||(P<.9*H||j<.9*k)&&H>O&&k>O,F&&!E.capped&&(P>O||j>O)&&(L=.1*P,B=.1*j)}return this instanceof s.Text&&this.path&&(M=!0,U=!0,L+=this.getHeightOfLine(0)*this.zoomX,B+=this.getHeightOfLine(0)*this.zoomY),!!M&&(U?(x.width=Math.ceil(P+L),x.height=Math.ceil(j+B)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,x.width,x.height)),S=E.x/2,T=E.y/2,this.cacheTranslationX=Math.round(x.width/2-S)+S,this.cacheTranslationY=Math.round(x.height/2-T)+T,this.cacheWidth=P,this.cacheHeight=j,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(W,z),this.zoomX=W,this.zoomY=z,!0)},setOptions:function(d){this._setOptions(d),this._initGradient(d.fill,"fill"),this._initGradient(d.stroke,"stroke"),this._initPattern(d.fill,"fill"),this._initPattern(d.stroke,"stroke")},transform:function(d){var f=this.group&&!this.group._transformDone||this.group&&this.canvas&&d===this.canvas.contextTop,m=this.calcTransformMatrix(!f);d.transform(m[0],m[1],m[2],m[3],m[4],m[5])},toObject:function(d){var f=s.Object.NUM_FRACTION_DIGITS,m={type:this.type,version:s.version,originX:this.originX,originY:this.originY,left:i(this.left,f),top:i(this.top,f),width:i(this.width,f),height:i(this.height,f),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:i(this.strokeWidth,f),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:i(this.strokeMiterLimit,f),scaleX:i(this.scaleX,f),scaleY:i(this.scaleY,f),angle:i(this.angle,f),flipX:this.flipX,flipY:this.flipY,opacity:i(this.opacity,f),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:i(this.skewX,f),skewY:i(this.skewY,f)};return this.clipPath&&!this.clipPath.excludeFromExport&&(m.clipPath=this.clipPath.toObject(d),m.clipPath.inverted=this.clipPath.inverted,m.clipPath.absolutePositioned=this.clipPath.absolutePositioned),s.util.populateWithProperties(this,m,d),this.includeDefaultValues||(m=this._removeDefaultValues(m)),m},toDatalessObject:function(d){return this.toObject(d)},_removeDefaultValues:function(d){var f=s.util.getKlass(d.type).prototype;return f.stateProperties.forEach(function(m){m!=="left"&&m!=="top"&&(d[m]===f[m]&&delete d[m],Array.isArray(d[m])&&Array.isArray(f[m])&&d[m].length===0&&f[m].length===0&&delete d[m])}),d},toString:function(){return"#<fabric."+r(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var d=s.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(d.scaleX),scaleY:Math.abs(d.scaleY)}},getTotalObjectScaling:function(){var d=this.getObjectScaling(),f=d.scaleX,m=d.scaleY;if(this.canvas){var S=this.canvas.getZoom(),T=this.canvas.getRetinaScaling();f*=S*T,m*=S*T}return{scaleX:f,scaleY:m}},getObjectOpacity:function(){var d=this.opacity;return this.group&&(d*=this.group.getObjectOpacity()),d},_set:function(d,f){var m=d==="scaleX"||d==="scaleY",S=this[d]!==f,T=!1;return m&&(f=this._constrainScale(f)),d==="scaleX"&&f<0?(this.flipX=!this.flipX,f*=-1):d==="scaleY"&&f<0?(this.flipY=!this.flipY,f*=-1):d!=="shadow"||!f||f instanceof s.Shadow?d==="dirty"&&this.group&&this.group.set("dirty",f):f=new s.Shadow(f),this[d]=f,S&&(T=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(d)>-1?(this.dirty=!0,T&&this.group.set("dirty",!0)):T&&this.stateProperties.indexOf(d)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:s.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(d){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(d.save(),this._setupCompositeOperation(d),this.drawSelectionBackground(d),this.transform(d),this._setOpacity(d),this._setShadow(d,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(d)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(d),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),d.restore())},renderCache:function(d){d=d||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,d.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!(this.paintFirst!=="stroke"||!this.hasFill()||!this.hasStroke()||typeof this.shadow!="object")||!!this.clipPath},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(d,f){if(d.save(),f.inverted?d.globalCompositeOperation="destination-out":d.globalCompositeOperation="destination-in",f.absolutePositioned){var m=s.util.invertTransform(this.calcTransformMatrix());d.transform(m[0],m[1],m[2],m[3],m[4],m[5])}f.transform(d),d.scale(1/f.zoomX,1/f.zoomY),d.drawImage(f._cacheCanvas,-f.cacheTranslationX,-f.cacheTranslationY),d.restore()},drawObject:function(d,f){var m=this.fill,S=this.stroke;f?(this.fill="black",this.stroke="",this._setClippingProperties(d)):this._renderBackground(d),this._render(d),this._drawClipPath(d,this.clipPath),this.fill=m,this.stroke=S},_drawClipPath:function(d,f){f&&(f.canvas=this.canvas,f.shouldCache(),f._transformDone=!0,f.renderCache({forClipping:!0}),this.drawClipPathOnCache(d,f))},drawCacheOnCanvas:function(d){d.scale(1/this.zoomX,1/this.zoomY),d.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(d){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!d&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!d){var f=this.cacheWidth/this.zoomX,m=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-f/2,-m/2,f,m)}return!0}return!1},_renderBackground:function(d){if(this.backgroundColor){var f=this._getNonTransformedDimensions();d.fillStyle=this.backgroundColor,d.fillRect(-f.x/2,-f.y/2,f.x,f.y),this._removeShadow(d)}},_setOpacity:function(d){this.group&&!this.group._transformDone?d.globalAlpha=this.getObjectOpacity():d.globalAlpha*=this.opacity},_setStrokeStyles:function(d,f){var m=f.stroke;m&&(d.lineWidth=f.strokeWidth,d.lineCap=f.strokeLineCap,d.lineDashOffset=f.strokeDashOffset,d.lineJoin=f.strokeLineJoin,d.miterLimit=f.strokeMiterLimit,m.toLive?m.gradientUnits==="percentage"||m.gradientTransform||m.patternTransform?this._applyPatternForTransformedGradient(d,m):(d.strokeStyle=m.toLive(d,this),this._applyPatternGradientTransform(d,m)):d.strokeStyle=f.stroke)},_setFillStyles:function(d,f){var m=f.fill;m&&(m.toLive?(d.fillStyle=m.toLive(d,this),this._applyPatternGradientTransform(d,f.fill)):d.fillStyle=m)},_setClippingProperties:function(d){d.globalAlpha=1,d.strokeStyle="transparent",d.fillStyle="#000000"},_setLineDash:function(d,f){f&&f.length!==0&&(1&f.length&&f.push.apply(f,f),d.setLineDash(f))},_renderControls:function(d,f){var m,S,T,x=this.getViewportTransform(),E=this.calcTransformMatrix();S=(f=f||{}).hasBorders!==void 0?f.hasBorders:this.hasBorders,T=f.hasControls!==void 0?f.hasControls:this.hasControls,E=s.util.multiplyTransformMatrices(x,E),m=s.util.qrDecompose(E),d.save(),d.translate(m.translateX,m.translateY),d.lineWidth=1*this.borderScaleFactor,this.group||(d.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(m.angle-=180),d.rotate(c(this.group?m.angle:this.angle)),f.forActiveSelection||this.group?S&&this.drawBordersInGroup(d,m,f):S&&this.drawBorders(d,f),T&&this.drawControls(d,f),d.restore()},_setShadow:function(d){if(this.shadow){var f,m=this.shadow,S=this.canvas,T=S&&S.viewportTransform[0]||1,x=S&&S.viewportTransform[3]||1;f=m.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),S&&S._isRetinaScaling()&&(T*=s.devicePixelRatio,x*=s.devicePixelRatio),d.shadowColor=m.color,d.shadowBlur=m.blur*s.browserShadowBlurConstant*(T+x)*(f.scaleX+f.scaleY)/4,d.shadowOffsetX=m.offsetX*T*f.scaleX,d.shadowOffsetY=m.offsetY*x*f.scaleY}},_removeShadow:function(d){this.shadow&&(d.shadowColor="",d.shadowBlur=d.shadowOffsetX=d.shadowOffsetY=0)},_applyPatternGradientTransform:function(d,f){if(!f||!f.toLive)return{offsetX:0,offsetY:0};var m=f.gradientTransform||f.patternTransform,S=-this.width/2+f.offsetX||0,T=-this.height/2+f.offsetY||0;return f.gradientUnits==="percentage"?d.transform(this.width,0,0,this.height,S,T):d.transform(1,0,0,1,S,T),m&&d.transform(m[0],m[1],m[2],m[3],m[4],m[5]),{offsetX:S,offsetY:T}},_renderPaintInOrder:function(d){this.paintFirst==="stroke"?(this._renderStroke(d),this._renderFill(d)):(this._renderFill(d),this._renderStroke(d))},_render:function(){},_renderFill:function(d){this.fill&&(d.save(),this._setFillStyles(d,this),this.fillRule==="evenodd"?d.fill("evenodd"):d.fill(),d.restore())},_renderStroke:function(d){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(d),d.save(),this.strokeUniform&&this.group){var f=this.getObjectScaling();d.scale(1/f.scaleX,1/f.scaleY)}else this.strokeUniform&&d.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(d,this.strokeDashArray),this._setStrokeStyles(d,this),d.stroke(),d.restore()}},_applyPatternForTransformedGradient:function(d,f){var m,S=this._limitCacheSize(this._getCacheCanvasDimensions()),T=s.util.createCanvasElement(),x=this.canvas.getRetinaScaling(),E=S.x/this.scaleX/x,O=S.y/this.scaleY/x;T.width=E,T.height=O,(m=T.getContext("2d")).beginPath(),m.moveTo(0,0),m.lineTo(E,0),m.lineTo(E,O),m.lineTo(0,O),m.closePath(),m.translate(E/2,O/2),m.scale(S.zoomX/this.scaleX/x,S.zoomY/this.scaleY/x),this._applyPatternGradientTransform(m,f),m.fillStyle=f.toLive(d),m.fill(),d.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),d.scale(x*this.scaleX/S.zoomX,x*this.scaleY/S.zoomY),d.strokeStyle=m.createPattern(T,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var d=s.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",d.scaleX),this.set("scaleY",d.scaleY),this.angle=d.angle,this.skewX=d.skewX,this.skewY=0}},_removeTransformMatrix:function(d){var f=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),f=s.util.transformPoint(f,this.transformMatrix)),this.transformMatrix=null,d&&(this.scaleX*=d.scaleX,this.scaleY*=d.scaleY,this.cropX=d.cropX,this.cropY=d.cropY,f.x+=d.offsetLeft,f.y+=d.offsetTop,this.width=d.width,this.height=d.height),this.setPositionByOrigin(f,"center","center")},clone:function(d,f){var m=this.toObject(f);this.constructor.fromObject?this.constructor.fromObject(m,d):s.Object._fromObject("Object",m,d)},cloneAsImage:function(d,f){var m=this.toCanvasElement(f);return d&&d(new s.Image(m)),this},toCanvasElement:function(d){d||(d={});var f=s.util,m=f.saveObjectTransform(this),S=this.group,T=this.shadow,x=Math.abs,E=(d.multiplier||1)*(d.enableRetinaScaling?s.devicePixelRatio:1);delete this.group,d.withoutTransform&&f.resetObjectTransform(this),d.withoutShadow&&(this.shadow=null);var O,P,j,W,z=s.util.createCanvasElement(),R=this.getBoundingRect(!0,!0),D=this.shadow,M={x:0,y:0};D&&(P=D.blur,O=D.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),M.x=2*Math.round(x(D.offsetX)+P)*x(O.scaleX),M.y=2*Math.round(x(D.offsetY)+P)*x(O.scaleY)),j=R.width+M.x,W=R.height+M.y,z.width=Math.ceil(j),z.height=Math.ceil(W);var L=new s.StaticCanvas(z,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});d.format==="jpeg"&&(L.backgroundColor="#fff"),this.setPositionByOrigin(new s.Point(L.width/2,L.height/2),"center","center");var B=this.canvas;L.add(this);var U=L.toCanvasElement(E||1,d);return this.shadow=T,this.set("canvas",B),S&&(this.group=S),this.set(m).setCoords(),L._objects=[],L.dispose(),L=null,U},toDataURL:function(d){return d||(d={}),s.util.toDataURL(this.toCanvasElement(d),d.format||"png",d.quality||1)},isType:function(d){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===d},complexity:function(){return 1},toJSON:function(d){return this.toObject(d)},rotate:function(d){var f=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return f&&this._setOriginToCenter(),this.set("angle",d),f&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(d,f){f=f||this.canvas.getPointer(d);var m=new s.Point(f.x,f.y),S=this._getLeftTopCoords();return this.angle&&(m=s.util.rotatePoint(m,S,c(-this.angle))),{x:m.x-S.x,y:m.y-S.y}},_setupCompositeOperation:function(d){this.globalCompositeOperation&&(d.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){s.runningAnimations&&s.runningAnimations.cancelByTarget(this)}}),s.util.createAccessors&&s.util.createAccessors(s.Object),l(s.Object.prototype,s.Observable),s.Object.NUM_FRACTION_DIGITS=2,s.Object.ENLIVEN_PROPS=["clipPath"],s.Object._fromObject=function(d,f,m,S){var T=s[d];f=u(f,!0),s.util.enlivenPatterns([f.fill,f.stroke],function(x){x[0]!==void 0&&(f.fill=x[0]),x[1]!==void 0&&(f.stroke=x[1]),s.util.enlivenObjectEnlivables(f,f,function(){var E=S?new T(f[S],f):new T(f);m&&m(E)})})},s.Object.__uid=0)}(t),re=y.util.degreesToRadians,le={left:-.5,center:0,right:.5},pe={top:-.5,center:0,bottom:.5},y.util.object.extend(y.Object.prototype,{translateToGivenOrigin:function(a,s,l,u,i){var r,c,p,d=a.x,f=a.y;return typeof s=="string"?s=le[s]:s-=.5,typeof u=="string"?u=le[u]:u-=.5,typeof l=="string"?l=pe[l]:l-=.5,typeof i=="string"?i=pe[i]:i-=.5,c=i-l,((r=u-s)||c)&&(p=this._getTransformedDimensions(),d=a.x+r*p.x,f=a.y+c*p.y),new y.Point(d,f)},translateToCenterPoint:function(a,s,l){var u=this.translateToGivenOrigin(a,s,l,"center","center");return this.angle?y.util.rotatePoint(u,a,re(this.angle)):u},translateToOriginPoint:function(a,s,l){var u=this.translateToGivenOrigin(a,"center","center",s,l);return this.angle?y.util.rotatePoint(u,a,re(this.angle)):u},getCenterPoint:function(){var a=new y.Point(this.left,this.top);return this.translateToCenterPoint(a,this.originX,this.originY)},getPointByOrigin:function(a,s){var l=this.getCenterPoint();return this.translateToOriginPoint(l,a,s)},toLocalPoint:function(a,s,l){var u,i,r=this.getCenterPoint();return u=s!==void 0&&l!==void 0?this.translateToGivenOrigin(r,"center","center",s,l):new y.Point(this.left,this.top),i=new y.Point(a.x,a.y),this.angle&&(i=y.util.rotatePoint(i,r,-re(this.angle))),i.subtractEquals(u)},setPositionByOrigin:function(a,s,l){var u=this.translateToCenterPoint(a,s,l),i=this.translateToOriginPoint(u,this.originX,this.originY);this.set("left",i.x),this.set("top",i.y)},adjustPosition:function(a){var s,l,u=re(this.angle),i=this.getScaledWidth(),r=y.util.cos(u)*i,c=y.util.sin(u)*i;s=typeof this.originX=="string"?le[this.originX]:this.originX-.5,l=typeof a=="string"?le[a]:a-.5,this.left+=r*(l-s),this.top+=c*(l-s),this.setCoords(),this.originX=a},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var a=this.getCenterPoint();this.originX="center",this.originY="center",this.left=a.x,this.top=a.y},_resetOrigin:function(){var a=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=a.x,this.top=a.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}}),function(){var a=y.util,s=a.degreesToRadians,l=a.multiplyTransformMatrices,u=a.transformPoint;a.object.extend(y.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(i,r){return r?i?this.calcACoords():this.calcLineCoords():(this.aCoords&&this.lineCoords||this.setCoords(!0),i?this.aCoords:this.lineCoords)},getCoords:function(i,r){return c=this._getCoords(i,r),[new y.Point(c.tl.x,c.tl.y),new y.Point(c.tr.x,c.tr.y),new y.Point(c.br.x,c.br.y),new y.Point(c.bl.x,c.bl.y)];var c},intersectsWithRect:function(i,r,c,p){var d=this.getCoords(c,p);return y.Intersection.intersectPolygonRectangle(d,i,r).status==="Intersection"},intersectsWithObject:function(i,r,c){return y.Intersection.intersectPolygonPolygon(this.getCoords(r,c),i.getCoords(r,c)).status==="Intersection"||i.isContainedWithinObject(this,r,c)||this.isContainedWithinObject(i,r,c)},isContainedWithinObject:function(i,r,c){for(var p=this.getCoords(r,c),d=r?i.aCoords:i.lineCoords,f=0,m=i._getImageLines(d);f<4;f++)if(!i.containsPoint(p[f],m))return!1;return!0},isContainedWithinRect:function(i,r,c,p){var d=this.getBoundingRect(c,p);return d.left>=i.x&&d.left+d.width<=r.x&&d.top>=i.y&&d.top+d.height<=r.y},containsPoint:function(i,r,c,p){var d=this._getCoords(c,p),f=(r=r||this._getImageLines(d),this._findCrossPoints(i,r));return f!==0&&f%2==1},isOnScreen:function(i){if(!this.canvas)return!1;var r=this.canvas.vptCoords.tl,c=this.canvas.vptCoords.br;return!!this.getCoords(!0,i).some(function(p){return p.x<=c.x&&p.x>=r.x&&p.y<=c.y&&p.y>=r.y})||!!this.intersectsWithRect(r,c,!0,i)||this._containsCenterOfCanvas(r,c,i)},_containsCenterOfCanvas:function(i,r,c){var p={x:(i.x+r.x)/2,y:(i.y+r.y)/2};return!!this.containsPoint(p,null,!0,c)},isPartiallyOnScreen:function(i){if(!this.canvas)return!1;var r=this.canvas.vptCoords.tl,c=this.canvas.vptCoords.br;return!!this.intersectsWithRect(r,c,!0,i)||this.getCoords(!0,i).every(function(p){return(p.x>=c.x||p.x<=r.x)&&(p.y>=c.y||p.y<=r.y)})&&this._containsCenterOfCanvas(r,c,i)},_getImageLines:function(i){return{topline:{o:i.tl,d:i.tr},rightline:{o:i.tr,d:i.br},bottomline:{o:i.br,d:i.bl},leftline:{o:i.bl,d:i.tl}}},_findCrossPoints:function(i,r){var c,p,d,f=0;for(var m in r)if(!((d=r[m]).o.y<i.y&&d.d.y<i.y||d.o.y>=i.y&&d.d.y>=i.y||(d.o.x===d.d.x&&d.o.x>=i.x?p=d.o.x:(c=(d.d.y-d.o.y)/(d.d.x-d.o.x),p=-(i.y-0*i.x-(d.o.y-c*d.o.x))/(0-c)),p>=i.x&&(f+=1),f!==2)))break;return f},getBoundingRect:function(i,r){var c=this.getCoords(i,r);return a.makeBoundingBoxFromPoints(c)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(i){return Math.abs(i)<this.minScaleLimit?i<0?-this.minScaleLimit:this.minScaleLimit:i===0?1e-4:i},scale:function(i){return this._set("scaleX",i),this._set("scaleY",i),this.setCoords()},scaleToWidth:function(i,r){var c=this.getBoundingRect(r).width/this.getScaledWidth();return this.scale(i/this.width/c)},scaleToHeight:function(i,r){var c=this.getBoundingRect(r).height/this.getScaledHeight();return this.scale(i/this.height/c)},calcLineCoords:function(){var i=this.getViewportTransform(),r=this.padding,c=s(this.angle),p=a.cos(c)*r,d=a.sin(c)*r,f=p+d,m=p-d,S=this.calcACoords(),T={tl:u(S.tl,i),tr:u(S.tr,i),bl:u(S.bl,i),br:u(S.br,i)};return r&&(T.tl.x-=m,T.tl.y-=f,T.tr.x+=f,T.tr.y-=m,T.bl.x-=f,T.bl.y+=m,T.br.x+=m,T.br.y+=f),T},calcOCoords:function(){var i=this._calcRotateMatrix(),r=this._calcTranslateMatrix(),c=this.getViewportTransform(),p=l(c,r),d=l(p,i),f=(d=l(d,[1/c[0],0,0,1/c[3],0,0]),this._calculateCurrentDimensions()),m={};return this.forEachControl(function(S,T,x){m[T]=S.positionHandler(f,d,x)}),m},calcACoords:function(){var i=this._calcRotateMatrix(),r=this._calcTranslateMatrix(),c=l(r,i),p=this._getTransformedDimensions(),d=p.x/2,f=p.y/2;return{tl:u({x:-d,y:-f},c),tr:u({x:d,y:-f},c),bl:u({x:-d,y:f},c),br:u({x:d,y:f},c)}},setCoords:function(i){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),i||(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords()),this},_calcRotateMatrix:function(){return a.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var i=this.getCenterPoint();return[1,0,0,1,i.x,i.y]},transformMatrixKey:function(i){var r="_",c="";return!i&&this.group&&(c=this.group.transformMatrixKey(i)+r),c+this.top+r+this.left+r+this.scaleX+r+this.scaleY+r+this.skewX+r+this.skewY+r+this.angle+r+this.originX+r+this.originY+r+this.width+r+this.height+r+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(i){var r=this.calcOwnMatrix();if(i||!this.group)return r;var c=this.transformMatrixKey(i),p=this.matrixCache||(this.matrixCache={});return p.key===c?p.value:(this.group&&(r=l(this.group.calcTransformMatrix(!1),r)),p.key=c,p.value=r,r)},calcOwnMatrix:function(){var i=this.transformMatrixKey(!0),r=this.ownMatrixCache||(this.ownMatrixCache={});if(r.key===i)return r.value;var c=this._calcTranslateMatrix(),p={angle:this.angle,translateX:c[4],translateY:c[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return r.key=i,r.value=a.composeMatrix(p),r.value},_getNonTransformedDimensions:function(){var i=this.strokeWidth;return{x:this.width+i,y:this.height+i}},_getTransformedDimensions:function(i,r){i===void 0&&(i=this.skewX),r===void 0&&(r=this.skewY);var c,p,d,f=i===0&&r===0;if(this.strokeUniform?(p=this.width,d=this.height):(p=(c=this._getNonTransformedDimensions()).x,d=c.y),f)return this._finalizeDimensions(p*this.scaleX,d*this.scaleY);var m=a.sizeAfterTransform(p,d,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:i,skewY:r});return this._finalizeDimensions(m.x,m.y)},_finalizeDimensions:function(i,r){return this.strokeUniform?{x:i+this.strokeWidth,y:r+this.strokeWidth}:{x:i,y:r}},_calculateCurrentDimensions:function(){var i=this.getViewportTransform(),r=this._getTransformedDimensions();return u(r,i,!0).scalarAdd(2*this.padding)}})}(),y.util.object.extend(y.Object.prototype,{sendToBack:function(){return this.group?y.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?y.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(a){return this.group?y.StaticCanvas.prototype.sendBackwards.call(this.group,this,a):this.canvas&&this.canvas.sendBackwards(this,a),this},bringForward:function(a){return this.group?y.StaticCanvas.prototype.bringForward.call(this.group,this,a):this.canvas&&this.canvas.bringForward(this,a),this},moveTo:function(a){return this.group&&this.group.type!=="activeSelection"?y.StaticCanvas.prototype.moveTo.call(this.group,this,a):this.canvas&&this.canvas.moveTo(this,a),this}}),function(){function a(l,u){if(u){if(u.toLive)return l+": url(#SVGID_"+u.id+"); ";var i=new y.Color(u),r=l+": "+i.toRgb()+"; ",c=i.getAlpha();return c!==1&&(r+=l+"-opacity: "+c.toString()+"; "),r}return l+": none; "}var s=y.util.toFixed;y.util.object.extend(y.Object.prototype,{getSvgStyles:function(l){var u=this.fillRule?this.fillRule:"nonzero",i=this.strokeWidth?this.strokeWidth:"0",r=this.strokeDashArray?this.strokeDashArray.join(" "):"none",c=this.strokeDashOffset?this.strokeDashOffset:"0",p=this.strokeLineCap?this.strokeLineCap:"butt",d=this.strokeLineJoin?this.strokeLineJoin:"miter",f=this.strokeMiterLimit?this.strokeMiterLimit:"4",m=this.opacity!==void 0?this.opacity:"1",S=this.visible?"":" visibility: hidden;",T=l?"":this.getSvgFilter(),x=a("fill",this.fill);return[a("stroke",this.stroke),"stroke-width: ",i,"; ","stroke-dasharray: ",r,"; ","stroke-linecap: ",p,"; ","stroke-dashoffset: ",c,"; ","stroke-linejoin: ",d,"; ","stroke-miterlimit: ",f,"; ",x,"fill-rule: ",u,"; ","opacity: ",m,";",T,S].join("")},getSvgSpanStyles:function(l,u){var i="; ",r=l.fontFamily?"font-family: "+(l.fontFamily.indexOf("'")===-1&&l.fontFamily.indexOf('"')===-1?"'"+l.fontFamily+"'":l.fontFamily)+i:"",c=l.strokeWidth?"stroke-width: "+l.strokeWidth+i:"",p=l.fontSize?"font-size: "+l.fontSize+"px"+i:"",d=l.fontStyle?"font-style: "+l.fontStyle+i:"",f=l.fontWeight?"font-weight: "+l.fontWeight+i:"",m=l.fill?a("fill",l.fill):"",S=l.stroke?a("stroke",l.stroke):"",T=this.getSvgTextDecoration(l);return T&&(T="text-decoration: "+T+i),[S,c,r,p,d,f,T,m,l.deltaY?"baseline-shift: "+-l.deltaY+"; ":"",u?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(l){return["overline","underline","line-through"].filter(function(u){return l[u.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(l,u){var i=l?this.calcTransformMatrix():this.calcOwnMatrix();return'transform="'+y.util.matrixToSVG(i)+(u||"")+'" '},_setSVGBg:function(l){if(this.backgroundColor){var u=y.Object.NUM_FRACTION_DIGITS;l.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',s(-this.width/2,u),'" y="',s(-this.height/2,u),'" width="',s(this.width,u),'" height="',s(this.height,u),`"></rect>
`)}},toSVG:function(l){return this._createBaseSVGMarkup(this._toSVG(l),{reviver:l})},toClipPathSVG:function(l){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(l),{reviver:l})},_createBaseClipPathSVGMarkup:function(l,u){var i=(u=u||{}).reviver,r=u.additionalTransform||"",c=[this.getSvgTransform(!0,r),this.getSvgCommons()].join(""),p=l.indexOf("COMMON_PARTS");return l[p]=c,i?i(l.join("")):l.join("")},_createBaseSVGMarkup:function(l,u){var i,r,c=(u=u||{}).noStyle,p=u.reviver,d=c?"":'style="'+this.getSvgStyles()+'" ',f=u.withShadow?'style="'+this.getSvgFilter()+'" ':"",m=this.clipPath,S=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",T=m&&m.absolutePositioned,x=this.stroke,E=this.fill,O=this.shadow,P=[],j=l.indexOf("COMMON_PARTS"),W=u.additionalTransform;return m&&(m.clipPathId="CLIPPATH_"+y.Object.__uid++,r='<clipPath id="'+m.clipPathId+`" >
`+m.toClipPathSVG(p)+`</clipPath>
`),T&&P.push("<g ",f,this.getSvgCommons(),` >
`),P.push("<g ",this.getSvgTransform(!1),T?"":f+this.getSvgCommons(),` >
`),i=[d,S,c?"":this.addPaintOrder()," ",W?'transform="'+W+'" ':""].join(""),l[j]=i,E&&E.toLive&&P.push(E.toSVG(this)),x&&x.toLive&&P.push(x.toSVG(this)),O&&P.push(O.toSVG(this)),m&&P.push(r),P.push(l.join("")),P.push(`</g>
`),T&&P.push(`</g>
`),p?p(P.join("")):P.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var a=y.util.object.extend,s="stateProperties";function l(i,r,c){var p={};c.forEach(function(d){p[d]=i[d]}),a(i[r],p,!0)}function u(i,r,c){if(i===r)return!0;if(Array.isArray(i)){if(!Array.isArray(r)||i.length!==r.length)return!1;for(var p=0,d=i.length;p<d;p++)if(!u(i[p],r[p]))return!1;return!0}if(i&&typeof i=="object"){var f,m=Object.keys(i);if(!r||typeof r!="object"||!c&&m.length!==Object.keys(r).length)return!1;for(p=0,d=m.length;p<d;p++)if((f=m[p])!=="canvas"&&f!=="group"&&!u(i[f],r[f]))return!1;return!0}}y.util.object.extend(y.Object.prototype,{hasStateChanged:function(i){var r="_"+(i=i||s);return Object.keys(this[r]).length<this[i].length||!u(this[r],this,!0)},saveState:function(i){var r=i&&i.propertySet||s,c="_"+r;return this[c]?(l(this,c,this[r]),i&&i.stateProperties&&l(this,c,i.stateProperties),this):this.setupState(i)},setupState:function(i){var r=(i=i||{}).propertySet||s;return i.propertySet=r,this["_"+r]={},this.saveState(i),this}})}(),function(){var a=y.util.degreesToRadians;y.util.object.extend(y.Object.prototype,{_findTargetCorner:function(s,l){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var u,i,r,c=s.x,p=s.y,d=Object.keys(this.oCoords),f=d.length-1;for(this.__corner=0;f>=0;f--)if(r=d[f],this.isControlVisible(r)&&(i=this._getImageLines(l?this.oCoords[r].touchCorner:this.oCoords[r].corner),(u=this._findCrossPoints({x:c,y:p},i))!==0&&u%2==1))return this.__corner=r,r;return!1},forEachControl:function(s){for(var l in this.controls)s(this.controls[l],l,this)},_setCornerCoords:function(){var s=this.oCoords;for(var l in s){var u=this.controls[l];s[l].corner=u.calcCornerCoords(this.angle,this.cornerSize,s[l].x,s[l].y,!1),s[l].touchCorner=u.calcCornerCoords(this.angle,this.touchCornerSize,s[l].x,s[l].y,!0)}},drawSelectionBackground:function(s){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;s.save();var l=this.getCenterPoint(),u=this._calculateCurrentDimensions(),i=this.canvas.viewportTransform;return s.translate(l.x,l.y),s.scale(1/i[0],1/i[3]),s.rotate(a(this.angle)),s.fillStyle=this.selectionBackgroundColor,s.fillRect(-u.x/2,-u.y/2,u.x,u.y),s.restore(),this},drawBorders:function(s,l){l=l||{};var u=this._calculateCurrentDimensions(),i=this.borderScaleFactor,r=u.x+i,c=u.y+i,p=l.hasControls!==void 0?l.hasControls:this.hasControls,d=!1;return s.save(),s.strokeStyle=l.borderColor||this.borderColor,this._setLineDash(s,l.borderDashArray||this.borderDashArray),s.strokeRect(-r/2,-c/2,r,c),p&&(s.beginPath(),this.forEachControl(function(f,m,S){f.withConnection&&f.getVisibility(S,m)&&(d=!0,s.moveTo(f.x*r,f.y*c),s.lineTo(f.x*r+f.offsetX,f.y*c+f.offsetY))}),d&&s.stroke()),s.restore(),this},drawBordersInGroup:function(s,l,u){u=u||{};var i=y.util.sizeAfterTransform(this.width,this.height,l),r=this.strokeWidth,c=this.strokeUniform,p=this.borderScaleFactor,d=i.x+r*(c?this.canvas.getZoom():l.scaleX)+p,f=i.y+r*(c?this.canvas.getZoom():l.scaleY)+p;return s.save(),this._setLineDash(s,u.borderDashArray||this.borderDashArray),s.strokeStyle=u.borderColor||this.borderColor,s.strokeRect(-d/2,-f/2,d,f),s.restore(),this},drawControls:function(s,l){l=l||{},s.save();var u,i,r=this.canvas.getRetinaScaling();return s.setTransform(r,0,0,r,0,0),s.strokeStyle=s.fillStyle=l.cornerColor||this.cornerColor,this.transparentCorners||(s.strokeStyle=l.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(s,l.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(u=this.group.calcTransformMatrix()),this.forEachControl(function(c,p,d){i=d.oCoords[p],c.getVisibility(d,p)&&(u&&(i=y.util.transformPoint(i,u)),c.render(s,i.x,i.y,l,d))}),s.restore(),this},isControlVisible:function(s){return this.controls[s]&&this.controls[s].getVisibility(this,s)},setControlVisible:function(s,l){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[s]=l,this},setControlsVisibility:function(s){for(var l in s||(s={}),s)this.setControlVisible(l,s[l]);return this},onDeselect:function(){},onSelect:function(){}})}(),y.util.object.extend(y.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(a,s){var l=function(){},u=(s=s||{}).onComplete||l,i=s.onChange||l,r=this;return y.util.animate({target:this,startValue:a.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(c){a.set("left",c),r.requestRenderAll(),i()},onComplete:function(){a.setCoords(),u()}})},fxCenterObjectV:function(a,s){var l=function(){},u=(s=s||{}).onComplete||l,i=s.onChange||l,r=this;return y.util.animate({target:this,startValue:a.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(c){a.set("top",c),r.requestRenderAll(),i()},onComplete:function(){a.setCoords(),u()}})},fxRemove:function(a,s){var l=function(){},u=(s=s||{}).onComplete||l,i=s.onChange||l,r=this;return y.util.animate({target:this,startValue:a.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(c){a.set("opacity",c),r.requestRenderAll(),i()},onComplete:function(){r.remove(a),u()}})}}),y.util.object.extend(y.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var a,s,l=[],u=[];for(a in arguments[0])l.push(a);for(var i=0,r=l.length;i<r;i++)a=l[i],s=i!==r-1,u.push(this._animate(a,arguments[0][a],arguments[1],s));return u}return this._animate.apply(this,arguments)},_animate:function(a,s,l,u){var i,r=this;s=s.toString(),l=l?y.util.object.clone(l):{},~a.indexOf(".")&&(i=a.split("."));var c=r.colorProperties.indexOf(a)>-1||i&&r.colorProperties.indexOf(i[1])>-1,p=i?this.get(i[0])[i[1]]:this.get(a);"from"in l||(l.from=p),c||(s=~s.indexOf("=")?p+parseFloat(s.replace("=","")):parseFloat(s));var d={target:this,startValue:l.from,endValue:s,byValue:l.by,easing:l.easing,duration:l.duration,abort:l.abort&&function(f,m,S){return l.abort.call(r,f,m,S)},onChange:function(f,m,S){i?r[i[0]][i[1]]=f:r.set(a,f),u||l.onChange&&l.onChange(f,m,S)},onComplete:function(f,m,S){u||(r.setCoords(),l.onComplete&&l.onComplete(f,m,S))}};return c?y.util.animateColor(d.startValue,d.endValue,d.duration,d):y.util.animate(d)}}),function(a){var s=a.fabric||(a.fabric={}),l=s.util.object.extend,u=s.util.object.clone,i={x1:1,x2:1,y1:1,y2:1};function r(c,p){var d=c.origin,f=c.axis1,m=c.axis2,S=c.dimension,T=p.nearest,x=p.center,E=p.farthest;return function(){switch(this.get(d)){case T:return Math.min(this.get(f),this.get(m));case x:return Math.min(this.get(f),this.get(m))+.5*this.get(S);case E:return Math.max(this.get(f),this.get(m))}}}s.Line?s.warn("fabric.Line is already defined"):(s.Line=s.util.createClass(s.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:s.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(c,p){c||(c=[0,0,0,0]),this.callSuper("initialize",p),this.set("x1",c[0]),this.set("y1",c[1]),this.set("x2",c[2]),this.set("y2",c[3]),this._setWidthHeight(p)},_setWidthHeight:function(c){c||(c={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in c?c.left:this._getLeftToOriginX(),this.top="top"in c?c.top:this._getTopToOriginY()},_set:function(c,p){return this.callSuper("_set",c,p),i[c]!==void 0&&this._setWidthHeight(),this},_getLeftToOriginX:r({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:r({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(c){c.beginPath();var p=this.calcLinePoints();c.moveTo(p.x1,p.y1),c.lineTo(p.x2,p.y2),c.lineWidth=this.strokeWidth;var d=c.strokeStyle;c.strokeStyle=this.stroke||c.fillStyle,this.stroke&&this._renderStroke(c),c.strokeStyle=d},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(c){return l(this.callSuper("toObject",c),this.calcLinePoints())},_getNonTransformedDimensions:function(){var c=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(c.y-=this.strokeWidth),this.height===0&&(c.x-=this.strokeWidth)),c},calcLinePoints:function(){var c=this.x1<=this.x2?-1:1,p=this.y1<=this.y2?-1:1,d=c*this.width*.5,f=p*this.height*.5;return{x1:d,x2:c*this.width*-.5,y1:f,y2:p*this.height*-.5}},_toSVG:function(){var c=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',c.x1,'" y1="',c.y1,'" x2="',c.x2,'" y2="',c.y2,`" />
`]}}),s.Line.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),s.Line.fromElement=function(c,p,d){d=d||{};var f=s.parseAttributes(c,s.Line.ATTRIBUTE_NAMES),m=[f.x1||0,f.y1||0,f.x2||0,f.y2||0];p(new s.Line(m,l(f,d)))},s.Line.fromObject=function(c,p){var d=u(c,!0);d.points=[c.x1,c.y1,c.x2,c.y2],s.Object._fromObject("Line",d,function(f){delete f.points,p&&p(f)},"points")})}(t),function(a){var s=a.fabric||(a.fabric={}),l=s.util.degreesToRadians;s.Circle?s.warn("fabric.Circle is already defined."):(s.Circle=s.util.createClass(s.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:s.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(u,i){return this.callSuper("_set",u,i),u==="radius"&&this.setRadius(i),this},toObject:function(u){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(u))},_toSVG:function(){var u,i=(this.endAngle-this.startAngle)%360;if(i===0)u=["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',this.radius,`" />
`];else{var r=l(this.startAngle),c=l(this.endAngle),p=this.radius;u=['<path d="M '+s.util.cos(r)*p+" "+s.util.sin(r)*p," A "+p+" "+p," 0 ",+(i>180?"1":"0")+" 1"," "+s.util.cos(c)*p+" "+s.util.sin(c)*p,'" ',"COMMON_PARTS",` />
`]}return u},_render:function(u){u.beginPath(),u.arc(0,0,this.radius,l(this.startAngle),l(this.endAngle),!1),this._renderPaintInOrder(u)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(u){return this.radius=u,this.set("width",2*u).set("height",2*u)}}),s.Circle.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),s.Circle.fromElement=function(u,i){var r,c=s.parseAttributes(u,s.Circle.ATTRIBUTE_NAMES);if(!("radius"in(r=c)&&r.radius>=0))throw new Error("value of `r` attribute is required and can not be negative");c.left=(c.left||0)-c.radius,c.top=(c.top||0)-c.radius,i(new s.Circle(c))},s.Circle.fromObject=function(u,i){s.Object._fromObject("Circle",u,i)})}(t),function(a){var s=a.fabric||(a.fabric={});s.Triangle?s.warn("fabric.Triangle is already defined"):(s.Triangle=s.util.createClass(s.Object,{type:"triangle",width:100,height:100,_render:function(l){var u=this.width/2,i=this.height/2;l.beginPath(),l.moveTo(-u,i),l.lineTo(0,-i),l.lineTo(u,i),l.closePath(),this._renderPaintInOrder(l)},_toSVG:function(){var l=this.width/2,u=this.height/2;return["<polygon ","COMMON_PARTS",'points="',[-l+" "+u,"0 "+-u,l+" "+u].join(","),'" />']}}),s.Triangle.fromObject=function(l,u){return s.Object._fromObject("Triangle",l,u)})}(t),function(a){var s=a.fabric||(a.fabric={}),l=2*Math.PI;s.Ellipse?s.warn("fabric.Ellipse is already defined."):(s.Ellipse=s.util.createClass(s.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:s.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(u){this.callSuper("initialize",u),this.set("rx",u&&u.rx||0),this.set("ry",u&&u.ry||0)},_set:function(u,i){switch(this.callSuper("_set",u,i),u){case"rx":this.rx=i,this.set("width",2*i);break;case"ry":this.ry=i,this.set("height",2*i)}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(u){return this.callSuper("toObject",["rx","ry"].concat(u))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(u){u.beginPath(),u.save(),u.transform(1,0,0,this.ry/this.rx,0,0),u.arc(0,0,this.rx,0,l,!1),u.restore(),this._renderPaintInOrder(u)}}),s.Ellipse.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),s.Ellipse.fromElement=function(u,i){var r=s.parseAttributes(u,s.Ellipse.ATTRIBUTE_NAMES);r.left=(r.left||0)-r.rx,r.top=(r.top||0)-r.ry,i(new s.Ellipse(r))},s.Ellipse.fromObject=function(u,i){s.Object._fromObject("Ellipse",u,i)})}(t),function(a){var s=a.fabric||(a.fabric={}),l=s.util.object.extend;s.Rect?s.warn("fabric.Rect is already defined"):(s.Rect=s.util.createClass(s.Object,{stateProperties:s.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:s.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(u){this.callSuper("initialize",u),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(u){var i=this.rx?Math.min(this.rx,this.width/2):0,r=this.ry?Math.min(this.ry,this.height/2):0,c=this.width,p=this.height,d=-this.width/2,f=-this.height/2,m=i!==0||r!==0,S=.4477152502;u.beginPath(),u.moveTo(d+i,f),u.lineTo(d+c-i,f),m&&u.bezierCurveTo(d+c-S*i,f,d+c,f+S*r,d+c,f+r),u.lineTo(d+c,f+p-r),m&&u.bezierCurveTo(d+c,f+p-S*r,d+c-S*i,f+p,d+c-i,f+p),u.lineTo(d+i,f+p),m&&u.bezierCurveTo(d+S*i,f+p,d,f+p-S*r,d,f+p-r),u.lineTo(d,f+r),m&&u.bezierCurveTo(d,f+S*r,d+S*i,f,d+i,f),u.closePath(),this._renderPaintInOrder(u)},toObject:function(u){return this.callSuper("toObject",["rx","ry"].concat(u))},_toSVG:function(){return["<rect ","COMMON_PARTS",'x="',-this.width/2,'" y="',-this.height/2,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),s.Rect.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),s.Rect.fromElement=function(u,i,r){if(!u)return i(null);r=r||{};var c=s.parseAttributes(u,s.Rect.ATTRIBUTE_NAMES);c.left=c.left||0,c.top=c.top||0,c.height=c.height||0,c.width=c.width||0;var p=new s.Rect(l(r?s.util.object.clone(r):{},c));p.visible=p.visible&&p.width>0&&p.height>0,i(p)},s.Rect.fromObject=function(u,i){return s.Object._fromObject("Rect",u,i)})}(t),function(a){var s=a.fabric||(a.fabric={}),l=s.util.object.extend,u=s.util.array.min,i=s.util.array.max,r=s.util.toFixed,c=s.util.projectStrokeOnPoints;s.Polyline?s.warn("fabric.Polyline is already defined"):(s.Polyline=s.util.createClass(s.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:s.Object.prototype.cacheProperties.concat("points"),initialize:function(p,d){d=d||{},this.points=p||[],this.callSuper("initialize",d),this._setPositionDimensions(d)},_projectStrokeOnPoints:function(){return c(this.points,this,!0)},_setPositionDimensions:function(p){var d,f=this._calcDimensions(p),m=this.exactBoundingBox?this.strokeWidth:0;this.width=f.width-m,this.height=f.height-m,p.fromSVG||(d=this.translateToGivenOrigin({x:f.left-this.strokeWidth/2+m/2,y:f.top-this.strokeWidth/2+m/2},"left","top",this.originX,this.originY)),p.left===void 0&&(this.left=p.fromSVG?f.left:d.x),p.top===void 0&&(this.top=p.fromSVG?f.top:d.y),this.pathOffset={x:f.left+this.width/2+m/2,y:f.top+this.height/2+m/2}},_calcDimensions:function(){var p=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,d=u(p,"x")||0,f=u(p,"y")||0;return{left:d,top:f,width:(i(p,"x")||0)-d,height:(i(p,"y")||0)-f}},toObject:function(p){return l(this.callSuper("toObject",p),{points:this.points.concat()})},_toSVG:function(){for(var p=[],d=this.pathOffset.x,f=this.pathOffset.y,m=s.Object.NUM_FRACTION_DIGITS,S=0,T=this.points.length;S<T;S++)p.push(r(this.points[S].x-d,m),",",r(this.points[S].y-f,m)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',p.join(""),`" />
`]},commonRender:function(p){var d,f=this.points.length,m=this.pathOffset.x,S=this.pathOffset.y;if(!f||isNaN(this.points[f-1].y))return!1;p.beginPath(),p.moveTo(this.points[0].x-m,this.points[0].y-S);for(var T=0;T<f;T++)d=this.points[T],p.lineTo(d.x-m,d.y-S);return!0},_render:function(p){this.commonRender(p)&&this._renderPaintInOrder(p)},complexity:function(){return this.get("points").length}}),s.Polyline.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat(),s.Polyline.fromElementGenerator=function(p){return function(d,f,m){if(!d)return f(null);m||(m={});var S=s.parsePointsAttribute(d.getAttribute("points")),T=s.parseAttributes(d,s[p].ATTRIBUTE_NAMES);T.fromSVG=!0,f(new s[p](S,l(T,m)))}},s.Polyline.fromElement=s.Polyline.fromElementGenerator("Polyline"),s.Polyline.fromObject=function(p,d){return s.Object._fromObject("Polyline",p,d,"points")})}(t),function(a){var s=a.fabric||(a.fabric={}),l=s.util.projectStrokeOnPoints;s.Polygon?s.warn("fabric.Polygon is already defined"):(s.Polygon=s.util.createClass(s.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return l(this.points,this)},_render:function(u){this.commonRender(u)&&(u.closePath(),this._renderPaintInOrder(u))}}),s.Polygon.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat(),s.Polygon.fromElement=s.Polyline.fromElementGenerator("Polygon"),s.Polygon.fromObject=function(u,i){s.Object._fromObject("Polygon",u,i,"points")})}(t),function(a){var s=a.fabric||(a.fabric={}),l=s.util.array.min,u=s.util.array.max,i=s.util.object.extend,r=s.util.object.clone,c=s.util.toFixed;s.Path?s.warn("fabric.Path is already defined"):(s.Path=s.util.createClass(s.Object,{type:"path",path:null,cacheProperties:s.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:s.Object.prototype.stateProperties.concat("path"),initialize:function(p,d){delete(d=r(d||{})).path,this.callSuper("initialize",d),this._setPath(p||[],d)},_setPath:function(p,d){this.path=s.util.makePathSimpler(Array.isArray(p)?p:s.util.parsePath(p)),s.Polyline.prototype._setPositionDimensions.call(this,d||{})},_renderPathCommands:function(p){var d,f=0,m=0,S=0,T=0,x=0,E=0,O=-this.pathOffset.x,P=-this.pathOffset.y;p.beginPath();for(var j=0,W=this.path.length;j<W;++j)switch((d=this.path[j])[0]){case"L":S=d[1],T=d[2],p.lineTo(S+O,T+P);break;case"M":f=S=d[1],m=T=d[2],p.moveTo(S+O,T+P);break;case"C":S=d[5],T=d[6],x=d[3],E=d[4],p.bezierCurveTo(d[1]+O,d[2]+P,x+O,E+P,S+O,T+P);break;case"Q":p.quadraticCurveTo(d[1]+O,d[2]+P,d[3]+O,d[4]+P),S=d[3],T=d[4],x=d[1],E=d[2];break;case"z":case"Z":S=f,T=m,p.closePath()}},_render:function(p){this._renderPathCommands(p),this._renderPaintInOrder(p)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(p){return i(this.callSuper("toObject",p),{path:this.path.map(function(d){return d.slice()})})},toDatalessObject:function(p){var d=this.toObject(["sourcePath"].concat(p));return d.sourcePath&&delete d.path,d},_toSVG:function(){return["<path ","COMMON_PARTS",'d="',s.util.joinPath(this.path),'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var p=s.Object.NUM_FRACTION_DIGITS;return" translate("+c(-this.pathOffset.x,p)+", "+c(-this.pathOffset.y,p)+")"},toClipPathSVG:function(p){var d=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:p,additionalTransform:d})},toSVG:function(p){var d=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:p,additionalTransform:d})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var p,d,f=[],m=[],S=0,T=0,x=0,E=0,O=0,P=this.path.length;O<P;++O){switch((p=this.path[O])[0]){case"L":x=p[1],E=p[2],d=[];break;case"M":S=x=p[1],T=E=p[2],d=[];break;case"C":d=s.util.getBoundsOfCurve(x,E,p[1],p[2],p[3],p[4],p[5],p[6]),x=p[5],E=p[6];break;case"Q":d=s.util.getBoundsOfCurve(x,E,p[1],p[2],p[1],p[2],p[3],p[4]),x=p[3],E=p[4];break;case"z":case"Z":x=S,E=T}d.forEach(function(z){f.push(z.x),m.push(z.y)}),f.push(x),m.push(E)}var j=l(f)||0,W=l(m)||0;return{left:j,top:W,width:(u(f)||0)-j,height:(u(m)||0)-W}}}),s.Path.fromObject=function(p,d){if(typeof p.sourcePath=="string"){var f=p.sourcePath;s.loadSVGFromURL(f,function(m){var S=m[0];S.setOptions(p),d&&d(S)})}else s.Object._fromObject("Path",p,d,"path")},s.Path.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat(["d"]),s.Path.fromElement=function(p,d,f){var m=s.parseAttributes(p,s.Path.ATTRIBUTE_NAMES);m.fromSVG=!0,d(new s.Path(m.d,i(m,f)))})}(t),function(a){var s=a.fabric||(a.fabric={}),l=s.util.array.min,u=s.util.array.max;s.Group||(s.Group=s.util.createClass(s.Object,s.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(i,r,c){r=r||{},this._objects=[],c&&this.callSuper("initialize",r),this._objects=i||[];for(var p=this._objects.length;p--;)this._objects[p].group=this;if(c)this._updateObjectsACoords();else{var d=r&&r.centerPoint;r.originX!==void 0&&(this.originX=r.originX),r.originY!==void 0&&(this.originY=r.originY),d||this._calcBounds(),this._updateObjectsCoords(d),delete r.centerPoint,this.callSuper("initialize",r)}this.setCoords()},_updateObjectsACoords:function(){for(var i=this._objects.length;i--;)this._objects[i].setCoords(!0)},_updateObjectsCoords:function(i){i=i||this.getCenterPoint();for(var r=this._objects.length;r--;)this._updateObjectCoords(this._objects[r],i)},_updateObjectCoords:function(i,r){var c=i.left,p=i.top;i.set({left:c-r.x,top:p-r.y}),i.group=this,i.setCoords(!0)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(i){var r=!!this.group;return this._restoreObjectsState(),s.util.resetObjectTransform(this),i&&(r&&s.util.removeTransformFromObject(i,this.group.calcTransformMatrix()),this._objects.push(i),i.group=this,i._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,r?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(i){return this._restoreObjectsState(),s.util.resetObjectTransform(this),this.remove(i),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(i){this.dirty=!0,i.group=this,i._set("canvas",this.canvas)},_onObjectRemoved:function(i){this.dirty=!0,delete i.group},_set:function(i,r){var c=this._objects.length;if(this.useSetOnGroup)for(;c--;)this._objects[c].setOnGroup(i,r);if(i==="canvas")for(;c--;)this._objects[c]._set(i,r);s.Object.prototype._set.call(this,i,r)},toObject:function(i){var r=this.includeDefaultValues,c=this._objects.filter(function(d){return!d.excludeFromExport}).map(function(d){var f=d.includeDefaultValues;d.includeDefaultValues=r;var m=d.toObject(i);return d.includeDefaultValues=f,m}),p=s.Object.prototype.toObject.call(this,i);return p.objects=c,p},toDatalessObject:function(i){var r,c=this.sourcePath;if(c)r=c;else{var p=this.includeDefaultValues;r=this._objects.map(function(f){var m=f.includeDefaultValues;f.includeDefaultValues=p;var S=f.toDatalessObject(i);return f.includeDefaultValues=m,S})}var d=s.Object.prototype.toDatalessObject.call(this,i);return d.objects=r,d},render:function(i){this._transformDone=!0,this.callSuper("render",i),this._transformDone=!1},shouldCache:function(){var i=s.Object.prototype.shouldCache.call(this);if(i){for(var r=0,c=this._objects.length;r<c;r++)if(this._objects[r].willDrawShadow())return this.ownCaching=!1,!1}return i},willDrawShadow:function(){if(s.Object.prototype.willDrawShadow.call(this))return!0;for(var i=0,r=this._objects.length;i<r;i++)if(this._objects[i].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(i){for(var r=0,c=this._objects.length;r<c;r++)this._objects[r].render(i);this._drawClipPath(i,this.clipPath)},isCacheDirty:function(i){if(this.callSuper("isCacheDirty",i))return!0;if(!this.statefullCache)return!1;for(var r=0,c=this._objects.length;r<c;r++)if(this._objects[r].isCacheDirty(!0)){if(this._cacheCanvas){var p=this.cacheWidth/this.zoomX,d=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-p/2,-d/2,p,d)}return!0}return!1},_restoreObjectsState:function(){var i=this.calcOwnMatrix();return this._objects.forEach(function(r){s.util.addTransformToObject(r,i),delete r.group,r.setCoords()}),this},destroy:function(){return this._objects.forEach(function(i){i.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(i){i.dispose&&i.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var i=this._objects,r=this.canvas;this._objects=[];var c=this.toObject();delete c.objects;var p=new s.ActiveSelection([]);return p.set(c),p.type="activeSelection",r.remove(this),i.forEach(function(d){d.group=p,d.dirty=!0,r.add(d)}),p.canvas=r,p._objects=i,r._activeObject=p,p.setCoords(),p}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){return this.forEachObject(function(i){i.setCoords(!0)}),this},_calcBounds:function(i){for(var r,c,p,d,f=[],m=[],S=["tr","br","bl","tl"],T=0,x=this._objects.length,E=S.length;T<x;++T){for(p=(r=this._objects[T]).calcACoords(),d=0;d<E;d++)c=S[d],f.push(p[c].x),m.push(p[c].y);r.aCoords=p}this._getBounds(f,m,i)},_getBounds:function(i,r,c){var p=new s.Point(l(i),l(r)),d=new s.Point(u(i),u(r)),f=p.y||0,m=p.x||0,S=d.x-p.x||0,T=d.y-p.y||0;this.width=S,this.height=T,c||this.setPositionByOrigin({x:m,y:f},"left","top")},_toSVG:function(i){for(var r=["<g ","COMMON_PARTS",` >
`],c=0,p=this._objects.length;c<p;c++)r.push("		",this._objects[c].toSVG(i));return r.push(`</g>
`),r},getSvgStyles:function(){var i=this.opacity!==void 0&&this.opacity!==1?"opacity: "+this.opacity+";":"",r=this.visible?"":" visibility: hidden;";return[i,this.getSvgFilter(),r].join("")},toClipPathSVG:function(i){for(var r=[],c=0,p=this._objects.length;c<p;c++)r.push("	",this._objects[c].toClipPathSVG(i));return this._createBaseClipPathSVGMarkup(r,{reviver:i})}}),s.Group.fromObject=function(i,r){var c=i.objects,p=s.util.object.clone(i,!0);delete p.objects,typeof c!="string"?s.util.enlivenObjects(c,function(d){var f=s.util.object.clone(i,!0);delete f.objects,s.util.enlivenObjectEnlivables(i,f,function(){r&&r(new s.Group(d,f,!0))})}):s.loadSVGFromURL(c,function(d){var f=s.util.groupSVGElements(d,i,c);f.set(p),r&&r(f)})})}(t),function(a){var s=a.fabric||(a.fabric={});s.ActiveSelection||(s.ActiveSelection=s.util.createClass(s.Group,{type:"activeSelection",initialize:function(l,u){u=u||{},this._objects=l||[];for(var i=this._objects.length;i--;)this._objects[i].group=this;u.originX&&(this.originX=u.originX),u.originY&&(this.originY=u.originY),this._calcBounds(),this._updateObjectsCoords(),s.Object.prototype.initialize.call(this,u),this.setCoords()},toGroup:function(){var l=this._objects.concat();this._objects=[];var u=s.Object.prototype.toObject.call(this),i=new s.Group([]);if(delete u.type,i.set(u),l.forEach(function(c){c.canvas.remove(c),c.group=i}),i._objects=l,!this.canvas)return i;var r=this.canvas;return r.add(i),r._activeObject=i,i.setCoords(),i},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(l,u,i){l.save(),l.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",l,u),(i=i||{}).hasControls===void 0&&(i.hasControls=!1),i.forActiveSelection=!0;for(var r=0,c=this._objects.length;r<c;r++)this._objects[r]._renderControls(l,i);l.restore()}}),s.ActiveSelection.fromObject=function(l,u){s.util.enlivenObjects(l.objects,function(i){delete l.objects,u&&u(new s.ActiveSelection(i,l,!0))})})}(t),function(a){var s=y.util.object.extend;a.fabric||(a.fabric={}),a.fabric.Image?y.warn("fabric.Image is already defined."):(y.Image=y.util.createClass(y.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:y.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:y.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(l,u){u||(u={}),this.filters=[],this.cacheKey="texture"+y.Object.__uid++,this.callSuper("initialize",u),this._initElement(l,u)},getElement:function(){return this._element||{}},setElement:function(l,u){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=l,this._originalElement=l,this._initConfig(u),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(l){var u=y.filterBackend;u&&u.evictCachesForKey&&u.evictCachesForKey(l)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(l){y.util.cleanUpJsdomNode(this[l]),this[l]=void 0}.bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var l=this.getElement();return{width:l.naturalWidth||l.width,height:l.naturalHeight||l.height}},_stroke:function(l){if(this.stroke&&this.strokeWidth!==0){var u=this.width/2,i=this.height/2;l.beginPath(),l.moveTo(-u,-i),l.lineTo(u,-i),l.lineTo(u,i),l.lineTo(-u,i),l.lineTo(-u,-i),l.closePath()}},toObject:function(l){var u=[];this.filters.forEach(function(r){r&&u.push(r.toObject())});var i=s(this.callSuper("toObject",["cropX","cropY"].concat(l)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:u});return this.resizeFilter&&(i.resizeFilter=this.resizeFilter.toObject()),i},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var l,u=[],i=[],r=this._element,c=-this.width/2,p=-this.height/2,d="",f="";if(!r)return[];if(this.hasCrop()){var m=y.Object.__uid++;u.push('<clipPath id="imageCrop_'+m+`">
`,'	<rect x="'+c+'" y="'+p+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),d=' clip-path="url(#imageCrop_'+m+')" '}if(this.imageSmoothing||(f='" image-rendering="optimizeSpeed'),i.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',c-this.cropX,'" y="',p-this.cropY,'" width="',r.width||r.naturalWidth,'" height="',r.height||r.height,f,'"',d,`></image>
`),this.stroke||this.strokeDashArray){var S=this.fill;this.fill=null,l=["	<rect ",'x="',c,'" y="',p,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=S}return this.paintFirst!=="fill"?u.concat(l,i):u.concat(i,l)},getSrc:function(l){var u=l?this._element:this._originalElement;return u?u.toDataURL?u.toDataURL():this.srcFromAttribute?u.getAttribute("src"):u.src:this.src||""},setSrc:function(l,u,i){return y.util.loadImage(l,function(r,c){this.setElement(r,i),this._setWidthHeight(),u&&u(this,c)},this,i&&i.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var l=this.resizeFilter,u=this.minimumScaleTrigger,i=this.getTotalObjectScaling(),r=i.scaleX,c=i.scaleY,p=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!l||r>u&&c>u)return this._element=p,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=r,void(this._lastScaleY=c);y.filterBackend||(y.filterBackend=y.initFilterBackend());var d=y.util.createCanvasElement(),f=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,m=p.width,S=p.height;d.width=m,d.height=S,this._element=d,this._lastScaleX=l.scaleX=r,this._lastScaleY=l.scaleY=c,y.filterBackend.applyFilters([l],p,m,S,this._element,f),this._filterScalingX=d.width/this._originalElement.width,this._filterScalingY=d.height/this._originalElement.height},applyFilters:function(l){if(l=(l=l||this.filters||[]).filter(function(p){return p&&!p.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),l.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var u=this._originalElement,i=u.naturalWidth||u.width,r=u.naturalHeight||u.height;if(this._element===this._originalElement){var c=y.util.createCanvasElement();c.width=i,c.height=r,this._element=c,this._filteredEl=c}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,i,r),this._lastScaleX=1,this._lastScaleY=1;return y.filterBackend||(y.filterBackend=y.initFilterBackend()),y.filterBackend.applyFilters(l,this._originalElement,i,r,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(l){y.util.setImageSmoothing(l,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(l),this._renderPaintInOrder(l)},drawCacheOnCanvas:function(l){y.util.setImageSmoothing(l,this.imageSmoothing),y.Object.prototype.drawCacheOnCanvas.call(this,l)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(l){var u=this._element;if(u){var i=this._filterScalingX,r=this._filterScalingY,c=this.width,p=this.height,d=Math.min,f=Math.max,m=f(this.cropX,0),S=f(this.cropY,0),T=u.naturalWidth||u.width,x=u.naturalHeight||u.height,E=m*i,O=S*r,P=d(c*i,T-E),j=d(p*r,x-O),W=-c/2,z=-p/2,R=d(c,T/i-m),D=d(p,x/r-S);u&&l.drawImage(u,E,O,P,j,W,z,R,D)}},_needsResize:function(){var l=this.getTotalObjectScaling();return l.scaleX!==this._lastScaleX||l.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(l,u){this.setElement(y.util.getById(l),u),y.util.addClass(this.getElement(),y.Image.CSS_CANVAS)},_initConfig:function(l){l||(l={}),this.setOptions(l),this._setWidthHeight(l)},_initFilters:function(l,u){l&&l.length?y.util.enlivenObjects(l,function(i){u&&u(i)},"fabric.Image.filters"):u&&u()},_setWidthHeight:function(l){l||(l={});var u=this.getElement();this.width=l.width||u.naturalWidth||u.width||0,this.height=l.height||u.naturalHeight||u.height||0},parsePreserveAspectRatioAttribute:function(){var l,u=y.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),i=this._element.width,r=this._element.height,c=1,p=1,d=0,f=0,m=0,S=0,T=this.width,x=this.height,E={width:T,height:x};return!u||u.alignX==="none"&&u.alignY==="none"?(c=T/i,p=x/r):(u.meetOrSlice==="meet"&&(l=(T-i*(c=p=y.util.findScaleToFit(this._element,E)))/2,u.alignX==="Min"&&(d=-l),u.alignX==="Max"&&(d=l),l=(x-r*p)/2,u.alignY==="Min"&&(f=-l),u.alignY==="Max"&&(f=l)),u.meetOrSlice==="slice"&&(l=i-T/(c=p=y.util.findScaleToCover(this._element,E)),u.alignX==="Mid"&&(m=l/2),u.alignX==="Max"&&(m=l),l=r-x/p,u.alignY==="Mid"&&(S=l/2),u.alignY==="Max"&&(S=l),i=T/c,r=x/p)),{width:i,height:r,scaleX:c,scaleY:p,offsetLeft:d,offsetTop:f,cropX:m,cropY:S}}}),y.Image.CSS_CANVAS="canvas-img",y.Image.prototype.getSvgSrc=y.Image.prototype.getSrc,y.Image.fromObject=function(l,u){var i=y.util.object.clone(l);y.util.loadImage(i.src,function(r,c){c?u&&u(null,!0):y.Image.prototype._initFilters.call(i,i.filters,function(p){i.filters=p||[],y.Image.prototype._initFilters.call(i,[i.resizeFilter],function(d){i.resizeFilter=d[0],y.util.enlivenObjectEnlivables(i,i,function(){var f=new y.Image(r,i);u(f,!1)})})})},null,i.crossOrigin)},y.Image.fromURL=function(l,u,i){y.util.loadImage(l,function(r,c){u&&u(new y.Image(r,i),c)},null,i&&i.crossOrigin)},y.Image.ATTRIBUTE_NAMES=y.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),y.Image.fromElement=function(l,u,i){var r=y.parseAttributes(l,y.Image.ATTRIBUTE_NAMES);y.Image.fromURL(r["xlink:href"],u,s(i?y.util.object.clone(i):{},r))})}(t),y.util.object.extend(y.Object.prototype,{_getAngleValueForStraighten:function(){var a=this.angle%360;return a>0?90*Math.round((a-1)/90):90*Math.round(a/90)},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(a){var s=function(){},l=(a=a||{}).onComplete||s,u=a.onChange||s,i=this;return y.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(r){i.rotate(r),u()},onComplete:function(){i.setCoords(),l()}})}}),y.util.object.extend(y.StaticCanvas.prototype,{straightenObject:function(a){return a.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(a){return a.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){function a(l,u){var i="precision "+u+` float;
void main(){}`,r=l.createShader(l.FRAGMENT_SHADER);return l.shaderSource(r,i),l.compileShader(r),!!l.getShaderParameter(r,l.COMPILE_STATUS)}function s(l){l&&l.tileSize&&(this.tileSize=l.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}y.isWebglSupported=function(l){if(y.isLikelyNode)return!1;l=l||y.WebglFilterBackend.prototype.tileSize;var u=document.createElement("canvas"),i=u.getContext("webgl")||u.getContext("experimental-webgl"),r=!1;if(i){y.maxTextureSize=i.getParameter(i.MAX_TEXTURE_SIZE),r=y.maxTextureSize>=l;for(var c=["highp","mediump","lowp"],p=0;p<3;p++)if(a(i,c[p])){y.webGlPrecision=c[p];break}}return this.isSupported=r,r},y.WebglFilterBackend=s,s.prototype={tileSize:2048,resources:{},setupGLContext:function(l,u){this.dispose(),this.createWebGLCanvas(l,u),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(l,u)},chooseFastestCopyGLTo2DMethod:function(l,u){var i,r=window.performance!==void 0;try{new ImageData(1,1),i=!0}catch{i=!1}var c=typeof ArrayBuffer<"u",p=typeof Uint8ClampedArray<"u";if(r&&i&&c&&p){var d=y.util.createCanvasElement(),f=new ArrayBuffer(l*u*4);if(y.forceGLPutImageData)return this.imageBuffer=f,void(this.copyGLTo2D=de);var m,S,T={imageBuffer:f,destinationWidth:l,destinationHeight:u,targetCanvas:d};d.width=l,d.height=u,m=window.performance.now(),ce.call(T,this.gl,T),S=window.performance.now()-m,m=window.performance.now(),de.call(T,this.gl,T),S>window.performance.now()-m?(this.imageBuffer=f,this.copyGLTo2D=de):this.copyGLTo2D=ce}},createWebGLCanvas:function(l,u){var i=y.util.createCanvasElement();i.width=l,i.height=u;var r={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},c=i.getContext("webgl",r);c||(c=i.getContext("experimental-webgl",r)),c&&(c.clearColor(0,0,0,0),this.canvas=i,this.gl=c)},applyFilters:function(l,u,i,r,c,p){var d,f=this.gl;p&&(d=this.getCachedTexture(p,u));var m={originalWidth:u.width||u.originalWidth,originalHeight:u.height||u.originalHeight,sourceWidth:i,sourceHeight:r,destinationWidth:i,destinationHeight:r,context:f,sourceTexture:this.createTexture(f,i,r,!d&&u),targetTexture:this.createTexture(f,i,r),originalTexture:d||this.createTexture(f,i,r,!d&&u),passes:l.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:c},S=f.createFramebuffer();return f.bindFramebuffer(f.FRAMEBUFFER,S),l.forEach(function(T){T&&T.applyTo(m)}),function(T){var x=T.targetCanvas,E=x.width,O=x.height,P=T.destinationWidth,j=T.destinationHeight;E===P&&O===j||(x.width=P,x.height=j)}(m),this.copyGLTo2D(f,m),f.bindTexture(f.TEXTURE_2D,null),f.deleteTexture(m.sourceTexture),f.deleteTexture(m.targetTexture),f.deleteFramebuffer(S),c.getContext("2d").setTransform(1,0,0,1,0,0),m},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(l,u,i,r){var c=l.createTexture();return l.bindTexture(l.TEXTURE_2D,c),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),r?l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,r):l.texImage2D(l.TEXTURE_2D,0,l.RGBA,u,i,0,l.RGBA,l.UNSIGNED_BYTE,null),c},getCachedTexture:function(l,u){if(this.textureCache[l])return this.textureCache[l];var i=this.createTexture(this.gl,u.width,u.height,u);return this.textureCache[l]=i,i},evictCachesForKey:function(l){this.textureCache[l]&&(this.gl.deleteTexture(this.textureCache[l]),delete this.textureCache[l])},copyGLTo2D:ce,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var l=this.gl,u={renderer:"",vendor:""};if(!l)return u;var i=l.getExtension("WEBGL_debug_renderer_info");if(i){var r=l.getParameter(i.UNMASKED_RENDERER_WEBGL),c=l.getParameter(i.UNMASKED_VENDOR_WEBGL);r&&(u.renderer=r.toLowerCase()),c&&(u.vendor=c.toLowerCase())}return this.gpuInfo=u,u}}}(),function(){var a=function(){};function s(){}y.Canvas2dFilterBackend=s,s.prototype={evictCachesForKey:a,dispose:a,clearWebGLCaches:a,resources:{},applyFilters:function(l,u,i,r,c){var p=c.getContext("2d");p.drawImage(u,0,0,i,r);var d={sourceWidth:i,sourceHeight:r,imageData:p.getImageData(0,0,i,r),originalEl:u,originalImageData:p.getImageData(0,0,i,r),canvasEl:c,ctx:p,filterBackend:this};return l.forEach(function(f){f.applyTo(d)}),d.imageData.width===i&&d.imageData.height===r||(c.width=d.imageData.width,c.height=d.imageData.height),p.putImageData(d.imageData,0,0),d}}}(),y.Image=y.Image||{},y.Image.filters=y.Image.filters||{},y.Image.filters.BaseFilter=y.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(a){a&&this.setOptions(a)},setOptions:function(a){for(var s in a)this[s]=a[s]},createProgram:function(a,s,l){s=s||this.fragmentSource,l=l||this.vertexSource,y.webGlPrecision!=="highp"&&(s=s.replace(/precision highp float/g,"precision "+y.webGlPrecision+" float"));var u=a.createShader(a.VERTEX_SHADER);if(a.shaderSource(u,l),a.compileShader(u),!a.getShaderParameter(u,a.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+a.getShaderInfoLog(u));var i=a.createShader(a.FRAGMENT_SHADER);if(a.shaderSource(i,s),a.compileShader(i),!a.getShaderParameter(i,a.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+a.getShaderInfoLog(i));var r=a.createProgram();if(a.attachShader(r,u),a.attachShader(r,i),a.linkProgram(r),!a.getProgramParameter(r,a.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+a.getProgramInfoLog(r));var c=this.getAttributeLocations(a,r),p=this.getUniformLocations(a,r)||{};return p.uStepW=a.getUniformLocation(r,"uStepW"),p.uStepH=a.getUniformLocation(r,"uStepH"),{program:r,attributeLocations:c,uniformLocations:p}},getAttributeLocations:function(a,s){return{aPosition:a.getAttribLocation(s,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(a,s,l){var u=s.aPosition,i=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,i),a.enableVertexAttribArray(u),a.vertexAttribPointer(u,2,a.FLOAT,!1,0,0),a.bufferData(a.ARRAY_BUFFER,l,a.STATIC_DRAW)},_setupFrameBuffer:function(a){var s,l,u=a.context;a.passes>1?(s=a.destinationWidth,l=a.destinationHeight,a.sourceWidth===s&&a.sourceHeight===l||(u.deleteTexture(a.targetTexture),a.targetTexture=a.filterBackend.createTexture(u,s,l)),u.framebufferTexture2D(u.FRAMEBUFFER,u.COLOR_ATTACHMENT0,u.TEXTURE_2D,a.targetTexture,0)):(u.bindFramebuffer(u.FRAMEBUFFER,null),u.finish())},_swapTextures:function(a){a.passes--,a.pass++;var s=a.targetTexture;a.targetTexture=a.sourceTexture,a.sourceTexture=s},isNeutralState:function(){var a=this.mainParameter,s=y.Image.filters[this.type].prototype;if(a){if(Array.isArray(s[a])){for(var l=s[a].length;l--;)if(this[a][l]!==s[a][l])return!1;return!0}return s[a]===this[a]}return!1},applyTo:function(a){a.webgl?(this._setupFrameBuffer(a),this.applyToWebGL(a),this._swapTextures(a)):this.applyTo2d(a)},retrieveShader:function(a){return a.programCache.hasOwnProperty(this.type)||(a.programCache[this.type]=this.createProgram(a.context)),a.programCache[this.type]},applyToWebGL:function(a){var s=a.context,l=this.retrieveShader(a);a.pass===0&&a.originalTexture?s.bindTexture(s.TEXTURE_2D,a.originalTexture):s.bindTexture(s.TEXTURE_2D,a.sourceTexture),s.useProgram(l.program),this.sendAttributeData(s,l.attributeLocations,a.aPosition),s.uniform1f(l.uniformLocations.uStepW,1/a.sourceWidth),s.uniform1f(l.uniformLocations.uStepH,1/a.sourceHeight),this.sendUniformData(s,l.uniformLocations),s.viewport(0,0,a.destinationWidth,a.destinationHeight),s.drawArrays(s.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(a,s,l){a.activeTexture(l),a.bindTexture(a.TEXTURE_2D,s),a.activeTexture(a.TEXTURE0)},unbindAdditionalTexture:function(a,s){a.activeTexture(s),a.bindTexture(a.TEXTURE_2D,null),a.activeTexture(a.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(a){this[this.mainParameter]=a},sendUniformData:function(){},createHelpLayer:function(a){if(!a.helpLayer){var s=document.createElement("canvas");s.width=a.sourceWidth,s.height=a.sourceHeight,a.helpLayer=s}},toObject:function(){var a={type:this.type},s=this.mainParameter;return s&&(a[s]=this[s]),a},toJSON:function(){return this.toObject()}}),y.Image.filters.BaseFilter.fromObject=function(a,s){var l=new y.Image.filters[a.type](a);return s&&s(l),l},function(a){var s=a.fabric||(a.fabric={}),l=s.Image.filters,u=s.util.createClass;l.ColorMatrix=u(l.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(i){this.callSuper("initialize",i),this.matrix=this.matrix.slice(0)},applyTo2d:function(i){var r,c,p,d,f,m=i.imageData.data,S=m.length,T=this.matrix,x=this.colorsOnly;for(f=0;f<S;f+=4)r=m[f],c=m[f+1],p=m[f+2],x?(m[f]=r*T[0]+c*T[1]+p*T[2]+255*T[4],m[f+1]=r*T[5]+c*T[6]+p*T[7]+255*T[9],m[f+2]=r*T[10]+c*T[11]+p*T[12]+255*T[14]):(d=m[f+3],m[f]=r*T[0]+c*T[1]+p*T[2]+d*T[3]+255*T[4],m[f+1]=r*T[5]+c*T[6]+p*T[7]+d*T[8]+255*T[9],m[f+2]=r*T[10]+c*T[11]+p*T[12]+d*T[13]+255*T[14],m[f+3]=r*T[15]+c*T[16]+p*T[17]+d*T[18]+255*T[19])},getUniformLocations:function(i,r){return{uColorMatrix:i.getUniformLocation(r,"uColorMatrix"),uConstants:i.getUniformLocation(r,"uConstants")}},sendUniformData:function(i,r){var c=this.matrix,p=[c[0],c[1],c[2],c[3],c[5],c[6],c[7],c[8],c[10],c[11],c[12],c[13],c[15],c[16],c[17],c[18]],d=[c[4],c[9],c[14],c[19]];i.uniformMatrix4fv(r.uColorMatrix,!1,p),i.uniform4fv(r.uConstants,d)}}),s.Image.filters.ColorMatrix.fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(a){var s=a.fabric||(a.fabric={}),l=s.Image.filters,u=s.util.createClass;l.Brightness=u(l.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(i){if(this.brightness!==0){var r,c=i.imageData.data,p=c.length,d=Math.round(255*this.brightness);for(r=0;r<p;r+=4)c[r]=c[r]+d,c[r+1]=c[r+1]+d,c[r+2]=c[r+2]+d}},getUniformLocations:function(i,r){return{uBrightness:i.getUniformLocation(r,"uBrightness")}},sendUniformData:function(i,r){i.uniform1f(r.uBrightness,this.brightness)}}),s.Image.filters.Brightness.fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(a){var s=a.fabric||(a.fabric={}),l=s.util.object.extend,u=s.Image.filters,i=s.util.createClass;u.Convolute=i(u.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(r){var c=Math.sqrt(this.matrix.length),p=this.type+"_"+c+"_"+(this.opaque?1:0),d=this.fragmentSource[p];return r.programCache.hasOwnProperty(p)||(r.programCache[p]=this.createProgram(r.context,d)),r.programCache[p]},applyTo2d:function(r){var c,p,d,f,m,S,T,x,E,O,P,j,W,z=r.imageData,R=z.data,D=this.matrix,M=Math.round(Math.sqrt(D.length)),L=Math.floor(M/2),B=z.width,U=z.height,H=r.ctx.createImageData(B,U),k=H.data,F=this.opaque?1:0;for(P=0;P<U;P++)for(O=0;O<B;O++){for(m=4*(P*B+O),c=0,p=0,d=0,f=0,W=0;W<M;W++)for(j=0;j<M;j++)S=O+j-L,(T=P+W-L)<0||T>=U||S<0||S>=B||(x=4*(T*B+S),E=D[W*M+j],c+=R[x]*E,p+=R[x+1]*E,d+=R[x+2]*E,F||(f+=R[x+3]*E));k[m]=c,k[m+1]=p,k[m+2]=d,k[m+3]=F?R[m+3]:f}r.imageData=H},getUniformLocations:function(r,c){return{uMatrix:r.getUniformLocation(c,"uMatrix"),uOpaque:r.getUniformLocation(c,"uOpaque"),uHalfSize:r.getUniformLocation(c,"uHalfSize"),uSize:r.getUniformLocation(c,"uSize")}},sendUniformData:function(r,c){r.uniform1fv(c.uMatrix,this.matrix)},toObject:function(){return l(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),s.Image.filters.Convolute.fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(a){var s=a.fabric||(a.fabric={}),l=s.Image.filters,u=s.util.createClass;l.Grayscale=u(l.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(i){var r,c,p=i.imageData.data,d=p.length,f=this.mode;for(r=0;r<d;r+=4)f==="average"?c=(p[r]+p[r+1]+p[r+2])/3:f==="lightness"?c=(Math.min(p[r],p[r+1],p[r+2])+Math.max(p[r],p[r+1],p[r+2]))/2:f==="luminosity"&&(c=.21*p[r]+.72*p[r+1]+.07*p[r+2]),p[r]=c,p[r+1]=c,p[r+2]=c},retrieveShader:function(i){var r=this.type+"_"+this.mode;if(!i.programCache.hasOwnProperty(r)){var c=this.fragmentSource[this.mode];i.programCache[r]=this.createProgram(i.context,c)}return i.programCache[r]},getUniformLocations:function(i,r){return{uMode:i.getUniformLocation(r,"uMode")}},sendUniformData:function(i,r){i.uniform1i(r.uMode,1)},isNeutralState:function(){return!1}}),s.Image.filters.Grayscale.fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(a){var s=a.fabric||(a.fabric={}),l=s.Image.filters,u=s.util.createClass;l.Invert=u(l.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(i){var r,c=i.imageData.data,p=c.length;for(r=0;r<p;r+=4)c[r]=255-c[r],c[r+1]=255-c[r+1],c[r+2]=255-c[r+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(i,r){return{uInvert:i.getUniformLocation(r,"uInvert")}},sendUniformData:function(i,r){i.uniform1i(r.uInvert,this.invert)}}),s.Image.filters.Invert.fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(a){var s=a.fabric||(a.fabric={}),l=s.util.object.extend,u=s.Image.filters,i=s.util.createClass;u.Noise=i(u.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(r){if(this.noise!==0){var c,p,d=r.imageData.data,f=d.length,m=this.noise;for(c=0,f=d.length;c<f;c+=4)p=(.5-Math.random())*m,d[c]+=p,d[c+1]+=p,d[c+2]+=p}},getUniformLocations:function(r,c){return{uNoise:r.getUniformLocation(c,"uNoise"),uSeed:r.getUniformLocation(c,"uSeed")}},sendUniformData:function(r,c){r.uniform1f(c.uNoise,this.noise/255),r.uniform1f(c.uSeed,Math.random())},toObject:function(){return l(this.callSuper("toObject"),{noise:this.noise})}}),s.Image.filters.Noise.fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(a){var s=a.fabric||(a.fabric={}),l=s.Image.filters,u=s.util.createClass;l.Pixelate=u(l.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(i){var r,c,p,d,f,m,S,T,x,E,O,P=i.imageData,j=P.data,W=P.height,z=P.width;for(c=0;c<W;c+=this.blocksize)for(p=0;p<z;p+=this.blocksize)for(d=j[r=4*c*z+4*p],f=j[r+1],m=j[r+2],S=j[r+3],E=Math.min(c+this.blocksize,W),O=Math.min(p+this.blocksize,z),T=c;T<E;T++)for(x=p;x<O;x++)j[r=4*T*z+4*x]=d,j[r+1]=f,j[r+2]=m,j[r+3]=S},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(i,r){return{uBlocksize:i.getUniformLocation(r,"uBlocksize"),uStepW:i.getUniformLocation(r,"uStepW"),uStepH:i.getUniformLocation(r,"uStepH")}},sendUniformData:function(i,r){i.uniform1f(r.uBlocksize,this.blocksize)}}),s.Image.filters.Pixelate.fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(a){var s=a.fabric||(a.fabric={}),l=s.util.object.extend,u=s.Image.filters,i=s.util.createClass;u.RemoveColor=i(u.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(r){var c,p,d,f,m=r.imageData.data,S=255*this.distance,T=new s.Color(this.color).getSource(),x=[T[0]-S,T[1]-S,T[2]-S],E=[T[0]+S,T[1]+S,T[2]+S];for(c=0;c<m.length;c+=4)p=m[c],d=m[c+1],f=m[c+2],p>x[0]&&d>x[1]&&f>x[2]&&p<E[0]&&d<E[1]&&f<E[2]&&(m[c+3]=0)},getUniformLocations:function(r,c){return{uLow:r.getUniformLocation(c,"uLow"),uHigh:r.getUniformLocation(c,"uHigh")}},sendUniformData:function(r,c){var p=new s.Color(this.color).getSource(),d=parseFloat(this.distance),f=[0+p[0]/255-d,0+p[1]/255-d,0+p[2]/255-d,1],m=[p[0]/255+d,p[1]/255+d,p[2]/255+d,1];r.uniform4fv(c.uLow,f),r.uniform4fv(c.uHigh,m)},toObject:function(){return l(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),s.Image.filters.RemoveColor.fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(a){var s=a.fabric||(a.fabric={}),l=s.Image.filters,u=s.util.createClass,i={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var r in i)l[r]=u(l.ColorMatrix,{type:r,matrix:i[r],mainParameter:!1,colorsOnly:!0}),s.Image.filters[r].fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(a){var s=a.fabric,l=s.Image.filters,u=s.util.createClass;l.BlendColor=u(l.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(i){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[i]+`}
}`},retrieveShader:function(i){var r,c=this.type+"_"+this.mode;return i.programCache.hasOwnProperty(c)||(r=this.buildSource(this.mode),i.programCache[c]=this.createProgram(i.context,r)),i.programCache[c]},applyTo2d:function(i){var r,c,p,d,f,m,S,T=i.imageData.data,x=T.length,E=1-this.alpha;r=(S=new s.Color(this.color).getSource())[0]*this.alpha,c=S[1]*this.alpha,p=S[2]*this.alpha;for(var O=0;O<x;O+=4)switch(d=T[O],f=T[O+1],m=T[O+2],this.mode){case"multiply":T[O]=d*r/255,T[O+1]=f*c/255,T[O+2]=m*p/255;break;case"screen":T[O]=255-(255-d)*(255-r)/255,T[O+1]=255-(255-f)*(255-c)/255,T[O+2]=255-(255-m)*(255-p)/255;break;case"add":T[O]=d+r,T[O+1]=f+c,T[O+2]=m+p;break;case"diff":case"difference":T[O]=Math.abs(d-r),T[O+1]=Math.abs(f-c),T[O+2]=Math.abs(m-p);break;case"subtract":T[O]=d-r,T[O+1]=f-c,T[O+2]=m-p;break;case"darken":T[O]=Math.min(d,r),T[O+1]=Math.min(f,c),T[O+2]=Math.min(m,p);break;case"lighten":T[O]=Math.max(d,r),T[O+1]=Math.max(f,c),T[O+2]=Math.max(m,p);break;case"overlay":T[O]=r<128?2*d*r/255:255-2*(255-d)*(255-r)/255,T[O+1]=c<128?2*f*c/255:255-2*(255-f)*(255-c)/255,T[O+2]=p<128?2*m*p/255:255-2*(255-m)*(255-p)/255;break;case"exclusion":T[O]=r+d-2*r*d/255,T[O+1]=c+f-2*c*f/255,T[O+2]=p+m-2*p*m/255;break;case"tint":T[O]=r+d*E,T[O+1]=c+f*E,T[O+2]=p+m*E}},getUniformLocations:function(i,r){return{uColor:i.getUniformLocation(r,"uColor")}},sendUniformData:function(i,r){var c=new s.Color(this.color).getSource();c[0]=this.alpha*c[0]/255,c[1]=this.alpha*c[1]/255,c[2]=this.alpha*c[2]/255,c[3]=this.alpha,i.uniform4fv(r.uColor,c)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),s.Image.filters.BlendColor.fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(a){var s=a.fabric,l=s.Image.filters,u=s.util.createClass;l.BlendImage=u(l.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(i){var r=this.type+"_"+this.mode,c=this.fragmentSource[this.mode];return i.programCache.hasOwnProperty(r)||(i.programCache[r]=this.createProgram(i.context,c)),i.programCache[r]},applyToWebGL:function(i){var r=i.context,c=this.createTexture(i.filterBackend,this.image);this.bindAdditionalTexture(r,c,r.TEXTURE1),this.callSuper("applyToWebGL",i),this.unbindAdditionalTexture(r,r.TEXTURE1)},createTexture:function(i,r){return i.getCachedTexture(r.cacheKey,r._element)},calculateMatrix:function(){var i=this.image,r=i._element.width,c=i._element.height;return[1/i.scaleX,0,0,0,1/i.scaleY,0,-i.left/r,-i.top/c,1]},applyTo2d:function(i){var r,c,p,d,f,m,S,T,x,E,O,P=i.imageData,j=i.filterBackend.resources,W=P.data,z=W.length,R=P.width,D=P.height,M=this.image;j.blendImage||(j.blendImage=s.util.createCanvasElement()),E=(x=j.blendImage).getContext("2d"),x.width!==R||x.height!==D?(x.width=R,x.height=D):E.clearRect(0,0,R,D),E.setTransform(M.scaleX,0,0,M.scaleY,M.left,M.top),E.drawImage(M._element,0,0,R,D),O=E.getImageData(0,0,R,D).data;for(var L=0;L<z;L+=4)switch(f=W[L],m=W[L+1],S=W[L+2],T=W[L+3],r=O[L],c=O[L+1],p=O[L+2],d=O[L+3],this.mode){case"multiply":W[L]=f*r/255,W[L+1]=m*c/255,W[L+2]=S*p/255,W[L+3]=T*d/255;break;case"mask":W[L+3]=d}},getUniformLocations:function(i,r){return{uTransformMatrix:i.getUniformLocation(r,"uTransformMatrix"),uImage:i.getUniformLocation(r,"uImage")}},sendUniformData:function(i,r){var c=this.calculateMatrix();i.uniform1i(r.uImage,1),i.uniformMatrix3fv(r.uTransformMatrix,!1,c)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),s.Image.filters.BlendImage.fromObject=function(i,r){s.Image.fromObject(i.image,function(c){var p=s.util.object.clone(i);p.image=c,r(new s.Image.filters.BlendImage(p))})}}(t),function(a){var s=a.fabric||(a.fabric={}),l=Math.pow,u=Math.floor,i=Math.sqrt,r=Math.abs,c=Math.round,p=Math.sin,d=Math.ceil,f=s.Image.filters,m=s.util.createClass;f.Resize=m(f.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(S,T){return{uDelta:S.getUniformLocation(T,"uDelta"),uTaps:S.getUniformLocation(T,"uTaps")}},sendUniformData:function(S,T){S.uniform2fv(T.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),S.uniform1fv(T.uTaps,this.taps)},retrieveShader:function(S){var T=this.getFilterWindow(),x=this.type+"_"+T;if(!S.programCache.hasOwnProperty(x)){var E=this.generateShader(T);S.programCache[x]=this.createProgram(S.context,E)}return S.programCache[x]},getFilterWindow:function(){var S=this.tempScale;return Math.ceil(this.lanczosLobes/S)},getTaps:function(){for(var S=this.lanczosCreate(this.lanczosLobes),T=this.tempScale,x=this.getFilterWindow(),E=new Array(x),O=1;O<=x;O++)E[O-1]=S(O*T);return E},generateShader:function(S){for(var T=new Array(S),x=this.fragmentSourceTOP,E=1;E<=S;E++)T[E-1]=E+".0 * uDelta";return x+="uniform float uTaps["+S+`];
`,x+=`void main() {
`,x+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,x+=`  float sum = 1.0;
`,T.forEach(function(O,P){x+="  color += texture2D(uTexture, vTexCoord + "+O+") * uTaps["+P+`];
`,x+="  color += texture2D(uTexture, vTexCoord - "+O+") * uTaps["+P+`];
`,x+="  sum += 2.0 * uTaps["+P+`];
`}),x+=`  gl_FragColor = color / sum;
`,x+="}"},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(S){S.webgl?(S.passes++,this.width=S.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=S.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),S.destinationWidth=this.dW,this._setupFrameBuffer(S),this.applyToWebGL(S),this._swapTextures(S),S.sourceWidth=S.destinationWidth,this.height=S.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),S.destinationHeight=this.dH,this._setupFrameBuffer(S),this.applyToWebGL(S),this._swapTextures(S),S.sourceHeight=S.destinationHeight):this.applyTo2d(S)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(S){return function(T){if(T>=S||T<=-S)return 0;if(T<11920929e-14&&T>-11920929e-14)return 1;var x=(T*=Math.PI)/S;return p(T)/T*p(x)/x}},applyTo2d:function(S){var T=S.imageData,x=this.scaleX,E=this.scaleY;this.rcpScaleX=1/x,this.rcpScaleY=1/E;var O,P=T.width,j=T.height,W=c(P*x),z=c(j*E);this.resizeType==="sliceHack"?O=this.sliceByTwo(S,P,j,W,z):this.resizeType==="hermite"?O=this.hermiteFastResize(S,P,j,W,z):this.resizeType==="bilinear"?O=this.bilinearFiltering(S,P,j,W,z):this.resizeType==="lanczos"&&(O=this.lanczosResize(S,P,j,W,z)),S.imageData=O},sliceByTwo:function(S,T,x,E,O){var P,j,W=S.imageData,z=.5,R=!1,D=!1,M=T*z,L=x*z,B=s.filterBackend.resources,U=0,H=0,k=T,F=0;for(B.sliceByTwo||(B.sliceByTwo=document.createElement("canvas")),((P=B.sliceByTwo).width<1.5*T||P.height<x)&&(P.width=1.5*T,P.height=x),(j=P.getContext("2d")).clearRect(0,0,1.5*T,x),j.putImageData(W,0,0),E=u(E),O=u(O);!R||!D;)T=M,x=L,E<u(M*z)?M=u(M*z):(M=E,R=!0),O<u(L*z)?L=u(L*z):(L=O,D=!0),j.drawImage(P,U,H,T,x,k,F,M,L),U=k,H=F,F+=L;return j.getImageData(U,H,E,O)},lanczosResize:function(S,T,x,E,O){var P=S.imageData.data,j=S.ctx.createImageData(E,O),W=j.data,z=this.lanczosCreate(this.lanczosLobes),R=this.rcpScaleX,D=this.rcpScaleY,M=2/this.rcpScaleX,L=2/this.rcpScaleY,B=d(R*this.lanczosLobes/2),U=d(D*this.lanczosLobes/2),H={},k={},F={};return function N(X){var Y,Q,ee,te,ie,se,oe,ue,_e,fe,ve;for(k.x=(X+.5)*R,F.x=u(k.x),Y=0;Y<O;Y++){for(k.y=(Y+.5)*D,F.y=u(k.y),ie=0,se=0,oe=0,ue=0,_e=0,Q=F.x-B;Q<=F.x+B;Q++)if(!(Q<0||Q>=T)){fe=u(1e3*r(Q-k.x)),H[fe]||(H[fe]={});for(var be=F.y-U;be<=F.y+U;be++)be<0||be>=x||(ve=u(1e3*r(be-k.y)),H[fe][ve]||(H[fe][ve]=z(i(l(fe*M,2)+l(ve*L,2))/1e3)),(ee=H[fe][ve])>0&&(ie+=ee,se+=ee*P[te=4*(be*T+Q)],oe+=ee*P[te+1],ue+=ee*P[te+2],_e+=ee*P[te+3]))}W[te=4*(Y*E+X)]=se/ie,W[te+1]=oe/ie,W[te+2]=ue/ie,W[te+3]=_e/ie}return++X<E?N(X):j}(0)},bilinearFiltering:function(S,T,x,E,O){var P,j,W,z,R,D,M,L,B,U=0,H=this.rcpScaleX,k=this.rcpScaleY,F=4*(T-1),N=S.imageData.data,X=S.ctx.createImageData(E,O),Y=X.data;for(W=0;W<O;W++)for(z=0;z<E;z++)for(R=H*z-(P=u(H*z)),D=k*W-(j=u(k*W)),B=4*(j*T+P),M=0;M<4;M++)L=N[B+M]*(1-R)*(1-D)+N[B+4+M]*R*(1-D)+N[B+F+M]*D*(1-R)+N[B+F+4+M]*R*D,Y[U++]=L;return X},hermiteFastResize:function(S,T,x,E,O){for(var P=this.rcpScaleX,j=this.rcpScaleY,W=d(P/2),z=d(j/2),R=S.imageData.data,D=S.ctx.createImageData(E,O),M=D.data,L=0;L<O;L++)for(var B=0;B<E;B++){for(var U=4*(B+L*E),H=0,k=0,F=0,N=0,X=0,Y=0,Q=0,ee=(L+.5)*j,te=u(L*j);te<(L+1)*j;te++)for(var ie=r(ee-(te+.5))/z,se=(B+.5)*P,oe=ie*ie,ue=u(B*P);ue<(B+1)*P;ue++){var _e=r(se-(ue+.5))/W,fe=i(oe+_e*_e);fe>1&&fe<-1||(H=2*fe*fe*fe-3*fe*fe+1)>0&&(Q+=H*R[3+(_e=4*(ue+te*T))],F+=H,R[_e+3]<255&&(H=H*R[_e+3]/250),N+=H*R[_e],X+=H*R[_e+1],Y+=H*R[_e+2],k+=H)}M[U]=N/k,M[U+1]=X/k,M[U+2]=Y/k,M[U+3]=Q/F}return D},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),s.Image.filters.Resize.fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(a){var s=a.fabric||(a.fabric={}),l=s.Image.filters,u=s.util.createClass;l.Contrast=u(l.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(i){if(this.contrast!==0){var r,c=i.imageData.data,p=c.length,d=Math.floor(255*this.contrast),f=259*(d+255)/(255*(259-d));for(r=0;r<p;r+=4)c[r]=f*(c[r]-128)+128,c[r+1]=f*(c[r+1]-128)+128,c[r+2]=f*(c[r+2]-128)+128}},getUniformLocations:function(i,r){return{uContrast:i.getUniformLocation(r,"uContrast")}},sendUniformData:function(i,r){i.uniform1f(r.uContrast,this.contrast)}}),s.Image.filters.Contrast.fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(a){var s=a.fabric||(a.fabric={}),l=s.Image.filters,u=s.util.createClass;l.Saturation=u(l.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(i){if(this.saturation!==0){var r,c,p=i.imageData.data,d=p.length,f=-this.saturation;for(r=0;r<d;r+=4)c=Math.max(p[r],p[r+1],p[r+2]),p[r]+=c!==p[r]?(c-p[r])*f:0,p[r+1]+=c!==p[r+1]?(c-p[r+1])*f:0,p[r+2]+=c!==p[r+2]?(c-p[r+2])*f:0}},getUniformLocations:function(i,r){return{uSaturation:i.getUniformLocation(r,"uSaturation")}},sendUniformData:function(i,r){i.uniform1f(r.uSaturation,-this.saturation)}}),s.Image.filters.Saturation.fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(a){var s=a.fabric||(a.fabric={}),l=s.Image.filters,u=s.util.createClass;l.Vibrance=u(l.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(i){if(this.vibrance!==0){var r,c,p,d,f=i.imageData.data,m=f.length,S=-this.vibrance;for(r=0;r<m;r+=4)c=Math.max(f[r],f[r+1],f[r+2]),p=(f[r]+f[r+1]+f[r+2])/3,d=2*Math.abs(c-p)/255*S,f[r]+=c!==f[r]?(c-f[r])*d:0,f[r+1]+=c!==f[r+1]?(c-f[r+1])*d:0,f[r+2]+=c!==f[r+2]?(c-f[r+2])*d:0}},getUniformLocations:function(i,r){return{uVibrance:i.getUniformLocation(r,"uVibrance")}},sendUniformData:function(i,r){i.uniform1f(r.uVibrance,-this.vibrance)}}),s.Image.filters.Vibrance.fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(a){var s=a.fabric||(a.fabric={}),l=s.Image.filters,u=s.util.createClass;l.Blur=u(l.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(i){i.webgl?(this.aspectRatio=i.sourceWidth/i.sourceHeight,i.passes++,this._setupFrameBuffer(i),this.horizontal=!0,this.applyToWebGL(i),this._swapTextures(i),this._setupFrameBuffer(i),this.horizontal=!1,this.applyToWebGL(i),this._swapTextures(i)):this.applyTo2d(i)},applyTo2d:function(i){i.imageData=this.simpleBlur(i)},simpleBlur:function(i){var r,c,p=i.filterBackend.resources,d=i.imageData.width,f=i.imageData.height;p.blurLayer1||(p.blurLayer1=s.util.createCanvasElement(),p.blurLayer2=s.util.createCanvasElement()),r=p.blurLayer1,c=p.blurLayer2,r.width===d&&r.height===f||(c.width=r.width=d,c.height=r.height=f);var m,S,T,x,E=r.getContext("2d"),O=c.getContext("2d"),P=.06*this.blur*.5;for(E.putImageData(i.imageData,0,0),O.clearRect(0,0,d,f),x=-15;x<=15;x++)T=P*(S=x/15)*d+(m=(Math.random()-.5)/4),O.globalAlpha=1-Math.abs(S),O.drawImage(r,T,m),E.drawImage(c,0,0),O.globalAlpha=1,O.clearRect(0,0,c.width,c.height);for(x=-15;x<=15;x++)T=P*(S=x/15)*f+(m=(Math.random()-.5)/4),O.globalAlpha=1-Math.abs(S),O.drawImage(r,m,T),E.drawImage(c,0,0),O.globalAlpha=1,O.clearRect(0,0,c.width,c.height);i.ctx.drawImage(r,0,0);var j=i.ctx.getImageData(0,0,r.width,r.height);return E.globalAlpha=1,E.clearRect(0,0,r.width,r.height),j},getUniformLocations:function(i,r){return{delta:i.getUniformLocation(r,"uDelta")}},sendUniformData:function(i,r){var c=this.chooseRightDelta();i.uniform2fv(r.delta,c)},chooseRightDelta:function(){var i,r=1,c=[0,0];return this.horizontal?this.aspectRatio>1&&(r=1/this.aspectRatio):this.aspectRatio<1&&(r=this.aspectRatio),i=r*this.blur*.12,this.horizontal?c[0]=i:c[1]=i,c}}),l.Blur.fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(a){var s=a.fabric||(a.fabric={}),l=s.Image.filters,u=s.util.createClass;l.Gamma=u(l.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(i){this.gamma=[1,1,1],l.BaseFilter.prototype.initialize.call(this,i)},applyTo2d:function(i){var r,c=i.imageData.data,p=this.gamma,d=c.length,f=1/p[0],m=1/p[1],S=1/p[2];for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),r=0,d=256;r<d;r++)this.rVals[r]=255*Math.pow(r/255,f),this.gVals[r]=255*Math.pow(r/255,m),this.bVals[r]=255*Math.pow(r/255,S);for(r=0,d=c.length;r<d;r+=4)c[r]=this.rVals[c[r]],c[r+1]=this.gVals[c[r+1]],c[r+2]=this.bVals[c[r+2]]},getUniformLocations:function(i,r){return{uGamma:i.getUniformLocation(r,"uGamma")}},sendUniformData:function(i,r){i.uniform3fv(r.uGamma,this.gamma)}}),s.Image.filters.Gamma.fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(a){var s=a.fabric||(a.fabric={}),l=s.Image.filters,u=s.util.createClass;l.Composed=u(l.BaseFilter,{type:"Composed",subFilters:[],initialize:function(i){this.callSuper("initialize",i),this.subFilters=this.subFilters.slice(0)},applyTo:function(i){i.passes+=this.subFilters.length-1,this.subFilters.forEach(function(r){r.applyTo(i)})},toObject:function(){return s.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(i){return i.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(i){return!i.isNeutralState()})}}),s.Image.filters.Composed.fromObject=function(i,r){var c=(i.subFilters||[]).map(function(d){return new s.Image.filters[d.type](d)}),p=new s.Image.filters.Composed({subFilters:c});return r&&r(p),p}}(t),function(a){var s=a.fabric||(a.fabric={}),l=s.Image.filters,u=s.util.createClass;l.HueRotation=u(l.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var i=this.rotation*Math.PI,r=s.util.cos(i),c=s.util.sin(i),p=1/3,d=Math.sqrt(p)*c,f=1-r;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=r+f/3,this.matrix[1]=p*f-d,this.matrix[2]=p*f+d,this.matrix[5]=p*f+d,this.matrix[6]=r+p*f,this.matrix[7]=p*f-d,this.matrix[10]=p*f-d,this.matrix[11]=p*f+d,this.matrix[12]=r+p*f},isNeutralState:function(i){return this.calculateMatrix(),l.BaseFilter.prototype.isNeutralState.call(this,i)},applyTo:function(i){this.calculateMatrix(),l.BaseFilter.prototype.applyTo.call(this,i)}}),s.Image.filters.HueRotation.fromObject=s.Image.filters.BaseFilter.fromObject}(t),function(a){var s=a.fabric||(a.fabric={}),l=s.util.object.clone;if(s.Text)s.warn("fabric.Text is already defined");else{var u="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");s.Text=s.util.createClass(s.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:s.Object.prototype.stateProperties.concat(u),cacheProperties:s.Object.prototype.cacheProperties.concat(u),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(i,r){this.styles=r&&r.styles||{},this.text=i,this.__skipDimension=!0,this.callSuper("initialize",r),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var i=this.path;i&&(i.segmentsInfo=s.util.getPathSegmentsInfo(i.path))},getMeasuringContext:function(){return s._measuringContext||(s._measuringContext=this.canvas&&this.canvas.contextCache||s.util.createCanvasElement().getContext("2d")),s._measuringContext},_splitText:function(){var i=this._splitTextIntoLines(this.text);return this.textLines=i.lines,this._textLines=i.graphemeLines,this._unwrappedTextLines=i._unwrappedLines,this._text=i.graphemeText,i},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var i,r,c,p,d,f,m,S=0,T=this._textLines.length;S<T;S++)if((this.textAlign==="justify"||S!==T-1&&!this.isEndOfWrapping(S))&&(p=0,d=this._textLines[S],(r=this.getLineWidth(S))<this.width&&(m=this.textLines[S].match(this._reSpacesAndTabs)))){c=m.length,i=(this.width-r)/c;for(var x=0,E=d.length;x<=E;x++)f=this.__charBounds[S][x],this._reSpaceAndTab.test(d[x])?(f.width+=i,f.kernedWidth+=i,f.left+=p,p+=i):f.left+=p}},isEndOfWrapping:function(i){return i===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var i=this.callSuper("_getCacheCanvasDimensions"),r=this.fontSize;return i.width+=r*i.zoomX,i.height+=r*i.zoomY,i},_render:function(i){var r=this.path;r&&!r.isNotVisible()&&r._render(i),this._setTextStyles(i),this._renderTextLinesBackground(i),this._renderTextDecoration(i,"underline"),this._renderText(i),this._renderTextDecoration(i,"overline"),this._renderTextDecoration(i,"linethrough")},_renderText:function(i){this.paintFirst==="stroke"?(this._renderTextStroke(i),this._renderTextFill(i)):(this._renderTextFill(i),this._renderTextStroke(i))},_setTextStyles:function(i,r,c){if(i.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":i.textBaseline="middle";break;case"ascender":i.textBaseline="top";break;case"descender":i.textBaseline="bottom"}i.font=this._getFontDeclaration(r,c)},calcTextWidth:function(){for(var i=this.getLineWidth(0),r=1,c=this._textLines.length;r<c;r++){var p=this.getLineWidth(r);p>i&&(i=p)}return i},_renderTextLine:function(i,r,c,p,d,f){this._renderChars(i,r,c,p,d,f)},_renderTextLinesBackground:function(i){if(this.textBackgroundColor||this.styleHas("textBackgroundColor")){for(var r,c,p,d,f,m,S,T=i.fillStyle,x=this._getLeftOffset(),E=this._getTopOffset(),O=0,P=0,j=this.path,W=0,z=this._textLines.length;W<z;W++)if(r=this.getHeightOfLine(W),this.textBackgroundColor||this.styleHas("textBackgroundColor",W)){p=this._textLines[W],c=this._getLineLeftOffset(W),P=0,O=0,d=this.getValueOfPropertyAt(W,0,"textBackgroundColor");for(var R=0,D=p.length;R<D;R++)f=this.__charBounds[W][R],m=this.getValueOfPropertyAt(W,R,"textBackgroundColor"),j?(i.save(),i.translate(f.renderLeft,f.renderTop),i.rotate(f.angle),i.fillStyle=m,m&&i.fillRect(-f.width/2,-r/this.lineHeight*(1-this._fontSizeFraction),f.width,r/this.lineHeight),i.restore()):m!==d?(S=x+c+O,this.direction==="rtl"&&(S=this.width-S-P),i.fillStyle=d,d&&i.fillRect(S,E,P,r/this.lineHeight),O=f.left,P=f.width,d=m):P+=f.kernedWidth;m&&!j&&(S=x+c+O,this.direction==="rtl"&&(S=this.width-S-P),i.fillStyle=m,i.fillRect(S,E,P,r/this.lineHeight)),E+=r}else E+=r;i.fillStyle=T,this._removeShadow(i)}},getFontCache:function(i){var r=i.fontFamily.toLowerCase();s.charWidthsCache[r]||(s.charWidthsCache[r]={});var c=s.charWidthsCache[r],p=i.fontStyle.toLowerCase()+"_"+(i.fontWeight+"").toLowerCase();return c[p]||(c[p]={}),c[p]},_measureChar:function(i,r,c,p){var d,f,m,S,T=this.getFontCache(r),x=c+i,E=this._getFontDeclaration(r)===this._getFontDeclaration(p),O=r.fontSize/this.CACHE_FONT_SIZE;if(c&&T[c]!==void 0&&(m=T[c]),T[i]!==void 0&&(S=d=T[i]),E&&T[x]!==void 0&&(S=(f=T[x])-m),d===void 0||m===void 0||f===void 0){var P=this.getMeasuringContext();this._setTextStyles(P,r,!0)}return d===void 0&&(S=d=P.measureText(i).width,T[i]=d),m===void 0&&E&&c&&(m=P.measureText(c).width,T[c]=m),E&&f===void 0&&(f=P.measureText(x).width,T[x]=f,S=f-m),{width:d*O,kernedWidth:S*O}},getHeightOfChar:function(i,r){return this.getValueOfPropertyAt(i,r,"fontSize")},measureLine:function(i){var r=this._measureLine(i);return this.charSpacing!==0&&(r.width-=this._getWidthOfCharSpacing()),r.width<0&&(r.width=0),r},_measureLine:function(i){var r,c,p,d,f,m,S=0,T=this._textLines[i],x=new Array(T.length),E=0,O=this.path,P=this.pathSide==="right";for(this.__charBounds[i]=x,r=0;r<T.length;r++)c=T[r],d=this._getGraphemeBox(c,i,r,p),x[r]=d,S+=d.kernedWidth,p=c;if(x[r]={left:d?d.left+d.width:0,width:0,kernedWidth:0,height:this.fontSize},O){switch(m=O.segmentsInfo[O.segmentsInfo.length-1].length,(f=s.util.getPointOnPath(O.path,0,O.segmentsInfo)).x+=O.pathOffset.x,f.y+=O.pathOffset.y,this.textAlign){case"left":E=P?m-S:0;break;case"center":E=(m-S)/2;break;case"right":E=P?0:m-S}for(E+=this.pathStartOffset*(P?-1:1),r=P?T.length-1:0;P?r>=0:r<T.length;P?r--:r++)d=x[r],E>m?E%=m:E<0&&(E+=m),this._setGraphemeOnPath(E,d,f),E+=d.kernedWidth}return{width:S,numOfSpaces:0}},_setGraphemeOnPath:function(i,r,c){var p=i+r.kernedWidth/2,d=this.path,f=s.util.getPointOnPath(d.path,p,d.segmentsInfo);r.renderLeft=f.x-c.x,r.renderTop=f.y-c.y,r.angle=f.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(i,r,c,p,d){var f,m=this.getCompleteStyleDeclaration(r,c),S=p?this.getCompleteStyleDeclaration(r,c-1):{},T=this._measureChar(i,m,p,S),x=T.kernedWidth,E=T.width;this.charSpacing!==0&&(E+=f=this._getWidthOfCharSpacing(),x+=f);var O={width:E,left:0,height:m.fontSize,kernedWidth:x,deltaY:m.deltaY};if(c>0&&!d){var P=this.__charBounds[r][c-1];O.left=P.left+P.width+T.kernedWidth-T.width}return O},getHeightOfLine:function(i){if(this.__lineHeights[i])return this.__lineHeights[i];for(var r=this._textLines[i],c=this.getHeightOfChar(i,0),p=1,d=r.length;p<d;p++)c=Math.max(this.getHeightOfChar(i,p),c);return this.__lineHeights[i]=c*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var i,r=0,c=0,p=this._textLines.length;c<p;c++)i=this.getHeightOfLine(c),r+=c===p-1?i/this.lineHeight:i;return r},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(i,r){i.save();for(var c=0,p=this._getLeftOffset(),d=this._getTopOffset(),f=0,m=this._textLines.length;f<m;f++){var S=this.getHeightOfLine(f),T=S/this.lineHeight,x=this._getLineLeftOffset(f);this._renderTextLine(r,i,this._textLines[f],p+x,d+c+T,f),c+=S}i.restore()},_renderTextFill:function(i){(this.fill||this.styleHas("fill"))&&this._renderTextCommon(i,"fillText")},_renderTextStroke:function(i){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(i),i.save(),this._setLineDash(i,this.strokeDashArray),i.beginPath(),this._renderTextCommon(i,"strokeText"),i.closePath(),i.restore())},_renderChars:function(i,r,c,p,d,f){var m,S,T,x,E,O=this.getHeightOfLine(f),P=this.textAlign.indexOf("justify")!==-1,j="",W=0,z=this.path,R=!P&&this.charSpacing===0&&this.isEmptyStyles(f)&&!z,D=this.direction==="ltr",M=this.direction==="ltr"?1:-1,L=r.canvas.getAttribute("dir");if(r.save(),L!==this.direction&&(r.canvas.setAttribute("dir",D?"ltr":"rtl"),r.direction=D?"ltr":"rtl",r.textAlign=D?"left":"right"),d-=O*this._fontSizeFraction/this.lineHeight,R)return this._renderChar(i,r,f,0,c.join(""),p,d,O),void r.restore();for(var B=0,U=c.length-1;B<=U;B++)x=B===U||this.charSpacing||z,j+=c[B],T=this.__charBounds[f][B],W===0?(p+=M*(T.kernedWidth-T.width),W+=T.width):W+=T.kernedWidth,P&&!x&&this._reSpaceAndTab.test(c[B])&&(x=!0),x||(m=m||this.getCompleteStyleDeclaration(f,B),S=this.getCompleteStyleDeclaration(f,B+1),x=this._hasStyleChanged(m,S)),x&&(z?(r.save(),r.translate(T.renderLeft,T.renderTop),r.rotate(T.angle),this._renderChar(i,r,f,B,j,-W/2,0,O),r.restore()):(E=p,this._renderChar(i,r,f,B,j,E,d,O)),j="",m=S,p+=M*W,W=0);r.restore()},_applyPatternGradientTransformText:function(i){var r,c=s.util.createCanvasElement(),p=this.width+this.strokeWidth,d=this.height+this.strokeWidth;return c.width=p,c.height=d,(r=c.getContext("2d")).beginPath(),r.moveTo(0,0),r.lineTo(p,0),r.lineTo(p,d),r.lineTo(0,d),r.closePath(),r.translate(p/2,d/2),r.fillStyle=i.toLive(r),this._applyPatternGradientTransform(r,i),r.fill(),r.createPattern(c,"no-repeat")},handleFiller:function(i,r,c){var p,d;return c.toLive?c.gradientUnits==="percentage"||c.gradientTransform||c.patternTransform?(p=-this.width/2,d=-this.height/2,i.translate(p,d),i[r]=this._applyPatternGradientTransformText(c),{offsetX:p,offsetY:d}):(i[r]=c.toLive(i,this),this._applyPatternGradientTransform(i,c)):(i[r]=c,{offsetX:0,offsetY:0})},_setStrokeStyles:function(i,r){return i.lineWidth=r.strokeWidth,i.lineCap=this.strokeLineCap,i.lineDashOffset=this.strokeDashOffset,i.lineJoin=this.strokeLineJoin,i.miterLimit=this.strokeMiterLimit,this.handleFiller(i,"strokeStyle",r.stroke)},_setFillStyles:function(i,r){return this.handleFiller(i,"fillStyle",r.fill)},_renderChar:function(i,r,c,p,d,f,m){var S,T,x=this._getStyleDeclaration(c,p),E=this.getCompleteStyleDeclaration(c,p),O=i==="fillText"&&E.fill,P=i==="strokeText"&&E.stroke&&E.strokeWidth;(P||O)&&(r.save(),O&&(S=this._setFillStyles(r,E)),P&&(T=this._setStrokeStyles(r,E)),r.font=this._getFontDeclaration(E),x&&x.textBackgroundColor&&this._removeShadow(r),x&&x.deltaY&&(m+=x.deltaY),O&&r.fillText(d,f-S.offsetX,m-S.offsetY),P&&r.strokeText(d,f-T.offsetX,m-T.offsetY),r.restore())},setSuperscript:function(i,r){return this._setScript(i,r,this.superscript)},setSubscript:function(i,r){return this._setScript(i,r,this.subscript)},_setScript:function(i,r,c){var p=this.get2DCursorLocation(i,!0),d=this.getValueOfPropertyAt(p.lineIndex,p.charIndex,"fontSize"),f=this.getValueOfPropertyAt(p.lineIndex,p.charIndex,"deltaY"),m={fontSize:d*c.size,deltaY:f+d*c.baseline};return this.setSelectionStyles(m,i,r),this},_hasStyleChanged:function(i,r){return i.fill!==r.fill||i.stroke!==r.stroke||i.strokeWidth!==r.strokeWidth||i.fontSize!==r.fontSize||i.fontFamily!==r.fontFamily||i.fontWeight!==r.fontWeight||i.fontStyle!==r.fontStyle||i.deltaY!==r.deltaY},_hasStyleChangedForSvg:function(i,r){return this._hasStyleChanged(i,r)||i.overline!==r.overline||i.underline!==r.underline||i.linethrough!==r.linethrough},_getLineLeftOffset:function(i){var r=this.getLineWidth(i),c=this.width-r,p=this.textAlign,d=this.direction,f=0,m=this.isEndOfWrapping(i);return p==="justify"||p==="justify-center"&&!m||p==="justify-right"&&!m||p==="justify-left"&&!m?0:(p==="center"&&(f=c/2),p==="right"&&(f=c),p==="justify-center"&&(f=c/2),p==="justify-right"&&(f=c),d==="rtl"&&(f-=c),f)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var i=this._forceClearCache;return i||(i=this.hasStateChanged("_dimensionAffectingProps")),i&&(this.dirty=!0,this._forceClearCache=!1),i},getLineWidth:function(i){if(this.__lineWidths[i]!==void 0)return this.__lineWidths[i];var r=this.measureLine(i).width;return this.__lineWidths[i]=r,r},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(i,r,c){var p=this._getStyleDeclaration(i,r);return p&&p[c]!==void 0?p[c]:this[c]},_renderTextDecoration:function(i,r){if(this[r]||this.styleHas(r)){for(var c,p,d,f,m,S,T,x,E,O,P,j,W,z,R,D,M=this._getLeftOffset(),L=this._getTopOffset(),B=this.path,U=this._getWidthOfCharSpacing(),H=this.offsets[r],k=0,F=this._textLines.length;k<F;k++)if(c=this.getHeightOfLine(k),this[r]||this.styleHas(r,k)){T=this._textLines[k],z=c/this.lineHeight,f=this._getLineLeftOffset(k),O=0,P=0,x=this.getValueOfPropertyAt(k,0,r),D=this.getValueOfPropertyAt(k,0,"fill"),E=L+z*(1-this._fontSizeFraction),p=this.getHeightOfChar(k,0),m=this.getValueOfPropertyAt(k,0,"deltaY");for(var N=0,X=T.length;N<X;N++)if(j=this.__charBounds[k][N],W=this.getValueOfPropertyAt(k,N,r),R=this.getValueOfPropertyAt(k,N,"fill"),d=this.getHeightOfChar(k,N),S=this.getValueOfPropertyAt(k,N,"deltaY"),B&&W&&R)i.save(),i.fillStyle=D,i.translate(j.renderLeft,j.renderTop),i.rotate(j.angle),i.fillRect(-j.kernedWidth/2,H*d+S,j.kernedWidth,this.fontSize/15),i.restore();else if((W!==x||R!==D||d!==p||S!==m)&&P>0){var Y=M+f+O;this.direction==="rtl"&&(Y=this.width-Y-P),x&&D&&(i.fillStyle=D,i.fillRect(Y,E+H*p+m,P,this.fontSize/15)),O=j.left,P=j.width,x=W,D=R,p=d,m=S}else P+=j.kernedWidth;Y=M+f+O,this.direction==="rtl"&&(Y=this.width-Y-P),i.fillStyle=R,W&&R&&i.fillRect(Y,E+H*p+m,P-U,this.fontSize/15),L+=c}else L+=c;this._removeShadow(i)}},_getFontDeclaration:function(i,r){var c=i||this,p=this.fontFamily,d=s.Text.genericFonts.indexOf(p.toLowerCase())>-1,f=p===void 0||p.indexOf("'")>-1||p.indexOf(",")>-1||p.indexOf('"')>-1||d?c.fontFamily:'"'+c.fontFamily+'"';return[s.isLikelyNode?c.fontWeight:c.fontStyle,s.isLikelyNode?c.fontStyle:c.fontWeight,r?this.CACHE_FONT_SIZE+"px":c.fontSize+"px",f].join(" ")},render:function(i){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",i)))},_splitTextIntoLines:function(i){for(var r=i.split(this._reNewline),c=new Array(r.length),p=[`
`],d=[],f=0;f<r.length;f++)c[f]=s.util.string.graphemeSplit(r[f]),d=d.concat(c[f],p);return d.pop(),{_unwrappedLines:c,lines:r,graphemeText:d,graphemeLines:c}},toObject:function(i){var r=u.concat(i),c=this.callSuper("toObject",r);return c.styles=l(this.styles,!0),c.path&&(c.path=this.path.toObject()),c},set:function(i,r){this.callSuper("set",i,r);var c=!1,p=!1;if(typeof i=="object")for(var d in i)d==="path"&&this.setPathInfo(),c=c||this._dimensionAffectingProps.indexOf(d)!==-1,p=p||d==="path";else c=this._dimensionAffectingProps.indexOf(i)!==-1,p=i==="path";return p&&this.setPathInfo(),c&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),s.Text.ATTRIBUTE_NAMES=s.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),s.Text.DEFAULT_SVG_FONT_SIZE=16,s.Text.fromElement=function(i,r,c){if(!i)return r(null);var p=s.parseAttributes(i,s.Text.ATTRIBUTE_NAMES),d=p.textAnchor||"left";if((c=s.util.object.extend(c?l(c):{},p)).top=c.top||0,c.left=c.left||0,p.textDecoration){var f=p.textDecoration;f.indexOf("underline")!==-1&&(c.underline=!0),f.indexOf("overline")!==-1&&(c.overline=!0),f.indexOf("line-through")!==-1&&(c.linethrough=!0),delete c.textDecoration}"dx"in p&&(c.left+=p.dx),"dy"in p&&(c.top+=p.dy),"fontSize"in c||(c.fontSize=s.Text.DEFAULT_SVG_FONT_SIZE);var m="";"textContent"in i?m=i.textContent:"firstChild"in i&&i.firstChild!==null&&"data"in i.firstChild&&i.firstChild.data!==null&&(m=i.firstChild.data),m=m.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var S=c.strokeWidth;c.strokeWidth=0;var T=new s.Text(m,c),x=T.getScaledHeight()/T.height,E=((T.height+T.strokeWidth)*T.lineHeight-T.height)*x,O=T.getScaledHeight()+E,P=0;d==="center"&&(P=T.getScaledWidth()/2),d==="right"&&(P=T.getScaledWidth()),T.set({left:T.left-P,top:T.top-(O-T.fontSize*(.07+T._fontSizeFraction))/T.lineHeight,strokeWidth:S!==void 0?S:1}),r(T)},s.Text.fromObject=function(i,r){var c=l(i),p=i.path;return delete c.path,s.Object._fromObject("Text",c,function(d){p?s.Object._fromObject("Path",p,function(f){d.set("path",f),r(d)},"path"):r(d)},"text")},s.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],s.util.createAccessors&&s.util.createAccessors(s.Text)}}(t),y.util.object.extend(y.Text.prototype,{isEmptyStyles:function(a){if(!this.styles||a!==void 0&&!this.styles[a])return!0;var s=a===void 0?this.styles:{line:this.styles[a]};for(var l in s)for(var u in s[l])for(var i in s[l][u])return!1;return!0},styleHas:function(a,s){if(!this.styles||!a||a===""||s!==void 0&&!this.styles[s])return!1;var l=s===void 0?this.styles:{0:this.styles[s]};for(var u in l)for(var i in l[u])if(l[u][i][a]!==void 0)return!0;return!1},cleanStyle:function(a){if(!this.styles||!a||a==="")return!1;var s,l,u=this.styles,i=0,r=!0,c=0;for(var p in u){for(var d in s=0,u[p]){var f;i++,(f=u[p][d]).hasOwnProperty(a)?(l?f[a]!==l&&(r=!1):l=f[a],f[a]===this[a]&&delete f[a]):r=!1,Object.keys(f).length!==0?s++:delete u[p][d]}s===0&&delete u[p]}for(var m=0;m<this._textLines.length;m++)c+=this._textLines[m].length;r&&i===c&&(this[a]=l,this.removeStyle(a))},removeStyle:function(a){if(this.styles&&a&&a!==""){var s,l,u,i=this.styles;for(l in i){for(u in s=i[l])delete s[u][a],Object.keys(s[u]).length===0&&delete s[u];Object.keys(s).length===0&&delete i[l]}}},_extendStyles:function(a,s){var l=this.get2DCursorLocation(a);this._getLineStyle(l.lineIndex)||this._setLineStyle(l.lineIndex),this._getStyleDeclaration(l.lineIndex,l.charIndex)||this._setStyleDeclaration(l.lineIndex,l.charIndex,{}),y.util.object.extend(this._getStyleDeclaration(l.lineIndex,l.charIndex),s)},get2DCursorLocation:function(a,s){a===void 0&&(a=this.selectionStart);for(var l=s?this._unwrappedTextLines:this._textLines,u=l.length,i=0;i<u;i++){if(a<=l[i].length)return{lineIndex:i,charIndex:a};a-=l[i].length+this.missingNewlineOffset(i)}return{lineIndex:i-1,charIndex:l[i-1].length<a?l[i-1].length:a}},getSelectionStyles:function(a,s,l){a===void 0&&(a=this.selectionStart||0),s===void 0&&(s=this.selectionEnd||a);for(var u=[],i=a;i<s;i++)u.push(this.getStyleAtPosition(i,l));return u},getStyleAtPosition:function(a,s){var l=this.get2DCursorLocation(a);return(s?this.getCompleteStyleDeclaration(l.lineIndex,l.charIndex):this._getStyleDeclaration(l.lineIndex,l.charIndex))||{}},setSelectionStyles:function(a,s,l){s===void 0&&(s=this.selectionStart||0),l===void 0&&(l=this.selectionEnd||s);for(var u=s;u<l;u++)this._extendStyles(u,a);return this._forceClearCache=!0,this},_getStyleDeclaration:function(a,s){var l=this.styles&&this.styles[a];return l?l[s]:null},getCompleteStyleDeclaration:function(a,s){for(var l,u=this._getStyleDeclaration(a,s)||{},i={},r=0;r<this._styleProperties.length;r++)i[l=this._styleProperties[r]]=u[l]===void 0?this[l]:u[l];return i},_setStyleDeclaration:function(a,s,l){this.styles[a][s]=l},_deleteStyleDeclaration:function(a,s){delete this.styles[a][s]},_getLineStyle:function(a){return!!this.styles[a]},_setLineStyle:function(a){this.styles[a]={}},_deleteLineStyle:function(a){delete this.styles[a]}}),function(){function a(s){s.textDecoration&&(s.textDecoration.indexOf("underline")>-1&&(s.underline=!0),s.textDecoration.indexOf("line-through")>-1&&(s.linethrough=!0),s.textDecoration.indexOf("overline")>-1&&(s.overline=!0),delete s.textDecoration)}y.IText=y.util.createClass(y.Text,y.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(s,l){this.callSuper("initialize",s,l),this.initBehavior()},setSelectionStart:function(s){s=Math.max(s,0),this._updateAndFire("selectionStart",s)},setSelectionEnd:function(s){s=Math.min(s,this.text.length),this._updateAndFire("selectionEnd",s)},_updateAndFire:function(s,l){this[s]!==l&&(this._fireSelectionChanged(),this[s]=l),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(s){this.clearContextTop(),this.callSuper("render",s),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(s){this.callSuper("_render",s)},clearContextTop:function(s){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var l=this.canvas.contextTop,u=this.canvas.viewportTransform;l.save(),l.transform(u[0],u[1],u[2],u[3],u[4],u[5]),this.transform(l),this._clearTextArea(l),s||l.restore()}},renderCursorOrSelection:function(){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var s=this._getCursorBoundaries(),l=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(s,l):this.renderSelection(s,l),l.restore()}},_clearTextArea:function(s){var l=this.width+4,u=this.height+4;s.clearRect(-l/2,-u/2,l,u)},_getCursorBoundaries:function(s){s===void 0&&(s=this.selectionStart);var l=this._getLeftOffset(),u=this._getTopOffset(),i=this._getCursorBoundariesOffsets(s);return{left:l,top:u,leftOffset:i.left,topOffset:i.top}},_getCursorBoundariesOffsets:function(s){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var l,u,i,r,c=0,p=0,d=this.get2DCursorLocation(s);i=d.charIndex,u=d.lineIndex;for(var f=0;f<u;f++)c+=this.getHeightOfLine(f);l=this._getLineLeftOffset(u);var m=this.__charBounds[u][i];return m&&(p=m.left),this.charSpacing!==0&&i===this._textLines[u].length&&(p-=this._getWidthOfCharSpacing()),r={top:c,left:l+(p>0?p:0)},this.direction==="rtl"&&(r.left*=-1),this.cursorOffsetCache=r,this.cursorOffsetCache},renderCursor:function(s,l){var u=this.get2DCursorLocation(),i=u.lineIndex,r=u.charIndex>0?u.charIndex-1:0,c=this.getValueOfPropertyAt(i,r,"fontSize"),p=this.scaleX*this.canvas.getZoom(),d=this.cursorWidth/p,f=s.topOffset,m=this.getValueOfPropertyAt(i,r,"deltaY");f+=(1-this._fontSizeFraction)*this.getHeightOfLine(i)/this.lineHeight-c*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(s,l),l.fillStyle=this.cursorColor||this.getValueOfPropertyAt(i,r,"fill"),l.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,l.fillRect(s.left+s.leftOffset-d/2,f+s.top+m,d,c)},renderSelection:function(s,l){for(var u=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,i=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,r=this.textAlign.indexOf("justify")!==-1,c=this.get2DCursorLocation(u),p=this.get2DCursorLocation(i),d=c.lineIndex,f=p.lineIndex,m=c.charIndex<0?0:c.charIndex,S=p.charIndex<0?0:p.charIndex,T=d;T<=f;T++){var x,E=this._getLineLeftOffset(T)||0,O=this.getHeightOfLine(T),P=0,j=0;if(T===d&&(P=this.__charBounds[d][m].left),T>=d&&T<f)j=r&&!this.isEndOfWrapping(T)?this.width:this.getLineWidth(T)||5;else if(T===f)if(S===0)j=this.__charBounds[f][S].left;else{var W=this._getWidthOfCharSpacing();j=this.__charBounds[f][S-1].left+this.__charBounds[f][S-1].width-W}x=O,(this.lineHeight<1||T===f&&this.lineHeight>1)&&(O/=this.lineHeight);var z=s.left+E+P,R=j-P,D=O,M=0;this.inCompositionMode?(l.fillStyle=this.compositionColor||"black",D=1,M=O):l.fillStyle=this.selectionColor,this.direction==="rtl"&&(z=this.width-z-R),l.fillRect(z,s.top+s.topOffset+M,R,D),s.topOffset+=x}},getCurrentCharFontSize:function(){var s=this._getCurrentCharIndex();return this.getValueOfPropertyAt(s.l,s.c,"fontSize")},getCurrentCharColor:function(){var s=this._getCurrentCharIndex();return this.getValueOfPropertyAt(s.l,s.c,"fill")},_getCurrentCharIndex:function(){var s=this.get2DCursorLocation(this.selectionStart,!0),l=s.charIndex>0?s.charIndex-1:0;return{l:s.lineIndex,c:l}}}),y.IText.fromObject=function(s,l){if(a(s),s.styles)for(var u in s.styles)for(var i in s.styles[u])a(s.styles[u][i]);y.Object._fromObject("IText",s,l,"text")}}(),ge=y.util.object.clone,y.util.object.extend(y.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var a=this;this.on("added",function(){var s=a.canvas;s&&(s._hasITextHandlers||(s._hasITextHandlers=!0,a._initCanvasHandlers(s)),s._iTextInstances=s._iTextInstances||[],s._iTextInstances.push(a))})},initRemovedHandler:function(){var a=this;this.on("removed",function(){var s=a.canvas;s&&(s._iTextInstances=s._iTextInstances||[],y.util.removeFromArray(s._iTextInstances,a),s._iTextInstances.length===0&&(s._hasITextHandlers=!1,a._removeCanvasHandlers(s)))})},_initCanvasHandlers:function(a){a._mouseUpITextHandler=function(){a._iTextInstances&&a._iTextInstances.forEach(function(s){s.__isMousedown=!1})},a.on("mouse:up",a._mouseUpITextHandler)},_removeCanvasHandlers:function(a){a.off("mouse:up",a._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(a,s,l,u){var i;return i={isAborted:!1,abort:function(){this.isAborted=!0}},a.animate("_currentCursorOpacity",s,{duration:l,onComplete:function(){i.isAborted||a[u]()},onChange:function(){a.canvas&&a.selectionStart===a.selectionEnd&&a.renderCursorOrSelection()},abort:function(){return i.isAborted}}),i},_onTickComplete:function(){var a=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){a._currentTickCompleteState=a._animateCursor(a,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(a){var s=this,l=a?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){s._tick()},l)},abortCursorAnimation:function(){var a=this._currentTickState||this._currentTickCompleteState,s=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,a&&s&&s.clearContext(s.contextTop||s.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(a){var s=0,l=a-1;if(this._reSpace.test(this._text[l]))for(;this._reSpace.test(this._text[l]);)s++,l--;for(;/\S/.test(this._text[l])&&l>-1;)s++,l--;return a-s},findWordBoundaryRight:function(a){var s=0,l=a;if(this._reSpace.test(this._text[l]))for(;this._reSpace.test(this._text[l]);)s++,l++;for(;/\S/.test(this._text[l])&&l<this._text.length;)s++,l++;return a+s},findLineBoundaryLeft:function(a){for(var s=0,l=a-1;!/\n/.test(this._text[l])&&l>-1;)s++,l--;return a-s},findLineBoundaryRight:function(a){for(var s=0,l=a;!/\n/.test(this._text[l])&&l<this._text.length;)s++,l++;return a+s},searchWordBoundary:function(a,s){for(var l=this._text,u=this._reSpace.test(l[a])?a-1:a,i=l[u],r=y.reNonWord;!r.test(i)&&u>0&&u<l.length;)i=l[u+=s];return r.test(i)&&(u+=s===1?0:1),u},selectWord:function(a){a=a||this.selectionStart;var s=this.searchWordBoundary(a,-1),l=this.searchWordBoundary(a,1);this.selectionStart=s,this.selectionEnd=l,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(a){a=a||this.selectionStart;var s=this.findLineBoundaryLeft(a),l=this.findLineBoundaryRight(a);return this.selectionStart=s,this.selectionEnd=l,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(a){if(!this.isEditing&&this.editable)return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(a),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(a){a._iTextInstances&&a._iTextInstances.forEach(function(s){s.selected=!1,s.isEditing&&s.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(a){if(this.__isMousedown&&this.isEditing){var s=this.getSelectionStartFromPointer(a.e),l=this.selectionStart,u=this.selectionEnd;(s===this.__selectionStartOnMouseDown&&l!==u||l!==s&&u!==s)&&(s>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=s):(this.selectionStart=s,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===l&&this.selectionEnd===u||(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(a,s,l){var u=l.slice(0,a),i=y.util.string.graphemeSplit(u).length;if(a===s)return{selectionStart:i,selectionEnd:i};var r=l.slice(a,s);return{selectionStart:i,selectionEnd:i+y.util.string.graphemeSplit(r).length}},fromGraphemeToStringSelection:function(a,s,l){var u=l.slice(0,a).join("").length;return a===s?{selectionStart:u,selectionEnd:u}:{selectionStart:u,selectionEnd:u+l.slice(a,s).join("").length}},_updateTextarea:function(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){var a=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=a.selectionStart,this.hiddenTextarea.selectionEnd=a.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var a=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=a.selectionEnd,this.inCompositionMode||(this.selectionStart=a.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var a=this._calcTextareaPosition();this.hiddenTextarea.style.left=a.left,this.hiddenTextarea.style.top=a.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var a=this.inCompositionMode?this.compositionStart:this.selectionStart,s=this._getCursorBoundaries(a),l=this.get2DCursorLocation(a),u=l.lineIndex,i=l.charIndex,r=this.getValueOfPropertyAt(u,i,"fontSize")*this.lineHeight,c=s.leftOffset,p=this.calcTransformMatrix(),d={x:s.left+c,y:s.top+s.topOffset+r},f=this.canvas.getRetinaScaling(),m=this.canvas.upperCanvasEl,S=m.width/f,T=m.height/f,x=S-r,E=T-r,O=m.clientWidth/S,P=m.clientHeight/T;return d=y.util.transformPoint(d,p),(d=y.util.transformPoint(d,this.canvas.viewportTransform)).x*=O,d.y*=P,d.x<0&&(d.x=0),d.x>x&&(d.x=x),d.y<0&&(d.y=0),d.y>E&&(d.y=E),d.x+=this.canvas._offset.left,d.y+=this.canvas._offset.top,{left:d.x+"px",top:d.y+"px",fontSize:r+"px",charHeight:r}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var a=this._textBeforeEdit!==this.text,s=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,s&&(s.blur&&s.blur(),s.parentNode&&s.parentNode.removeChild(s)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),a&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),a&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var a in this.styles)this._textLines[a]||delete this.styles[a]},removeStyleFromTo:function(a,s){var l,u,i=this.get2DCursorLocation(a,!0),r=this.get2DCursorLocation(s,!0),c=i.lineIndex,p=i.charIndex,d=r.lineIndex,f=r.charIndex;if(c!==d){if(this.styles[c])for(l=p;l<this._unwrappedTextLines[c].length;l++)delete this.styles[c][l];if(this.styles[d])for(l=f;l<this._unwrappedTextLines[d].length;l++)(u=this.styles[d][l])&&(this.styles[c]||(this.styles[c]={}),this.styles[c][p+l-f]=u);for(l=c+1;l<=d;l++)delete this.styles[l];this.shiftLineStyles(d,c-d)}else if(this.styles[c]){u=this.styles[c];var m,S,T=f-p;for(l=p;l<f;l++)delete u[l];for(S in this.styles[c])(m=parseInt(S,10))>=f&&(u[m-T]=u[S],delete u[S])}},shiftLineStyles:function(a,s){var l=ge(this.styles);for(var u in this.styles){var i=parseInt(u,10);i>a&&(this.styles[i+s]=l[i],l[i-s]||delete this.styles[i])}},restartCursorIfNeeded:function(){this._currentTickState&&!this._currentTickState.isAborted&&this._currentTickCompleteState&&!this._currentTickCompleteState.isAborted||this.initDelayedCursor()},insertNewlineStyleObject:function(a,s,l,u){var i,r={},c=!1,p=this._unwrappedTextLines[a].length===s;for(var d in l||(l=1),this.shiftLineStyles(a,l),this.styles[a]&&(i=this.styles[a][s===0?s:s-1]),this.styles[a]){var f=parseInt(d,10);f>=s&&(c=!0,r[f-s]=this.styles[a][d],p&&s===0||delete this.styles[a][d])}var m=!1;for(c&&!p&&(this.styles[a+l]=r,m=!0),m&&l--;l>0;)u&&u[l-1]?this.styles[a+l]={0:ge(u[l-1])}:i?this.styles[a+l]={0:ge(i)}:delete this.styles[a+l],l--;this._forceClearCache=!0},insertCharStyleObject:function(a,s,l,u){this.styles||(this.styles={});var i=this.styles[a],r=i?ge(i):{};for(var c in l||(l=1),r){var p=parseInt(c,10);p>=s&&(i[p+l]=r[p],r[p-l]||delete i[p])}if(this._forceClearCache=!0,u)for(;l--;)Object.keys(u[l]).length&&(this.styles[a]||(this.styles[a]={}),this.styles[a][s+l]=ge(u[l]));else if(i)for(var d=i[s?s-1:1];d&&l--;)this.styles[a][s+l]=ge(d)},insertNewStyleBlock:function(a,s,l){for(var u=this.get2DCursorLocation(s,!0),i=[0],r=0,c=0;c<a.length;c++)a[c]===`
`?i[++r]=0:i[r]++;for(i[0]>0&&(this.insertCharStyleObject(u.lineIndex,u.charIndex,i[0],l),l=l&&l.slice(i[0]+1)),r&&this.insertNewlineStyleObject(u.lineIndex,u.charIndex+i[0],r),c=1;c<r;c++)i[c]>0?this.insertCharStyleObject(u.lineIndex+c,0,i[c],l):l&&this.styles[u.lineIndex+c]&&l[0]&&(this.styles[u.lineIndex+c][0]=l[0]),l=l&&l.slice(i[c]+1);i[c]>0&&this.insertCharStyleObject(u.lineIndex+c,0,i[c],l)},setSelectionStartEndWithShift:function(a,s,l){l<=a?(s===a?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=a),this.selectionStart=l):l>a&&l<s?this._selectionDirection==="right"?this.selectionEnd=l:this.selectionStart=l:(s===a?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=s),this.selectionEnd=l)},setSelectionInBoundaries:function(){var a=this.text.length;this.selectionStart>a?this.selectionStart=a:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>a?this.selectionEnd=a:this.selectionEnd<0&&(this.selectionEnd=0)}}),y.util.object.extend(y.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(a){if(this.canvas){this.__newClickTime=+new Date;var s=a.pointer;this.isTripleClick(s)&&(this.fire("tripleclick",a),this._stopEvent(a.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=s,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(a){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===a.x&&this.__lastPointer.y===a.y},_stopEvent:function(a){a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(a){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(a.e))},tripleClickHandler:function(a){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(a.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(a){!this.canvas||!this.editable||a.e.button&&a.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(a.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(a){!this.canvas||!this.editable||a.e.button&&a.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(a){if(this.__isMousedown=!1,!(!this.editable||this.group||a.transform&&a.transform.actionPerformed||a.e.button&&a.e.button!==1)){if(this.canvas){var s=this.canvas._activeObject;if(s&&s!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(a.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(a){var s=this.getSelectionStartFromPointer(a),l=this.selectionStart,u=this.selectionEnd;a.shiftKey?this.setSelectionStartEndWithShift(l,u,s):(this.selectionStart=s,this.selectionEnd=s),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(a){for(var s,l=this.getLocalPointer(a),u=0,i=0,r=0,c=0,p=0,d=0,f=this._textLines.length;d<f&&r<=l.y;d++)r+=this.getHeightOfLine(d)*this.scaleY,p=d,d>0&&(c+=this._textLines[d-1].length+this.missingNewlineOffset(d-1));i=this._getLineLeftOffset(p)*this.scaleX,s=this._textLines[p],this.direction==="rtl"&&(l.x=this.width*this.scaleX-l.x+i);for(var m=0,S=s.length;m<S&&(u=i,(i+=this.__charBounds[p][m].kernedWidth*this.scaleX)<=l.x);m++)c++;return this._getNewSelectionStartFromOffset(l,u,i,c,S)},_getNewSelectionStartFromOffset:function(a,s,l,u,i){var r=a.x-s,c=l-a.x,p=u+(c>r||c<0?0:1);return this.flipX&&(p=i-p),p>this._text.length&&(p=this._text.length),p}}),y.util.object.extend(y.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=y.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var a=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+a.top+"; left: "+a.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding\uFF70top: "+a.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):y.document.body.appendChild(this.hiddenTextarea),y.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),y.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),y.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),y.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),y.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),y.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),y.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),y.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),y.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(y.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(a){if(this.isEditing){var s=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(a.keyCode in s)this[s[a.keyCode]](a);else{if(!(a.keyCode in this.ctrlKeysMapDown)||!a.ctrlKey&&!a.metaKey)return;this[this.ctrlKeysMapDown[a.keyCode]](a)}a.stopImmediatePropagation(),a.preventDefault(),a.keyCode>=33&&a.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(a){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:a.keyCode in this.ctrlKeysMapUp&&(a.ctrlKey||a.metaKey)&&(this[this.ctrlKeysMapUp[a.keyCode]](a),a.stopImmediatePropagation(),a.preventDefault(),this.canvas&&this.canvas.requestRenderAll())},onInput:function(a){var s=this.fromPaste;if(this.fromPaste=!1,a&&a.stopPropagation(),this.isEditing){var l,u,i,r,c,p=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,d=this._text.length,f=p.length,m=f-d,S=this.selectionStart,T=this.selectionEnd,x=S!==T;if(this.hiddenTextarea.value==="")return this.styles={},this.updateFromTextArea(),this.fire("changed"),void(this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll()));var E=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),O=S>E.selectionStart;x?(l=this._text.slice(S,T),m+=T-S):f<d&&(l=O?this._text.slice(T+m,T):this._text.slice(S,S-m)),u=p.slice(E.selectionEnd-m,E.selectionEnd),l&&l.length&&(u.length&&(i=this.getSelectionStyles(S,S+1,!1),i=u.map(function(){return i[0]})),x?(r=S,c=T):O?(r=T-l.length,c=T):(r=T,c=T+l.length),this.removeStyleFromTo(r,c)),u.length&&(s&&u.join("")===y.copiedText&&!y.disableStyleCopyPaste&&(i=y.copiedTextStyle),this.insertNewStyleBlock(u,S,i)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(a){this.compositionStart=a.target.selectionStart,this.compositionEnd=a.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(y.copiedText=this.getSelectedText(),y.disableStyleCopyPaste?y.copiedTextStyle=null:y.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(a){return a&&a.clipboardData||y.window.clipboardData},_getWidthBeforeCursor:function(a,s){var l,u=this._getLineLeftOffset(a);return s>0&&(u+=(l=this.__charBounds[a][s-1]).left+l.width),u},getDownCursorOffset:function(a,s){var l=this._getSelectionForOffset(a,s),u=this.get2DCursorLocation(l),i=u.lineIndex;if(i===this._textLines.length-1||a.metaKey||a.keyCode===34)return this._text.length-l;var r=u.charIndex,c=this._getWidthBeforeCursor(i,r),p=this._getIndexOnLine(i+1,c);return this._textLines[i].slice(r).length+p+1+this.missingNewlineOffset(i)},_getSelectionForOffset:function(a,s){return a.shiftKey&&this.selectionStart!==this.selectionEnd&&s?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(a,s){var l=this._getSelectionForOffset(a,s),u=this.get2DCursorLocation(l),i=u.lineIndex;if(i===0||a.metaKey||a.keyCode===33)return-l;var r=u.charIndex,c=this._getWidthBeforeCursor(i,r),p=this._getIndexOnLine(i-1,c),d=this._textLines[i].slice(0,r),f=this.missingNewlineOffset(i-1);return-this._textLines[i-1].length+p-d.length+(1-f)},_getIndexOnLine:function(a,s){for(var l,u,i=this._textLines[a],r=this._getLineLeftOffset(a),c=0,p=0,d=i.length;p<d;p++)if((r+=l=this.__charBounds[a][p].width)>s){u=!0;var f=r-l,m=r,S=Math.abs(f-s);c=Math.abs(m-s)<S?p:p-1;break}return u||(c=i.length-1),c},moveCursorDown:function(a){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",a)},moveCursorUp:function(a){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",a)},_moveCursorUpOrDown:function(a,s){var l=this["get"+a+"CursorOffset"](s,this._selectionDirection==="right");s.shiftKey?this.moveCursorWithShift(l):this.moveCursorWithoutShift(l),l!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(a){var s=this._selectionDirection==="left"?this.selectionStart+a:this.selectionEnd+a;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,s),a!==0},moveCursorWithoutShift:function(a){return a<0?(this.selectionStart+=a,this.selectionEnd=this.selectionStart):(this.selectionEnd+=a,this.selectionStart=this.selectionEnd),a!==0},moveCursorLeft:function(a){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",a)},_move:function(a,s,l){var u;if(a.altKey)u=this["findWordBoundary"+l](this[s]);else{if(!a.metaKey&&a.keyCode!==35&&a.keyCode!==36)return this[s]+=l==="Left"?-1:1,!0;u=this["findLineBoundary"+l](this[s])}if(typeof u!==void 0&&this[s]!==u)return this[s]=u,!0},_moveLeft:function(a,s){return this._move(a,s,"Left")},_moveRight:function(a,s){return this._move(a,s,"Right")},moveCursorLeftWithoutShift:function(a){var s=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(s=this._moveLeft(a,"selectionStart")),this.selectionEnd=this.selectionStart,s},moveCursorLeftWithShift:function(a){return this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd?this._moveLeft(a,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection="left",this._moveLeft(a,"selectionStart")):void 0},moveCursorRight:function(a){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",a)},_moveCursorLeftOrRight:function(a,s){var l="moveCursor"+a+"With";this._currentCursorOpacity=1,s.shiftKey?l+="Shift":l+="outShift",this[l](s)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(a){return this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd?this._moveRight(a,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection="right",this._moveRight(a,"selectionEnd")):void 0},moveCursorRightWithoutShift:function(a){var s=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(s=this._moveRight(a,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,s},removeChars:function(a,s){s===void 0&&(s=a+1),this.removeStyleFromTo(a,s),this._text.splice(a,s-a),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(a,s,l,u){u===void 0&&(u=l),u>l&&this.removeStyleFromTo(l,u);var i=y.util.string.graphemeSplit(a);this.insertNewStyleBlock(i,l,s),this._text=[].concat(this._text.slice(0,l),i,this._text.slice(u)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var a=y.util.toFixed,s=/  +/g;y.util.object.extend(y.Text.prototype,{_toSVG:function(){var l=this._getSVGLeftTopOffsets(),u=this._getSVGTextAndBg(l.textTop,l.textLeft);return this._wrapSVGTextAndBg(u)},toSVG:function(l){return this._createBaseSVGMarkup(this._toSVG(),{reviver:l,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(l){var u=this.getSvgTextDecoration(this);return[l.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",u?'text-decoration="'+u+'" ':"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",l.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(l,u){var i,r=[],c=[],p=l;this._setSVGBg(c);for(var d=0,f=this._textLines.length;d<f;d++)i=this._getLineLeftOffset(d),(this.textBackgroundColor||this.styleHas("textBackgroundColor",d))&&this._setSVGTextLineBg(c,d,u+i,p),this._setSVGTextLineText(r,d,u+i,p),p+=this.getHeightOfLine(d);return{textSpans:r,textBgRects:c}},_createTextCharSpan:function(l,u,i,r){var c=l!==l.trim()||l.match(s),p=this.getSvgSpanStyles(u,c),d=p?'style="'+p+'"':"",f=u.deltaY,m="",S=y.Object.NUM_FRACTION_DIGITS;return f&&(m=' dy="'+a(f,S)+'" '),['<tspan x="',a(i,S),'" y="',a(r,S),'" ',m,d,">",y.util.string.escapeXml(l),"</tspan>"].join("")},_setSVGTextLineText:function(l,u,i,r){var c,p,d,f,m,S=this.getHeightOfLine(u),T=this.textAlign.indexOf("justify")!==-1,x="",E=0,O=this._textLines[u];r+=S*(1-this._fontSizeFraction)/this.lineHeight;for(var P=0,j=O.length-1;P<=j;P++)m=P===j||this.charSpacing,x+=O[P],d=this.__charBounds[u][P],E===0?(i+=d.kernedWidth-d.width,E+=d.width):E+=d.kernedWidth,T&&!m&&this._reSpaceAndTab.test(O[P])&&(m=!0),m||(c=c||this.getCompleteStyleDeclaration(u,P),p=this.getCompleteStyleDeclaration(u,P+1),m=this._hasStyleChangedForSvg(c,p)),m&&(f=this._getStyleDeclaration(u,P)||{},l.push(this._createTextCharSpan(x,f,i,r)),x="",c=p,i+=E,E=0)},_pushTextBgRect:function(l,u,i,r,c,p){var d=y.Object.NUM_FRACTION_DIGITS;l.push("		<rect ",this._getFillAttributes(u),' x="',a(i,d),'" y="',a(r,d),'" width="',a(c,d),'" height="',a(p,d),`"></rect>
`)},_setSVGTextLineBg:function(l,u,i,r){for(var c,p,d=this._textLines[u],f=this.getHeightOfLine(u)/this.lineHeight,m=0,S=0,T=this.getValueOfPropertyAt(u,0,"textBackgroundColor"),x=0,E=d.length;x<E;x++)c=this.__charBounds[u][x],(p=this.getValueOfPropertyAt(u,x,"textBackgroundColor"))!==T?(T&&this._pushTextBgRect(l,T,i+S,r,m,f),S=c.left,m=c.width,T=p):m+=c.kernedWidth;p&&this._pushTextBgRect(l,p,i+S,r,m,f)},_getFillAttributes:function(l){var u=l&&typeof l=="string"?new y.Color(l):"";return u&&u.getSource()&&u.getAlpha()!==1?'opacity="'+u.getAlpha()+'" fill="'+u.setAlpha(1).toRgb()+'"':'fill="'+l+'"'},_getSVGLineTopOffset:function(l){for(var u,i=0,r=0;r<l;r++)i+=this.getHeightOfLine(r);return u=this.getHeightOfLine(r),{lineTop:i,offset:(this._fontSizeMult-this._fontSizeFraction)*u/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(l){return y.Object.prototype.getSvgStyles.call(this,l)+" white-space: pre;"}})}(),function(a){var s=a.fabric||(a.fabric={});s.Textbox=s.util.createClass(s.IText,s.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:s.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(l){for(var u=0,i=0,r=0,c={},p=0;p<l.graphemeLines.length;p++)l.graphemeText[r]===`
`&&p>0?(i=0,r++,u++):!this.splitByGrapheme&&this._reSpaceAndTab.test(l.graphemeText[r])&&p>0&&(i++,r++),c[p]={line:u,offset:i},r+=l.graphemeLines[p].length,i+=l.graphemeLines[p].length;return c},styleHas:function(l,u){if(this._styleMap&&!this.isWrapping){var i=this._styleMap[u];i&&(u=i.line)}return s.Text.prototype.styleHas.call(this,l,u)},isEmptyStyles:function(l){if(!this.styles)return!0;var u,i,r=0,c=!1,p=this._styleMap[l],d=this._styleMap[l+1];for(var f in p&&(l=p.line,r=p.offset),d&&(c=d.line===l,u=d.offset),i=l===void 0?this.styles:{line:this.styles[l]})for(var m in i[f])if(m>=r&&(!c||m<u))for(var S in i[f][m])return!1;return!0},_getStyleDeclaration:function(l,u){if(this._styleMap&&!this.isWrapping){var i=this._styleMap[l];if(!i)return null;l=i.line,u=i.offset+u}return this.callSuper("_getStyleDeclaration",l,u)},_setStyleDeclaration:function(l,u,i){var r=this._styleMap[l];l=r.line,u=r.offset+u,this.styles[l][u]=i},_deleteStyleDeclaration:function(l,u){var i=this._styleMap[l];l=i.line,u=i.offset+u,delete this.styles[l][u]},_getLineStyle:function(l){var u=this._styleMap[l];return!!this.styles[u.line]},_setLineStyle:function(l){var u=this._styleMap[l];this.styles[u.line]={}},_wrapText:function(l,u){var i,r=[];for(this.isWrapping=!0,i=0;i<l.length;i++)r=r.concat(this._wrapLine(l[i],i,u));return this.isWrapping=!1,r},_measureWord:function(l,u,i){var r,c=0;i=i||0;for(var p=0,d=l.length;p<d;p++)c+=this._getGraphemeBox(l[p],u,p+i,r,!0).kernedWidth,r=l[p];return c},_wrapLine:function(l,u,i,r){var c=0,p=this.splitByGrapheme,d=[],f=[],m=p?s.util.string.graphemeSplit(l):l.split(this._wordJoiners),S="",T=0,x=p?"":" ",E=0,O=0,P=0,j=!0,W=this._getWidthOfCharSpacing();r=r||0,m.length===0&&m.push([]),i-=r;for(var z=0;z<m.length;z++)S=p?m[z]:s.util.string.graphemeSplit(m[z]),E=this._measureWord(S,u,T),T+=S.length,(c+=O+E-W)>i&&!j?(d.push(f),f=[],c=E,j=!0):c+=W,j||p||f.push(x),f=f.concat(S),O=p?0:this._measureWord([x],u,T),T++,j=!1,E>P&&(P=E);return z&&d.push(f),P+r>this.dynamicMinWidth&&(this.dynamicMinWidth=P-W+r),d},isEndOfWrapping:function(l){return!this._styleMap[l+1]||this._styleMap[l+1].line!==this._styleMap[l].line},missingNewlineOffset:function(l){return this.splitByGrapheme?this.isEndOfWrapping(l)?1:0:1},_splitTextIntoLines:function(l){for(var u=s.Text.prototype._splitTextIntoLines.call(this,l),i=this._wrapText(u.lines,this.width),r=new Array(i.length),c=0;c<i.length;c++)r[c]=i[c].join("");return u.lines=r,u.graphemeLines=i,u},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var l={};for(var u in this._styleMap)this._textLines[u]&&(l[this._styleMap[u].line]=1);for(var u in this.styles)l[u]||delete this.styles[u]},toObject:function(l){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(l))}}),s.Textbox.fromObject=function(l,u){return s.Object._fromObject("Textbox",l,u,"text")}}(t),function(){var a=y.controlsUtils,s=a.scaleSkewCursorStyleHandler,l=a.scaleCursorStyleHandler,u=a.scalingEqually,i=a.scalingYOrSkewingX,r=a.scalingXOrSkewingY,c=a.scaleOrSkewActionName,p=y.Object.prototype.controls;if(p.ml=new y.Control({x:-.5,y:0,cursorStyleHandler:s,actionHandler:r,getActionName:c}),p.mr=new y.Control({x:.5,y:0,cursorStyleHandler:s,actionHandler:r,getActionName:c}),p.mb=new y.Control({x:0,y:.5,cursorStyleHandler:s,actionHandler:i,getActionName:c}),p.mt=new y.Control({x:0,y:-.5,cursorStyleHandler:s,actionHandler:i,getActionName:c}),p.tl=new y.Control({x:-.5,y:-.5,cursorStyleHandler:l,actionHandler:u}),p.tr=new y.Control({x:.5,y:-.5,cursorStyleHandler:l,actionHandler:u}),p.bl=new y.Control({x:-.5,y:.5,cursorStyleHandler:l,actionHandler:u}),p.br=new y.Control({x:.5,y:.5,cursorStyleHandler:l,actionHandler:u}),p.mtr=new y.Control({x:0,y:-.5,actionHandler:a.rotationWithSnapping,cursorStyleHandler:a.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),y.Textbox){var d=y.Textbox.prototype.controls={};d.mtr=p.mtr,d.tr=p.tr,d.br=p.br,d.tl=p.tl,d.bl=p.bl,d.mt=p.mt,d.mb=p.mb,d.mr=new y.Control({x:.5,y:0,actionHandler:a.changeWidth,cursorStyleHandler:s,actionName:"resizing"}),d.ml=new y.Control({x:-.5,y:0,actionHandler:a.changeWidth,cursorStyleHandler:s,actionName:"resizing"})}}()},192:()=>{},898:()=>{},245:()=>{}},Cs={};function Ht(e){var t=Cs[e];if(t!==void 0)return t.exports;var n=Cs[e]={exports:{}};return Gh[e](n,n.exports,Ht),n.exports}Ht.d=(e,t)=>{for(var n in t)Ht.o(t,n)&&!Ht.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},Ht.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var Oa={};(()=>{let e;Ht.d(Oa,{R:()=>e}),e=typeof document<"u"&&typeof window<"u"?Ht(653).fabric:{version:"5.2.1"}})();var xe=Oa.R;/*!
 * Dynamsoft JavaScript Library
 * @product Dynamsoft Camera Enhancer JS Edition
 * @website https://www.dynamsoft.com
 * @copyright Copyright 2022, Dynamsoft Corporation
 * @author Dynamsoft
 * @version 3.0.1 (js 20220803)
 * @fileoverview Dynamsoft JavaScript Library for Camera Enhancer
 * More info on DCE JS: https://www.dynamsoft.com/camera-enhancer/docs/programming/javascript/?ver=latest
 */function Te(e,t,n,o){return new(n||(n=Promise))(function(h,g){function _(C){try{b(o.next(C))}catch(w){g(w)}}function v(C){try{b(o.throw(C))}catch(w){g(w)}}function b(C){var w;C.done?h(C.value):(w=C.value,w instanceof n?w:new n(function(I){I(w)})).then(_,v)}b((o=o.apply(e,t||[])).next())})}const Dn=typeof self>"u";let Zt,qe,Ki,pn,ke;if(typeof navigator<"u"&&(Zt=navigator,qe=Zt.userAgent,Ki=Zt.platform,pn=Zt.mediaDevices),!Dn){const e={init:function(){this.browser=this.searchString(this.dataBrowser)||"unknownBrowser",this.version=this.searchVersion(qe)||this.searchVersion(Zt.appVersion)||0,this.OS=this.searchString(this.dataOS)||"unknownOS",this.OS=="Linux"&&qe.indexOf("Windows NT")!=-1&&(this.OS="HarmonyOS")},searchString:function(t){for(let n=0;n<t.length;n++){let o=t[n].string,h=t[n].prop;if(this.versionSearchString=t[n].versionSearch||t[n].identity,o){if(o.indexOf(t[n].subString)!=-1)return t[n].identity}else if(h)return t[n].identity}},searchVersion:function(t){let n=t.indexOf(this.versionSearchString);if(n!=-1)return parseFloat(t.substring(n+this.versionSearchString.length+1))},dataBrowser:[{string:qe,subString:"Edge",identity:"Edge"},{string:qe,subString:"OPR",identity:"OPR"},{string:qe,subString:"Chrome",identity:"Chrome"},{string:Zt.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{string:qe,subString:"Firefox",identity:"Firefox"},{string:qe,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"}],dataOS:[{string:qe,subString:"HarmonyOS",identity:"HarmonyOS"},{string:qe,subString:"Android",identity:"Android"},{string:qe,subString:"iPhone",identity:"iPhone"},{string:Ki,subString:"Win",identity:"Windows"},{string:Ki,subString:"Mac",identity:"Mac"},{string:Ki,subString:"Linux",identity:"Linux"}]};e.init(),ke={browser:e.browser,version:e.version,OS:e.OS}}Dn&&(ke={browser:"ssr",version:0,OS:"ssr"});const Wh=typeof WebAssembly<"u"&&qe&&!(/Safari/.test(qe)&&!/Chrome/.test(qe)&&/\(.+\s11_2_([2-6]).*\)/.test(qe)),Hh=!(typeof Worker>"u"),Ra=!(!pn||!pn.getUserMedia),Yh=async()=>{let e=!1;if(Ra)try{(await pn.getUserMedia({video:!0})).getTracks().forEach(t=>{t.stop()}),e=!0}catch{}return e};ke.browser==="Chrome"&&ke.version>66||ke.browser==="Safari"&&ke.version>13||ke.browser==="OPR"&&ke.version>43||ke.browser==="Edge"&&ke.version;const Xh=(()=>{if(!Dn&&document.currentScript){let e=document.currentScript.src,t=e.indexOf("?");if(t!=-1)e=e.substring(0,t);else{let n=e.indexOf("#");n!=-1&&(e=e.substring(0,n))}return e.substring(0,e.lastIndexOf("/")+1)}return"./"})();class Ge{constructor(t,n){this._zIndex=null,this._drawingLayer=null,this._drawingLayerId=null,this._mapStyle=new Map,this.mapEvents=new Map([["select",[]],["deselect",[]]]),this.isDrawingItem=!0,this._setFabricObject(t),this._mediaType=t.type,this.styleSelector="default",this.styleId=n;for(let o of Ge.arrStyleSelectors)this._mapStyle.set(o,null)}get mediaType(){return this._mediaType}get drawingLayerId(){return this._drawingLayerId}_setFabricObject(t){this._fabricObject=t;const n=this.mapEvents;this._fabricObject.onSelect=()=>{this.styleSelector="selected";const o=this.mapEvents.get("select");for(let h of o)h&&h.apply(this)},this._fabricObject.onDeselect=()=>{this.styleSelector="default";const o=n.get("deselect");for(let h of o)h&&h.apply(this)},t.getDrawingItem=()=>this}_getFabricObject(){return this._fabricObject}on(t,n,o){const h=this.mapEvents.get(t);h.includes(n)||h.push(n)}off(t,n){const o=this.mapEvents.get(t),h=o.indexOf(n);h!==-1&&o.splice(h,1)}_setEditable(t){const n=this._fabricObject;t?(n.selectable=!0,n.evented=!0,n.hasControls=!0):(n.selectable=!1,n.evented=!1,n.hasControls=!1)}_extendSet(t,n){return!1}_extendGet(t){}set(t,n){this._extendSet(t,n)||(t==="x"?this._fabricObject.set("left",n):t==="y"?this._fabricObject.set("top",n):this._fabricObject.set(t,n)),["vertices","left","top","width","height","scaleX","scaleY","skewX","skewY","padding","angle","strokeWidth"].includes(t)&&this._fabricObject.setCoords()}get(t){let n=this._extendGet(t);return n===void 0&&(n=t==="x"?this._fabricObject.get("left"):t==="y"?this._fabricObject.get("top"):this._fabricObject.get(t)),n}}function ws(e,t,n){let o=n.points[this.pointIndex].x-n.pathOffset.x,h=n.points[this.pointIndex].y-n.pathOffset.y;return xe.util.transformPoint({x:o,y:h},xe.util.multiplyTransformMatrices(n.canvas.viewportTransform,n.calcTransformMatrix()))}function Da(e){let t=new xe.Point(e.strokeUniform?1/e.scaleX:1,e.strokeUniform?1/e.scaleY:1).multiply(e.strokeWidth);return new xe.Point(e.width+t.x,e.height+t.y)}function Ts(e,t,n,o){let h=t.target,g=h.controls[h.__corner],_=h.toLocalPoint(new xe.Point(n,o),"center","center"),v=Da(h),b=h._getTransformedDimensions(0,0),C={x:_.x*v.x/b.x+h.pathOffset.x,y:_.y*v.y/b.y+h.pathOffset.y};return h.points[g.pointIndex]=C,!0}function xs(e,t){return function(n,o,h,g){let _=o.target,v=xe.util.transformPoint({x:_.points[e].x-_.pathOffset.x,y:_.points[e].y-_.pathOffset.y},_.calcTransformMatrix()),b=t(n,o,h,g);_._setPositionDimensions({});let C=Da(_),w=(_.points[e].x-_.pathOffset.x)/C.x,I=(_.points[e].y-_.pathOffset.y)/C.y;return _.setPositionByOrigin(v,w+.5,I+.5),b}}Ge.arrMediaTypes=["rect","arc","polygon","image","text","line","path"],Ge.arrStyleSelectors=["default","selected"],typeof document<"u"&&typeof window<"u"&&(xe.StaticCanvas.prototype.dispose=function(){return this.isRendering&&(xe.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(e){e.dispose&&e.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),xe.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},xe.Object.prototype.transparentCorners=!1,xe.Object.prototype.cornerSize=20,xe.Object.prototype.touchCornerSize=100,xe.Object.prototype.cornerColor="rgb(254,142,20)",xe.Object.prototype.cornerStyle="circle",xe.Object.prototype.strokeUniform=!0,xe.Object.prototype.hasBorders=!1,xe.ActiveSelection.prototype.onDeselect=function(){return this.getObjects().forEach(e=>{setTimeout(e.onDeselect,0)}),this.destroy(),!1},xe.Canvas.prototype.containerClass="",xe.Canvas.prototype.getPointer=function(e,t){if(this._absolutePointer&&!t)return this._absolutePointer;if(this._pointer&&t)return this._pointer;var n,o=this.upperCanvasEl,h=xe.util.getPointer(e,o),g=o.getBoundingClientRect(),_=g.width||0,v=g.height||0;_&&v||("top"in g&&"bottom"in g&&(v=Math.abs(g.top-g.bottom)),"right"in g&&"left"in g&&(_=Math.abs(g.right-g.left))),this.calcOffset(),h.x=h.x-this._offset.left,h.y=h.y-this._offset.top,t||(h=this.restorePointerVpt(h));var b=this.getRetinaScaling();if(b!==1&&(h.x/=b,h.y/=b),_!==0&&v!==0){var C=window.getComputedStyle(o).objectFit,w=o.width,I=o.height,A=_,V=v;n={width:w/A,height:I/V};var J,q,K=w/I,Z=A/V;return C==="contain"?K>Z?(J=A,q=A/K,{x:h.x*n.width,y:(h.y-(V-q)/2)*n.width}):(J=V*K,q=V,{x:(h.x-(A-J)/2)*n.height,y:h.y*n.height}):C==="cover"?K>Z?{x:(w-n.height*A)/2+h.x*n.height,y:h.y*n.height}:{x:h.x*n.width,y:(I-n.width*V)/2+h.y*n.width}:{x:h.x*n.width,y:h.y*n.height}}return n={width:1,height:1},{x:h.x*n.width,y:h.y*n.height}});class zh{constructor(t,n,o,h){let g,_;switch(this.mapMediaType_Style=new Map,this.mode="viewer",this.onSelectionChange=null,this._arrDrwaingItem=[],this._arrFabricObject=[],this._visible=!0,t.hasOwnProperty("getFabricCanvas")?this.fabricCanvas=t.getFabricCanvas():(this.fabricCanvas=new xe.Canvas(t,h),this.fabricCanvas.setDimensions({width:"100%",height:"100%"},{cssOnly:!0}),this.fabricCanvas.lowerCanvasEl.className="",this.fabricCanvas.upperCanvasEl.className="",this.fabricCanvas.on("selection:created",function(v){const b=v.selected,C=[];for(let w of b){const I=w.getDrawingItem()._drawingLayer;I&&!C.includes(I)&&C.push(I)}for(let w of C){const I=[];for(let A of b){const V=A.getDrawingItem();V._drawingLayer===w&&I.push(V)}setTimeout(()=>{w.onSelectionChange&&w.onSelectionChange(I,[])},0)}}),this.fabricCanvas.on("before:selection:cleared",function(v){const b=this.getActiveObjects(),C=[];for(let w of b){const I=w.getDrawingItem()._drawingLayer;I&&!C.includes(I)&&C.push(I)}for(let w of C){const I=[];for(let A of b){const V=A.getDrawingItem();V._drawingLayer===w&&I.push(V)}setTimeout(()=>{const A=[];for(let V of I)w.hasDrawingItem(V)&&A.push(V);A.length>0&&w.onSelectionChange&&w.onSelectionChange([],A)},0)}}),this.fabricCanvas.on("selection:updated",function(v){const b=v.selected,C=v.deselected,w=[];for(let I of b){const A=I.getDrawingItem()._drawingLayer;A&&!w.includes(A)&&w.push(A)}for(let I of C){const A=I.getDrawingItem()._drawingLayer;A&&!w.includes(A)&&w.push(A)}for(let I of w){const A=[],V=[];for(let J of b){const q=J.getDrawingItem();q._drawingLayer===I&&A.push(q)}for(let J of C){const q=J.getDrawingItem();q._drawingLayer===I&&V.push(q)}setTimeout(()=>{I.onSelectionChange&&I.onSelectionChange(A,V)},0)}}),this.fabricCanvas.wrapperEl.style.position="absolute",t.getFabricCanvas=()=>this.fabricCanvas),this.id=n,this._mapDrawingStyles=o,n){case 1:g=o.get(1),_=o.get(5);break;case 2:g=o.get(2),_=o.get(6);break;case 3:g=o.get(3),_=o.get(7);break;default:g=o.get(4),_=o.get(8)}for(let v of Ge.arrMediaTypes)this.mapMediaType_Style.set(v,{default:g,selected:_})}getId(){return this.id}_getDrawingStyle(t,n){if(typeof t!="number")throw new Error("Invalid style id.");const o=this._mapDrawingStyles.get(t);return o?n?JSON.parse(JSON.stringify(o)):o:null}setVisible(t){if(t){for(let n of this._arrFabricObject)n.visible=!0;this._visible=!0}else{for(let n of this._arrFabricObject)n.visible=!1;this._visible=!1}this.fabricCanvas.renderAll()}isVisible(){return this._visible}_getItemCurrentStyleId(t){return t.styleId?t.styleId:this.mapMediaType_Style.get(t._mediaType)[t.styleSelector].styleId}_getItemCurrentStyle(t){return t.styleId?this._getDrawingStyle(t.styleId):t._mapStyle.get(t.styleSelector)||null}_changeMediaTypeCurStyleInStyleSelector(t,n,o,h){let g;switch(t){case"rect":g=this.fabricCanvas.getObjects("rect");break;case"arc":g=this.fabricCanvas.getObjects("circle");break;case"polygon":g=this.fabricCanvas.getObjects("polygon");break;case"image":g=this.fabricCanvas.getObjects("image");break;case"text":g=this.fabricCanvas.getObjects("text");break;case"line":g=this.fabricCanvas.getObjects("line");break;case"path":g=this.fabricCanvas.getObjects("path")}for(let _ of g){if(!this._arrFabricObject.includes(_))continue;const v=_.getDrawingItem();v.styleSelector===n&&this._changeItemStyle(v,o,!0)}h||this.fabricCanvas.renderAll()}_changeItemStyle(t,n,o){if(!t||!n)return;const h=t._getFabricObject();typeof t.styleId=="number"&&(n=this._getDrawingStyle(t.styleId)),h.strokeWidth=n.lineWidth,n.paintMode==="fill"?(h.fill=n.fillStyle,h.stroke=n.fillStyle):n.paintMode==="stroke"?(h.fill="transparent",h.stroke=n.strokeStyle):n.paintMode==="strokeAndFill"&&(h.fill=n.fillStyle,h.stroke=n.strokeStyle),h.fontFamily&&(h.fontFamily=n.fontFamily),h.fontSize&&(h.fontSize=n.fontSize),h.group||(h.dirty=!0),o||this.fabricCanvas.renderAll()}_updateGroupItem(t,n,o){if(!t||!n)return;const h=t.getChildItems();if(o==="add"){if(h.includes(n))return;const g=n._getFabricObject();if(this.fabricCanvas.getObjects().includes(g)){if(!this._arrFabricObject.includes(g))throw new Error("Existed in other drawing layers.");n._zIndex=null}else{let _;if(n.styleId)_=this._getDrawingStyle(n.styleId);else{_=this.mapMediaType_Style.get(n._mediaType)[t.styleSelector];const v=()=>{this._changeItemStyle(n,this.mapMediaType_Style.get(n._mediaType).selected,!0)},b=()=>{this._changeItemStyle(n,this.mapMediaType_Style.get(n._mediaType).default,!0)};n.on("select",v),n.on("deselect",b),n._funcChangeStyleToSelected=v,n._funcChangeStyleToDefault=b}n._drawingLayer=this,n._drawingLayerId=this.id,this._changeItemStyle(n,_,!0)}t._fabricObject.addWithUpdate(n._getFabricObject())}else{if(o!=="remove"||!h.includes(n))return;n._zIndex=null,n._drawingLayer=null,n._drawingLayerId=null,n.off("select",n._funcChangeStyleToSelected),n.off("deselect",n._funcChangeStyleToDefault),n._funcChangeStyleToSelected=null,n._funcChangeStyleToDefault=null,t._fabricObject.removeWithUpdate(n._getFabricObject())}this.fabricCanvas.renderAll()}_addDrawingItem(t,n){let o=t._getFabricObject();const h=this.fabricCanvas.getObjects();let g,_;if(h.includes(o)){if(this._arrFabricObject.includes(o))return;throw new Error("Existed in other drawing layers.")}if(t._mediaType==="group"){g=t.getChildItems();for(let C of g)if(C._drawingLayer&&C._drawingLayer!==this)throw new Error("The childItems of DT_Group have existed in other drawing layers.")}if(n&&typeof n=="object"&&!Array.isArray(n))for(let C in n)o.set(C,n[C]);if(g){for(let C of g){if(C.styleId)_=this._getDrawingStyle(C.styleId);else{const w=this.mapMediaType_Style.get(C._mediaType);for(let V of Ge.arrStyleSelectors)C._mapStyle.set(V,w[V]);_=w.default;const I=()=>{this._changeItemStyle(C,this.mapMediaType_Style.get(C._mediaType).selected,!0)},A=()=>{this._changeItemStyle(C,this.mapMediaType_Style.get(C._mediaType).default,!0)};C.on("select",I),C.on("deselect",A),C._funcChangeStyleToSelected=I,C._funcChangeStyleToDefault=A}C._drawingLayer=this,C._drawingLayerId=this.id,this._changeItemStyle(C,_,!0)}o.dirty=!0,this.fabricCanvas.renderAll()}else{if(t.styleId)_=this._getDrawingStyle(t.styleId);else{const C=this.mapMediaType_Style.get(t._mediaType);for(let A of Ge.arrStyleSelectors)t._mapStyle.set(A,C[A]);_=C.default;const w=()=>{this._changeItemStyle(t,this.mapMediaType_Style.get(t._mediaType).selected)},I=()=>{this._changeItemStyle(t,this.mapMediaType_Style.get(t._mediaType).default)};t.on("select",w),t.on("deselect",I),t._funcChangeStyleToSelected=w,t._funcChangeStyleToDefault=I}this._changeItemStyle(t,_)}t._zIndex=this.id,t._drawingLayer=this,t._drawingLayerId=this.id;const v=this._arrFabricObject.length;let b=h.length;if(v)b=h.indexOf(this._arrFabricObject[v-1])+1;else for(let C=0;C<h.length;C++)if(t._zIndex<h[C].getDrawingItem()._zIndex){b=C;break}this._arrDrwaingItem.push(t),this._arrFabricObject.push(o),this._visible?o.visible=!0:o.visible=!1,this.fabricCanvas.insertAt(o,b,!1)}addDrawingItem(t){if(!t||!t.isDrawingItem)throw TypeError("Illegal drawing item.");if(this.mode==="viewer")t._setEditable(!1);else{if(this.mode!=="editor")throw new Error("Illegal 'mode'.");t._setEditable(!0)}this._addDrawingItem(t)}addDrawingItems(t){for(let n of t)this.addDrawingItem(n)}removeDrawingItem(t){if(!t||!t.isDrawingItem)throw TypeError("Illegal drawing item.");if(!this.hasDrawingItem(t))return;if(t._zIndex=null,t._drawingLayer=null,t._drawingLayerId=null,t._mediaType==="group"){const o=t.getChildItems();for(let h of o)h._zIndex=null,h._drawingLayer=null,h._drawingLayerId=null,h.off("select",h._funcChangeStyleToSelected),h.off("deselect",h._funcChangeStyleToDefault),h._funcChangeStyleToSelected=null,h._funcChangeStyleToDefault=null,h._mapStyle.clear()}else t.off("select",t._funcChangeStyleToSelected),t.off("deselect",t._funcChangeStyleToDefault),t._funcChangeStyleToSelected=null,t._funcChangeStyleToDefault=null,t._mapStyle.clear();t.styleSelector==="selected"&&(this.fabricCanvas._activeObject=null,t.styleSelector="default");const n=t._getFabricObject();this.fabricCanvas.remove(n),this._arrDrwaingItem.splice(this._arrDrwaingItem.indexOf(t),1),this._arrFabricObject.splice(this._arrFabricObject.indexOf(n),1)}removeDrawingItems(t){for(let n of t)this.removeDrawingItem(n)}setDrawingItems(t){this.clearDrawingItems(),this.addDrawingItems(t)}getDrawingItems(){return this._arrDrwaingItem}getSelectedDrawingItems(){const t=this.fabricCanvas.getActiveObjects(),n=[];for(let o of t)this._arrFabricObject.includes(o)&&n.push(o.getDrawingItem());return n}hasDrawingItem(t){if(!t||!t.isDrawingItem)throw TypeError("Illegal drawing item.");return this._arrDrwaingItem.includes(t)}clearDrawingItems(){this.removeDrawingItems(Array.from(this._arrDrwaingItem))}setDrawingStyle(t,n,o){let h,g;if(n=n?n.toLocaleLowerCase():"all",o=o?o.toLocaleLowerCase():"all",h=typeof t=="number"?this._getDrawingStyle(t):t,n==="all"){const _=this.mapMediaType_Style.keys();for(let v of _)if(g=this.mapMediaType_Style.get(v),o==="all")for(let b of Ge.arrStyleSelectors){this._changeMediaTypeCurStyleInStyleSelector(v,b,h,!0),g[b]=h;for(let C of this._arrDrwaingItem)typeof C.styleId!="number"&&C._mapStyle.set(b,h)}else{this._changeMediaTypeCurStyleInStyleSelector(v,o,h,!0),g[o]=h;for(let b of this._arrDrwaingItem)typeof b.styleId!="number"&&b._mapStyle.set(o,h)}this.fabricCanvas.renderAll()}else if(g=this.mapMediaType_Style.get(n),o==="all")for(let _ of Ge.arrStyleSelectors){this._changeMediaTypeCurStyleInStyleSelector(n,_,h,!0),g[_]=h;for(let v of this._arrDrwaingItem)typeof v.styleId!="number"&&v._mediaType===n&&v._mapStyle.set(_,h)}else{this._changeMediaTypeCurStyleInStyleSelector(n,o,h,!0),g[o]=h;for(let _ of this._arrDrwaingItem)typeof _.styleId!="number"&&_._mediaType===n&&_._mapStyle.set(o,h)}}setMode(t){if((t=t.toLocaleLowerCase())==="viewer"){for(let n of this._arrDrwaingItem)n._setEditable(!1);this.fabricCanvas.discardActiveObject(),this.fabricCanvas.renderAll(),this.mode="viewer"}else{if(t!=="editor")throw new RangeError("Invalid value.");for(let n of this._arrDrwaingItem)n._setEditable(!0);this.mode="editor"}this._manager._switchPointerEvent()}getMode(){return this.mode}_setDimensions(t,n){this.fabricCanvas.setDimensions(t,n)}_setObjectFit(t){if(t=t.toLowerCase(),!["contain","cover"].includes(t))throw new Error(`Unsupported value '${t}'.`);this.fabricCanvas.lowerCanvasEl.style.objectFit=t,this.fabricCanvas.upperCanvasEl.style.objectFit=t}_getObjectFit(){return this.fabricCanvas.lowerCanvasEl.style.objectFit}renderAll(){for(let t of this._arrDrwaingItem){const n=this._getItemCurrentStyle(t);this._changeItemStyle(t,n,!0)}this.fabricCanvas.renderAll()}dispose(){this.clearDrawingItems(),this._manager._arrDrawingLayer.length===1&&(this.fabricCanvas.wrapperEl.style.pointerEvents="none",this.fabricCanvas.dispose(),this._arrDrwaingItem.length=0,this._arrFabricObject.length=0)}}class qh{constructor(){this._arrDrawingLayer=[],this._mapDrawingStyles=new Map([[1,{id:1,lineWidth:2,fillStyle:"rgba(73, 173, 245, 0.3)",strokeStyle:"rgba(73, 173, 245, 1)",paintMode:"stroke",fontFamily:"sans-serif",fontSize:10}],[2,{id:2,lineWidth:2,fillStyle:"rgba(73, 245, 73, 0.3)",strokeStyle:"rgba(73, 245, 73, 0.9)",paintMode:"strokeAndFill",fontFamily:"sans-serif",fontSize:10}],[3,{id:3,lineWidth:2,fillStyle:"rgba(254, 180, 32, 0.3)",strokeStyle:"rgba(254, 180, 32, 0.9)",paintMode:"strokeAndFill",fontFamily:"sans-serif",fontSize:10}],[4,{id:4,lineWidth:2,fillStyle:"rgba(245, 236, 73, 0.3)",strokeStyle:"rgba(245, 236, 73, 1)",paintMode:"stroke",fontFamily:"sans-serif",fontSize:10}],[5,{id:5,lineWidth:2,fillStyle:"rgba(73, 173, 245, 0.3)",strokeStyle:"rgba(73, 173, 245, 1)",paintMode:"strokeAndFill",fontFamily:"sans-serif",fontSize:10}],[6,{id:6,lineWidth:2,fillStyle:"rgba(73, 245, 73, 0.3)",strokeStyle:"rgba(73, 245, 73, 0.9)",paintMode:"strokeAndFill",fontFamily:"sans-serif",fontSize:10}],[7,{id:7,lineWidth:2,fillStyle:"rgba(254, 180, 32, 0.3)",strokeStyle:"rgba(254, 180, 32, 1)",paintMode:"strokeAndFill",fontFamily:"sans-serif",fontSize:10}],[8,{id:8,lineWidth:2,fillStyle:"rgba(245, 236, 73, 0.3)",strokeStyle:"rgba(245, 236, 73, 1)",paintMode:"strokeAndFill",fontFamily:"sans-serif",fontSize:10}]]),this._defaultStyleTemplate={lineWidth:2,fillStyle:"rgba(245, 236, 73, 0.3)",strokeStyle:"rgba(245, 236, 73, 1)",paintMode:"stroke",fontFamily:"sans-serif",fontSize:10}}createDrawingStyle(t){let n;if(t.hasOwnProperty("id")){if(this._mapDrawingStyles.has(t.id))throw new Error("Existing drawing style id.");n=t.id}else{let h=100;for(;this._mapDrawingStyles.has(h);)h++;n=h}const o=JSON.parse(JSON.stringify(t));o.id=n;for(let h in this._defaultStyleTemplate)o.hasOwnProperty(h)||(o[h]=this._defaultStyleTemplate[h]);return this._mapDrawingStyles.set(n,o),o.id}_getDrawingStyle(t,n){if(typeof t!="number")throw new Error("Invalid style id.");const o=this._mapDrawingStyles.get(t);return o?n?JSON.parse(JSON.stringify(o)):o:null}getDrawingStyle(t){return this._getDrawingStyle(t,!0)}getDrawingStyles(){return JSON.parse(JSON.stringify(Array.from(this._mapDrawingStyles.values())))}_updateDrawingStyle(t,n){const o=this._mapDrawingStyles.get(t);if(o)for(let h in n)o.hasOwnProperty(h)&&(o[h]=n[h])}updateDrawingStyle(t,n){this._updateDrawingStyle(t,n);for(let o of this._arrDrawingLayer)o.renderAll()}createDrawingLayer(t,n){const o=g=>{for(let _ of this._arrDrawingLayer)if(_.getId()===g)return!0;return!1};if(n===void 0){for(let g=100;;g++)if(!o(g)){n=g;break}}else if(o(n))throw new Error("Existed drawing layer id.");const h=new zh(t,n,this._mapDrawingStyles,{enableRetinaScaling:!1});return h._manager=this,this._arrDrawingLayer.push(h),this._switchPointerEvent(),h}deleteDrwaingLayer(t){const n=this.getDrawingLayer(t);if(!n)return;const o=this._arrDrawingLayer;n.dispose(),o.splice(o.indexOf(n),1),this._switchPointerEvent()}clearDrawingLayers(){for(let t of this._arrDrawingLayer)t.dispose();this._arrDrawingLayer.length=0}getDrawingLayer(t){for(let n of this._arrDrawingLayer)if(n.getId()===t)return n;return null}getDrawingLayers(){return Array.from(this._arrDrawingLayer)}getSelectedDrawingItems(){if(!this._arrDrawingLayer.length)return;const t=this._arrDrawingLayer[0].fabricCanvas.getActiveObjects(),n=[];for(let o of t)n.push(o.getDrawingItem());return n}setDimensions(t,n){this._arrDrawingLayer.length&&this._arrDrawingLayer[0]._setDimensions(t,n)}setObjectFit(t){for(let n of this._arrDrawingLayer)n&&n._setObjectFit(t)}getObjectFit(){return this._arrDrawingLayer.length?this._arrDrawingLayer[0]._getObjectFit():null}setVisible(t){this._arrDrawingLayer.length&&(this._arrDrawingLayer[0].fabricCanvas.wrapperEl.style.display=t?"block":"none")}_switchPointerEvent(){if(!this._arrDrawingLayer.length)return;let t=!1;for(let n of this._arrDrawingLayer)n.getMode()==="editor"&&(t=!0);this._arrDrawingLayer[0].fabricCanvas.wrapperEl.style.pointerEvents=t?"":"none"}}class Jh{constructor(t){this._controlTarget=null,this._arrUsers=[],this._mapAction_UserArgs=new Map,this._mapProperty_UserValue=new Map,this._mapAction_Callbacks=new Map,this._controlTarget=t}setControlTarget(t){this._controlTarget=t}getControlTarget(){return this._controlTarget}register(t){this._arrUsers.includes(t)||this._arrUsers.push(t)}logout(t){const n=this._arrUsers.indexOf(t);n!==-1&&(this.clearUserDisiredAction({user:t}),this.clearUserDisiredValue({user:t}),this._arrUsers.splice(n,1))}getRegisteredUsers(){return this._arrUsers}ifUserExisted(t){return this._arrUsers.includes(t)}setDisiredValue(t,n,o,h){if(!this._arrUsers.includes(t))throw new Error("Unregistered user.");h&&(this._controlTarget[n]=o),this._mapProperty_UserValue.get(n)?this._mapProperty_UserValue.get(n).set(t,o):this._mapProperty_UserValue.set(n,new Map([[t,o]]))}clearUserDisiredValue(t){if(t&&(t.user||t.property)){if(t.property&&t.user){const n=this._mapProperty_UserValue.get(t.property);if(!n)return;n.delete(t.user)}else if(t.property)this._mapProperty_UserValue.delete(t.property);else if(t.user)for(let n of this._mapProperty_UserValue.values())n.delete(t.user)}else this._mapProperty_UserValue=new Map}getValue(t){if(!this._controlTarget)throw new Error("Control target is not set.");return this._controlTarget[t]}getPropertyDisiredValue(t){if(this._mapProperty_UserValue.get(t)){const n=[],o=this._mapProperty_UserValue.get(t);for(let h of o.values())n.push(h);return n}return null}setDisiredAction(t,n,o,h){if(!this._arrUsers.includes(t))throw new Error("Unregistered user.");return o||(o=[]),h?this._controlTarget[n](...o):(this._mapAction_UserArgs.get(n)?this._mapAction_UserArgs.get(n).set(t,o):this._mapAction_UserArgs.set(n,new Map([[t,o]])),this._render(n))}clearUserDisiredAction(t){if(t&&(t.user||t.actionName)){if(t.actionName&&t.user){const n=this._mapAction_UserArgs.get(t.actionName);if(!n)return;n.delete(t.user)}else if(t.actionName)this._mapAction_UserArgs.delete(t.actionName);else if(t.user)for(let n of this._mapAction_UserArgs.values())n.delete(t.user);this.render()}else this._mapAction_UserArgs=new Map}addCallback(t,n){const o=this._mapAction_Callbacks.get(t);o?o.push(n):this._mapAction_Callbacks.set(t,[n])}removeCallback(t,n){const o=this._mapAction_Callbacks.get(t);if(!o)return;const h=o.indexOf(n);h!==-1&&o.splice(h,1)}clearCallback(t){t?this._mapAction_Callbacks.delete(t):this._mapAction_Callbacks.clear()}_fireCallback(t){const n=this._mapAction_Callbacks.get(t);if(n)for(let o of n){if(!o)return;setTimeout(o.bind(this._controlTarget),0)}}_render(t){const n=this._mapAction_UserArgs.get(t);if(!n)throw new Error("Unrecorded action.");if(n.size===this._arrUsers.length){let o=[];for(let h of n.values())h.length>0&&(o=h);if(this._controlTarget[t]){const h=this._controlTarget[t](...o);return this._mapAction_UserArgs.delete(t),this._fireCallback(t),h}}}render(t){if(t)return this._render(t);for(let n of this._mapAction_UserArgs.keys())this._render(n)}}class he{constructor(){this._maxCvsSideLength=void 0,this._defaultMaxCvsSideLength=null,this._predefinedResolutions=[{width:160,height:120},{width:320,height:240},{width:480,height:360},{width:640,height:480},{width:800,height:600},{width:960,height:720},{width:1280,height:720},{width:1920,height:1080},{width:2560,height:1440},{width:3840,height:2160}],this._mapCameraResolutions=new Map,this._bWebGLSupported=!0,this.extraBindings=[],this._singleFrameMode=!(navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia),this._cvsSingleFrameMode=null,this._cvsOriginalImage=null,this._imgWidth=0,this._imgHeight=0,this._singleFrameModeIpt=null,this._clickIptSingleFrameMode=()=>{if(this.singleFrameMode){if(!this._singleFrameModeIpt){const t=document.createElement("input");this._singleFrameModeIpt=t,t.setAttribute("type","file"),t.setAttribute("accept",".jpg,.jpeg,.icon,.gif,.svg,.webp,.png,.bmp"),t.setAttribute("capture",""),t.addEventListener("change",()=>Te(this,void 0,void 0,function*(){const n=t.files[0];t.value="";const o=yield(C=>Te(this,void 0,void 0,function*(){let w=null,I=null;if(typeof createImageBitmap<"u")try{if(w=yield createImageBitmap(C),w)return w}catch{}var A;return w||(I=yield(A=C,new Promise((V,J)=>{let q=URL.createObjectURL(A),K=new Image;K.dbrObjUrl=q,K.src=q,K.onload=()=>{V(K)},K.onerror=Z=>{J(new Error("Can't convert blob to image : "+(Z instanceof Event?Z.type:Z)))}}))),I}))(n),h=o instanceof HTMLImageElement?o.naturalWidth:o.width,g=o instanceof HTMLImageElement?o.naturalHeight:o.height;this._imgWidth=h,this._imgHeight=g;const _=C=>{const w=Date.now();if(h===0||g===0)return null;const I=this._scanRegion,A=this.getFrameSize(h,g,I,this.maxCvsSideLength);if(!A)return null;let V,J;V=h!==A.sWidth||g!==A.sHeight,J=A.sWidth!==A.dWidth||A.sHeight!==A.dHeight;const q=(()=>!(!this._bWebGLSupported||J))(),K={data:null,region:I?JSON.parse(JSON.stringify(I)):null,sx:A.sx,sy:A.sy,width:A.dWidth,height:A.dHeight,colorMode:null,timeSpent:null,timeStamp:null,isCropped:V,toCanvas:this._toCanvas,_sWidth:A.sWidth,_sHeight:A.sHeight,_bUseWebGL:null};let Z;try{Z=this._getImageData(C,h,g,A,null,{targetColorMode:this.frameColorMode,bUseWebGL:q})}catch($){if($.name!=="WebGLError")throw $;Z=this._getImageData(C,h,g,A,null,{targetColorMode:this.frameColorMode,bUseWebGL:!1})}if(!Z)return null;const ne=Date.now();return he._onLog&&he._onLog("DCE: _getVideoFrame(region?) END: "+ne),K.data=Z.data,K.colorMode=Z.colorMode,K._bUseWebGL=Z._bUseWebGL,K.timeSpent=ne-w,K.timeStamp=ne,K};(C=>{let w=this._cvsSingleFrameMode;if(!w){if(w=document.createElement("canvas"),w.style.pointerEvents="none",!this._video)throw new Error("'video' is null.");this._video.after(w),w.style.position="absolute",w.style.width="100%",w.style.height="100%",w.style.left="0",w.style.top="0",w.style.objectFit="contain",this._cvsSingleFrameMode=w}w.width==h&&w.height==g||(w.width=h,w.height=g);const I=w.getContext("2d");I.clearRect(0,0,w.width,w.height),I.drawImage(C,0,0)})(o),this._updateScanRegionCanvas(),this._updateScanAreaDiv(),this._updateViewDecorator();for(let C of this._arrScanRegionOverlays)C&&this._updateScanRegionOverlay(C);let v;this._updateDrawingLayersSize();try{v=_(o)}catch(C){throw C}const b=this.mapCameraEvents.get("singleFrameAcquired");for(let C of b)if(C)try{const w={data:new Uint8Array(v.data),region:JSON.parse(JSON.stringify(v.region)),sx:v.sx,sy:v.sy,width:v.width,height:v.height,colorMode:v.colorMode,timeSpent:v.timeSpent,timeStamp:v.timeStamp,isCropped:v.isCropped,toCanvas:v.toCanvas,_sWidth:v._sWidth,_sHeight:v._sHeight,_bUseWebGL:v._bUseWebGL};yield C.apply(this,[w])}catch(w){console.error(w)}})),t.style.position="fixed",t.style.left="-1px",t.style.top="-1px",t.style.width="1px",t.style.height="1px",t.style.backgroundColor="transparent",t.style.color="transparent",document.body.appendChild(t)}this._singleFrameModeIpt.click()}},this.styleEls=[],this._frameColorMode=void 0,this._defaultFrameColorMode="RGBA",this.currentFSColorMode="rgba",this.ifReuseArrayBufferView=!1,this.maxVideoCvsLength=3,this._reusedCvs=null,this._reusedWebGLCvs=null,this._reusedWebGLCtx=null,this._reusedDataContainer=null,this._webGLTexture=null,this._webGLProgramInfo=null,this._webGLBuffers=null,this._recordedStates={},this._toCanvas=function(){const t=document.createElement("canvas");let n;if(t.width=this.width,t.height=this.height,this.colorMode==="grey"){n=new Uint8ClampedArray(this.width*this.height*4);for(let h=0;h<n.length;h+=4)n[h]=this.data[h/4],n[h+1]=this.data[h/4],n[h+2]=this.data[h/4],n[h+3]=255}else n=new Uint8ClampedArray(this.data);const o=new ImageData(n,this.width,this.height);return t.getContext("2d").putImageData(o,0,0),t},this._onCameraSelChange=()=>Te(this,void 0,void 0,function*(){yield this.selectCamera(this._selCam.value),this._bOpen||this.stop()}),this._onResolutionSelChange=()=>Te(this,void 0,void 0,function*(){let t,n;if(this._selRsl&&this._selRsl.selectedIndex!=-1){let o=this._selRsl.options[this._selRsl.selectedIndex];t=o.getAttribute("data-width"),n=o.getAttribute("data-height")}yield this.setResolution(t,n),this._bOpen||this.stop()}),this._onCloseBtnClick=()=>{this.close(!0)},this._bOpen=!1,this.isCameraEnhancer=!0,this.isDisposed=!1,this.videoSrc=null,this.videoSettings={video:{width:{ideal:1280},height:{ideal:720},facingMode:{ideal:"environment"}}},this.iPlayRound=0,this.promisePlay=null,this._ifSaveLastUsedCamera=!1,this.ifSkipCameraInspection=!1,this._allCameras=[],this._currentCamera=null,this._videoTrack=null,this._lastDeviceId=void 0,this._vc_bPlayingVideoBeforeHide=!1,this._ev_documentHideEvent=()=>{document.visibilityState==="visible"?this._vc_bPlayingVideoBeforeHide&&(ke.browser=="Firefox"?this.play():this._video.play(),this._vc_bPlayingVideoBeforeHide=!1):this._video&&!this._video.paused&&(this._vc_bPlayingVideoBeforeHide=!0,this._video.pause())},this._divVideoContainer=null,this._video=null,this.videoFit="contain",this._cvsScanRegion=null,this._divScanArea=null,this._divScanLight=null,this._bgLoading=null,this._selCam=null,this._bgCamera=null,this._selRsl=null,this._optGotRsl=null,this._btnClose=null,this._selMinLtr=null,this._optGotMinLtr=null,this.regionMaskFillStyle="rgba(0,0,0,0.5)",this.regionMaskStrokeStyle="rgb(254,142,20)",this.regionMaskLineWidth=2,this._bShowScanRegionMask=!0,this._bShowScanRegionLaser=void 0,this._defaultBShowScanRegionLaser=!1,this._scanRegion=null,this._arrScanRegionOverlays=[],this._layerBaseCvs=null,this._cvsViewDecorator=null,this._decoratorType=[],this._decoratorArea=null,this._viewDecoratorInfo={rectangle:{lineWidth:4,strokeStyle:"rgb(254,142,20)",fillStyle:"transparent",maskFillStyle:"transparent"},focus:{lineWidth:4,strokeStyle:"rgb(254,142,20)",fillStyle:"transparent",maskFillStyle:"transparent"},crossline:{lineWidth:2,strokeStyle:"rgb(254,142,20)"},crosshair:{lineWidth:4,strokeStyle:"rgb(254,142,20)"}},this._croppingRegions=void 0,this._defaultCroppingRegions=[null],this.bIncreaseRegionIndexAuto=!0,this._croppingRegionIndex=0,this._loopInterval=void 0,this._defaultLoopInterval=0,this._maxNumberOfFramesInBuffer=void 0,this._defaultMaxNumberOfFramesInBuffer=1,this._frameQueue=[],this._bFetchingLoopStarted=!1,this._refreshInterval=void 0,this._defaultRefreshInterval=-1,this._updateLayersTimeout=100,this._updateLayers=()=>{this._resizeTimeoutId&&clearTimeout(this._resizeTimeoutId),this._resizeTimeoutId=setTimeout(()=>{if(!this.isDisposed){this._updateScanRegionCanvas(),this._updateScanAreaDiv(),this._updateViewDecorator();for(let t of this._arrScanRegionOverlays)t&&this._updateScanRegionOverlay(t);this._updateDrawingLayersSize()}},this._updateLayersTimeout)},this.mapCameraEvents=new Map([["cameraOpen",[]],["cameraClose",[]],["cameraChange",[]],["resolutionChange",[]],["played",[]],["singleFrameAcquired",[]],["frameAddedToBuffer",[]]]),this._controler=null}static getVersion(){return this._version}static detectEnvironment(){return Te(this,void 0,void 0,function*(){return yield(async()=>({wasm:Wh,worker:Hh,getUserMedia:Ra,camera:await Yh(),browser:ke.browser,version:ke.version,OS:ke.OS}))()})}static set engineResourcePath(t){if(this._hasEngineResourceLoaded)throw new Error("`engineResourcePath` is not allowed to change after `createInstance` is called.");he._engineResourcePath=(n=>{if(n==null&&(n="./"),!Dn){let o=document.createElement("a");o.href=n,n=o.href}return n.endsWith("/")||(n+="/"),n})(t)}static get engineResourcePath(){return this._engineResourcePath}static isStorageAvailable(t){let n;try{n=window[t];const o="__storage_test__";return n.setItem(o,o),n.removeItem(o),!0}catch(o){return o instanceof DOMException&&(o.code===22||o.code===1014||o.name==="QuotaExceededError"||o.name==="NS_ERROR_DOM_QUOTA_REACHED")&&n&&n.length!==0}}static isDCEFrame(t){return!(!t||typeof t!="object"||Array.isArray(t))&&"data"in t&&"region"in t&&"sx"in t&&"sy"in t&&"width"in t&&"height"in t&&"colorMode"in t&&"timeSpent"in t&&"timeStamp"in t&&"isCropped"in t&&"toCanvas"in t&&"_sWidth"in t&&"_sHeight"in t&&"_bUseWebGL"in t}set maxCvsSideLength(t){if(t<=0)throw new Error("Invalid value.");this._maxCvsSideLength=t}get maxCvsSideLength(){if(this._maxCvsSideLength!==void 0)return this._maxCvsSideLength;if(this._controler){const t=this._controler.getPropertyDisiredValue("maxCvsSideLength");if(t&&t.length===1)return t[0]}return this._defaultMaxCvsSideLength}static set defaultUIElementURL(t){he._defaultUIElementURL=t}static get defaultUIElementURL(){var t;return(t=he._defaultUIElementURL)===null||t===void 0?void 0:t.replace("@engineResourcePath/",he.engineResourcePath)}getUIElement(){return this.UIElement}setUIElement(t){return Te(this,void 0,void 0,function*(){if(this._bOpen)throw new Error("It is not allowed to change the UIElement when the camera is open.");if(typeof t=="string"||t instanceof String){if(!t.trim().startsWith("<")){let o=yield fetch(t);if(!o.ok)throw Error("setUIElement(elementOrUrl): Network Error: "+o.statusText);t=yield o.text()}if(!t.trim().startsWith("<"))throw Error("setUIElement(elementOrUrl): Can't get valid HTMLElement.");let n=document.createElement("div");n.innerHTML=t;for(let o=0;o<n.childElementCount;++o){let h=n.children[o];h instanceof HTMLStyleElement&&(this.styleEls.push(h),document.head.append(h))}(t=n.childElementCount==1?n.children[0]:n).remove()}this.UIElement=t,this._uiOriginalState={display:t&&t.style.display,inDom:document.body.contains(t)}})}appendAndShowUI(){this.UIElement&&(this.UIElement.parentNode||(this.UIElement.style.position="fixed",this.UIElement.style.left="0",this.UIElement.style.top="0",document.body.append(this.UIElement)),this.UIElement.style.display=="none"&&(this.UIElement.style.display=""))}hideUI(){this.UIElement&&(this.UIElement.style.display="none")}get singleFrameMode(){return this._singleFrameMode}set singleFrameMode(t){if(this._bOpen)throw new Error("It is not allowed to change `singleFrameMode` when the camera is open.");this._singleFrameMode=t}set frameColorMode(t){this._frameColorMode=t}get frameColorMode(){if(this._frameColorMode!==void 0)return this._frameColorMode;if(this._controler){const t=this._controler.getPropertyDisiredValue("frameColorMode");if(t&&t.length===1)return t[0]}return this._defaultFrameColorMode}set bOpen(t){if(this._bOpen=t,t){this._updateScanRegionCanvas(),this._updateScanAreaDiv(),this._updateViewDecorator();for(let n of this._arrScanRegionOverlays)n&&this._updateScanRegionOverlay(n);this._updateDrawingLayersSize(),this.ifShowScanRegionMask?this.showScanRegionMask():this.hideScanRegionMask(),this.ifShowScanRegionLaser?this.showScanRegionLaser():this.hideScanRegionLaser(),this.showViewDecorator(),this.showScanRegionOverlays(),this._drawingLayersManager.setVisible(!0)}}set ifSaveLastUsedCamera(t){t?he.isStorageAvailable("localStorage")?this._ifSaveLastUsedCamera=!0:(this._ifSaveLastUsedCamera=!1,console.warn("Local storage is unavailable")):this._ifSaveLastUsedCamera=!1}get ifSaveLastUsedCamera(){return this._ifSaveLastUsedCamera}get video(){return this._video}setVideoFit(t){if(t=t.toLowerCase(),!["contain","cover"].includes(t))throw new Error(`Unsupported value '${t}'.`);if(this.videoFit=t,this._video&&(this._video.style.objectFit=t,!this.singleFrameMode)){this._updateScanRegionCanvas(),this._updateScanAreaDiv(),this._updateViewDecorator();for(let n of this._arrScanRegionOverlays)n&&this._updateScanRegionOverlay(n);this._drawingLayersManager.setObjectFit(t)}}getVideoFit(){return this.videoFit}set ifShowScanRegionMask(t){this._bShowScanRegionMask=t,t?this.showScanRegionMask():this.hideScanRegionMask()}get ifShowScanRegionMask(){return this._bShowScanRegionMask}showScanRegionMask(){this._cvsScanRegion&&(this._cvsScanRegion.style.display=="none"&&(this._cvsScanRegion.style.display=""),this._recordedStates.maskShow=!0)}hideScanRegionMask(){this._cvsScanRegion&&(this._cvsScanRegion.style.display="none",this._recordedStates.maskShow=!1)}set ifShowScanRegionLaser(t){this._bShowScanRegionLaser=t,t?this.showScanRegionLaser():this.hideScanRegionLaser()}get ifShowScanRegionLaser(){if(this._bShowScanRegionLaser!==void 0)return this._bShowScanRegionLaser;if(this._controler){const t=this._controler.getPropertyDisiredValue("ifShowScanRegionLaser");if(t&&t.length){let n=0;for(let o of t)o||n++;return n!==this._controler.getRegisteredUsers().length}}return this._defaultBShowScanRegionLaser}showScanRegionLaser(){this._divScanLight&&(this._divScanLight.style.display=="none"&&(this._divScanLight.style.display="block"),this._recordedStates.laserShow=!0)}hideScanRegionLaser(){this._divScanLight&&(this._divScanLight.style.display="none",this._recordedStates.laserShow=!1)}_checkValidRegion(t){return!(t!==null&&(!t||!(t.hasOwnProperty("regionLeft")&&t.hasOwnProperty("regionTop")&&t.hasOwnProperty("regionRight")&&t.hasOwnProperty("regionBottom")&&t.hasOwnProperty("regionMeasuredByPercentage"))||t.regionLeft<0||t.regionTop<0||t.regionRight<0||t.regionBottom<0||t.regionMeasuredByPercentage&&(t.regionLeft>100||t.regionTop>100||t.regionRight>100||t.regionBottom>100)))}set scanRegion(t){if(!this._checkValidRegion(t))throw new Error("Invalid region.");this._scanRegion=JSON.parse(JSON.stringify(t)),this._updateScanRegionCanvas(),this._updateScanAreaDiv();for(let n of this._arrScanRegionOverlays)n&&this._updateScanRegionOverlay(n)}setScanRegion(t){this.scanRegion=t}getScanRegion(){return JSON.parse(JSON.stringify(this._scanRegion))}_calculateCvsSize(){if(!this._bOpen)return null;let t,n,o;if(this.singleFrameMode)t=this._imgWidth,n=this._imgHeight,o="contain";else{if(!this._video)return null;t=this._video.videoWidth,n=this._video.videoHeight,o=this.getVideoFit()}return{width:t,height:n,objectFit:o}}addScanRegionOverlayCanvas(){this._assertOpen();const t=document.createElement("canvas");if(this._updateScanRegionOverlay(t),!this._scanRegionOverlayContainer){const n=document.createElement("div");if(this._scanRegionOverlayContainer=n,n.style.position="absolute",n.style.left="0",n.style.top="0",n.style.width="100%",n.style.height="100%",n.style.overflow="hidden",n.style.pointerEvents="none",this._layerBaseCvs)this._layerBaseCvs.parentElement.after(n);else if(this._cvsScanRegion)this._cvsScanRegion.before(n);else if(this._cvsSingleFrameMode)this._cvsSingleFrameMode.after(n);else{if(!this._video)throw new Error("'video' is null.");this._video.after(n)}this._recordedStates.overlayShow=!0}return this._scanRegionOverlayContainer.append(t),this._arrScanRegionOverlays.push(t),t}removeScanRegionOverlayCanvas(t){const n=this._arrScanRegionOverlays.indexOf(t);n!==-1&&(t.remove(),this._arrScanRegionOverlays.splice(n,1))}_updateScanRegionOverlay(t){if(!t)return;const n=this._calculateCvsSize();if(!n)return;const{width:o,height:h,objectFit:g}=n;if(o<=0||h<=0)return t.width=0,void(t.height=0);const _=this._getRegionInPixels(o,h,this._scanRegion),v=this.getFrameSize(o,h,this._scanRegion,this.maxCvsSideLength),b=v.dWidth,C=v.dHeight;t.width==b&&t.height==C||(t.width=b,t.height=C);const w=window.getComputedStyle(this._video),I=parseFloat(w.width),A=parseFloat(w.height),V=I/A,J=o/h;let q,K,Z,ne,$=1;g==="contain"?(V<J?($=I/o,q=0,K=(A-h*$)/2):($=A/h,q=(I-o*$)/2,K=0),q+=_.regionLeft*$,K+=_.regionTop*$,Z=(_.regionRight-_.regionLeft)*$,ne=(_.regionBottom-_.regionTop)*$):g==="cover"?(J>V?($=A/h,q=_.regionLeft*$-(o*$-I)/2,K=_.regionTop*$):($=I/o,q=_.regionLeft*$,K=_.regionTop*$-(h*$-A)/2),Z=(_.regionRight-_.regionLeft)*$,ne=(_.regionBottom-_.regionTop)*$):(q=0,K=0,Z=0,ne=0),t.style.position="absolute",t.style.left=q+"px",t.style.top=K+"px",t.style.width=Z+"px",t.style.height=ne+"px"}showScanRegionOverlays(){this._scanRegionOverlayContainer&&(this._scanRegionOverlayContainer.style.display=="none"&&(this._scanRegionOverlayContainer.style.display=""),this._recordedStates.overlayShow=!0)}hideScanRegionOverlays(){this._scanRegionOverlayContainer&&(this._scanRegionOverlayContainer.style.display="none",this._recordedStates.overlayShow=!1)}setViewDecorator(t,n){if(!t)return void(this._cvsViewDecorator&&(this._cvsViewDecorator.remove(),this._cvsViewDecorator=null));this._assertOpen();let o=[];if(typeof t=="string"?o.push(t):Array.isArray(t)&&(o=JSON.parse(JSON.stringify(t))),!this._cvsViewDecorator){if(this._cvsViewDecorator=document.createElement("canvas"),this._cvsViewDecorator.style.pointerEvents="none",this._cvsScanRegion)this._cvsScanRegion.after(this._cvsViewDecorator);else if(this._scanRegionOverlayContainer)this._scanRegionOverlayContainer.after(this._cvsViewDecorator);else if(this._layerBaseCvs)this._layerBaseCvs.parentElement.after(this._cvsViewDecorator);else if(this._cvsSingleFrameMode)this._cvsSingleFrameMode.after(this._cvsViewDecorator);else{if(!this._video)throw new Error("'video' is null.");this._video.after(this._cvsViewDecorator)}this._recordedStates.decoratorShow=!0}this._decoratorArea=JSON.parse(JSON.stringify(n)),this._decoratorType.length=0;const h=["rectangle","focus"],g=["crossline","crosshair"];let _=!1,v=!1;for(let b of o)b=b.toLowerCase(),h.includes(b)&&!_&&(_=!0,this._decoratorType.push(b)),g.includes(b)&&!v&&(v=!0,!this._decoratorType.includes(b)&&this._decoratorType.push(b));this._updateViewDecorator()}getViewDecorator(){return{type:JSON.parse(JSON.stringify(this._decoratorType)),area:JSON.parse(JSON.stringify(this._decoratorArea)),canvas:this._cvsViewDecorator}}showViewDecorator(){this._cvsViewDecorator&&(this._cvsViewDecorator.style.display=="none"&&(this._cvsViewDecorator.style.display=""),this._recordedStates.decoratorShow=!0)}hideViewDecorator(){this._cvsViewDecorator&&(this._cvsViewDecorator.style.display="none",this._recordedStates.decoratorShow=!1)}setViewDecoratorLineWidth(t,n){if(typeof t!="string")throw new Error("The 'type' should be a string.");if(t=t.toLowerCase(),!this._viewDecoratorInfo.hasOwnProperty(t))throw new Error(`The type of '${t}' doesn't exist.`);if(!this._viewDecoratorInfo[t].hasOwnProperty("lineWidth"))throw new Error(`It is not allowed to change the property 'lineWidth' when the decorator type is '${t}'.`);this._viewDecoratorInfo[t].lineWidth=n,this._updateViewDecorator()}setViewDecoratorStrokeStyle(t,n){if(typeof t!="string")throw new Error("The 'type' should be a string.");if(t=t.toLowerCase(),!this._viewDecoratorInfo.hasOwnProperty(t))throw new Error(`The type of '${t}' doesn't exist.`);if(!this._viewDecoratorInfo[t].hasOwnProperty("strokeStyle"))throw new Error(`It is not allowed to change the property 'strokeStyle' when the decorator type is '${t}'.`);this._viewDecoratorInfo[t].strokeStyle=n,this._updateViewDecorator()}setViewDecoratorFillStyle(t,n){if(typeof t!="string")throw new Error("The 'type' should be a string.");if(t=t.toLowerCase(),!this._viewDecoratorInfo.hasOwnProperty(t))throw new Error(`The type of '${t}' doesn't exist.`);if(!this._viewDecoratorInfo[t].hasOwnProperty("fillStyle"))throw new Error(`It is not allowed to change the property 'fillStyle' when the decorator type is '${t}'.`);this._viewDecoratorInfo[t].fillStyle=n,this._updateViewDecorator()}setViewDecoratorMaskFillStyle(t,n){if(typeof t!="string")throw new Error("The 'type' should be a string.");if(t=t.toLowerCase(),!this._viewDecoratorInfo.hasOwnProperty(t))throw new Error(`The type of '${t}' doesn't exist.`);if(!this._viewDecoratorInfo[t].hasOwnProperty("maskFillStyle"))throw new Error(`It is not allowed to change the property 'maskFillStyle' when the decorator type is '${t}'.`);this._viewDecoratorInfo[t].maskFillStyle=n,this._updateViewDecorator()}_updateViewDecorator(){if(!this._bOpen||!this._cvsViewDecorator||!this._decoratorArea)return;let t;if(this.singleFrameMode)t="contain";else{if(!this._video)return;t=this.getVideoFit()}const n=this._cvsViewDecorator;n.style.position="absolute",n.style.width="100%",n.style.height="100%",n.style.left="0",n.style.top="0",n.style.objectFit=t;const o=this.getVisibleRegion(!0),h=o.regionRight-o.regionLeft,g=o.regionBottom-o.regionTop;if(n.width==h&&n.height==g||(n.width=h,n.height=g),h<=0||g<=0)return;const _=n.getContext("2d");_.clearRect(0,0,n.width,n.height);const v=this._decoratorArea.x/100*h,b=this._decoratorArea.y/100*g,C=this._decoratorArea.width/100*h,w=this._decoratorArea.height/100*g;for(let I of this._decoratorType){if(I==="rectangle"){_.fillStyle=this._viewDecoratorInfo.rectangle.maskFillStyle,_.fillRect(0,0,n.width,n.height),_.clearRect(Math.round(v),Math.round(b),Math.round(C),Math.round(w)),_.fillStyle=this._viewDecoratorInfo.rectangle.fillStyle,_.fillRect(Math.round(v),Math.round(b),Math.round(C),Math.round(w)),_.lineWidth=this._viewDecoratorInfo.rectangle.lineWidth,_.strokeStyle=this._viewDecoratorInfo.rectangle.strokeStyle;const A=_.lineWidth/2;_.strokeRect(Math.round(v-A),Math.round(b-A),Math.round(C+_.lineWidth),Math.round(w+_.lineWidth))}if(I==="focus"){_.fillStyle=this._viewDecoratorInfo.focus.maskFillStyle,_.fillRect(0,0,n.width,n.height),_.clearRect(Math.round(v),Math.round(b),Math.round(C),Math.round(w)),_.fillStyle=this._viewDecoratorInfo.focus.fillStyle,_.fillRect(Math.round(v),Math.round(b),Math.round(C),Math.round(w)),_.lineWidth=this._viewDecoratorInfo.focus.lineWidth,_.strokeStyle=this._viewDecoratorInfo.focus.strokeStyle;const A=_.lineWidth/2,V=[0,.25,.75,1],J=[0,.25,.75,1];_.beginPath();for(let q=0;q<V.length;q++)if(q==0||q==3)for(let K=0;K<J.length;K+=2)_.moveTo(Math.round(v+V[q]*C),Math.round(b+J[K]*w)),_.lineTo(Math.round(v+V[q]*C),Math.round(b+J[K+1]*w));for(let q=0;q<J.length;q++)if(q==0||q==3)for(let K=0;K<V.length;K+=2)_.moveTo(Math.round(v+V[K]*C-A),Math.round(b+J[q]*w)),_.lineTo(Math.round(v+V[K+1]*C+A),Math.round(b+J[q]*w));_.stroke()}if(I==="crossline"&&(_.beginPath(),_.lineWidth=this._viewDecoratorInfo.crossline.lineWidth,_.strokeStyle=this._viewDecoratorInfo.crossline.strokeStyle,_.moveTo(Math.round(v),Math.round(b+w/2)),_.lineTo(Math.round(v+C),Math.round(b+w/2)),_.moveTo(Math.round(v+C/2),Math.round(b)),_.lineTo(Math.round(v+C/2),Math.round(b+w)),_.stroke()),I==="crosshair"){_.beginPath();const A=.05*Math.min(C,w);_.lineWidth=this._viewDecoratorInfo.crosshair.lineWidth,_.strokeStyle=this._viewDecoratorInfo.crosshair.strokeStyle,_.moveTo(Math.round(v+(C-A)/2),Math.round(b+w/2)),_.lineTo(Math.round(v+(C+A)/2),Math.round(b+w/2)),_.moveTo(Math.round(v+C/2),Math.round(b+(w-A)/2)),_.lineTo(Math.round(v+C/2),Math.round(b+(w+A)/2)),_.stroke()}}}getVisibleRegion(t){this._assertOpen();const n=this._calculateCvsSize();if(!n)return null;const{width:o,height:h,objectFit:g}=n;let _=(()=>{const v=parseFloat(window.getComputedStyle(this._video).width),b=parseFloat(window.getComputedStyle(this._video).height);let C,w={regionBottom:h,regionRight:o,regionLeft:0,regionTop:0,regionMeasuredByPercentage:!1};return g==="cover"?v/b<o/h?(C=b/h,w.regionLeft=Math.floor((o-v/C)/2),w.regionRight=Math.ceil(o-w.regionLeft),w.regionTop=0,w.regionBottom=h):(C=v/o,w.regionTop=Math.floor((h-b/C)/2),w.regionBottom=Math.ceil(h-w.regionTop),w.regionLeft=0,w.regionRight=o):g==="none"&&(v<o&&b<h?(w.regionLeft=Math.floor((o-v)/2),w.regionRight=Math.ceil(o-w.regionLeft),w.regionTop=Math.floor((h-b)/2),w.regionBottom=Math.ceil(h-w.regionTop)):v<o?(w.regionLeft=Math.floor((o-v)/2),w.regionRight=Math.ceil(o-w.regionLeft),w.regionTop=0,w.regionBottom=h):b<h&&(w.regionTop=Math.floor((h-b)/2),w.regionBottom=Math.ceil(h-w.regionTop),w.regionLeft=0,w.regionRight=o)),w})();return t?_.regionMeasuredByPercentage=!1:(_.regionBottom=Math.ceil(_.regionBottom/h*100),_.regionRight=Math.ceil(_.regionRight/o*100),_.regionLeft=Math.floor(_.regionLeft/o*100),_.regionTop=Math.floor(_.regionTop/h*100),_.regionMeasuredByPercentage=!0),_}setScanRegionMaskStyle(t){t&&(t.fillStyle&&(this.regionMaskFillStyle=t.fillStyle),t.strokeStyle&&(this.regionMaskStrokeStyle=t.strokeStyle),t.lineWidth&&(this.regionMaskLineWidth=t.lineWidth),this._updateScanRegionCanvas())}_getRegionInPixels(t,n,o){if(!(t<=0||n<=0))return o?o.regionMeasuredByPercentage?{regionLeft:Math.round(o.regionLeft/100*t),regionTop:Math.round(o.regionTop/100*n),regionRight:Math.round(o.regionRight/100*t),regionBottom:Math.round(o.regionBottom/100*n),regionMeasuredByPercentage:!1}:JSON.parse(JSON.stringify(o)):{regionLeft:0,regionTop:0,regionRight:t,regionBottom:n,regionMeasuredByPercentage:!1}}_updateScanRegionCanvas(){if(!this._bOpen)return;const t=this._calculateCvsSize();if(!t)return;const{width:n,height:o,objectFit:h}=t;if(n<=0||o<=0)return void(this._cvsScanRegion&&(this._cvsScanRegion.width=0,this._cvsScanRegion.height=0));const g=this._getRegionInPixels(n,o,this._scanRegion);this._cvsScanRegion||(this._cvsScanRegion=document.createElement("canvas"),this._cvsScanRegion.style.pointerEvents="none",this._scanRegionOverlayContainer?this._scanRegionOverlayContainer.after(this._cvsScanRegion):this._layerBaseCvs?this._layerBaseCvs.parentElement.after(this._cvsScanRegion):this._cvsSingleFrameMode?this._cvsSingleFrameMode.after(this._cvsScanRegion):this._video.after(this._cvsScanRegion),this._recordedStates.maskShow=!0);const _=this._cvsScanRegion;_.style.position="absolute",_.style.width="100%",_.style.height="100%",_.style.left="0",_.style.top="0",_.style.objectFit=h,_.width==n&&_.height==o||(_.width=n,_.height=o);const v=_.getContext("2d");if(v.clearRect(0,0,_.width,_.height),g.regionLeft!=0||g.regionRight!=n||g.regionTop!=0||g.regionBottom!=o){const b=g.regionLeft,C=g.regionTop,w=g.regionRight-g.regionLeft,I=g.regionBottom-g.regionTop;v.fillStyle=this.regionMaskFillStyle,v.fillRect(0,0,_.width,_.height),v.clearRect(Math.round(b),Math.round(C),Math.round(w),Math.round(I)),v.strokeStyle=this.regionMaskStrokeStyle,v.lineWidth=this.regionMaskLineWidth;const A=v.lineWidth/2;v.strokeRect(Math.round(b-A),Math.round(C-A),Math.round(w+v.lineWidth),Math.round(I+v.lineWidth))}}_updateScanAreaDiv(){if(!this._bOpen)return;const t=this._calculateCvsSize();if(!t)return;const{width:n,height:o,objectFit:h}=t;if(!this._divScanArea)return;if(n<=0||o<=0)return this._divScanArea.style.width="0",void(this._divScanArea.style.height="0");const g=this._getRegionInPixels(n,o,this._scanRegion),_=window.getComputedStyle(this._video),v=parseFloat(_.width),b=parseFloat(_.height),C=v/b,w=n/o;let I,A,V,J,q=1;if(h==="contain")C<w?(q=v/n,I=0,A=(b-o*q)/2):(q=b/o,I=(v-n*q)/2,A=0),I+=g.regionLeft*q,A+=g.regionTop*q,V=(g.regionRight-g.regionLeft)*q,J=(g.regionBottom-g.regionTop)*q;else if(h==="cover")if(C<w){q=b/o,I=g.regionLeft*q-(n*q-v)/2,I=Math.max(I,0),I=Math.min(I,parseFloat(_.width)),A=g.regionTop*q;let K=g.regionRight*q-(n*q-v)/2;K=Math.max(K,0),K=Math.min(K,parseFloat(_.width)),V=K-I,J=(g.regionBottom-g.regionTop)*q}else{q=v/n,I=g.regionLeft*q,A=g.regionTop*q-(o*q-b)/2,A=Math.max(A,0),A=Math.min(A,parseFloat(_.height));let K=g.regionBottom*q-(o*q-b)/2;K=Math.max(K,0),K=Math.min(K,parseFloat(_.height)),V=(g.regionRight-g.regionLeft)*q,J=K-A}else I=0,A=0,V=0,J=0;this._divScanArea.style.left=I+"px",this._divScanArea.style.top=A+"px",this._divScanArea.style.width=V+"px",this._divScanArea.style.height=J+"px"}set croppingRegions(t){this._croppingRegions=t,this._bFetchingLoopStarted&&(this.bIncreaseRegionIndexAuto&&(this._croppingRegionIndex=0),this._fetchingLoop(!1))}get croppingRegions(){if(this._croppingRegions!==void 0)return this._croppingRegions;if(this._controler){const t=this._controler.getPropertyDisiredValue("croppingRegions");if(t&&t.length===1)return t[0]}return this._defaultCroppingRegions}set croppingRegionIndex(t){t<0?(this.bIncreaseRegionIndexAuto=!0,this._croppingRegionIndex=0):(this.bIncreaseRegionIndexAuto=!1,this._croppingRegionIndex=t)}get croppingRegionIndex(){return this._croppingRegionIndex}set loopInterval(t){if(t<0)throw new Error("'Invalid value.");this._loopInterval=t,this._bFetchingLoopStarted&&this._fetchingLoop(!1)}get loopInterval(){if(this._loopInterval!==void 0)return this._loopInterval;if(this._controler){const t=this._controler.getPropertyDisiredValue("loopInterval");if(t&&t.length===1)return t[0]}return this._defaultLoopInterval}set maxNumberOfFramesInBuffer(t){if(t<=0)throw new Error("Invalid value.");for(this._maxNumberOfFramesInBuffer=t;this._frameQueue&&this._frameQueue.length>this.maxNumberOfFramesInBuffer;)this._frameQueue.shift()}get maxNumberOfFramesInBuffer(){if(this._maxNumberOfFramesInBuffer!==void 0)return this._maxNumberOfFramesInBuffer;if(this._controler){const t=this._controler.getPropertyDisiredValue("maxNumberOfFramesInBuffer");if(t&&t.length===1)return t[0]}return this._defaultMaxNumberOfFramesInBuffer}get numberOfFramesInBuffer(){return this._frameQueue.length}set refreshInterval(t){this._refreshInterval=t}get refreshInterval(){if(this._refreshInterval!==void 0)return this._refreshInterval;if(this._controler){const t=this._controler.getPropertyDisiredValue("refreshInterval");if(t&&t.length===1)return t[0]}return this._defaultRefreshInterval}static createInstance(t){return Te(this,void 0,void 0,function*(){let n=new he;(typeof t=="string"||t instanceof String)&&(t=JSON.parse(t));for(let o in t)n[o]=t[o];return this._hasEngineResourceLoaded=!0,he.onWarning&&(location&&location.protocol==="file:"?setTimeout(()=>{he.onWarning&&he.onWarning({id:1,message:"Not using HTTP protocol, the SDK may not work correctly."})},0):location&&location.protocol!=="https:"&&setTimeout(()=>{he.onWarning&&he.onWarning({id:2,message:"Not connected via SSL (HTTPS), the SDK may not work correctly."})},0)),n._drawingLayersManager=new qh,n})}play(t,n,o,h){return Te(this,void 0,void 0,function*(){if(this._video&&this.videoSrc){yield new Promise((A,V)=>{this._video.onloadedmetadata=()=>Te(this,void 0,void 0,function*(){this._video&&(this._video.onloadedmetadata=null,yield this._video.play(),A())}),typeof this.videoSrc=="string"||this.videoSrc instanceof String?this._video.src=this.videoSrc:this._video.srcObject=this.videoSrc,setTimeout(()=>V(new Error("Failed to play video. Timeout.")),4e3)});const w={width:this._video.videoWidth,height:this._video.videoHeight,deviceId:this._currentCamera&&this._currentCamera.deviceId};this.playCallbackInfo=JSON.parse(JSON.stringify(w));const I=this.mapCameraEvents.get("played");for(let A of I){if(!A)continue;const V=JSON.parse(JSON.stringify(w));setTimeout(()=>A.apply(this,[V]),0)}return this._recordedStates.videoPlaying=!0,w}if(this.singleFrameMode)return h&&h.notTriggerSingleFrameClick||this._clickIptSingleFrameMode(),this.playCallbackInfo={width:0,height:0,deviceId:null},JSON.parse(JSON.stringify(this.playCallbackInfo));if(!this._video)return this.playCallbackInfo=null,null;const g=++this.iPlayRound;let _=null,v=0,b=0;if(this._currentCamera&&(_=this._currentCamera.deviceId),this._video&&(v=this._video.videoWidth,b=this._video.videoHeight),this.promisePlay&&(yield this.promisePlay,g<this.iPlayRound))return this.playCallbackInfo={width:this._video.videoWidth,height:this._video.videoHeight,deviceId:this._currentCamera&&this._currentCamera.deviceId},JSON.parse(JSON.stringify(this.playCallbackInfo));this.promisePlay=(()=>Te(this,void 0,void 0,function*(){var w;try{let le=function(de){return Te(this,void 0,void 0,function*(){for(let a of ne){I(),a&&(yield new Promise(s=>setTimeout(s,a))),I();{const s=de.video.deviceId;re=s?s.exact||s.ideal||s:null}try{he._onLog&&he._onLog("DCE: ask "+JSON.stringify(de)),K=yield navigator.mediaDevices.getUserMedia(de),I();break}catch(s){$=s,he._onLog&&he._onLog("DCE: "+s.message||s)}}})};this._video&&this._video.srcObject&&this.stop(),he._onLog&&he._onLog("DCE: ======before video========");const I=()=>{if(!this._video)throw K&&K.getTracks().forEach(de=>{de.stop()}),this._videoTrack=null,this._currentCamera=null,new Error("'video' is null.")},A=this.getVideoSettings();let V;typeof A.video=="boolean"&&(A.video={});const J=["rear","back","r\xFCck","arri\xE8re","trasera","tr\xE1s","traseira","posteriore","\u540E\u9762","\u5F8C\u9762","\u80CC\u9762","\u540E\u7F6E","\u5F8C\u7F6E","\u80CC\u7F6E","\u0437\u0430\u0434\u043D\u0435\u0439","\u0627\u0644\u062E\u0644\u0641\u064A\u0629","\uD6C4","arka","achterzijde","\u0E2B\u0E25\u0E31\u0E07","baksidan","bagside","sau","bak","tylny","takakamera","belakang","\u05D0\u05D7\u05D5\u05E8\u05D9\u05EA","\u03C0\u03AF\u03C3\u03C9","spate","h\xE1ts\xF3","zadn\xED","darrere","zadn\xE1","\u0437\u0430\u0434\u043D\u044F","stra\u017Enja","belakang","\u092C\u0948\u0915"],q=()=>{for(let de of this._allCameras){let a=de.label.toLowerCase();if(a&&J.some(s=>a.indexOf(s)!=-1)&&/\b0(\b)?/.test(a)){delete A.video.facingMode,A.video.deviceId={ideal:de.deviceId};break}}A.video.deviceId||["Android","HarmonyOS"].indexOf(ke.OS)==-1||(delete A.video.facingMode,A.video.deviceId={ideal:this._allCameras[this._allCameras.length-1].deviceId})};if(t)delete A.video.facingMode,A.video.deviceId={exact:t};else if(!A.video.deviceId){if(this._lastDeviceId)delete A.video.facingMode,A.video.deviceId={exact:this._lastDeviceId};else if(this.ifSaveLastUsedCamera&&he.isStorageAvailable&&window.localStorage.getItem("dce_last_camera_id")){delete A.video.facingMode,A.video.deviceId={exact:window.localStorage.getItem("dce_last_camera_id")};const de=JSON.parse(window.localStorage.getItem("dce_last_apply_width")),a=JSON.parse(window.localStorage.getItem("dce_last_apply_height"));de&&a&&(A.video.width=de,A.video.height=a)}else if(!this.ifSkipCameraInspection){if(A.video.facingMode){if(ke.OS!=="iPhone"&&ke.OS!=="Mac"&&(yield this.getAllCameras(!0)),!this._video)return null;let de=A.video.facingMode;de instanceof Array&&de.length&&(de=de[0]),de=de.exact||de.ideal||de,de==="environment"&&(V=!!A.video.facingMode,q())}}}let K;n&&(A.video.width={ideal:n}),o&&(A.video.height={ideal:o}),he._onLog&&he._onLog("DCE: ======try getUserMedia========");let Z,ne=[0,500],$=null,re=null;if(yield le(A),K||(he._onLog&&he._onLog("DCE: ======try getUserMedia again========"),Z=JSON.parse(JSON.stringify(A)),typeof Z.video=="object"&&(ke.OS=="iPhone"?(n>=1280||o>=1280?Z.video.width=1280:n>=640||o>=640?Z.video.width=640:(n<640||o<640)&&(Z.video.width=320),delete Z.video.height):V&&!A.video.deviceId?(delete Z.video.facingMode,this._allCameras.length&&(Z.video.deviceId={ideal:this._allCameras[this._allCameras.length-1].deviceId})):Z.video=!0),he._onLog&&he._onLog("DCE: "+Z),yield le(Z)),K||(ne=[1e3,2e3],yield le(A)),K||(yield le(Z)),!K)throw $;const pe=()=>{const de=K.getVideoTracks();let a,s;if(de.length&&(a=this._videoTrack=de[0]),this._video&&a){const l=a.getSettings();if(l){for(let u of this._allCameras)if(l.deviceId===u.deviceId){u._checked=!0,u.label=a.label,s=u;break}}if(!s&&re){for(let u of this._allCameras)if(re==u.deviceId){a.label&&(u._checked=!0,u.label=a.label),s=u;break}}}this._currentCamera=s};if(yield this.getAllCameras(!0),I(),V){pe(),q();let de=A.video.deviceId;de&&(de=de.exact||de.ideal||de);let a=(w=this._currentCamera)===null||w===void 0?void 0:w.deviceId;!de||a&&de==a||(K.getTracks().forEach(s=>{s.stop()}),ne=[0,500,1e3,2e3],yield le(A))}I(),yield(()=>Te(this,void 0,void 0,function*(){he._onLog&&he._onLog("======play video========"),yield new Promise((de,a)=>{I(),this._video.onloadedmetadata=()=>Te(this,void 0,void 0,function*(){I(),this._video.onloadedmetadata=null,yield this._video.play(),de()}),this._video.srcObject=K,setTimeout(()=>a(new Error("Failed to play video. Timeout.")),4e3)})}))(),I(),he._onLog&&he._onLog("DCE: ======played video========"),this._bgLoading&&(this._bgLoading.style.animationPlayState="paused");const y=this._video.videoWidth+"x"+this._video.videoHeight;this._optGotRsl&&(this._optGotRsl.setAttribute("data-width",this._video.videoWidth),this._optGotRsl.setAttribute("data-height",this._video.videoHeight),this._optGotRsl.innerText=y,this._selRsl&&this._optGotRsl.parentNode==this._selRsl&&(this._selRsl.value="got")),he._onLog&&he._onLog("DCE: got "+y),pe(),I(),this._renderSelCameraInfo();const me={width:this._video.videoWidth,height:this._video.videoHeight,deviceId:this._currentCamera&&this._currentCamera.deviceId};me.deviceId&&(this._lastDeviceId=me.deviceId,this.ifSaveLastUsedCamera&&he.isStorageAvailable&&(window.localStorage.setItem("dce_last_camera_id",this._lastDeviceId),A.video.width&&A.video.height&&(window.localStorage.setItem("dce_last_apply_width",JSON.stringify(A.video.width)),window.localStorage.setItem("dce_last_apply_height",JSON.stringify(A.video.height)))));const ce=this.mapCameraEvents.get("played");for(let de of ce){if(!de)continue;const a=JSON.parse(JSON.stringify(me));setTimeout(()=>de.apply(this,[a]),0)}if(_&&_!=me.deviceId){const de=this.mapCameraEvents.get("cameraChange");for(let a of de){if(!a)continue;const s=JSON.parse(JSON.stringify(me));setTimeout(()=>a.apply(this,[s]),0)}}if(v&&b&&(v!=me.width||b!=me.height)){this._updateScanRegionCanvas(),this._updateScanAreaDiv(),this._updateViewDecorator();for(let a of this._arrScanRegionOverlays)a&&this._updateScanRegionOverlay(a);this._cvsOriginalImage||this._updateDrawingLayersSize();const de=this.mapCameraEvents.get("resolutionChange");for(let a of de){if(!a)continue;const s=JSON.parse(JSON.stringify(me));setTimeout(()=>a.apply(this,[s]),0)}}return this.promisePlay=null,me}catch(I){throw this.promisePlay=null,this._bgLoading&&(this._bgLoading.style.display="none"),I.name==="NotFoundError"&&(DOMException?I=new DOMException("No camera available, please use a device with an accessible camera.",I.name):(I=new Error("No camera available, please use a device with an accessible camera.")).name="NotFoundError"),I}}))();const C=yield this.promisePlay;return this.playCallbackInfo=JSON.parse(JSON.stringify(C)),this._recordedStates.videoPlaying=!0,C})}resume(){return Te(this,void 0,void 0,function*(){this._assertOpen(),yield this.play(),this.ifShowScanRegionLaser&&this.showScanRegionLaser()})}pause(){this._assertOpen(),this._video&&(this._video.pause(),this._recordedStates.videoPlaying=!1),this.ifShowScanRegionLaser&&this.hideScanRegionLaser()}_bindUI(){if(!this.UIElement)throw new Error("Need to define `UIElement` before opening.");const t=[this.UIElement];for(let n=0;n<t.length;++n)for(let o of t[n].children)t.push(o);for(let n of t){if(!this._video&&n.classList.contains("dce-video-container")){this._divVideoContainer=n;const o=document.createElement("video");o.style.position="absolute",o.style.left="0",o.style.top="0",o.style.width="100%",o.style.height="100%",o.style.objectFit=this.getVideoFit(),o.setAttribute("playsinline","true"),o.setAttribute("muted","true"),n.prepend(o),this._video=o}else!this._divScanArea&&n.classList.contains("dce-scanarea")?this._divScanArea=n:!this._divScanLight&&n.classList.contains("dce-scanlight")?this._divScanLight=n:!this._bgLoading&&n.classList.contains("dce-bg-loading")?this._bgLoading=n:!this._bgCamera&&n.classList.contains("dce-bg-camera")?this._bgCamera=n:!this._selCam&&n.classList.contains("dce-sel-camera")?this._selCam=n:!this._selRsl&&n.classList.contains("dce-sel-resolution")?(this._selRsl=n,this.videoSrc||this.singleFrameMode||this._selRsl.options.length||(this._selRsl.innerHTML=[this._optGotRsl?"":'<option class="dce-opt-gotResolution" value="got"></option>','<option data-width="3840" data-height="2160">3840x2160</option>','<option data-width="1920" data-height="1080">1920x1080</option>','<option data-width="1280" data-height="720">1280x720</option>'].join(""),this._optGotRsl=this._optGotRsl||this._selRsl.options[0])):!this._optGotRsl&&n.classList.contains("dce-opt-gotResolution")?this._optGotRsl=n:!this._btnClose&&n.classList.contains("dce-btn-close")?this._btnClose=n:!this._selMinLtr&&n.classList.contains("dlr-sel-minletter")?(this._selMinLtr=n,this._selMinLtr.options.length||(this._selMinLtr.innerHTML=[this._optGotMinLtr?"":'<option class="dlr-opt-gotMinLtr" value="got"></option>','<option value="0" selected>any letter</option>','<option value="3">3+ letters</option>','<option value="5">5+ letters</option>','<option value="8">8+ letters</option>','<option value="12">12+ letters</option>','<option value="17">17+ letters</option>','<option value="30">30+ letters</option>','<option value="50">50+ letters</option>','<option value="80">80+ letters</option>','<option value="120">120+ letters</option>'].join(""),this._optGotMinLtr=this._optGotMinLtr||this._selMinLtr.options[0])):!this._optGotMinLtr&&n.classList.contains("dlr-opt-gotMinLtr")&&(this._optGotMinLtr=n);if(this.extraBindings&&this.extraBindings.length)for(let o of this.extraBindings)try{o(n)}catch{}}if(!this._video)throw this._unbindUI(),Error("Can not find the video container element with class 'dce-video-container'");this.singleFrameMode?(this._video&&(this._video.addEventListener("click",this._clickIptSingleFrameMode),this._video.style.cursor="pointer",this._video.setAttribute("title","Take a photo")),this._selCam&&(this._selCam.style.display="none"),this._selRsl&&(this._selRsl.style.display="none"),this._selMinLtr&&(this._selMinLtr.style.display="none"),this._bgCamera&&(this._bgCamera.style.display="block")):(this._selCam&&(this._selCam.style.display="block",this._selCam.addEventListener("change",this._onCameraSelChange)),this._selRsl&&(this._selRsl.style.display="block",this._selRsl.addEventListener("change",this._onResolutionSelChange)),this._selMinLtr&&(this._selMinLtr.style.display="block"),this._bgLoading&&(this._bgLoading.style.display="block")),this._btnClose&&this._btnClose.addEventListener("click",this._onCloseBtnClick),document.addEventListener("visibilitychange",this._ev_documentHideEvent),window.ResizeObserver?(this._resizeObserver||(this._resizeObserver=new ResizeObserver(n=>{for(let o of n)o.target===this._divVideoContainer&&this._updateLayers()})),this._divVideoContainer&&this._resizeObserver.observe(this._divVideoContainer)):window.addEventListener("resize",this._updateLayers)}_unbindUI(){this.singleFrameMode?(this._video&&(this._video.removeEventListener("click",this._clickIptSingleFrameMode),this._video.style.cursor="",this._video.removeAttribute("title")),this._bgCamera&&(this._bgCamera.style.display="none")):this._bgLoading&&(this._bgLoading.style.display="none"),this._selCam&&this._selCam.removeEventListener("change",this._onCameraSelChange),this._selRsl&&this._selRsl.removeEventListener("change",this._onResolutionSelChange),this._btnClose&&this._btnClose.removeEventListener("click",this._onCloseBtnClick),this.hideScanRegionLaser(),this.hideViewDecorator(),this.hideScanRegionOverlays(),this._drawingLayersManager.setVisible(!1),this._hideOriginalImageCvs(),this._video&&(this._video.onloadedmetadata=null,this._video.remove()),this._divVideoContainer=null,this._video=null,this._selCam=null,this._selRsl=null,this._optGotRsl=null,this._btnClose=null,this._selMinLtr=null,this._optGotMinLtr=null,this._divScanArea=null,this._divScanLight=null,this._cvsScanRegion&&(this._cvsScanRegion.remove(),this._cvsScanRegion=null),this._singleFrameModeIpt&&(this._singleFrameModeIpt.remove(),this._singleFrameModeIpt=null),this._cvsSingleFrameMode&&(this._cvsSingleFrameMode.remove(),this._cvsSingleFrameMode=null),document.removeEventListener("visibilitychange",this._ev_documentHideEvent),window.ResizeObserver?this._resizeObserver&&this._resizeObserver.disconnect():window.removeEventListener("resize",this._updateLayers)}_assertOpen(){if(!this._bOpen)throw Error("The camera is not open.")}open(t){return Te(this,void 0,void 0,function*(){this.UIElement||(yield this.setUIElement(he.defaultUIElementURL)),this._bindUI(),t&&this.appendAndShowUI();let n=yield this.play();this.bOpen=!0;const o=this.mapCameraEvents.get("cameraOpen");for(let h of o){if(!h)continue;const g=JSON.parse(JSON.stringify(n));setTimeout(()=>h.apply(this,[g]),0)}return n})}close(t){if(!this._video)return;this.stop(),this._hideOriginalImage(!1),this._unbindUI(),t&&this.hideUI(),this.stopFetchingLoop(),this.bOpen=!1;const n=this.mapCameraEvents.get("cameraClose");for(let o of n){if(!o)continue;const h={width:0,height:0,deviceId:null};setTimeout(()=>o.apply(this,[h]),0)}}stop(){this._video&&this._video.srcObject&&(he._onLog&&he._onLog("DCE: ======stop video========"),this._video.srcObject.getTracks().forEach(t=>{t.stop()}),this._video.srcObject=null,this._videoTrack=null,this._currentCamera=null),this._video&&this.videoSrc&&(he._onLog&&he._onLog("DCE: ======stop existing video========"),this._video.pause(),this._video.currentTime=0),this._bgLoading&&(this._bgLoading.style.animationPlayState=""),this._frameQueue.length=0,this._reusedCvs&&this._reusedCvs.ctx2d&&this._reusedCvs.ctx2d.clearRect(0,0,this._reusedCvs.width,this._reusedCvs.height),this.forceLoseContext()}getAllCameras(t){return Te(this,void 0,void 0,function*(){let n=yield navigator.mediaDevices.enumerateDevices();if(!t&&n&&n.length&&!n[0].deviceId){let g=yield navigator.mediaDevices.getUserMedia({video:!0});n=yield navigator.mediaDevices.enumerateDevices(),g.getTracks().forEach(_=>{_.stop()}),g=null}const o=[],h=[];if(this._allCameras)for(let g of this._allCameras)g._checked&&h.push(g);for(let g=0;g<n.length;g++){let _,v=n[g];if(v.kind=="videoinput"){for(let b of h)v.deviceId==b.deviceId&&(_=b);_||(_={},_.deviceId=v.deviceId,_.label=v.label?v.label:"camera "+g),o.push(_)}}return this._allCameras=o,he._onLog&&he._onLog("DCE: "+JSON.stringify(this._allCameras)),Promise.resolve(o)})}_renderSelCameraInfo(){if(this._selCam&&(this._selCam.innerHTML=""),this._selCam){let t;for(let n of this._allCameras){let o=document.createElement("option");o.value=n.deviceId,o.innerText=n.label,this._selCam.append(o),n.deviceId&&this._currentCamera&&this._currentCamera.deviceId==n.deviceId&&(t=o)}this._selCam.value=t?t.value:""}}getSelectedCamera(){if(!this._bOpen){let t="";const n=this.videoSettings.video.deviceId;n&&(t=n.exact||n.ideal||n);for(let o of this._allCameras)if(o.deviceId===t)return JSON.parse(JSON.stringify(o));return{deviceId:t,label:"",_checked:!1}}return this._currentCamera}selectCamera(t){return Te(this,void 0,void 0,function*(){let n="";return t&&(n=t.deviceId||t),this.videoSettings.video.deviceId={exact:n},this._bOpen?yield this.play(t.deviceId||t):null})}getResolution(){if(this._bOpen)return[this._video.videoWidth,this._video.videoHeight];{let t=0,n=0;const o=this.videoSettings.video.width,h=this.videoSettings.video.height;return o&&(t=o.exact||o.ideal||o),h&&(n=h.exact||h.ideal||h),[t,n]}}setResolution(t,n){return Te(this,void 0,void 0,function*(){let o,h;return t instanceof Array?(o=t[0],h=t[1]):(o=t,h=n),this.videoSettings.video.width={ideal:o},this.videoSettings.video.height={ideal:h},this._bOpen?yield this.play(null,o,h):null})}getResolutions(t){return Te(this,void 0,void 0,function*(){let n="";const o=(g,_)=>{const v=this._mapCameraResolutions.get(g);if(!v||!v.length)return!1;for(let b of v)if(b[0]===_.width&&b[1]===_.height)return!0;return!1},h=(g,_,v)=>Te(this,void 0,void 0,function*(){const b={video:{deviceId:{exact:g},width:{ideal:_},height:{ideal:v}}};let C=null;try{C=yield navigator.mediaDevices.getUserMedia(b)}catch{return null}if(!C)return null;const w=C.getVideoTracks();let I=null;try{const A=w[0].getSettings();I={width:A.width,height:A.height}}catch{const V=document.createElement("video");V.srcObject=C,I={width:V.videoWidth,height:V.videoHeight},V.srcObject=null}return w.forEach(A=>{A.stop()}),I});if(!this._bOpen){const g=this.videoSettings.video.deviceId;if(!g||(n=g.hasOwnProperty("exact")?this.videoSettings.video.deviceId.exact:g.hasOwnProperty("ideal")?this.videoSettings.video.deviceId.ideal:this.videoSettings.video.deviceId,!n))return null;let _=this._mapCameraResolutions.get(n);if(_&&!t)return this._mapCameraResolutions.get(n);this._mapCameraResolutions.set(n,[]),_=this._mapCameraResolutions.get(n);for(let v of this._predefinedResolutions){const b=yield h(n,v.width,v.height);b&&!o(n,b)&&_.push([b.width,b.height])}return _}if(this._currentCamera){n=this._currentCamera.deviceId;let g=this._mapCameraResolutions.get(n);if(g&&!t)return this._mapCameraResolutions.get(n);this._mapCameraResolutions.set(n,[]),g=this._mapCameraResolutions.get(n);const _=this.getConstraints();for(let v of this._predefinedResolutions){yield this._videoTrack.applyConstraints({width:{ideal:v.width},height:{ideal:v.height}});const b=this._videoTrack.getSettings(),C={width:b.width,height:b.height};o(n,C)||g.push([C.width,C.height])}return yield this._videoTrack.applyConstraints(_),g}return null})}on(t,n){if(!this.mapCameraEvents.has(t))throw new Error(`Event '${t}' is not exists.`);const o=this.mapCameraEvents.get(t);o.includes(n)||o.push(n)}off(t,n){if(!this.mapCameraEvents.has(t))throw new Error(`Event '${t}' is not exists.`);const o=this.mapCameraEvents.get(t),h=o.indexOf(n);h!==-1&&o.splice(h,1)}offAll(t){if(t){if(typeof t=="string"){const n=this.mapCameraEvents.get(t);n&&(n.length=0)}}else for(let n of this.mapCameraEvents.values())n&&(n.length=0)}getVideoSettings(){return JSON.parse(JSON.stringify(this.videoSettings))}updateVideoSettings(t){return this.videoSettings=JSON.parse(JSON.stringify(t)),this._lastDeviceId=null,this._bOpen?this.play():Promise.resolve()}isOpen(){return this._bOpen}getCapabilities(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'getCapabilities()' is unavailable in singleFrameMode.");return this._videoTrack&&this._videoTrack.getCapabilities?this._videoTrack.getCapabilities():{}}getCameraSettings(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'getCameraSettings()' is unavailable in singleFrameMode.");return this._videoTrack?this._videoTrack.getSettings():null}getConstraints(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'getConstraints()' is unavailable in singleFrameMode.");return this._videoTrack?this._videoTrack.getConstraints():null}applyConstraints(t){return Te(this,void 0,void 0,function*(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'applyConstraints()' is unavailable in singleFrameMode.");if(!this._videoTrack)throw new Error('"_videoTrack" is null.');if(!this._videoTrack.applyConstraints)throw Error("Not supported.");return yield this._videoTrack.applyConstraints(t)})}turnOnTorch(){return Te(this,void 0,void 0,function*(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'turnOnTorch()' is unavailable in singleFrameMode.");if(this.getCapabilities().torch)return yield this._videoTrack.applyConstraints({advanced:[{torch:!0}]});throw Error("Not supported.")})}turnOffTorch(){return Te(this,void 0,void 0,function*(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'turnOffTorch()' is unavailable in singleFrameMode.");if(this.getCapabilities().torch)return yield this._videoTrack.applyConstraints({advanced:[{torch:!1}]});throw Error("Not supported.")})}setColorTemperature(t){return Te(this,void 0,void 0,function*(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'setColorTemperature()' is unavailable in singleFrameMode.");let n=this.getCapabilities().colorTemperature;if(!n)throw Error("Not supported.");return t<n.min?t=n.min:t>n.max&&(t=n.max),yield this._videoTrack.applyConstraints({advanced:[{colorTemperature:t}]})})}setExposureCompensation(t){return Te(this,void 0,void 0,function*(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'setExposureCompensation()' is unavailable in singleFrameMode.");let n=this.getCapabilities().exposureCompensation;if(!n)throw Error("Not supported.");return t<n.min?t=n.min:t>n.max&&(t=n.max),yield this._videoTrack.applyConstraints({advanced:[{exposureCompensation:t}]})})}setZoom(t){return Te(this,void 0,void 0,function*(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'setZoom()' is unavailable in singleFrameMode.");let n=this.getCapabilities().zoom;if(!n)throw Error("Not supported.");return t<n.min?t=n.min:t>n.max&&(t=n.max),yield this._videoTrack.applyConstraints({advanced:[{zoom:t}]})})}setFrameRate(t){return Te(this,void 0,void 0,function*(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'setFrameRate()' is unavailable in singleFrameMode.");let n=this.getCapabilities().frameRate;if(!n)throw Error("Not supported.");return t<n.min?t=n.min:t>n.max&&(t=n.max),yield this._videoTrack.applyConstraints({width:{ideal:Math.max(this._video.videoWidth,this._video.videoHeight)},frameRate:t})})}getFrameRate(){return this.getCameraSettings().frameRate}setFocus(t,n){return Te(this,void 0,void 0,function*(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'setFocus()' is unavailable in singleFrameMode.");const o=this.getCapabilities().focusMode,h=this.getCapabilities().focusDistance;if(!o||!o.includes(t)||!h)throw Error("Not supported.");return n?(n<h.min?n=h.min:n>h.max&&(n=h.max),yield this._videoTrack.applyConstraints({advanced:[{focusMode:t,focusDistance:n}]})):yield this._videoTrack.applyConstraints({advanced:[{focusMode:t}]})})}getFocus(){const t=this.getCameraSettings().focusMode;return t==="continuous"?{mode:t}:{mode:t,distance:this.getCameraSettings().focusDistance}}getFrameSize(t,n,o,h){if(!t||!n)return null;let g,_,v,b,C=t,w=n;const I={regionLeft:0,regionTop:0,regionRight:C,regionBottom:w,regionMeasuredByPercentage:!1};o?(o.regionMeasuredByPercentage?(I.regionLeft=o.regionLeft*C/100,I.regionTop=o.regionTop*w/100,I.regionRight=o.regionRight*C/100,I.regionBottom=o.regionBottom*w/100):(I.regionLeft=o.regionLeft,I.regionTop=o.regionTop,I.regionRight=o.regionRight,I.regionBottom=o.regionBottom),g=I.regionLeft,_=I.regionTop,C=Math.round(I.regionRight-I.regionLeft),w=Math.round(I.regionBottom-I.regionTop)):(g=0,_=0);const A=Math.max(C,w);if(h&&h>0&&A>h){const V=h/A;C>w?(v=h,b=Math.round(w*V)):(v=Math.round(C*V),b=h)}else v=C,b=w;return v<=0||b<=0?null:{sx:g,sy:_,sWidth:C,sHeight:w,dWidth:v,dHeight:b}}getFrame(){if(this.singleFrameMode)throw Error("'getFrame()' is unavailable in singleFrameMode.");if(this._assertOpen(),this.singleFrameMode)throw new Error("'getFrame()' is unavailable in singleFrameMode.");return this._getVideoFrame(this._scanRegion)}getImage(){const t=this.getFrame();return t.pixelFormat=t.colorMode,Object.assign(Object.assign({},t),{pixelFormat:t.colorMode})}_getVideoFrame(t,n){if(this.isDisposed)throw Error("The 'CameraEnhancer' instance has been disposed.");if(this._assertOpen(),this.singleFrameMode)throw new Error("'_getVideoFrame()' is unavailable in singleFrameMode.");const o=Date.now();he._onLog&&he._onLog("DCE: _getVideoFrame() START: "+o);const h=this._video.videoWidth,g=this._video.videoHeight;if(h===0||g===0)return null;const _=this.getFrameSize(h,g,t,this.maxCvsSideLength);if(!_)return null;let v,b;v=h!==_.sWidth||g!==_.sHeight,b=_.sWidth!==_.dWidth||_.sHeight!==_.dHeight;const C=(()=>!(!this._bWebGLSupported||b))(),w={data:null,region:t?JSON.parse(JSON.stringify(t)):null,sx:_.sx,sy:_.sy,width:_.dWidth,height:_.dHeight,colorMode:null,timeSpent:null,timeStamp:null,isCropped:v,toCanvas:this._toCanvas,_sWidth:_.sWidth,_sHeight:_.sHeight,_bUseWebGL:null};let I;try{I=this._getImageData(this._video,h,g,_,n,{targetColorMode:this.frameColorMode,bUseWebGL:C})}catch(V){if(V.name!=="WebGLError")throw V;he._onLog&&he._onLog("DCE: get WebGLError, try again in canvas."),I=this._getImageData(this._video,h,g,_,n,{targetColorMode:this.frameColorMode,bUseWebGL:!1})}if(!I)return null;const A=Date.now();return he._onLog&&he._onLog("DCE: _getVideoFrame() END: "+A),w.data=I.data,w.colorMode=I.colorMode,w._bUseWebGL=I._bUseWebGL,w.timeSpent=A-o,w.timeStamp=A,w}_getImageData(t,n,o,h,g,_){if(this.isDisposed)throw Error("The 'CameraEnhancer' instance has been disposed.");if(!n||!o)return null;he._onLog&&he._onLog("DCE: _getImageData(), START: "+Date.now());const{sx:v,sy:b,sWidth:C,sHeight:w,dWidth:I,dHeight:A}=h;let V;if(V=_&&_.targetColorMode?_.targetColorMode.toLowerCase():"rgba",_&&_.bUseWebGL){he._onLog&&he._onLog("DCE:  _getImageData() in WebGL."),this._reusedWebGLCvs||(this._reusedWebGLCvs=document.createElement("canvas"));const J=this._reusedWebGLCvs;J.width==n&&J.height==o||(J.width=n,J.height=o,this._reusedWebGLCtx&&this._reusedWebGLCtx.viewport(0,0,n,o));const q=this._reusedWebGLCtx||J.getContext("webgl",{antialias:!1})||J.getContext("experimental-webgl",{antialias:!1});if(!q){he._onLog&&he._onLog("DCE: WebGL unavailable."),this._reusedWebGLCtx=null,this._bWebGLSupported=!1;const $=new Error("WebGL error: unable to initialize WebGL. Your browser or machine may not support it.");throw $.name="WebGLError",$}if(q.enable(q.SCISSOR_TEST),q.scissor(v,b,I,A),!this._reusedWebGLCtx||V!==this.currentFSColorMode){this._reusedWebGLCtx=q;const $=ce=>{const de=ce.createBuffer();ce.bindBuffer(ce.ARRAY_BUFFER,de),ce.bufferData(ce.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,1,1,-1,1]),ce.STATIC_DRAW);const a=ce.createBuffer();return ce.bindBuffer(ce.ELEMENT_ARRAY_BUFFER,a),ce.bufferData(ce.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,0,2,3]),ce.STATIC_DRAW),{position:de,indices:a}},re=ce=>{const de=ce.createTexture();return ce.bindTexture(ce.TEXTURE_2D,de),ce.texParameteri(ce.TEXTURE_2D,ce.TEXTURE_MAG_FILTER,ce.LINEAR),ce.texParameteri(ce.TEXTURE_2D,ce.TEXTURE_MIN_FILTER,ce.LINEAR),ce.texParameteri(ce.TEXTURE_2D,ce.TEXTURE_WRAP_S,ce.CLAMP_TO_EDGE),ce.texParameteri(ce.TEXTURE_2D,ce.TEXTURE_WRAP_T,ce.CLAMP_TO_EDGE),de},le=(ce,de,a)=>{const s=pe(ce,ce.VERTEX_SHADER,de),l=pe(ce,ce.FRAGMENT_SHADER,a),u=ce.createProgram();return ce.attachShader(u,s),ce.attachShader(u,l),ce.linkProgram(u),ce.getProgramParameter(u,ce.LINK_STATUS)?u:(alert("Unable to initialize the shader program: "+ce.getProgramInfoLog(u)),null)},pe=(ce,de,a)=>{const s=ce.createShader(de);return ce.shaderSource(s,a),ce.compileShader(s),ce.getShaderParameter(s,ce.COMPILE_STATUS)?s:(alert("An error occurred compiling the shaders: "+ce.getShaderInfoLog(s)),ce.deleteShader(s),null)},ge=`
                  attribute mediump vec2 aVertexPosition;
                  varying mediump vec2 vDirection;
          
                  void main( void )
                  {
                      gl_Position = vec4(aVertexPosition, 1.0, 1.0) * 2.0;
                      vDirection = aVertexPosition;
                  }
                `;let y;y=["rgba","rbga","grba","gbra","brga","bgra"].includes(V)?V.slice(0,3):"rgb";const me=le(q,ge,`
                    precision mediump float;

                    varying mediump vec2 vDirection;
                    uniform sampler2D uSampler;
                    uniform lowp float uColorFactor;
            
                    void main(void)
                    {
                        vec4 sample = texture2D(uSampler, vec2(vDirection.x * 0.5 + 0.5, vDirection.y * 0.5 + 0.5));
                        lowp float grey = 0.21 * sample.r + 0.71 * sample.g + 0.07 * sample.b;
                        gl_FragColor = vec4(sample.${y} * (1.0 - uColorFactor) + (grey * uColorFactor), sample.a);
                    }
                `);this._webGLProgramInfo={program:me,attribLocations:{vertexPosition:q.getAttribLocation(me,"aVertexPosition")},uniformLocations:{uSampler:q.getUniformLocation(me,"uSampler"),uColorFactor:q.getUniformLocation(me,"uColorFactor")}},this._webGLBuffers=$(q),this._webGLTexture=re(q),this.currentFSColorMode=V}const K=($,re,le)=>{const pe=$.RGBA,ge=$.RGBA,y=$.UNSIGNED_BYTE;$.bindTexture($.TEXTURE_2D,re),$.texImage2D($.TEXTURE_2D,0,pe,ge,y,le)},Z=($,re,le,pe)=>{$.clearColor(0,0,0,1),$.clearDepth(1),$.enable($.DEPTH_TEST),$.depthFunc($.LEQUAL),$.clear($.COLOR_BUFFER_BIT|$.DEPTH_BUFFER_BIT),$.bindBuffer($.ELEMENT_ARRAY_BUFFER,le.indices),$.useProgram(re.program);{const me=$.FLOAT,ce=!1,de=0,a=0;$.bindBuffer($.ARRAY_BUFFER,le.position),$.vertexAttribPointer(re.attribLocations.vertexPosition,2,me,ce,de,a),$.enableVertexAttribArray(re.attribLocations.vertexPosition)}$.activeTexture($.TEXTURE0),$.bindTexture($.TEXTURE_2D,pe),$.uniform1i(re.uniformLocations.uSampler,0),$.uniform1f(re.uniformLocations.uColorFactor,V==="grey"||V==="grey32"?1:0);const ge=$.UNSIGNED_SHORT;$.drawElements($.TRIANGLES,6,ge,0)};let ne;if(K(q,this._webGLTexture,t),Z(q,this._webGLProgramInfo,this._webGLBuffers,this._webGLTexture),g){if(g.length<I*A*4)return null;ne=g}else this.ifReuseArrayBufferView||V==="grey"?(this._reusedDataContainer&&this._reusedDataContainer.length===I*A*4||(this._reusedDataContainer=new Uint8Array(I*A*4)),ne=this._reusedDataContainer):ne=new Uint8Array(I*A*4);if(q.readPixels(v,b,I,A,q.RGBA,q.UNSIGNED_BYTE,ne),q.disable(q.SCISSOR_TEST),ne[3]!==255){he._onLog&&he._onLog("DCE: WebGL drawing incorrect."),this.forceLoseContext(),this._bWebGLSupported=!1;const $=new Error("WebGL error: incorrect WebGL drawing.");throw $.name="WebGLError",$}if(V==="grey"){let $=he._onLog?Date.now():0;if(ne=new Uint8Array(new Uint32Array(ne.buffer)),g){if(g.length<ne.length)return null;g.set(ne)}he._onLog&&he._onLog("DCE: Extract grey cost: "+(Date.now()-$))}return he._onLog&&he._onLog("DCE: _getImageData() in WebGL, END: "+Date.now()),{data:ne,colorMode:V,_bUseWebGL:!0}}{he._onLog&&he._onLog("DCE:  _getImageData() in canvas."),this._reusedCvs||(this._reusedCvs=document.createElement("canvas"));const J=this._reusedCvs;J.width===I&&J.height===A||(J.width=I,J.height=A),J.ctx2d||(J.ctx2d=J.getContext("2d"));const q=J.ctx2d;q.drawImage(t,v,b,C,w,0,0,I,A);let K=q.getImageData(0,0,J.width,J.height).data;if(["rbga","grba","gbra","brga","bgra"].includes(V)){const Z=V.indexOf("r"),ne=V.indexOf("g"),$=V.indexOf("b");let re=0;Z===1||Z===2?re=Z:ne===2&&(re=ne);for(let le=0;le<K.length;le+=4){let pe;re&&(pe=K[le+re]),K[le+Z]=K[le],K[le+ne]=re===1?pe:K[le+1],K[le+$]=re===2?pe:K[le+2]}}else if(V==="grey"||V==="grey32")for(let Z=0;Z<K.length;Z+=4){const ne=.21*K[Z]+.71*K[Z+1]+.07*K[Z+2];K[Z]=ne,K[Z+1]=ne,K[Z+2]=ne}if(K=V==="grey"?new Uint8Array(new Uint32Array(K.buffer)):new Uint8Array(K.buffer),g){if(g.length<K.length)return null;g.set(K)}return he._onLog&&he._onLog("DCE: _getImageData() in canvas, END: "+Date.now()),{data:K,colorMode:V,_bUseWebGL:!1}}}getCurrentRegion(){let t=null;if(this._scanRegion)t=this._scanRegion;else if(this.croppingRegions){if(this._croppingRegionIndex>=this.croppingRegions.length||this._croppingRegionIndex<0)throw new Error("The 'croppingRegionIndex' is out of bounds.");t=this.croppingRegions[this._croppingRegionIndex],this.bIncreaseRegionIndexAuto&&++this._croppingRegionIndex>=this.croppingRegions.length&&(this._croppingRegionIndex=0)}return t}_fetchingLoop(t){if(this.isDisposed)return;if(!this._bOpen||!this.isFetchingLoopStarted())return void this.stopFetchingLoop();const n=()=>{he._onLog&&he._onLog("DCE: start fetching a frame: "+Date.now());const h=this.getCurrentRegion();let g=this._getVideoFrame(h);if(!g)return void(he._onLog&&he._onLog("DCE: get a invalid frame, abandon it: "+Date.now()));for(;this._frameQueue&&this._frameQueue.length>=this.maxNumberOfFramesInBuffer;)this._frameQueue.shift();this._frameQueue.push(g),he._onLog&&he._onLog("DCE: finish fetching a frame: "+Date.now());const _=this.mapCameraEvents.get("frameAddedToBuffer");for(let v of _)v&&setTimeout(v.bind(this),0)},o=()=>{this.isDisposed||(this._frameLoopTimeoutId2&&clearTimeout(this._frameLoopTimeoutId2),this.refreshInterval<=0||(this._frameLoopTimeoutId2=setTimeout(()=>{this.isDisposed||(this._bOpen&&this.isFetchingLoopStarted()?(he._onLog&&he._onLog("DCE: second timeout executes: "+Date.now()),n(),o()):this.stopFetchingLoop())},this.refreshInterval)))};t&&(this._frameQueue.length<this.maxNumberOfFramesInBuffer?(n(),this.refreshInterval>0&&o()):this.refreshInterval>0?(n(),o()):this.refreshInterval===0?n():this.refreshInterval),this._frameLoopTimeoutId&&clearTimeout(this._frameLoopTimeoutId),this._frameLoopTimeoutId=setTimeout(()=>{this.isDisposed||this._fetchingLoop(!0)},this.loopInterval)}startFetchingLoop(){if(this.isDisposed)throw Error("The 'CameraEnhancer' instance has been disposed.");if(this._assertOpen(),this.singleFrameMode)throw Error("'startFetchingLoop()' is unavailable in singleFrameMode.");this.isFetchingLoopStarted()||(this._bFetchingLoopStarted=!0,this._recordedStates.fetchingLoopStart=!0,he._onLog&&he._onLog("start fetching loop: "+Date.now()),this._fetchingLoop(!0))}isFetchingLoopStarted(){return this._bFetchingLoopStarted}stopFetchingLoop(){this._bFetchingLoopStarted&&(he._onLog&&he._onLog("stop fetching loop: "+Date.now()),this._frameLoopTimeoutId&&clearTimeout(this._frameLoopTimeoutId),this._frameQueue.length=0,this._bFetchingLoopStarted=!1,this._recordedStates.fetchingLoopStart=!1)}getFrameFromBuffer(t){return this._frameQueue&&this._frameQueue.length?t?t<this._frameQueue.length?(this._frameLoopTimeoutId2&&clearTimeout(this._frameLoopTimeoutId2),this._frameQueue.splice(t,1)[0]):void 0:(this._frameLoopTimeoutId2&&clearTimeout(this._frameLoopTimeoutId2),this._frameQueue.shift()):null}forceLoseContext(){if(!this._reusedWebGLCtx)return;const t=this._reusedWebGLCtx;t&&!t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").loseContext(),this._webGLTexture=null,this._webGLProgramInfo=null,this._webGLBuffers=null,this._reusedWebGLCtx=null,this._reusedWebGLCvs=null}_createDrawingLayerBaseCvs(){this._assertOpen();const t=this._calculateCvsSize();if(!t)throw new Error("Camera is not open.");const{width:n,height:o,objectFit:h}=t;if(n<=0||o<=0)throw new Error("Invalid dimension of video or image.");const g=document.createElement("canvas");if(g.width==n&&g.height==o||(g.width=n,g.height=o),g.style.objectFit=h,this._scanRegionOverlayContainer)this._scanRegionOverlayContainer.before(g);else if(this._cvsScanRegion)this._cvsScanRegion.before(g);else if(this._cvsSingleFrameMode)this._cvsSingleFrameMode.after(g);else{if(!this._video)throw new Error("'_video' is lost.");this._video.after(g)}return g}_updateDrawingLayersSize(t){let n;if(n=t&&t.width&&t.height&&t.objectFit?{width:t.width,height:t.height,objectFit:t.objectFit}:this._calculateCvsSize(),!n)return;const{width:o,height:h,objectFit:g}=n;this._drawingLayersManager.setDimensions({width:o,height:h},{backstoreOnly:!0}),this._drawingLayersManager.setObjectFit(g)}_createDrawingLayer(t){this._layerBaseCvs||(this._layerBaseCvs=this._createDrawingLayerBaseCvs());const n=this._layerBaseCvs;return this._drawingLayersManager.createDrawingLayer(n,t)}createDrawingLayer(){return this._createDrawingLayer()}getDrawingLayer(t){return this._drawingLayersManager.getDrawingLayer(t)||([1,2,3].includes(t)?this._createDrawingLayer(t):null)}getDrawingLayers(){return this._drawingLayersManager.getDrawingLayers()}getSelectedDrawingItems(){return this._drawingLayersManager.getSelectedDrawingItems()}createDrawingStyle(t){return this._drawingLayersManager.createDrawingStyle(t)}getDrawingStyle(t){return this._drawingLayersManager.getDrawingStyle(t)}getDrawingStyles(){return this._drawingLayersManager.getDrawingStyles()}updateDrawingStyle(t,n){return this._drawingLayersManager.updateDrawingStyle(t,n)}clearDrawingLayers(){this._drawingLayersManager.clearDrawingLayers(),this._layerBaseCvs&&(this._layerBaseCvs.remove(),this._layerBaseCvs=null)}_createControler(){if(this._controler||(this._controler=new Jh(this)),this._controler)return this._controler}_destroyControler(){this._controler=null}setOriginalImage(t,n,o){if(!t||!n||!o)throw new Error("Invalid arguments");this._originalImageData={imageData:t,width:n,height:o};let h=this._cvsOriginalImage;h||(h=document.createElement("canvas"),h.style.position="absolute",h.style.width="100%",h.style.height="100%",h.style.left="0",h.style.top="0",h.style.backgroundColor="white",h.style.objectFit="contain",this._cvsOriginalImage=h),h.width===n&&h.height===o||(h.width=n,h.height=o);const g=h.getContext("2d");g.clearRect(0,0,h.width,h.height),t instanceof Uint8Array||t instanceof Uint8ClampedArray?(t instanceof Uint8Array&&(t=new Uint8ClampedArray(t)),g.putImageData(new ImageData(t,n,o),0,0)):t instanceof HTMLCanvasElement&&g.drawImage(t,0,0),document.body.contains(h)&&h.style.display===""&&this._updateDrawingLayersSize({width:n,height:o,objectFit:"contain"})}getOriginalImage(){return this._originalImageData?Object.assign({},this._originalImageData):null}deleteOriginalImage(){return Te(this,void 0,void 0,function*(){yield this.hideOriginalImage(),this._cvsOriginalImage&&(this._cvsOriginalImage.remove(),this._cvsOriginalImage=null),this._originalImageData=null})}_showOriginalImageCvs(){this._cvsOriginalImage&&this._cvsOriginalImage.style.display=="none"&&(this._cvsOriginalImage.style.display="")}_hideOriginalImageCvs(){this._cvsOriginalImage&&(this._cvsOriginalImage.style.display="none")}showOriginalImage(){if(!this._originalImageData)throw new Error("No original image is set.");const t=this._cvsOriginalImage;if(t.style.display===""&&document.body.contains(t))return;const{width:n,height:o}=this._originalImageData;if(this._updateDrawingLayersSize({width:n,height:o,objectFit:"contain"}),this._bOpen&&(this._video&&!this._video.paused&&this._video.pause(),this._bFetchingLoopStarted&&(this.stopFetchingLoop(),this._recordedStates.fetchingLoopStart=!0),this.ifShowScanRegionMask&&this._cvsScanRegion&&(this._cvsScanRegion.style.display="none"),this.ifShowScanRegionLaser&&this._divScanLight&&(this._divScanLight.style.display="none"),this._cvsViewDecorator&&(this._cvsViewDecorator.style.display="none"),this._scanRegionOverlayContainer&&(this._scanRegionOverlayContainer.style.display="none"),this._selCam&&(this._selCam.parentElement.style.display="none")),!document.body.contains(t))if(this._cvsSingleFrameMode)this._cvsSingleFrameMode.after(t);else{if(!this._video)throw new Error("'video' is null.");this._video.after(t)}this._showOriginalImageCvs()}_hideOriginalImage(t){return Te(this,void 0,void 0,function*(){this._originalImageData&&this._cvsOriginalImage&&this._cvsOriginalImage.style.display!=="none"&&(this._updateDrawingLayersSize(),this._bOpen&&t&&(this._video&&this._recordedStates.videoPlaying&&(yield this.play(null,null,null,{notTriggerSingleFrameClick:!0})),this._recordedStates.fetchingLoopStart&&!this.singleFrameMode&&this.startFetchingLoop(),this.ifShowScanRegionMask&&this._cvsScanRegion&&this._recordedStates.maskShow&&this.showScanRegionMask(),this.ifShowScanRegionLaser&&this._divScanLight&&this._recordedStates.laserShow&&this.showScanRegionLaser(),this._cvsViewDecorator&&this._recordedStates.decoratorShow&&this.showViewDecorator(),this._scanRegionOverlayContainer&&this._recordedStates.overlayShow&&this.showScanRegionOverlays()),this._selCam&&(this._selCam.parentElement.style.display=""),this._hideOriginalImageCvs())})}hideOriginalImage(){return Te(this,void 0,void 0,function*(){return this._hideOriginalImage(!0)})}dispose(t){this.UIElement&&(this._uiOriginalState&&this._uiOriginalState.inDom?this.UIElement.style.display=this._uiOriginalState.display:this.UIElement.style.display="none"),this.clearDrawingLayers(),this.close(),this.forceLoseContext(),this.setViewDecorator(null,null),this._scanRegionOverlayContainer&&this._scanRegionOverlayContainer.remove(),this._arrScanRegionOverlays.length=0,t&&this.UIElement&&this.UIElement.remove(),this.__proto__=null;for(let n in this)delete this[n];Object.defineProperty(this,"isCameraEnhancer",{value:!0}),Object.defineProperty(this,"isDisposed",{value:!0})}}he._jsVersion="3.0.1",he._jsEditVersion="20220803",he._version="JS "+he._jsVersion+"."+he._jsEditVersion,he.browserInfo=ke,he._hasEngineResourceLoaded=!1,he._engineResourcePath=Xh,he._defaultUIElementURL="@engineResourcePath/dce.ui.html";const $h={DT_Arc:class extends Ge{constructor(e,t,n,o,h,g){super(new xe.Circle({left:e,top:t,radius:n,startAngle:o,endAngle:h}),g),this._mediaType="arc"}},DT_Polygon:class extends Ge{constructor(e,t){super(new xe.Polygon(e,{objectCaching:!1}),t);const n=this._fabricObject;let o=n.points.length-1;n.controls=n.points.reduce(function(h,g,_){return h["p"+_]=new xe.Control({positionHandler:ws,actionHandler:xs(_>0?_-1:o,Ts),actionName:"modifyPolygon",pointIndex:_}),h},{})}_extendSet(e,t){if(e==="vertices"){const n=this._fabricObject;n.points=t;const o=n.points.length-1;return n.controls=n.points.reduce(function(h,g,_){return h["p"+_]=new xe.Control({positionHandler:ws,actionHandler:xs(_>0?_-1:o,Ts),actionName:"modifyPolygon",pointIndex:_}),h},{}),n._setPositionDimensions({}),!0}}_extendGet(e){if(e==="vertices"){const t=[],n=this._fabricObject;if(n.selectable)for(let o in n.oCoords)t.push({x:n.oCoords[o].x,y:n.oCoords[o].y});else for(let o in n.getCoords())t.push({x:n.getCoords()[o].x,y:n.getCoords()[o].y});return t}}},DT_Rect:class extends Ge{constructor(e,t,n,o,h){super(new xe.Rect({left:e,top:t,width:n,height:o}),h)}},DT_Image:class extends Ge{constructor(e,t,n,o){super(new xe.Image(e,{left:t,top:n}),o),this.image=e}_extendSet(e,t){if(e==="image"){if(t instanceof HTMLImageElement)return this._fabricObject.setElement(t),this.image=t,!0;if(t instanceof HTMLCanvasElement){const n=new Image;return n.src=t.toDataURL(),this._fabricObject.setElement(n),this.image=t,!0}throw new Error("Unsupported value.")}}_extendGet(e){if(e==="image")return this.image}},DT_Text:class extends Ge{constructor(e,t,n,o){super(new xe.IText(e,{left:t,top:n}),o),this._mediaType="text"}},DT_Line:class extends Ge{constructor(e,t,n){super(new xe.Line([e.x,e.y,t.x,t.y]),n)}_extendSet(e,t){return e==="startPoint"?(this._fabricObject.set("x1",t.x),this._fabricObject.set("y1",t.y),!0):e==="endPoint"?(this._fabricObject.set("x2",t.x),this._fabricObject.set("y2",t.y),!0):void 0}_extendGet(e){return e==="startPoint"?{x:this._fabricObject.get("x1"),y:this._fabricObject.get("y1")}:e==="endPoint"?{x:this._fabricObject.get("x2"),y:this._fabricObject.get("y2")}:void 0}},DT_Group:class extends Ge{constructor(e){super(new xe.Group(e.map(n=>n._getFabricObject())));const t=this.mapEvents;this._fabricObject.onSelect=()=>{this.styleSelector="selected";const n=this.mapEvents.get("select");for(let h of n)h&&h.apply(this);const o=this._fabricObject._objects;for(let h of o)setTimeout(()=>{h.onSelect&&h.onSelect()},0);setTimeout(()=>{this._fabricObject&&this._fabricObject.canvas&&(this._fabricObject.dirty=!0,this._fabricObject.canvas.renderAll())},0)},this._fabricObject.onDeselect=()=>{this.styleSelector="default";const n=t.get("deselect");for(let h of n)h&&h.apply(this);const o=this._fabricObject._objects;for(let h of o)setTimeout(()=>{h.onDeselect&&h.onDeselect()},0);setTimeout(()=>{this._fabricObject&&this._fabricObject.canvas&&(this._fabricObject.dirty=!0,this._fabricObject.canvas.renderAll())},0)}}getChildItems(){return this._fabricObject._objects.map(e=>e.getDrawingItem())}addChildItem(e){if(!e||!e.isDrawingItem)throw TypeError("Illegal drawing item.");this._drawingLayer?this._drawingLayer._updateGroupItem(this,e,"add"):this._fabricObject.addWithUpdate(e._getFabricObject())}removeChildItem(e){e&&e.isDrawingItem&&(this._drawingLayer?this._drawingLayer._updateGroupItem(this,e,"remove"):this._fabricObject.removeWithUpdate(e._getFabricObject()))}}};class St extends G{constructor(){super(),this._barcodeFillStyle="rgba(254,180,32,0.3)",this._barcodeStrokeStyle="rgba(254,180,32,0.9)",this._barcodeLineWidth=1,this._barcodeFillStyleBeforeVerification="rgba(248,252,0,0.2)",this._barcodeStrokeStyleBeforeVerification="transparent",this._barcodeLineWidthBeforeVerification=2,this.bFilterRegionInJs=!0,this._onCameraSelChange=()=>{},this._onResolutionSelChange=()=>{},this._onCloseBtnClick=()=>{},this._onPlayed=null}static get version(){return this._version+`(DCE ${he.getVersion()})`}static _fireHTTPSWarnning(){St.onWarning&&location&&location.protocol!=="https:"&&setTimeout(()=>{St.onWarning&&St.onWarning({id:2,message:"Not connected via SSL (HTTPS), the SDK may not work correctly."})},0)}_fireResolutionWarning(){if(!this.singleFrameMode&&this.onWarning&&this.dce.isOpen()){const t=this.dce.getConstraints();t&&t.width<1280&&t.height<720&&setTimeout(()=>{this.onWarning&&this.onWarning({id:3,message:"Camera resolution too low, please use a higher resolution (720P or better)."})},0)}}getUIElement(){return this.dce.getUIElement()}async setUIElement(t){await this.dce.setUIElement(t)}get singleFrameMode(){return this.dce.singleFrameMode}set singleFrameMode(t){this.dce.singleFrameMode=t,t&&(this.dce.ifShowScanRegionLaser=!1,(async()=>{let n=await this.getScanSettings();n.oneDTrustFrameCount=1,await this.updateScanSettings(n)})())}get onUnduplicatedRead(){return this.onUniqueRead}set onUnduplicatedRead(t){this.onUniqueRead=t}get video(){return this.dce&&this.dce.video}set videoSrc(t){this.dce&&(this.dce.videoSrc=t)}get videoSrc(){return this.dce&&this.dce.videoSrc}_assertOpen(){if(!this.dce.isOpen())throw Error("The scanner is not open.")}set barcodeFillStyle(t){this._barcodeFillStyle=t,this.dce&&this.dce.updateDrawingStyle(3,{fillStyle:t})}get barcodeFillStyle(){return this._barcodeFillStyle}set barcodeStrokeStyle(t){this._barcodeStrokeStyle=t,this.dce&&this.dce.updateDrawingStyle(3,{strokeStyle:t})}get barcodeStrokeStyle(){return this._barcodeStrokeStyle}set barcodeLineWidth(t){this._barcodeLineWidth=t,this.dce&&this.dce.updateDrawingStyle(3,{lineWidth:t})}get barcodeLineWidth(){return this._barcodeLineWidth}set barcodeFillStyleBeforeVerification(t){this._barcodeFillStyleBeforeVerification=t,this._styleIdBeforeVerification&&this.dce.updateDrawingStyle(this._styleIdBeforeVerification,{fillStyle:t})}get barcodeFillStyleBeforeVerification(){return this._barcodeFillStyleBeforeVerification}set barcodeStrokeStyleBeforeVerification(t){this._barcodeStrokeStyleBeforeVerification=t,this._styleIdBeforeVerification&&this.dce.updateDrawingStyle(this._styleIdBeforeVerification,{strokeStyle:t})}get barcodeStrokeStyleBeforeVerification(){return this._barcodeStrokeStyleBeforeVerification}set barcodeLineWidthBeforeVerification(t){this._barcodeLineWidthBeforeVerification=t,this._styleIdBeforeVerification&&this.dce.updateDrawingStyle(this._styleIdBeforeVerification,{lineWidth:t})}get barcodeLineWidthBeforeVerification(){return this._barcodeLineWidthBeforeVerification}set regionMaskFillStyle(t){this.dce.setScanRegionMaskStyle({fillStyle:t})}get regionMaskFillStyle(){return this.dce.regionMaskFillStyle}set regionMaskStrokeStyle(t){this.dce.setScanRegionMaskStyle({strokeStyle:t})}get regionMaskStrokeStyle(){return this.dce.regionMaskStrokeStyle}set regionMaskLineWidth(t){this.dce.setScanRegionMaskStyle({lineWidth:t})}get regionMaskLineWidth(){return this.dce.regionMaskLineWidth}set region(t){this._region=t,this.dce&&(t?t instanceof Array||this.dce.setScanRegion(t):this.dce.setScanRegion(null)),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0}get region(){return this._region}set ifSaveOriginalImageInACanvas(t){this._ifSaveOriginalImageInACanvas=t,this.dce.frameColorMode=t?"rgba":"grey"}get ifSaveOriginalImageInACanvas(){return this._ifSaveOriginalImageInACanvas}async createDCEInstance(){this.dce||(G._onLog&&G._onLog("createDCEInstance()"),he.defaultUIElementURL=null,this.dce=await he.createInstance(),this.dce.refreshInterval=200,this.dce.frameColorMode="grey",this.dce.maxCvsSideLength=this.maxCvsSideLength,this._drawingItemNamespace=$h,G.browserInfo.OS!=="iPhone"&&G.browserInfo.OS!=="Android"&&G.browserInfo.OS!=="HarmonyOS"&&this.dce.setResolution(1920,1080),this._styleIdBeforeVerification=this.dce.createDrawingStyle({fillStyle:"rgba(248,252,0,0.2)",strokeStyle:"transparent",paintMode:"strokeAndFill"}),this.barcodeLineWidth=this._barcodeLineWidth,this.dce.on("cameraChange",()=>{this._drawResults(null),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0}),this.dce.on("resolutionChange",()=>{this._drawResults(null),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0}),this.dce.on("cameraClose",()=>{this._drawResults(null),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0,this._bPauseScan=!1}),this.dce.on("singleFrameAcquired",async t=>{if(!t||!t.data)return;let n;this.ifSaveOriginalImageInACanvas&&(this.oriCanvas=null,this.oriCanvasData={width:t.width,height:t.height,colorMode:t.colorMode,data:new Uint8Array(t.data),toCanvas:t.toCanvas});const{data:o,sx:h,sy:g,width:_,height:v,colorMode:b,timeStamp:C,_sWidth:w,_sHeight:I}=t,A={timeStamp:C};if(b==="grey")n=await this._decodeBuffer_Uint8Array(o,_,v,_,Le.IPF_GrayScaled,A);else if(b==="rgba")n=await this._decodeBuffer_Uint8Array(o,_,v,4*_,Le.IPF_ABGR_8888,A);else{if(b!=="bgra")throw new Error(`Color mode '${b}' is not supported.`);n=await this._decodeBuffer_Uint8Array(o,_,v,4*_,Le.IPF_ARGB_8888,A)}if(await this.clearMapDecodeRecord(),G.recalculateResultLocation(n,h,g,w,I,_,v),this._drawResults(n),this.onFrameRead&&this.isOpen()&&!this._bPauseScan){let V=this._cloneDecodeResults(n);this.onFrameRead(V)}if(this.onUniqueRead&&this.isOpen()&&!this._bPauseScan)for(let V of n)this.onUniqueRead(V.barcodeText,this._cloneDecodeResults(V))}))}set maxCvsSideLength(t){this._maxCvsSideLength=t,this.dce.maxCvsSideLength=t}get maxCvsSideLength(){return this._maxCvsSideLength}static async createInstance(t){let n=new St;n._instanceID=await St.createInstanceInWorker(!0),await n.createDCEInstance(),typeof t=="string"&&(t=JSON.parse(t));for(let o in t)n[o]=t[o];return await n.dce.setUIElement(St.defaultUIElementURL),n.singleFrameMode&&console.warn("The `navigator.mediaDevices.getUserMedia` is unavailable. automatically change to `singleFrameMode`."),St._fireHTTPSWarnning(),n.singleFrameMode||await n.updateRuntimeSettings("single"),n}async decodeCurrentFrame(t){this._assertOpen();let n=null;t&&t.region&&(n=t.region);const o=this.dce._getVideoFrame(n);return this._decode_DCEFrame(o)}async updateRuntimeSettings(t){let n;if(typeof t=="string")if(t=="speed"){let o=await this.getRuntimeSettings();await this.resetRuntimeSettings(),n=await this.getRuntimeSettings(),n.barcodeFormatIds=o.barcodeFormatIds,n.barcodeFormatIds_2=o.barcodeFormatIds_2,o.region&&(n.region=o.region),n.expectedBarcodesCount=0,n.localizationModes=[2,0,0,0,0,0,0,0],n.barcodeZoneMinDistanceToImageBorders=9}else if(t=="balance"){let o=await this.getRuntimeSettings();await this.resetRuntimeSettings(),n=await this.getRuntimeSettings(),n.barcodeFormatIds=o.barcodeFormatIds,n.barcodeFormatIds_2=o.barcodeFormatIds_2,o.region&&(n.region=o.region),n.expectedBarcodesCount=512,n.deblurLevel=3,n.localizationModes=[2,16,0,0,0,0,0,0],n.barcodeZoneMinDistanceToImageBorders=9,n.timeout=1e5}else if(t=="coverage"){let o=await this.getRuntimeSettings();await this.resetRuntimeSettings(),n=await this.getRuntimeSettings(),n.barcodeFormatIds=o.barcodeFormatIds,n.barcodeFormatIds_2=o.barcodeFormatIds_2,o.region&&(n.region=o.region),n.expectedBarcodesCount=512,n.deblurLevel=5,n.scaleDownThreshold=1e5,n.localizationModes=[2,16,4,8,0,0,0,0],n.barcodeZoneMinDistanceToImageBorders=9,n.timeout=1e5}else if(t=="single"){let o=await this.getRuntimeSettings();await this.resetRuntimeSettings(),n=await this.getRuntimeSettings(),n.barcodeFormatIds=o.barcodeFormatIds,n.barcodeFormatIds_2=o.barcodeFormatIds_2,o.region&&(n.region=o.region)}else if(t=="dense"){let o=await this.getRuntimeSettings();await this.resetRuntimeSettings(),this.maxCvsSideLength=4096,n=await this.getRuntimeSettings(),n.barcodeFormatIds=o.barcodeFormatIds,n.barcodeFormatIds_2=o.barcodeFormatIds_2,o.region&&(n.region=o.region),n.expectedBarcodesCount=0,n.deblurLevel=7,n.scaleDownThreshold=1e5,n.localizationModes=[2,8,0,0,0,0,0,0],n.minResultConfidence=0,n.barcodeZoneMinDistanceToImageBorders=9,n.timeout=1e5}else if(t=="distance"){let o=await this.getRuntimeSettings();await this.resetRuntimeSettings(),this.maxCvsSideLength=4096,n=await this.getRuntimeSettings(),n.barcodeFormatIds=o.barcodeFormatIds,n.barcodeFormatIds_2=o.barcodeFormatIds_2,o.region&&(n.region=o.region),n.expectedBarcodesCount=0,n.scaleDownThreshold=1e5,n.localizationModes=[2,8,0,0,0,0,0,0],n.barcodeZoneMinDistanceToImageBorders=9,n.timeout=1e5}else n=JSON.parse(t);else{if(typeof t!="object")throw TypeError("'UpdateRuntimeSettings(settings)': Type of 'settings' should be 'string' or 'PlainObject'.");if(n=JSON.parse(JSON.stringify(t)),n.region instanceof Array){let o=t.region;[o.regionLeft,o.regionTop,o.regionLeft,o.regionBottom,o.regionMeasuredByPercentage].some(h=>h!==void 0)&&(n.region={regionLeft:o.regionLeft||0,regionTop:o.regionTop||0,regionRight:o.regionRight||0,regionBottom:o.regionBottom||0,regionMeasuredByPercentage:o.regionMeasuredByPercentage||0})}}if(!G._bUseFullFeature){if((n.barcodeFormatIds&~(ft.BF_ONED|ft.BF_QR_CODE|ft.BF_PDF417|ft.BF_DATAMATRIX))!=0||n.barcodeFormatIds_2!=0)throw Error("Some of the specified barcode formats are not supported in the compact version. Please try the full-featured version.");if(n.intermediateResultTypes!=0)throw Error("Intermediate results is not supported in the compact version. Please try the full-featured version.")}{let o=n.region;if(this.bFilterRegionInJs?this.userDefinedRegion=JSON.parse(JSON.stringify(o)):this.userDefinedRegion=null,o instanceof Array)if(o.length){for(let h=0;h<o.length;++h){let g=o[h];g&&((g.regionLeft||g.regionTop||g.regionRight||g.regionBottom||g.regionMeasuredByPercentage)&&(g.regionLeft||g.regionTop||g.regionRight!=100||g.regionBottom!=100||!g.regionMeasuredByPercentage)||(o[h]=null))}this.region=o}else this.region=null;else o&&(o.regionLeft||o.regionTop||o.regionRight||o.regionBottom||o.regionMeasuredByPercentage)&&(o.regionLeft||o.regionTop||o.regionRight!=100||o.regionBottom!=100||!o.regionMeasuredByPercentage)?this.region=o:this.region=null;this.bFilterRegionInJs&&(n.region={regionLeft:0,regionTop:0,regionRight:0,regionBottom:0,regionMeasuredByPercentage:0})}await new Promise((o,h)=>{let g=G._nextTaskID++;G._taskCallbackMap.set(g,_=>{if(_.success){try{this._handleRetJsonString(_.updateReturn)}catch(v){h(v)}return o()}{let v=new Error(_.message);return v.stack=_.stack+`
`+v.stack,h(v)}}),G._dbrWorker.postMessage({type:"updateRuntimeSettings",id:g,instanceID:this._instanceID,body:{settings:JSON.stringify(n)}})}),typeof t=="string"&&["speed","balance","coverage","dense","distance"].includes(t)&&(await this.setModeArgument("BinarizationModes",0,"EnableFillBinaryVacancy","1"),await this.setModeArgument("BinarizationModes",0,"BlockSizeX","0"),await this.setModeArgument("BinarizationModes",0,"BlockSizeY","0"))}_bindUI(){if(!this.getUIElement())throw new Error("Need to define `UIElement` before opening.");if(this.dce._bindUI(),!this.dce.video)throw this._unbindUI(),Error("Can not find the video container element with class 'dce-video-container'")}_unbindUI(){this.dce._unbindUI()}set onPlayed(t){this.dce.off("played",this._onPlayed),this._onPlayed=t,this.dce.on("played",this._onPlayed)}get onPlayed(){return this._onPlayed}async getAllCameras(){return this.dce.getAllCameras()}async getCurrentCamera(){return this.dce.getSelectedCamera()}async setCurrentCamera(t){const n=await this.dce.selectCamera(t);return this._fireResolutionWarning(),n}getResolution(){return this.dce.getResolution()}async setResolution(t,n){const o=await this.dce.setResolution(t,n);return this._fireResolutionWarning(),o}getVideoSettings(){return this.dce.getVideoSettings()}updateVideoSettings(t){return this.dce.updateVideoSettings(t)}isOpen(){return this.dce&&this.dce.isOpen()}setVideoFit(t){return this.dce&&this.dce.setVideoFit(t)}set ifShowScanRegionMask(t){this.dce&&(this.dce.ifShowScanRegionMask=t)}get ifShowScanRegionMask(){return this.dce&&this.dce.ifShowScanRegionMask}set ifSaveLastUsedCamera(t){this.dce&&(this.dce.ifSaveLastUsedCamera=t)}get ifSaveLastUsedCamera(){return this.dce&&this.dce.ifSaveLastUsedCamera}set ifSkipCameraInspection(t){this.dce&&(this.dce.ifSkipCameraInspection=t)}get ifSkipCameraInspection(){return this.dce&&this.dce.ifSkipCameraInspection}stop(){this._drawResults(null),this.dce.stop(),this.dce.ifShowScanRegionLaser=!1,this.dce.hideViewDecorator(),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0}pause(){this.dce.pause()}async play(t,n,o){this.dce.ifShowScanRegionLaser=!0;const h=await this.dce.play(t,n,o);return this._fireResolutionWarning(),h}pauseScan(t){this._assertOpen(),t&&t.keepResultsHighlighted||this._drawResults(null),this._bPauseScan=!0,this.dce.ifShowScanRegionLaser=!1,this.dce.stopFetchingLoop()}resumeScan(){this._assertOpen(),this._bPauseScan=!1,this.dce.ifShowScanRegionLaser=!0}getCapabilities(){return this.dce.getCapabilities()}getCameraSettings(){return this.dce.getCameraSettings()}getConstraints(){return this.dce.getConstraints()}async applyConstraints(t){return this.dce.applyConstraints(t)}async turnOnTorch(){return this.dce.turnOnTorch()}async turnOffTorch(){return this.dce.turnOffTorch()}async setColorTemperature(t){return this.dce.setColorTemperature(t)}async setExposureCompensation(t){return this.dce.setExposureCompensation(t)}async setZoom(t){return this.dce.setZoom(t)}async setFrameRate(t){return this.dce.setFrameRate(t)}getFrameRate(){return this.dce.getFrameRate()}async setFocus(t,n){return this.dce.setFocus(t,n)}getFocus(){return this.dce.getFocus()}async _loopReadVideo(){if(this.bDestroyed)return this.dce&&this.dce.stopFetchingLoop(),void this._drawResults(null);if(!this.isOpen())return this._drawResults(null),void await this.clearMapDecodeRecord();if(!this.dce.video||this.dce.video.paused||this._bPauseScan)return G._onLog&&G._onLog("Video or scan is paused. Ask in 1s."),await this.clearMapDecodeRecord(),this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),void(this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},this._intervalDetectVideoPause));G._onLog&&G._onLog("======= once read ======="),G._onLog&&(this._timeStartDecode=Date.now());const t=this._getVideoFrame();if(!t)return G._onLog&&G._onLog("Get invalid frame."),this._drawResults(null),this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),void(this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},0));(async()=>{t._bUseWebGL||t.colorMode!=="grey"||(this.dce.frameColorMode="rgba");let n=[];this.ifSaveOriginalImageInACanvas&&(this.oriCanvas=null,this.oriCanvasData={width:t.width,height:t.height,colorMode:t.colorMode,data:new Uint8Array(t.data),toCanvas:t.toCanvas});const{data:o,sx:h,sy:g,width:_,height:v,colorMode:b,timeStamp:C,_sWidth:w,_sHeight:I}=t,A={timeStamp:C};if(b==="grey")n=await this._decodeBuffer_Uint8Array(o,_,v,_,Le.IPF_GrayScaled,A);else if(b==="rgba")n=await this._decodeBuffer_Uint8Array(o,_,v,4*_,Le.IPF_ABGR_8888,A);else{if(b!=="bgra")throw new Error(`Color mode '${b}' is not supported.`);n=await this._decodeBuffer_Uint8Array(o,_,v,4*_,Le.IPF_ARGB_8888,A)}return G.recalculateResultLocation(n,h,g,w,I,_,v),this._drawResults(n),n})().then(n=>{if(G._onLog&&G._onLog(n),this.captureAndDecodeInParallel){let o=this.array_decodeFrameTimeCost,h=this.array_getFrameTimeCost,g=this._indexCurrentDecodingFrame;const _=()=>{let v=0;if(this.region instanceof Array){let b=0,C=0;b=g+1>=this.region.length?0:g+1,C=b+1>=this.region.length?0:b+1,v=o[b]&&o[b].length&&h[C]&&h[C].length?Math.min(...o[b])-Math.max(...h[C]):0}else if(h&&h.length){let b=Math.min(...o),C=Math.max(...h);b&&C&&(v=b-C)}else v=0;return v>0?v:0};(()=>{if(this.region instanceof Array){for(o[g]&&o[g]instanceof Array||(o[g]=[]);o[g].length>=5;)o[g].shift();o[g].push(this._lastInnerDecodeDuration)}else{for(;o.length>=5;)o.shift();o.push(this._lastInnerDecodeDuration)}})(),this._intervalGetVideoFrame=_()+this.intervalTime,G._onLog&&G._onLog("Next fetching frame loop interval: "+this._intervalGetVideoFrame)}if(this.isOpen()&&this.dce.video&&!this.dce.video.paused&&!this._bPauseScan){if(this.bPlaySoundOnSuccessfulRead&&n.length){let o=!1;this.bPlaySoundOnSuccessfulRead===!0||this.bPlaySoundOnSuccessfulRead==="frame"?o=n.some(h=>h.resultState>=0):this.bPlaySoundOnSuccessfulRead==="unique"&&(o=n.some(h=>h.resultState===0)),o&&(this.beepSound.stop(),this.beepSound.play())}if(navigator.vibrate&&this.bVibrateOnSuccessfulRead&&n.length){let o=!1;if(this.bVibrateOnSuccessfulRead===!0||this.bVibrateOnSuccessfulRead==="frame"?o=n.some(h=>h.resultState>=0):this.bVibrateOnSuccessfulRead==="unique"&&(o=n.some(h=>h.resultState===0)),o)try{navigator.vibrate(this.vibrateDuration)}catch(h){console.warn("Vibration not allowed. User interaction required: "+(h.message||h))}}if(this.onFrameRead){n=n.filter(h=>h.resultState>=0);const o=this._cloneDecodeResults(n);this.onFrameRead(o)}if(this.onUniqueRead){n=n.filter(h=>h.resultState==0);const o=this._cloneDecodeResults(n);for(let h of o)this.onUniqueRead(h.barcodeText,h)}}this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this.intervalTime?this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},this.intervalTime):this._loopReadVideo()}).catch(n=>{this.dce.stopFetchingLoop(),G._onLog&&G._onLog(n.message||n),this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},Math.max(this.intervalTime,1e3)),n.message=="platform error"||console.warn(n.message||n)})}_getVideoFrame(){if(!this.dce)return null;let t;if(this.captureAndDecodeInParallel){G._onLog&&G._onLog("Get frame in parallel.");let n=this.dce.isFetchingLoopStarted();if(this.dce.loopInterval=this._intervalGetVideoFrame,n||this.dce.startFetchingLoop(),!this.dce.numberOfFramesInBuffer)return this.dce.loopInterval=0,null;t=this.dce.getFrameFromBuffer(),(h=>{if(!h)return;let g=h.timeSpent,_=this.array_getFrameTimeCost;for(;_.length>=5;)_.shift();_.push(g)})(t)}else G._onLog&&G._onLog("Get frame in serial."),this.dce.stopFetchingLoop(),t=this.dce.getFrame();return t}async open(){this._bindUI();const t=await this.dce.open();return this._bPauseScan=!1,this.singleFrameMode||(this.dce&&(this.dce.ifShowScanRegionLaser=!0),this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},0)),this._fireResolutionWarning(),this.keepAlive(),t}async openVideo(){this._bindUI(),this.dce.ifShowScanRegionLaser=!1;const t=await this.dce.open();return this._bPauseScan=!0,this.singleFrameMode||(this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},0)),this._fireResolutionWarning(),this.keepAlive(),t}close(){this.dce.close(),this._bPauseScan=!0,this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId)}async show(){this._bindUI();const t=await this.dce.open(!0);return this._bPauseScan=!1,this.singleFrameMode||(this.dce&&(this.dce.ifShowScanRegionLaser=!0),this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},0)),this._fireResolutionWarning(),this.keepAlive(),t}async showVideo(){this._bindUI(),this.dce.ifShowScanRegionLaser=!1;const t=await this.dce.open(!0);return this._bPauseScan=!0,this.singleFrameMode||(this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},0)),this._fireResolutionWarning(),this.keepAlive(),t}hide(){this.dce.close(!0),this._bPauseScan=!0,this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId)}destroyContext(){this.close(),this.dce&&this.dce.dispose(!1),this.bDestroyed||super.destroyContext()}}var Es,As,Is,Os,Rs,Ds,Ms,Ls,Ps,Fs,ks,Bs,Ns,js,Vs,Us,Gs,Ws,Hs,Ys,Xs,zs,qs,Js,$s,Ks,Qs;(function(e){e[e.BICM_DARK_ON_LIGHT=1]="BICM_DARK_ON_LIGHT",e[e.BICM_LIGHT_ON_DARK=2]="BICM_LIGHT_ON_DARK",e[e.BICM_DARK_ON_DARK=4]="BICM_DARK_ON_DARK",e[e.BICM_LIGHT_ON_LIGHT=8]="BICM_LIGHT_ON_LIGHT",e[e.BICM_DARK_LIGHT_MIXED=16]="BICM_DARK_LIGHT_MIXED",e[e.BICM_DARK_ON_LIGHT_DARK_SURROUNDING=32]="BICM_DARK_ON_LIGHT_DARK_SURROUNDING",e[e.BICM_SKIP=0]="BICM_SKIP",e[e.BICM_REV=2147483648]="BICM_REV"})(Es||(Es={})),function(e){e[e.BCM_AUTO=1]="BCM_AUTO",e[e.BCM_GENERAL=2]="BCM_GENERAL",e[e.BCM_SKIP=0]="BCM_SKIP",e[e.BCM_REV=2147483648]="BCM_REV"}(As||(As={})),function(e){e[e.BF2_NULL=0]="BF2_NULL",e[e.BF2_POSTALCODE=32505856]="BF2_POSTALCODE",e[e.BF2_NONSTANDARD_BARCODE=1]="BF2_NONSTANDARD_BARCODE",e[e.BF2_USPSINTELLIGENTMAIL=1048576]="BF2_USPSINTELLIGENTMAIL",e[e.BF2_POSTNET=2097152]="BF2_POSTNET",e[e.BF2_PLANET=4194304]="BF2_PLANET",e[e.BF2_AUSTRALIANPOST=8388608]="BF2_AUSTRALIANPOST",e[e.BF2_RM4SCC=16777216]="BF2_RM4SCC",e[e.BF2_DOTCODE=2]="BF2_DOTCODE",e[e.BF2_PHARMACODE_ONE_TRACK=4]="BF2_PHARMACODE_ONE_TRACK",e[e.BF2_PHARMACODE_TWO_TRACK=8]="BF2_PHARMACODE_TWO_TRACK",e[e.BF2_PHARMACODE=12]="BF2_PHARMACODE"}(Is||(Is={})),function(e){e[e.BM_AUTO=1]="BM_AUTO",e[e.BM_LOCAL_BLOCK=2]="BM_LOCAL_BLOCK",e[e.BM_SKIP=0]="BM_SKIP",e[e.BM_THRESHOLD=4]="BM_THRESHOLD",e[e.BM_REV=2147483648]="BM_REV"}(Os||(Os={})),function(e){e[e.ECCM_CONTRAST=1]="ECCM_CONTRAST"}(Rs||(Rs={})),function(e){e[e.CFM_GENERAL=1]="CFM_GENERAL"}(Ds||(Ds={})),function(e){e[e.CCM_AUTO=1]="CCM_AUTO",e[e.CCM_GENERAL_HSV=2]="CCM_GENERAL_HSV",e[e.CCM_SKIP=0]="CCM_SKIP",e[e.CCM_REV=2147483648]="CCM_REV"}(Ms||(Ms={})),function(e){e[e.CICM_GENERAL=1]="CICM_GENERAL",e[e.CICM_SKIP=0]="CICM_SKIP",e[e.CICM_REV=2147483648]="CICM_REV"}(Ls||(Ls={})),function(e){e[e.CM_IGNORE=1]="CM_IGNORE",e[e.CM_OVERWRITE=2]="CM_OVERWRITE"}(Ps||(Ps={})),function(e){e[e.DM_SKIP=0]="DM_SKIP",e[e.DM_DIRECT_BINARIZATION=1]="DM_DIRECT_BINARIZATION",e[e.DM_THRESHOLD_BINARIZATION=2]="DM_THRESHOLD_BINARIZATION",e[e.DM_GRAY_EQUALIZATION=4]="DM_GRAY_EQUALIZATION",e[e.DM_SMOOTHING=8]="DM_SMOOTHING",e[e.DM_MORPHING=16]="DM_MORPHING",e[e.DM_DEEP_ANALYSIS=32]="DM_DEEP_ANALYSIS",e[e.DM_SHARPENING=64]="DM_SHARPENING",e[e.DM_BASED_ON_LOC_BIN=128]="DM_BASED_ON_LOC_BIN",e[e.DM_SHARPENING_SMOOTHING=256]="DM_SHARPENING_SMOOTHING"}(Fs||(Fs={})),function(e){e[e.DRM_AUTO=1]="DRM_AUTO",e[e.DRM_GENERAL=2]="DRM_GENERAL",e[e.DRM_BROAD_WARP=4]="DRM_BROAD_WARP",e[e.DRM_LOCAL_REFERENCE=8]="DRM_LOCAL_REFERENCE",e[e.DRM_DEWRINKLE=16]="DRM_DEWRINKLE",e[e.DRM_SKIP=0]="DRM_SKIP",e[e.DRM_REV=2147483648]="DRM_REV"}(ks||(ks={})),function(e){e[e.DPMCRM_AUTO=1]="DPMCRM_AUTO",e[e.DPMCRM_GENERAL=2]="DPMCRM_GENERAL",e[e.DPMCRM_SKIP=0]="DPMCRM_SKIP",e[e.DPMCRM_REV=2147483648]="DPMCRM_REV"}(Bs||(Bs={})),function(e){e[e.GTM_INVERTED=1]="GTM_INVERTED",e[e.GTM_ORIGINAL=2]="GTM_ORIGINAL",e[e.GTM_SKIP=0]="GTM_SKIP",e[e.GTM_REV=2147483648]="GTM_REV"}(Ns||(Ns={})),function(e){e[e.IPM_AUTO=1]="IPM_AUTO",e[e.IPM_GENERAL=2]="IPM_GENERAL",e[e.IPM_GRAY_EQUALIZE=4]="IPM_GRAY_EQUALIZE",e[e.IPM_GRAY_SMOOTH=8]="IPM_GRAY_SMOOTH",e[e.IPM_SHARPEN_SMOOTH=16]="IPM_SHARPEN_SMOOTH",e[e.IPM_MORPHOLOGY=32]="IPM_MORPHOLOGY",e[e.IPM_SKIP=0]="IPM_SKIP",e[e.IPM_REV=2147483648]="IPM_REV"}(js||(js={})),function(e){e[e.IRSM_MEMORY=1]="IRSM_MEMORY",e[e.IRSM_FILESYSTEM=2]="IRSM_FILESYSTEM",e[e.IRSM_BOTH=4]="IRSM_BOTH"}(Vs||(Vs={})),function(e){e[e.IRT_NO_RESULT=0]="IRT_NO_RESULT",e[e.IRT_ORIGINAL_IMAGE=1]="IRT_ORIGINAL_IMAGE",e[e.IRT_COLOUR_CLUSTERED_IMAGE=2]="IRT_COLOUR_CLUSTERED_IMAGE",e[e.IRT_COLOUR_CONVERTED_GRAYSCALE_IMAGE=4]="IRT_COLOUR_CONVERTED_GRAYSCALE_IMAGE",e[e.IRT_TRANSFORMED_GRAYSCALE_IMAGE=8]="IRT_TRANSFORMED_GRAYSCALE_IMAGE",e[e.IRT_PREDETECTED_REGION=16]="IRT_PREDETECTED_REGION",e[e.IRT_PREPROCESSED_IMAGE=32]="IRT_PREPROCESSED_IMAGE",e[e.IRT_BINARIZED_IMAGE=64]="IRT_BINARIZED_IMAGE",e[e.IRT_TEXT_ZONE=128]="IRT_TEXT_ZONE",e[e.IRT_CONTOUR=256]="IRT_CONTOUR",e[e.IRT_LINE_SEGMENT=512]="IRT_LINE_SEGMENT",e[e.IRT_FORM=1024]="IRT_FORM",e[e.IRT_SEGMENTATION_BLOCK=2048]="IRT_SEGMENTATION_BLOCK",e[e.IRT_TYPED_BARCODE_ZONE=4096]="IRT_TYPED_BARCODE_ZONE",e[e.IRT_PREDETECTED_QUADRILATERAL=8192]="IRT_PREDETECTED_QUADRILATERAL"}(Us||(Us={})),function(e){e[e.LM_SKIP=0]="LM_SKIP",e[e.LM_AUTO=1]="LM_AUTO",e[e.LM_CONNECTED_BLOCKS=2]="LM_CONNECTED_BLOCKS",e[e.LM_LINES=8]="LM_LINES",e[e.LM_STATISTICS=4]="LM_STATISTICS",e[e.LM_SCAN_DIRECTLY=16]="LM_SCAN_DIRECTLY",e[e.LM_STATISTICS_MARKS=32]="LM_STATISTICS_MARKS",e[e.LM_STATISTICS_POSTAL_CODE=64]="LM_STATISTICS_POSTAL_CODE",e[e.LM_CENTRE=128]="LM_CENTRE",e[e.LM_ONED_FAST_SCAN=256]="LM_ONED_FAST_SCAN",e[e.LM_REV=2147483648]="LM_REV"}(Gs||(Gs={})),function(e){e[e.PDFRM_RASTER=1]="PDFRM_RASTER",e[e.PDFRM_AUTO=2]="PDFRM_AUTO",e[e.PDFRM_VECTOR=4]="PDFRM_VECTOR",e[e.PDFRM_REV=2147483648]="PDFRM_REV"}(Ws||(Ws={})),function(e){e[e.QRECL_ERROR_CORRECTION_H=0]="QRECL_ERROR_CORRECTION_H",e[e.QRECL_ERROR_CORRECTION_L=1]="QRECL_ERROR_CORRECTION_L",e[e.QRECL_ERROR_CORRECTION_M=2]="QRECL_ERROR_CORRECTION_M",e[e.QRECL_ERROR_CORRECTION_Q=3]="QRECL_ERROR_CORRECTION_Q"}(Hs||(Hs={})),function(e){e[e.RPM_AUTO=1]="RPM_AUTO",e[e.RPM_GENERAL=2]="RPM_GENERAL",e[e.RPM_GENERAL_RGB_CONTRAST=4]="RPM_GENERAL_RGB_CONTRAST",e[e.RPM_GENERAL_GRAY_CONTRAST=8]="RPM_GENERAL_GRAY_CONTRAST",e[e.RPM_GENERAL_HSV_CONTRAST=16]="RPM_GENERAL_HSV_CONTRAST",e[e.RPM_SKIP=0]="RPM_SKIP",e[e.RPM_REV=2147483648]="RPM_REV"}(Ys||(Ys={})),function(e){e[e.RCT_PIXEL=1]="RCT_PIXEL",e[e.RCT_PERCENTAGE=2]="RCT_PERCENTAGE"}(Xs||(Xs={})),function(e){e[e.RT_STANDARD_TEXT=0]="RT_STANDARD_TEXT",e[e.RT_RAW_TEXT=1]="RT_RAW_TEXT",e[e.RT_CANDIDATE_TEXT=2]="RT_CANDIDATE_TEXT",e[e.RT_PARTIAL_TEXT=3]="RT_PARTIAL_TEXT"}(zs||(zs={})),function(e){e[e.SUM_AUTO=1]="SUM_AUTO",e[e.SUM_LINEAR_INTERPOLATION=2]="SUM_LINEAR_INTERPOLATION",e[e.SUM_NEAREST_NEIGHBOUR_INTERPOLATION=4]="SUM_NEAREST_NEIGHBOUR_INTERPOLATION",e[e.SUM_SKIP=0]="SUM_SKIP",e[e.SUM_REV=2147483648]="SUM_REV"}(qs||(qs={})),function(e){e[e.TP_REGION_PREDETECTED=1]="TP_REGION_PREDETECTED",e[e.TP_IMAGE_PREPROCESSED=2]="TP_IMAGE_PREPROCESSED",e[e.TP_IMAGE_BINARIZED=4]="TP_IMAGE_BINARIZED",e[e.TP_BARCODE_LOCALIZED=8]="TP_BARCODE_LOCALIZED",e[e.TP_BARCODE_TYPE_DETERMINED=16]="TP_BARCODE_TYPE_DETERMINED",e[e.TP_BARCODE_RECOGNIZED=32]="TP_BARCODE_RECOGNIZED"}(Js||(Js={})),function(e){e[e.TFM_AUTO=1]="TFM_AUTO",e[e.TFM_GENERAL_CONTOUR=2]="TFM_GENERAL_CONTOUR",e[e.TFM_SKIP=0]="TFM_SKIP",e[e.TFM_REV=2147483648]="TFM_REV"}($s||($s={})),function(e){e[e.TROM_CONFIDENCE=1]="TROM_CONFIDENCE",e[e.TROM_POSITION=2]="TROM_POSITION",e[e.TROM_FORMAT=4]="TROM_FORMAT",e[e.TROM_SKIP=0]="TROM_SKIP",e[e.TROM_REV=2147483648]="TROM_REV"}(Ks||(Ks={})),function(e){e[e.TDM_AUTO=1]="TDM_AUTO",e[e.TDM_GENERAL_WIDTH_CONCENTRATION=2]="TDM_GENERAL_WIDTH_CONCENTRATION",e[e.TDM_SKIP=0]="TDM_SKIP",e[e.TDM_REV=2147483648]="TDM_REV"}(Qs||(Qs={}));G.license="DLS2eyJoYW5kc2hha2VDb2RlIjoiMTAwNzM0NzAxLVRYbFhaV0pRY205cVgyUmljZyIsIm1haW5TZXJ2ZXJVUkwiOiJodHRwczovL2Nvbm5hcy5keW5hbXNvZnQuY29tIiwib3JnYW5pemF0aW9uSUQiOiIxMDA3MzQ3MDEiLCJjaGVja0NvZGUiOi0xODE3MTQ1MDl9";G.engineResourcePath="https://cdn.jsdelivr.net/npm/dynamsoft-javascript-barcode@9.3.1/dist/";/*!
  * vue-router v4.1.6
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const ti=typeof window<"u";function Kh(e){return e.__esModule||e[Symbol.toStringTag]==="Module"}const Ee=Object.assign;function Gn(e,t){const n={};for(const o in t){const h=t[o];n[o]=ct(h)?h.map(e):e(h)}return n}const Ri=()=>{},ct=Array.isArray,Qh=/\/$/,Zh=e=>e.replace(Qh,"");function Wn(e,t,n="/"){let o,h={},g="",_="";const v=t.indexOf("#");let b=t.indexOf("?");return v<b&&v>=0&&(b=-1),b>-1&&(o=t.slice(0,b),g=t.slice(b+1,v>-1?v:t.length),h=e(g)),v>-1&&(o=o||t.slice(0,v),_=t.slice(v,t.length)),o=nu(o!=null?o:t,n),{fullPath:o+(g&&"?")+g+_,path:o,query:h,hash:_}}function eu(e,t){const n=t.query?e(t.query):"";return t.path+(n&&"?")+n+(t.hash||"")}function Zs(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function tu(e,t,n){const o=t.matched.length-1,h=n.matched.length-1;return o>-1&&o===h&&ui(t.matched[o],n.matched[h])&&Ma(t.params,n.params)&&e(t.query)===e(n.query)&&t.hash===n.hash}function ui(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function Ma(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(!iu(e[n],t[n]))return!1;return!0}function iu(e,t){return ct(e)?eo(e,t):ct(t)?eo(t,e):e===t}function eo(e,t){return ct(t)?e.length===t.length&&e.every((n,o)=>n===t[o]):e.length===1&&e[0]===t}function nu(e,t){if(e.startsWith("/"))return e;if(!e)return t;const n=t.split("/"),o=e.split("/");let h=n.length-1,g,_;for(g=0;g<o.length;g++)if(_=o[g],_!==".")if(_==="..")h>1&&h--;else break;return n.slice(0,h).join("/")+"/"+o.slice(g-(g===o.length?1:0)).join("/")}var Vi;(function(e){e.pop="pop",e.push="push"})(Vi||(Vi={}));var Di;(function(e){e.back="back",e.forward="forward",e.unknown=""})(Di||(Di={}));function ru(e){if(!e)if(ti){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),Zh(e)}const su=/^[^#]+#/;function ou(e,t){return e.replace(su,"#")+t}function au(e,t){const n=document.documentElement.getBoundingClientRect(),o=e.getBoundingClientRect();return{behavior:t.behavior,left:o.left-n.left-(t.left||0),top:o.top-n.top-(t.top||0)}}const Mn=()=>({left:window.pageXOffset,top:window.pageYOffset});function lu(e){let t;if("el"in e){const n=e.el,o=typeof n=="string"&&n.startsWith("#"),h=typeof n=="string"?o?document.getElementById(n.slice(1)):document.querySelector(n):n;if(!h)return;t=au(h,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.pageXOffset,t.top!=null?t.top:window.pageYOffset)}function to(e,t){return(history.state?history.state.position-t:-1)+e}const or=new Map;function cu(e,t){or.set(e,t)}function hu(e){const t=or.get(e);return or.delete(e),t}let uu=()=>location.protocol+"//"+location.host;function La(e,t){const{pathname:n,search:o,hash:h}=t,g=e.indexOf("#");if(g>-1){let v=h.includes(e.slice(g))?e.slice(g).length:1,b=h.slice(v);return b[0]!=="/"&&(b="/"+b),Zs(b,"")}return Zs(n,e)+o+h}function du(e,t,n,o){let h=[],g=[],_=null;const v=({state:A})=>{const V=La(e,location),J=n.value,q=t.value;let K=0;if(A){if(n.value=V,t.value=A,_&&_===J){_=null;return}K=q?A.position-q.position:0}else o(V);h.forEach(Z=>{Z(n.value,J,{delta:K,type:Vi.pop,direction:K?K>0?Di.forward:Di.back:Di.unknown})})};function b(){_=n.value}function C(A){h.push(A);const V=()=>{const J=h.indexOf(A);J>-1&&h.splice(J,1)};return g.push(V),V}function w(){const{history:A}=window;!A.state||A.replaceState(Ee({},A.state,{scroll:Mn()}),"")}function I(){for(const A of g)A();g=[],window.removeEventListener("popstate",v),window.removeEventListener("beforeunload",w)}return window.addEventListener("popstate",v),window.addEventListener("beforeunload",w),{pauseListeners:b,listen:C,destroy:I}}function io(e,t,n,o=!1,h=!1){return{back:e,current:t,forward:n,replaced:o,position:window.history.length,scroll:h?Mn():null}}function fu(e){const{history:t,location:n}=window,o={value:La(e,n)},h={value:t.state};h.value||g(o.value,{back:null,current:o.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function g(b,C,w){const I=e.indexOf("#"),A=I>-1?(n.host&&document.querySelector("base")?e:e.slice(I))+b:uu()+e+b;try{t[w?"replaceState":"pushState"](C,"",A),h.value=C}catch(V){console.error(V),n[w?"replace":"assign"](A)}}function _(b,C){const w=Ee({},t.state,io(h.value.back,b,h.value.forward,!0),C,{position:h.value.position});g(b,w,!0),o.value=b}function v(b,C){const w=Ee({},h.value,t.state,{forward:b,scroll:Mn()});g(w.current,w,!0);const I=Ee({},io(o.value,b,null),{position:w.position+1},C);g(b,I,!1),o.value=b}return{location:o,state:h,push:v,replace:_}}function gu(e){e=ru(e);const t=fu(e),n=du(e,t.state,t.location,t.replace);function o(g,_=!0){_||n.pauseListeners(),history.go(g)}const h=Ee({location:"",base:e,go:o,createHref:ou.bind(null,e)},t,n);return Object.defineProperty(h,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(h,"state",{enumerable:!0,get:()=>t.state.value}),h}function pu(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),gu(e)}function _u(e){return typeof e=="string"||e&&typeof e=="object"}function Pa(e){return typeof e=="string"||typeof e=="symbol"}const Et={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},Fa=Symbol("");var no;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(no||(no={}));function di(e,t){return Ee(new Error,{type:e,[Fa]:!0},t)}function mt(e,t){return e instanceof Error&&Fa in e&&(t==null||!!(e.type&t))}const ro="[^/]+?",mu={sensitive:!1,strict:!1,start:!0,end:!0},vu=/[.+*?^${}()[\]/\\]/g;function yu(e,t){const n=Ee({},mu,t),o=[];let h=n.start?"^":"";const g=[];for(const C of e){const w=C.length?[]:[90];n.strict&&!C.length&&(h+="/");for(let I=0;I<C.length;I++){const A=C[I];let V=40+(n.sensitive?.25:0);if(A.type===0)I||(h+="/"),h+=A.value.replace(vu,"\\$&"),V+=40;else if(A.type===1){const{value:J,repeatable:q,optional:K,regexp:Z}=A;g.push({name:J,repeatable:q,optional:K});const ne=Z||ro;if(ne!==ro){V+=10;try{new RegExp(`(${ne})`)}catch(re){throw new Error(`Invalid custom RegExp for param "${J}" (${ne}): `+re.message)}}let $=q?`((?:${ne})(?:/(?:${ne}))*)`:`(${ne})`;I||($=K&&C.length<2?`(?:/${$})`:"/"+$),K&&($+="?"),h+=$,V+=20,K&&(V+=-8),q&&(V+=-20),ne===".*"&&(V+=-50)}w.push(V)}o.push(w)}if(n.strict&&n.end){const C=o.length-1;o[C][o[C].length-1]+=.7000000000000001}n.strict||(h+="/?"),n.end?h+="$":n.strict&&(h+="(?:/|$)");const _=new RegExp(h,n.sensitive?"":"i");function v(C){const w=C.match(_),I={};if(!w)return null;for(let A=1;A<w.length;A++){const V=w[A]||"",J=g[A-1];I[J.name]=V&&J.repeatable?V.split("/"):V}return I}function b(C){let w="",I=!1;for(const A of e){(!I||!w.endsWith("/"))&&(w+="/"),I=!1;for(const V of A)if(V.type===0)w+=V.value;else if(V.type===1){const{value:J,repeatable:q,optional:K}=V,Z=J in C?C[J]:"";if(ct(Z)&&!q)throw new Error(`Provided param "${J}" is an array but it is not repeatable (* or + modifiers)`);const ne=ct(Z)?Z.join("/"):Z;if(!ne)if(K)A.length<2&&(w.endsWith("/")?w=w.slice(0,-1):I=!0);else throw new Error(`Missing required param "${J}"`);w+=ne}}return w||"/"}return{re:_,score:o,keys:g,parse:v,stringify:b}}function Su(e,t){let n=0;for(;n<e.length&&n<t.length;){const o=t[n]-e[n];if(o)return o;n++}return e.length<t.length?e.length===1&&e[0]===40+40?-1:1:e.length>t.length?t.length===1&&t[0]===40+40?1:-1:0}function bu(e,t){let n=0;const o=e.score,h=t.score;for(;n<o.length&&n<h.length;){const g=Su(o[n],h[n]);if(g)return g;n++}if(Math.abs(h.length-o.length)===1){if(so(o))return 1;if(so(h))return-1}return h.length-o.length}function so(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const Cu={type:0,value:""},wu=/[a-zA-Z0-9_]/;function Tu(e){if(!e)return[[]];if(e==="/")return[[Cu]];if(!e.startsWith("/"))throw new Error(`Invalid path "${e}"`);function t(V){throw new Error(`ERR (${n})/"${C}": ${V}`)}let n=0,o=n;const h=[];let g;function _(){g&&h.push(g),g=[]}let v=0,b,C="",w="";function I(){!C||(n===0?g.push({type:0,value:C}):n===1||n===2||n===3?(g.length>1&&(b==="*"||b==="+")&&t(`A repeatable param (${C}) must be alone in its segment. eg: '/:ids+.`),g.push({type:1,value:C,regexp:w,repeatable:b==="*"||b==="+",optional:b==="*"||b==="?"})):t("Invalid state to consume buffer"),C="")}function A(){C+=b}for(;v<e.length;){if(b=e[v++],b==="\\"&&n!==2){o=n,n=4;continue}switch(n){case 0:b==="/"?(C&&I(),_()):b===":"?(I(),n=1):A();break;case 4:A(),n=o;break;case 1:b==="("?n=2:wu.test(b)?A():(I(),n=0,b!=="*"&&b!=="?"&&b!=="+"&&v--);break;case 2:b===")"?w[w.length-1]=="\\"?w=w.slice(0,-1)+b:n=3:w+=b;break;case 3:I(),n=0,b!=="*"&&b!=="?"&&b!=="+"&&v--,w="";break;default:t("Unknown state");break}}return n===2&&t(`Unfinished custom RegExp for param "${C}"`),I(),_(),h}function xu(e,t,n){const o=yu(Tu(e.path),n),h=Ee(o,{record:e,parent:t,children:[],alias:[]});return t&&!h.record.aliasOf==!t.record.aliasOf&&t.children.push(h),h}function Eu(e,t){const n=[],o=new Map;t=lo({strict:!1,end:!0,sensitive:!1},t);function h(w){return o.get(w)}function g(w,I,A){const V=!A,J=Au(w);J.aliasOf=A&&A.record;const q=lo(t,w),K=[J];if("alias"in w){const $=typeof w.alias=="string"?[w.alias]:w.alias;for(const re of $)K.push(Ee({},J,{components:A?A.record.components:J.components,path:re,aliasOf:A?A.record:J}))}let Z,ne;for(const $ of K){const{path:re}=$;if(I&&re[0]!=="/"){const le=I.record.path,pe=le[le.length-1]==="/"?"":"/";$.path=I.record.path+(re&&pe+re)}if(Z=xu($,I,q),A?A.alias.push(Z):(ne=ne||Z,ne!==Z&&ne.alias.push(Z),V&&w.name&&!ao(Z)&&_(w.name)),J.children){const le=J.children;for(let pe=0;pe<le.length;pe++)g(le[pe],Z,A&&A.children[pe])}A=A||Z,(Z.record.components&&Object.keys(Z.record.components).length||Z.record.name||Z.record.redirect)&&b(Z)}return ne?()=>{_(ne)}:Ri}function _(w){if(Pa(w)){const I=o.get(w);I&&(o.delete(w),n.splice(n.indexOf(I),1),I.children.forEach(_),I.alias.forEach(_))}else{const I=n.indexOf(w);I>-1&&(n.splice(I,1),w.record.name&&o.delete(w.record.name),w.children.forEach(_),w.alias.forEach(_))}}function v(){return n}function b(w){let I=0;for(;I<n.length&&bu(w,n[I])>=0&&(w.record.path!==n[I].record.path||!ka(w,n[I]));)I++;n.splice(I,0,w),w.record.name&&!ao(w)&&o.set(w.record.name,w)}function C(w,I){let A,V={},J,q;if("name"in w&&w.name){if(A=o.get(w.name),!A)throw di(1,{location:w});q=A.record.name,V=Ee(oo(I.params,A.keys.filter(ne=>!ne.optional).map(ne=>ne.name)),w.params&&oo(w.params,A.keys.map(ne=>ne.name))),J=A.stringify(V)}else if("path"in w)J=w.path,A=n.find(ne=>ne.re.test(J)),A&&(V=A.parse(J),q=A.record.name);else{if(A=I.name?o.get(I.name):n.find(ne=>ne.re.test(I.path)),!A)throw di(1,{location:w,currentLocation:I});q=A.record.name,V=Ee({},I.params,w.params),J=A.stringify(V)}const K=[];let Z=A;for(;Z;)K.unshift(Z.record),Z=Z.parent;return{name:q,path:J,params:V,matched:K,meta:Ou(K)}}return e.forEach(w=>g(w)),{addRoute:g,resolve:C,removeRoute:_,getRoutes:v,getRecordMatcher:h}}function oo(e,t){const n={};for(const o of t)o in e&&(n[o]=e[o]);return n}function Au(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:Iu(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}}}function Iu(e){const t={},n=e.props||!1;if("component"in e)t.default=n;else for(const o in e.components)t[o]=typeof n=="boolean"?n:n[o];return t}function ao(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function Ou(e){return e.reduce((t,n)=>Ee(t,n.meta),{})}function lo(e,t){const n={};for(const o in e)n[o]=o in t?t[o]:e[o];return n}function ka(e,t){return t.children.some(n=>n===e||ka(e,n))}const Ba=/#/g,Ru=/&/g,Du=/\//g,Mu=/=/g,Lu=/\?/g,Na=/\+/g,Pu=/%5B/g,Fu=/%5D/g,ja=/%5E/g,ku=/%60/g,Va=/%7B/g,Bu=/%7C/g,Ua=/%7D/g,Nu=/%20/g;function Pr(e){return encodeURI(""+e).replace(Bu,"|").replace(Pu,"[").replace(Fu,"]")}function ju(e){return Pr(e).replace(Va,"{").replace(Ua,"}").replace(ja,"^")}function ar(e){return Pr(e).replace(Na,"%2B").replace(Nu,"+").replace(Ba,"%23").replace(Ru,"%26").replace(ku,"`").replace(Va,"{").replace(Ua,"}").replace(ja,"^")}function Vu(e){return ar(e).replace(Mu,"%3D")}function Uu(e){return Pr(e).replace(Ba,"%23").replace(Lu,"%3F")}function Gu(e){return e==null?"":Uu(e).replace(Du,"%2F")}function _n(e){try{return decodeURIComponent(""+e)}catch{}return""+e}function Wu(e){const t={};if(e===""||e==="?")return t;const o=(e[0]==="?"?e.slice(1):e).split("&");for(let h=0;h<o.length;++h){const g=o[h].replace(Na," "),_=g.indexOf("="),v=_n(_<0?g:g.slice(0,_)),b=_<0?null:_n(g.slice(_+1));if(v in t){let C=t[v];ct(C)||(C=t[v]=[C]),C.push(b)}else t[v]=b}return t}function co(e){let t="";for(let n in e){const o=e[n];if(n=Vu(n),o==null){o!==void 0&&(t+=(t.length?"&":"")+n);continue}(ct(o)?o.map(g=>g&&ar(g)):[o&&ar(o)]).forEach(g=>{g!==void 0&&(t+=(t.length?"&":"")+n,g!=null&&(t+="="+g))})}return t}function Hu(e){const t={};for(const n in e){const o=e[n];o!==void 0&&(t[n]=ct(o)?o.map(h=>h==null?null:""+h):o==null?o:""+o)}return t}const Yu=Symbol(""),ho=Symbol(""),Fr=Symbol(""),Ga=Symbol(""),lr=Symbol("");function Ci(){let e=[];function t(o){return e.push(o),()=>{const h=e.indexOf(o);h>-1&&e.splice(h,1)}}function n(){e=[]}return{add:t,list:()=>e,reset:n}}function Rt(e,t,n,o,h){const g=o&&(o.enterCallbacks[h]=o.enterCallbacks[h]||[]);return()=>new Promise((_,v)=>{const b=I=>{I===!1?v(di(4,{from:n,to:t})):I instanceof Error?v(I):_u(I)?v(di(2,{from:t,to:I})):(g&&o.enterCallbacks[h]===g&&typeof I=="function"&&g.push(I),_())},C=e.call(o&&o.instances[h],t,n,b);let w=Promise.resolve(C);e.length<3&&(w=w.then(b)),w.catch(I=>v(I))})}function Hn(e,t,n,o){const h=[];for(const g of e)for(const _ in g.components){let v=g.components[_];if(!(t!=="beforeRouteEnter"&&!g.instances[_]))if(Xu(v)){const C=(v.__vccOpts||v)[t];C&&h.push(Rt(C,n,o,g,_))}else{let b=v();h.push(()=>b.then(C=>{if(!C)return Promise.reject(new Error(`Couldn't resolve component "${_}" at "${g.path}"`));const w=Kh(C)?C.default:C;g.components[_]=w;const A=(w.__vccOpts||w)[t];return A&&Rt(A,n,o,g,_)()}))}}return h}function Xu(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function uo(e){const t=gt(Fr),n=gt(Ga),o=Ke(()=>t.resolve(Je(e.to))),h=Ke(()=>{const{matched:b}=o.value,{length:C}=b,w=b[C-1],I=n.matched;if(!w||!I.length)return-1;const A=I.findIndex(ui.bind(null,w));if(A>-1)return A;const V=fo(b[C-2]);return C>1&&fo(w)===V&&I[I.length-1].path!==V?I.findIndex(ui.bind(null,b[C-2])):A}),g=Ke(()=>h.value>-1&&Ju(n.params,o.value.params)),_=Ke(()=>h.value>-1&&h.value===n.matched.length-1&&Ma(n.params,o.value.params));function v(b={}){return qu(b)?t[Je(e.replace)?"replace":"push"](Je(e.to)).catch(Ri):Promise.resolve()}return{route:o,href:Ke(()=>o.value.href),isActive:g,isExactActive:_,navigate:v}}const zu=Ct({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:uo,setup(e,{slots:t}){const n=ot(uo(e)),{options:o}=gt(Fr),h=Ke(()=>({[go(e.activeClass,o.linkActiveClass,"router-link-active")]:n.isActive,[go(e.exactActiveClass,o.linkExactActiveClass,"router-link-exact-active")]:n.isExactActive}));return()=>{const g=t.default&&t.default(n);return e.custom?g:ma("a",{"aria-current":n.isExactActive?e.ariaCurrentValue:null,href:n.href,onClick:n.navigate,class:h.value},g)}}}),Ui=zu;function qu(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function Ju(e,t){for(const n in t){const o=t[n],h=e[n];if(typeof o=="string"){if(o!==h)return!1}else if(!ct(h)||h.length!==o.length||o.some((g,_)=>g!==h[_]))return!1}return!0}function fo(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const go=(e,t,n)=>e!=null?e:t!=null?t:n,$u=Ct({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:n}){const o=gt(lr),h=Ke(()=>e.route||o.value),g=gt(ho,0),_=Ke(()=>{let C=Je(g);const{matched:w}=h.value;let I;for(;(I=w[C])&&!I.components;)C++;return C}),v=Ke(()=>h.value.matched[_.value]);Zi(ho,Ke(()=>_.value+1)),Zi(Yu,v),Zi(lr,h);const b=Cn();return xi(()=>[b.value,v.value,e.name],([C,w,I],[A,V,J])=>{w&&(w.instances[I]=C,V&&V!==w&&C&&C===A&&(w.leaveGuards.size||(w.leaveGuards=V.leaveGuards),w.updateGuards.size||(w.updateGuards=V.updateGuards))),C&&w&&(!V||!ui(w,V)||!A)&&(w.enterCallbacks[I]||[]).forEach(q=>q(C))},{flush:"post"}),()=>{const C=h.value,w=e.name,I=v.value,A=I&&I.components[w];if(!A)return po(n.default,{Component:A,route:C});const V=I.props[w],J=V?V===!0?C.params:typeof V=="function"?V(C):V:null,K=ma(A,Ee({},J,t,{onVnodeUnmounted:Z=>{Z.component.isUnmounted&&(I.instances[w]=null)},ref:b}));return po(n.default,{Component:K,route:C})||K}}});function po(e,t){if(!e)return null;const n=e(t);return n.length===1?n[0]:n}const Wa=$u;function Ku(e){const t=Eu(e.routes,e),n=e.parseQuery||Wu,o=e.stringifyQuery||co,h=e.history,g=Ci(),_=Ci(),v=Ci(),b=Pl(Et);let C=Et;ti&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const w=Gn.bind(null,x=>""+x),I=Gn.bind(null,Gu),A=Gn.bind(null,_n);function V(x,E){let O,P;return Pa(x)?(O=t.getRecordMatcher(x),P=E):P=x,t.addRoute(P,O)}function J(x){const E=t.getRecordMatcher(x);E&&t.removeRoute(E)}function q(){return t.getRoutes().map(x=>x.record)}function K(x){return!!t.getRecordMatcher(x)}function Z(x,E){if(E=Ee({},E||b.value),typeof x=="string"){const R=Wn(n,x,E.path),D=t.resolve({path:R.path},E),M=h.createHref(R.fullPath);return Ee(R,D,{params:A(D.params),hash:_n(R.hash),redirectedFrom:void 0,href:M})}let O;if("path"in x)O=Ee({},x,{path:Wn(n,x.path,E.path).path});else{const R=Ee({},x.params);for(const D in R)R[D]==null&&delete R[D];O=Ee({},x,{params:I(x.params)}),E.params=I(E.params)}const P=t.resolve(O,E),j=x.hash||"";P.params=w(A(P.params));const W=eu(o,Ee({},x,{hash:ju(j),path:P.path})),z=h.createHref(W);return Ee({fullPath:W,hash:j,query:o===co?Hu(x.query):x.query||{}},P,{redirectedFrom:void 0,href:z})}function ne(x){return typeof x=="string"?Wn(n,x,b.value.path):Ee({},x)}function $(x,E){if(C!==x)return di(8,{from:E,to:x})}function re(x){return ge(x)}function le(x){return re(Ee(ne(x),{replace:!0}))}function pe(x){const E=x.matched[x.matched.length-1];if(E&&E.redirect){const{redirect:O}=E;let P=typeof O=="function"?O(x):O;return typeof P=="string"&&(P=P.includes("?")||P.includes("#")?P=ne(P):{path:P},P.params={}),Ee({query:x.query,hash:x.hash,params:"path"in P?{}:x.params},P)}}function ge(x,E){const O=C=Z(x),P=b.value,j=x.state,W=x.force,z=x.replace===!0,R=pe(O);if(R)return ge(Ee(ne(R),{state:typeof R=="object"?Ee({},j,R.state):j,force:W,replace:z}),E||O);const D=O;D.redirectedFrom=E;let M;return!W&&tu(o,P,O)&&(M=di(16,{to:D,from:P}),d(P,P,!0,!1)),(M?Promise.resolve(M):me(D,P)).catch(L=>mt(L)?mt(L,2)?L:p(L):r(L,D,P)).then(L=>{if(L){if(mt(L,2))return ge(Ee({replace:z},ne(L.to),{state:typeof L.to=="object"?Ee({},j,L.to.state):j,force:W}),E||D)}else L=de(D,P,!0,z,j);return ce(D,P,L),L})}function y(x,E){const O=$(x,E);return O?Promise.reject(O):Promise.resolve()}function me(x,E){let O;const[P,j,W]=Qu(x,E);O=Hn(P.reverse(),"beforeRouteLeave",x,E);for(const R of P)R.leaveGuards.forEach(D=>{O.push(Rt(D,x,E))});const z=y.bind(null,x,E);return O.push(z),ei(O).then(()=>{O=[];for(const R of g.list())O.push(Rt(R,x,E));return O.push(z),ei(O)}).then(()=>{O=Hn(j,"beforeRouteUpdate",x,E);for(const R of j)R.updateGuards.forEach(D=>{O.push(Rt(D,x,E))});return O.push(z),ei(O)}).then(()=>{O=[];for(const R of x.matched)if(R.beforeEnter&&!E.matched.includes(R))if(ct(R.beforeEnter))for(const D of R.beforeEnter)O.push(Rt(D,x,E));else O.push(Rt(R.beforeEnter,x,E));return O.push(z),ei(O)}).then(()=>(x.matched.forEach(R=>R.enterCallbacks={}),O=Hn(W,"beforeRouteEnter",x,E),O.push(z),ei(O))).then(()=>{O=[];for(const R of _.list())O.push(Rt(R,x,E));return O.push(z),ei(O)}).catch(R=>mt(R,8)?R:Promise.reject(R))}function ce(x,E,O){for(const P of v.list())P(x,E,O)}function de(x,E,O,P,j){const W=$(x,E);if(W)return W;const z=E===Et,R=ti?history.state:{};O&&(P||z?h.replace(x.fullPath,Ee({scroll:z&&R&&R.scroll},j)):h.push(x.fullPath,j)),b.value=x,d(x,E,O,z),p()}let a;function s(){a||(a=h.listen((x,E,O)=>{if(!T.listening)return;const P=Z(x),j=pe(P);if(j){ge(Ee(j,{replace:!0}),P).catch(Ri);return}C=P;const W=b.value;ti&&cu(to(W.fullPath,O.delta),Mn()),me(P,W).catch(z=>mt(z,12)?z:mt(z,2)?(ge(z.to,P).then(R=>{mt(R,20)&&!O.delta&&O.type===Vi.pop&&h.go(-1,!1)}).catch(Ri),Promise.reject()):(O.delta&&h.go(-O.delta,!1),r(z,P,W))).then(z=>{z=z||de(P,W,!1),z&&(O.delta&&!mt(z,8)?h.go(-O.delta,!1):O.type===Vi.pop&&mt(z,20)&&h.go(-1,!1)),ce(P,W,z)}).catch(Ri)}))}let l=Ci(),u=Ci(),i;function r(x,E,O){p(x);const P=u.list();return P.length?P.forEach(j=>j(x,E,O)):console.error(x),Promise.reject(x)}function c(){return i&&b.value!==Et?Promise.resolve():new Promise((x,E)=>{l.add([x,E])})}function p(x){return i||(i=!x,s(),l.list().forEach(([E,O])=>x?O(x):E()),l.reset()),x}function d(x,E,O,P){const{scrollBehavior:j}=e;if(!ti||!j)return Promise.resolve();const W=!O&&hu(to(x.fullPath,0))||(P||!O)&&history.state&&history.state.scroll||null;return xr().then(()=>j(x,E,W)).then(z=>z&&lu(z)).catch(z=>r(z,x,E))}const f=x=>h.go(x);let m;const S=new Set,T={currentRoute:b,listening:!0,addRoute:V,removeRoute:J,hasRoute:K,getRoutes:q,resolve:Z,options:e,push:re,replace:le,go:f,back:()=>f(-1),forward:()=>f(1),beforeEach:g.add,beforeResolve:_.add,afterEach:v.add,onError:u.add,isReady:c,install(x){const E=this;x.component("RouterLink",Ui),x.component("RouterView",Wa),x.config.globalProperties.$router=E,Object.defineProperty(x.config.globalProperties,"$route",{enumerable:!0,get:()=>Je(b)}),ti&&!m&&b.value===Et&&(m=!0,re(h.location).catch(j=>{}));const O={};for(const j in Et)O[j]=Ke(()=>b.value[j]);x.provide(Fr,E),x.provide(Ga,ot(O)),x.provide(lr,b);const P=x.unmount;S.add(x),x.unmount=function(){S.delete(x),S.size<1&&(C=Et,a&&a(),a=null,b.value=Et,m=!1,i=!1),P()}}};return T}function ei(e){return e.reduce((t,n)=>t.then(()=>n()),Promise.resolve())}function Qu(e,t){const n=[],o=[],h=[],g=Math.max(t.matched.length,e.matched.length);for(let _=0;_<g;_++){const v=t.matched[_];v&&(e.matched.find(C=>ui(C,v))?o.push(v):n.push(v));const b=e.matched[_];b&&(t.matched.find(C=>ui(C,b))||h.push(b))}return[n,o,h]}const Zu=""+new URL("NULL.f6ddcc99.png",import.meta.url).href,ed=""+new URL("8997788990680.68b2579c.png",import.meta.url).href,td=""+new URL("8991102759342.d9de5189.png",import.meta.url).href,id=""+new URL("8801019606540.eb8e467f.png",import.meta.url).href,nd=""+new URL("8000380005932.1ef4bd3e.png",import.meta.url).href,rd=""+new URL("6935205329080.3940477e.png",import.meta.url).href,sd=""+new URL("6924999633558.ba087760.png",import.meta.url).href,od=""+new URL("6921734924797.a0062c36.png",import.meta.url).href,ad=""+new URL("5034709000295.6be5c21a.png",import.meta.url).href,ld=""+new URL("4014400924268.02d540f6.png",import.meta.url).href,cd=""+new URL("262833.d1859ed8.png",import.meta.url).href,Gi=Mh("counter",()=>{const e=ot([]);let t=null;const n=Cn(!1),o=ot(new Map([["262833",{id:"262833",name:"Mike wafer biscuits",stock:400,price:.6,locality:"New mexico",imgURL:[cd]}],["4014400924268",{id:"4014400924268",name:"Mike wafer biscuits Pack",stock:125,price:5.2,locality:"New mexico",imgURL:[ld]}],["5034709000295",{id:"5034709000295",name:"Potato chips",stock:300,price:4.1,locality:"British",imgURL:[ad]}],["6921734924797",{id:"6921734924797",name:"Ball pen",stock:201,price:2.5,locality:"Tennessee",imgURL:[od]}],["6924999633558",{id:"6924999633558",name:"Marker pen",stock:65,price:2.6,locality:"Boston",imgURL:[sd]}],["6935205329080",{id:"6935205329080",name:"Pencil",stock:102,price:1.5,locality:"Missouri",imgURL:[rd]}],["8000380005932",{id:"8000380005932",name:"Lemon wafer biscuit",stock:54,price:5.4,locality:"New York",imgURL:[nd]}],["8801019606540",{id:"8801019606540",name:"Honey Butter Chip",stock:67,price:6.4,locality:"korea",imgURL:[id]}],["8991102759342",{id:"8991102759342",name:"Tabgo Waffle",stock:30,price:5.55,locality:"Texas",imgURL:[td]}],["8997788990680",{id:"6924999633558",name:"Shrimp Crackers",stock:1,price:4.3,locality:"Indonesia",imgURL:[ed]}]])),h=ot([]),g=ot([]);function _(re){return o.has(re)?o.get(re):null}function v(re,le){_(re).stock-=le}function b(re){return g.find(pe=>pe.id===re)||null}function C(re){if(!!h.find(pe=>pe.id===re)){let pe=h.find(ge=>ge.id===re);for(let ge in h)h[ge].id===re&&h.splice(ge,1);h.unshift(pe)}else{let pe=_(re);if(pe===null){console.log("Don't find item by id:"+re+"in store."),o.set(re,{id:re,name:re,stock:999,price:0,locality:"test for your scan",imgURL:[Zu]}),C(re);return}let ge=b(re);ge===null?h.unshift({id:pe.id,_qty:1}):h.unshift({id:pe.id,_qty:ge._qty})}}function w(re){for(let le in h)h[le].id===re&&h.splice(le,1)}function I(re,le){if(le===0){$("The quantity cannot be 0");return}if(!!!g.find(ge=>ge.id===re))g.push({id:re,_qty:le});else for(let ge of g)ge.id===re&&(ge._qty+=le);$("Successfully added to your cart")}const A=Ke(()=>{let re=0;for(let le of g){let pe=_(le.id).price;re+=pe*10**4*le._qty/10**4}return re});function V(re,le){for(let pe in h)if(h[pe].id===re){h[pe]._qty+=le,h[pe]._qty<=0&&h.splice(pe,1);break}}function J(re,le){for(let pe in g)if(g[pe].id===re){g[pe]._qty+=le,g[pe]._qty<=0&&g.splice(pe,1);break}}const q=ot(new Map([]));function K(){let re=[];for(let ge of g){let y={name:_(ge.id).name,qty:ge._qty,price:_(ge.id).price};re.push(y)}let le=new Date,pe={id:""+le.getUTCMonth()+le.getUTCFullYear()+le.getUTCDate()+le.getUTCHours()+le.getUTCMinutes()+le.getUTCSeconds()+(Math.random()+"").slice(2,8),amount:A.value,date:le.getUTCMonth()+"/"+le.getUTCFullYear()+"/"+le.getUTCDate()+" "+le.getUTCHours()+":"+le.getUTCMinutes()+":"+le.getUTCSeconds(),paymentMethod:"Visa",customerName:"Dynamsoft_Customer",status:!1,items:re};return console.log(pe),pe}function Z(re){q.set(re.id,re)}function ne(re){return q.get(re)}function $(re){e.unshift({text:re,time:new Date}),setTimeout(()=>{e.pop()},900)}return{message_list:e,dbrScanner:t,is_cameraRunning:n,scanItemList:h,cartList:g,totalPrice_FromCartList:A,getItemById_FromStoreMap:_,operateItemStock_onStoreMap:v,delItemById_InScanList:w,addItemById_ToScanList:C,addItemById_ToCratList:I,setOrder_inOrderMap:Z,getOrder_FromOrderMap:ne,NewOrderDetail:K,showMessage:$,itemQtyChange_inScanItemList:V,itemQtyChange_inCartList:J}}),hd={class:"msg-list",scroll:"no"},ud=Ct({__name:"CompMsgBox",setup(e){const t=Gi();return(n,o)=>(He(),rt("div",hd,[Oe(mh,{name:"msg"},{default:ci(()=>[(He(!0),rt(Ue,null,$n(Je(t).message_list,h=>(He(),rt("div",{class:"msg",key:h.time},ni(h.text),1))),128))]),_:1})]))}});const _i=(e,t)=>{const n=e.__vccOpts||e;for(const[o,h]of t)n[o]=h;return n},dd=_i(ud,[["__scopeId","data-v-d84f30fe"]]),fd=Ct({__name:"App",setup(e){return an(async()=>{try{await St.loadWasm()}catch(t){let n=t.message||t;console.error(n),alert(n)}}),an(()=>{let t=0;document.addEventListener("touchstart",function(n){console.log("1",n.touches.length),n.touches.length>1&&n.preventDefault()}),document.addEventListener("touchend",function(n){var o=new Date;o.getTime()-t<=300&&n.preventDefault(),t=o.getTime()},!1),document.addEventListener("gesturestart",function(n){console.log("Two-finger operation interception"),n.preventDefault()})}),(t,n)=>(He(),rt(Ue,null,[Ie("div",null,[Oe(Je(Wa),{style:{background:"#ffffff"}})]),Oe(dd)],64))}});const gd="modulepreload",pd=function(e,t){return new URL(e,t).href},_o={},wi=function(t,n,o){if(!n||n.length===0)return t();const h=document.getElementsByTagName("link");return Promise.all(n.map(g=>{if(g=pd(g,o),g in _o)return;_o[g]=!0;const _=g.endsWith(".css"),v=_?'[rel="stylesheet"]':"";if(!!o)for(let w=h.length-1;w>=0;w--){const I=h[w];if(I.href===g&&(!_||I.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${g}"]${v}`))return;const C=document.createElement("link");if(C.rel=_?"stylesheet":gd,_||(C.as="script",C.crossOrigin=""),C.href=g,document.head.appendChild(C),_)return new Promise((w,I)=>{C.addEventListener("load",w),C.addEventListener("error",()=>I(new Error(`Unable to preload CSS for ${g}`)))})})).then(()=>t())},_d=""+new URL("AD_1.f79527be.jpg",import.meta.url).href,md={class:"comp-item"},vd={class:"btn-info"},yd=["src"],Sd={class:"discount"},bd={class:"text-omit-1-lines"},Cd=Ct({__name:"CompItemBlock_1",props:{item:null},setup(e){const t=e;return Gi(),(n,o)=>(He(),rt("div",md,[Oe(Je(Ui),{to:{name:"info",params:{itemId:t.item.id}}},{default:ci(()=>[Ie("div",vd,[Ie("img",{src:t.item.imgURL[0]},null,8,yd),Ie("div",Sd,[Ie("span",null,"-"+ni(Math.floor(Math.random()*100%40))+"%",1)])])]),_:1},8,["to"]),Ie("span",bd,ni(t.item.name),1),Ie("p",null,"$ "+ni(t.item.price.toFixed(2)),1)]))}});const wd=_i(Cd,[["__scopeId","data-v-6a8e662c"]]),Td={class:"comp-item"},xd=["src"],Ed={class:"text-omit-1-lines"},Ad=Ct({__name:"CompItemBlock_2",props:{item:null},setup(e){const t=e;return Gi(),(n,o)=>(He(),rt("div",Td,[Oe(Je(Ui),{class:"btn-info",to:{name:"info",params:{itemId:t.item.id}}},{default:ci(()=>[Ie("img",{src:t.item.imgURL[0]},null,8,xd)]),_:1},8,["to"]),Ie("span",Ed,ni(t.item.name),1),Ie("p",null,"$ "+ni(t.item.price.toFixed(2)),1)]))}});const Id=_i(Ad,[["__scopeId","data-v-38f3a2a7"]]),Ha=e=>(zo("data-v-36161706"),e=e(),qo(),e),Od={class:"comp-content"},Rd={class:"center"},Dd={href:"#/info/8801019606540",class:"btn-AD"},Md=["src"],Ld={class:"show-area no-wrap"},Pd=Ha(()=>Ie("p",null,"Flash Deals",-1)),Fd={class:"row-list"},kd={class:"show-area wrap"},Bd=Ha(()=>Ie("p",null,"Hot sale",-1)),Nd={class:"row-list"},jd=Ct({__name:"CompContent",setup(e){const t=Gi();let n=[t.getItemById_FromStoreMap("4014400924268"),t.getItemById_FromStoreMap("8000380005932"),t.getItemById_FromStoreMap("5034709000295")],o=[t.getItemById_FromStoreMap("8997788990680"),t.getItemById_FromStoreMap("8991102759342"),t.getItemById_FromStoreMap("8801019606540"),t.getItemById_FromStoreMap("6935205329080"),t.getItemById_FromStoreMap("6935205329080"),t.getItemById_FromStoreMap("6921734924797"),t.getItemById_FromStoreMap("6924999633558"),t.getItemById_FromStoreMap("262833")];return(h,g)=>(He(),rt("div",Od,[Ie("div",Rd,[Ie("a",Dd,[Ie("img",{src:_d},null,8,Md)])]),Ie("div",Ld,[Pd,Ie("div",Fd,[(He(!0),rt(Ue,null,$n(Je(n),_=>(He(),cn(wd,{key:_==null?void 0:_.id,item:_},null,8,["item"]))),128))])]),Ie("div",kd,[Bd,Ie("div",Nd,[(He(!0),rt(Ue,null,$n(Je(o),_=>(He(),cn(Id,{key:_==null?void 0:_.id,item:_},null,8,["item"]))),128))])])]))}});const Vd=_i(jd,[["__scopeId","data-v-36161706"]]),Ud=""+new URL("icon_cart.e1deafcd.svg",import.meta.url).href,Gd=""+new URL("icon_scan.9830e638.svg",import.meta.url).href,Wd=e=>(zo("data-v-9327306b"),e=e(),qo(),e),Hd={class:"comp-nav-bar"},Yd={class:"btn-scan"},Xd=["src"],zd=Wd(()=>Ie("span",null,"Scan Barcode",-1)),qd={class:"btn-cart"},Jd=["src"],$d={key:0,class:"dot"},Kd=Ct({__name:"CompNavBar",setup(e){const t=Gi();return(n,o)=>(He(),rt("div",Hd,[Oe(Je(Ui),{to:"/scan"},{default:ci(()=>[Ie("div",Yd,[Ie("img",{class:"icon-scan",src:Gd},null,8,Xd),zd])]),_:1}),Oe(Je(Ui),{to:"/cart"},{default:ci(()=>[Ie("div",qd,[Ie("img",{src:Ud},null,8,Jd),Je(t).cartList.length!==0?(He(),rt("div",$d)):Fc("",!0)])]),_:1})]))}});const Qd=_i(Kd,[["__scopeId","data-v-9327306b"]]),Zd={class:"view-home"},ef=Ct({__name:"HomeView",setup(e){return(t,n)=>(He(),rt("div",Zd,[Oe(Qd),Oe(Vd)]))}});const tf=_i(ef,[["__scopeId","data-v-d5665399"]]),nf=Ku({history:pu("./"),routes:[{path:"/",name:"home",component:tf},{path:"/scan",name:"scan",component:()=>wi(()=>import("./ScanView.9263f3fa.js"),["./ScanView.9263f3fa.js","./CompNavBar.19ad20b6.js","./CompNavBar.19408ebb.css","./ScanView.1d5ed4fe.css"],import.meta.url)},{path:"/cart",name:"cart",component:()=>wi(()=>import("./CartView.03909844.js"),["./CartView.03909844.js","./CompNavBar.19ad20b6.js","./CompNavBar.19408ebb.css","./CartView.a2f90071.css"],import.meta.url)},{path:"/info/:itemId",name:"info",component:()=>wi(()=>import("./InfoView.9b4f3985.js"),["./InfoView.9b4f3985.js","./CompNavBar.19ad20b6.js","./CompNavBar.19408ebb.css","./InfoView.c8e92a44.css"],import.meta.url),props:!0},{path:"/payment/:orderId",name:"payment",component:()=>wi(()=>import("./PaymentView.9a15d20a.js"),["./PaymentView.9a15d20a.js","./CompNavBar.19ad20b6.js","./CompNavBar.19408ebb.css","./PaymentView.029bac7d.css"],import.meta.url),props:!0},{path:"/receipt/:orderId",name:"receipt",component:()=>wi(()=>import("./ReceiptView.a84826c6.js"),["./ReceiptView.a84826c6.js","./CompNavBar.19ad20b6.js","./CompNavBar.19408ebb.css","./ReceiptView.4907dc90.css"],import.meta.url),props:!0}]});const kr=Th(fd);kr.use(Ah());kr.use(nf);kr.mount("#app");export{Pc as A,gt as B,Zi as C,Ue as F,Ui as R,_i as _,Oe as a,Je as b,rt as c,Ct as d,Ie as e,qo as f,Cn as g,an as h,Dr as i,ta as j,sf as k,of as l,$n as m,cn as n,He as o,zo as p,St as q,rf as r,Fc as s,ni as t,Gi as u,Ke as v,ci as w,hr as x,Ud as y,nf as z};
