(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))r(c);new MutationObserver(c=>{for(const u of c)if(u.type==="childList")for(const g of u.addedNodes)g.tagName==="LINK"&&g.rel==="modulepreload"&&r(g)}).observe(document,{childList:!0,subtree:!0});function i(c){const u={};return c.integrity&&(u.integrity=c.integrity),c.referrerpolicy&&(u.referrerPolicy=c.referrerpolicy),c.crossorigin==="use-credentials"?u.credentials="include":c.crossorigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function r(c){if(c.ep)return;c.ep=!0;const u=i(c);fetch(c.href,u)}})();function ei(e,t){const i=Object.create(null),r=e.split(",");for(let c=0;c<r.length;c++)i[r[c]]=!0;return t?c=>!!i[c.toLowerCase()]:c=>!!i[c]}function vs(e){if(ve(e)){const t={};for(let i=0;i<e.length;i++){const r=e[i],c=je(r)?Gc(r):vs(r);if(c)for(const u in c)t[u]=c[u]}return t}else{if(je(e))return e;if(Oe(e))return e}}const Nc=/;(?![^(]*\))/g,Vc=/:([^]+)/,Uc=/\/\*.*?\*\//gs;function Gc(e){const t={};return e.replace(Uc,"").split(Nc).forEach(i=>{if(i){const r=i.split(Vc);r.length>1&&(t[r[0].trim()]=r[1].trim())}}),t}function ys(e){let t="";if(je(e))t=e;else if(ve(e))for(let i=0;i<e.length;i++){const r=ys(e[i]);r&&(t+=r+" ")}else if(Oe(e))for(const i in e)e[i]&&(t+=i+" ");return t.trim()}const Wc="html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,summary,template,blockquote,iframe,tfoot",Hc="svg,animate,animateMotion,animateTransform,circle,clipPath,color-profile,defs,desc,discard,ellipse,feBlend,feColorMatrix,feComponentTransfer,feComposite,feConvolveMatrix,feDiffuseLighting,feDisplacementMap,feDistanceLight,feDropShadow,feFlood,feFuncA,feFuncB,feFuncG,feFuncR,feGaussianBlur,feImage,feMerge,feMergeNode,feMorphology,feOffset,fePointLight,feSpecularLighting,feSpotLight,feTile,feTurbulence,filter,foreignObject,g,hatch,hatchpath,image,line,linearGradient,marker,mask,mesh,meshgradient,meshpatch,meshrow,metadata,mpath,path,pattern,polygon,polyline,radialGradient,rect,set,solidcolor,stop,switch,symbol,text,textPath,title,tspan,unknown,use,view",Yc=ei(Wc),Xc=ei(Hc),$c="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",zc=ei($c);function Na(e){return!!e||e===""}const Bi=e=>je(e)?e:e==null?"":ve(e)||Oe(e)&&(e.toString===Wa||!Se(e.toString))?JSON.stringify(e,Va,2):String(e),Va=(e,t)=>t&&t.__v_isRef?Va(e,t.value):di(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((i,[r,c])=>(i[`${r} =>`]=c,i),{})}:Ga(t)?{[`Set(${t.size})`]:[...t.values()]}:Oe(t)&&!ve(t)&&!Ha(t)?String(t):t,De=Object.freeze({}),ji=Object.freeze([]),st=()=>{},Ua=()=>!1,qc=/^on[^a-z]/,Sn=e=>qc.test(e),Jn=e=>e.startsWith("onUpdate:"),Fe=Object.assign,bs=(e,t)=>{const i=e.indexOf(t);i>-1&&e.splice(i,1)},Jc=Object.prototype.hasOwnProperty,we=(e,t)=>Jc.call(e,t),ve=Array.isArray,di=e=>gr(e)==="[object Map]",Ga=e=>gr(e)==="[object Set]",Se=e=>typeof e=="function",je=e=>typeof e=="string",Ss=e=>typeof e=="symbol",Oe=e=>e!==null&&typeof e=="object",Cs=e=>Oe(e)&&Se(e.then)&&Se(e.catch),Wa=Object.prototype.toString,gr=e=>Wa.call(e),ws=e=>gr(e).slice(8,-1),Ha=e=>gr(e)==="[object Object]",Ts=e=>je(e)&&e!=="NaN"&&e[0]!=="-"&&""+parseInt(e,10)===e,Nn=ei(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Kc=ei("bind,cloak,else-if,else,for,html,if,model,on,once,pre,show,slot,text,memo"),pr=e=>{const t=Object.create(null);return i=>t[i]||(t[i]=e(i))},Qc=/-(\w)/g,It=pr(e=>e.replace(Qc,(t,i)=>i?i.toUpperCase():"")),Zc=/\B([A-Z])/g,Jt=pr(e=>e.replace(Zc,"-$1").toLowerCase()),yi=pr(e=>e.charAt(0).toUpperCase()+e.slice(1)),si=pr(e=>e?`on${yi(e)}`:""),cn=(e,t)=>!Object.is(e,t),$i=(e,t)=>{for(let i=0;i<e.length;i++)e[i](t)},Kn=(e,t,i)=>{Object.defineProperty(e,t,{configurable:!0,enumerable:!1,value:i})},xs=e=>{const t=parseFloat(e);return isNaN(t)?e:t};let Ks;const Ya=()=>Ks||(Ks=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{});function Qn(e,...t){console.warn(`[Vue warn] ${e}`,...t)}let ot;class Xa{constructor(t=!1){this.detached=t,this.active=!0,this.effects=[],this.cleanups=[],this.parent=ot,!t&&ot&&(this.index=(ot.scopes||(ot.scopes=[])).push(this)-1)}run(t){if(this.active){const i=ot;try{return ot=this,t()}finally{ot=i}}else Qn("cannot run an inactive effect scope.")}on(){ot=this}off(){ot=this.parent}stop(t){if(this.active){let i,r;for(i=0,r=this.effects.length;i<r;i++)this.effects[i].stop();for(i=0,r=this.cleanups.length;i<r;i++)this.cleanups[i]();if(this.scopes)for(i=0,r=this.scopes.length;i<r;i++)this.scopes[i].stop(!0);if(!this.detached&&this.parent&&!t){const c=this.parent.scopes.pop();c&&c!==this&&(this.parent.scopes[this.index]=c,c.index=this.index)}this.parent=void 0,this.active=!1}}}function $a(e){return new Xa(e)}function eh(e,t=ot){t&&t.active&&t.effects.push(e)}function th(){return ot}function ih(e){ot?ot.cleanups.push(e):Qn("onScopeDispose() is called when there is no active effect scope to be associated with.")}const Es=e=>{const t=new Set(e);return t.w=0,t.n=0,t},za=e=>(e.w&Kt)>0,qa=e=>(e.n&Kt)>0,nh=({deps:e})=>{if(e.length)for(let t=0;t<e.length;t++)e[t].w|=Kt},rh=e=>{const{deps:t}=e;if(t.length){let i=0;for(let r=0;r<t.length;r++){const c=t[r];za(c)&&!qa(c)?c.delete(e):t[i++]=c,c.w&=~Kt,c.n&=~Kt}t.length=i}},Wr=new WeakMap;let en=0,Kt=1;const Hr=30;let it;const fi=Symbol("iterate"),Yr=Symbol("Map key iterate");class As{constructor(t,i=null,r){this.fn=t,this.scheduler=i,this.active=!0,this.deps=[],this.parent=void 0,eh(this,r)}run(){if(!this.active)return this.fn();let t=it,i=qt;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=it,it=this,qt=!0,Kt=1<<++en,en<=Hr?nh(this):Qs(this),this.fn()}finally{en<=Hr&&rh(this),Kt=1<<--en,it=this.parent,qt=i,this.parent=void 0,this.deferStop&&this.stop()}}stop(){it===this?this.deferStop=!0:this.active&&(Qs(this),this.onStop&&this.onStop(),this.active=!1)}}function Qs(e){const{deps:t}=e;if(t.length){for(let i=0;i<t.length;i++)t[i].delete(e);t.length=0}}let qt=!0;const Ja=[];function Ci(){Ja.push(qt),qt=!1}function wi(){const e=Ja.pop();qt=e===void 0?!0:e}function at(e,t,i){if(qt&&it){let r=Wr.get(e);r||Wr.set(e,r=new Map);let c=r.get(i);c||r.set(i,c=Es()),Ka(c,{effect:it,target:e,type:t,key:i})}}function Ka(e,t){let i=!1;en<=Hr?qa(e)||(e.n|=Kt,i=!za(e)):i=!e.has(it),i&&(e.add(it),it.deps.push(e),it.onTrack&&it.onTrack(Object.assign({effect:it},t)))}function jt(e,t,i,r,c,u){const g=Wr.get(e);if(!g)return;let v=[];if(t==="clear")v=[...g.values()];else if(i==="length"&&ve(e)){const S=xs(r);g.forEach((w,E)=>{(E==="length"||E>=S)&&v.push(w)})}else switch(i!==void 0&&v.push(g.get(i)),t){case"add":ve(e)?Ts(i)&&v.push(g.get("length")):(v.push(g.get(fi)),di(e)&&v.push(g.get(Yr)));break;case"delete":ve(e)||(v.push(g.get(fi)),di(e)&&v.push(g.get(Yr)));break;case"set":di(e)&&v.push(g.get(fi));break}const b={target:e,type:t,key:i,newValue:r,oldValue:c,oldTarget:u};if(v.length===1)v[0]&&Xr(v[0],b);else{const S=[];for(const w of v)w&&S.push(...w);Xr(Es(S),b)}}function Xr(e,t){const i=ve(e)?e:[...e];for(const r of i)r.computed&&Zs(r,t);for(const r of i)r.computed||Zs(r,t)}function Zs(e,t){(e!==it||e.allowRecurse)&&(e.onTrigger&&e.onTrigger(Fe({effect:e},t)),e.scheduler?e.scheduler():e.run())}const sh=ei("__proto__,__v_isRef,__isVue"),Qa=new Set(Object.getOwnPropertyNames(Symbol).filter(e=>e!=="arguments"&&e!=="caller").map(e=>Symbol[e]).filter(Ss)),oh=_r(),ah=_r(!1,!0),lh=_r(!0),ch=_r(!0,!0),eo=hh();function hh(){const e={};return["includes","indexOf","lastIndexOf"].forEach(t=>{e[t]=function(...i){const r=be(this);for(let u=0,g=this.length;u<g;u++)at(r,"get",u+"");const c=r[t](...i);return c===-1||c===!1?r[t](...i.map(be)):c}}),["push","pop","shift","unshift","splice"].forEach(t=>{e[t]=function(...i){Ci();const r=be(this)[t].apply(this,i);return wi(),r}}),e}function _r(e=!1,t=!1){return function(r,c,u){if(c==="__v_isReactive")return!e;if(c==="__v_isReadonly")return e;if(c==="__v_isShallow")return t;if(c==="__v_raw"&&u===(e?t?ol:sl:t?rl:nl).get(r))return r;const g=ve(r);if(!e&&g&&we(eo,c))return Reflect.get(eo,c,u);const v=Reflect.get(r,c,u);return(Ss(c)?Qa.has(c):sh(c))||(e||at(r,"get",c),t)?v:ke(v)?g&&Ts(c)?v:v.value:Oe(v)?e?al(v):mt(v):v}}const uh=Za(),dh=Za(!0);function Za(e=!1){return function(i,r,c,u){let g=i[r];if(Qt(g)&&ke(g)&&!ke(c))return!1;if(!e&&(!Zn(c)&&!Qt(c)&&(g=be(g),c=be(c)),!ve(i)&&ke(g)&&!ke(c)))return g.value=c,!0;const v=ve(i)&&Ts(r)?Number(r)<i.length:we(i,r),b=Reflect.set(i,r,c,u);return i===be(u)&&(v?cn(c,g)&&jt(i,"set",r,c,g):jt(i,"add",r,c)),b}}function fh(e,t){const i=we(e,t),r=e[t],c=Reflect.deleteProperty(e,t);return c&&i&&jt(e,"delete",t,void 0,r),c}function gh(e,t){const i=Reflect.has(e,t);return(!Ss(t)||!Qa.has(t))&&at(e,"has",t),i}function ph(e){return at(e,"iterate",ve(e)?"length":fi),Reflect.ownKeys(e)}const el={get:oh,set:uh,deleteProperty:fh,has:gh,ownKeys:ph},tl={get:lh,set(e,t){return Qn(`Set operation on key "${String(t)}" failed: target is readonly.`,e),!0},deleteProperty(e,t){return Qn(`Delete operation on key "${String(t)}" failed: target is readonly.`,e),!0}},_h=Fe({},el,{get:ah,set:dh}),mh=Fe({},tl,{get:ch}),Is=e=>e,mr=e=>Reflect.getPrototypeOf(e);function On(e,t,i=!1,r=!1){e=e.__v_raw;const c=be(e),u=be(t);i||(t!==u&&at(c,"get",t),at(c,"get",u));const{has:g}=mr(c),v=r?Is:i?Os:hn;if(g.call(c,t))return v(e.get(t));if(g.call(c,u))return v(e.get(u));e!==c&&e.get(t)}function Rn(e,t=!1){const i=this.__v_raw,r=be(i),c=be(e);return t||(e!==c&&at(r,"has",e),at(r,"has",c)),e===c?i.has(e):i.has(e)||i.has(c)}function Dn(e,t=!1){return e=e.__v_raw,!t&&at(be(e),"iterate",fi),Reflect.get(e,"size",e)}function to(e){e=be(e);const t=be(this);return mr(t).has.call(t,e)||(t.add(e),jt(t,"add",e,e)),this}function io(e,t){t=be(t);const i=be(this),{has:r,get:c}=mr(i);let u=r.call(i,e);u?il(i,r,e):(e=be(e),u=r.call(i,e));const g=c.call(i,e);return i.set(e,t),u?cn(t,g)&&jt(i,"set",e,t,g):jt(i,"add",e,t),this}function no(e){const t=be(this),{has:i,get:r}=mr(t);let c=i.call(t,e);c?il(t,i,e):(e=be(e),c=i.call(t,e));const u=r?r.call(t,e):void 0,g=t.delete(e);return c&&jt(t,"delete",e,void 0,u),g}function ro(){const e=be(this),t=e.size!==0,i=di(e)?new Map(e):new Set(e),r=e.clear();return t&&jt(e,"clear",void 0,void 0,i),r}function Mn(e,t){return function(r,c){const u=this,g=u.__v_raw,v=be(g),b=t?Is:e?Os:hn;return!e&&at(v,"iterate",fi),g.forEach((S,w)=>r.call(c,b(S),b(w),u))}}function Ln(e,t,i){return function(...r){const c=this.__v_raw,u=be(c),g=di(u),v=e==="entries"||e===Symbol.iterator&&g,b=e==="keys"&&g,S=c[e](...r),w=i?Is:t?Os:hn;return!t&&at(u,"iterate",b?Yr:fi),{next(){const{value:E,done:A}=S.next();return A?{value:E,done:A}:{value:v?[w(E[0]),w(E[1])]:w(E),done:A}},[Symbol.iterator](){return this}}}}function Ut(e){return function(...t){{const i=t[0]?`on key "${t[0]}" `:"";console.warn(`${yi(e)} operation ${i}failed: target is readonly.`,be(this))}return e==="delete"?!1:this}}function vh(){const e={get(u){return On(this,u)},get size(){return Dn(this)},has:Rn,add:to,set:io,delete:no,clear:ro,forEach:Mn(!1,!1)},t={get(u){return On(this,u,!1,!0)},get size(){return Dn(this)},has:Rn,add:to,set:io,delete:no,clear:ro,forEach:Mn(!1,!0)},i={get(u){return On(this,u,!0)},get size(){return Dn(this,!0)},has(u){return Rn.call(this,u,!0)},add:Ut("add"),set:Ut("set"),delete:Ut("delete"),clear:Ut("clear"),forEach:Mn(!0,!1)},r={get(u){return On(this,u,!0,!0)},get size(){return Dn(this,!0)},has(u){return Rn.call(this,u,!0)},add:Ut("add"),set:Ut("set"),delete:Ut("delete"),clear:Ut("clear"),forEach:Mn(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(u=>{e[u]=Ln(u,!1,!1),i[u]=Ln(u,!0,!1),t[u]=Ln(u,!1,!0),r[u]=Ln(u,!0,!0)}),[e,i,t,r]}const[yh,bh,Sh,Ch]=vh();function vr(e,t){const i=t?e?Ch:Sh:e?bh:yh;return(r,c,u)=>c==="__v_isReactive"?!e:c==="__v_isReadonly"?e:c==="__v_raw"?r:Reflect.get(we(i,c)&&c in r?i:r,c,u)}const wh={get:vr(!1,!1)},Th={get:vr(!1,!0)},xh={get:vr(!0,!1)},Eh={get:vr(!0,!0)};function il(e,t,i){const r=be(i);if(r!==i&&t.call(e,r)){const c=ws(e);console.warn(`Reactive ${c} contains both the raw and reactive versions of the same object${c==="Map"?" as keys":""}, which can lead to inconsistencies. Avoid differentiating between the raw and reactive versions of an object and only use the reactive version if possible.`)}}const nl=new WeakMap,rl=new WeakMap,sl=new WeakMap,ol=new WeakMap;function Ah(e){switch(e){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function Ih(e){return e.__v_skip||!Object.isExtensible(e)?0:Ah(ws(e))}function mt(e){return Qt(e)?e:yr(e,!1,el,wh,nl)}function Oh(e){return yr(e,!1,_h,Th,rl)}function al(e){return yr(e,!0,tl,xh,sl)}function Pi(e){return yr(e,!0,mh,Eh,ol)}function yr(e,t,i,r,c){if(!Oe(e))return console.warn(`value cannot be made reactive: ${String(e)}`),e;if(e.__v_raw&&!(t&&e.__v_isReactive))return e;const u=c.get(e);if(u)return u;const g=Ih(e);if(g===0)return e;const v=new Proxy(e,g===2?r:i);return c.set(e,v),v}function Tt(e){return Qt(e)?Tt(e.__v_raw):!!(e&&e.__v_isReactive)}function Qt(e){return!!(e&&e.__v_isReadonly)}function Zn(e){return!!(e&&e.__v_isShallow)}function er(e){return Tt(e)||Qt(e)}function be(e){const t=e&&e.__v_raw;return t?be(t):e}function pt(e){return Kn(e,"__v_skip",!0),e}const hn=e=>Oe(e)?mt(e):e,Os=e=>Oe(e)?al(e):e;function ll(e){qt&&it&&(e=be(e),Ka(e.dep||(e.dep=Es()),{target:e,type:"get",key:"value"}))}function cl(e,t){e=be(e),e.dep&&Xr(e.dep,{target:e,type:"set",key:"value",newValue:t})}function ke(e){return!!(e&&e.__v_isRef===!0)}function Cn(e){return hl(e,!1)}function Rh(e){return hl(e,!0)}function hl(e,t){return ke(e)?e:new Dh(e,t)}class Dh{constructor(t,i){this.__v_isShallow=i,this.dep=void 0,this.__v_isRef=!0,this._rawValue=i?t:be(t),this._value=i?t:hn(t)}get value(){return ll(this),this._value}set value(t){const i=this.__v_isShallow||Zn(t)||Qt(t);t=i?t:be(t),cn(t,this._rawValue)&&(this._rawValue=t,this._value=i?t:hn(t),cl(this,t))}}function Ke(e){return ke(e)?e.value:e}const Mh={get:(e,t,i)=>Ke(Reflect.get(e,t,i)),set:(e,t,i,r)=>{const c=e[t];return ke(c)&&!ke(i)?(c.value=i,!0):Reflect.set(e,t,i,r)}};function ul(e){return Tt(e)?e:new Proxy(e,Mh)}function so(e){er(e)||console.warn("toRefs() expects a reactive object but received a plain one.");const t=ve(e)?new Array(e.length):{};for(const i in e)t[i]=Vn(e,i);return t}class Lh{constructor(t,i,r){this._object=t,this._key=i,this._defaultValue=r,this.__v_isRef=!0}get value(){const t=this._object[this._key];return t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}}function Vn(e,t,i){const r=e[t];return ke(r)?r:new Lh(e,t,i)}var dl;class Ph{constructor(t,i,r,c){this._setter=i,this.dep=void 0,this.__v_isRef=!0,this[dl]=!1,this._dirty=!0,this.effect=new As(t,()=>{this._dirty||(this._dirty=!0,cl(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!c,this.__v_isReadonly=r}get value(){const t=be(this);return ll(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}dl="__v_isReadonly";function kh(e,t,i=!1){let r,c;const u=Se(e);u?(r=e,c=()=>{console.warn("Write operation failed: computed value is readonly")}):(r=e.get,c=e.set);const g=new Ph(r,c,u||!c,i);return t&&!i&&(g.effect.onTrack=t.onTrack,g.effect.onTrigger=t.onTrigger),g}const gi=[];function Un(e){gi.push(e)}function Gn(){gi.pop()}function de(e,...t){Ci();const i=gi.length?gi[gi.length-1].component:null,r=i&&i.appContext.config.warnHandler,c=Fh();if(r)Bt(r,i,11,[e+t.join(""),i&&i.proxy,c.map(({vnode:u})=>`at <${Er(i,u.type)}>`).join(`
`),c]);else{const u=[`[Vue warn]: ${e}`,...t];c.length&&u.push(`
`,...Bh(c)),console.warn(...u)}wi()}function Fh(){let e=gi[gi.length-1];if(!e)return[];const t=[];for(;e;){const i=t[0];i&&i.vnode===e?i.recurseCount++:t.push({vnode:e,recurseCount:0});const r=e.component&&e.component.parent;e=r&&r.vnode}return t}function Bh(e){const t=[];return e.forEach((i,r)=>{t.push(...r===0?[]:[`
`],...jh(i))}),t}function jh({vnode:e,recurseCount:t}){const i=t>0?`... (${t} recursive calls)`:"",r=e.component?e.component.parent==null:!1,c=` at <${Er(e.component,e.type,r)}`,u=">"+i;return e.props?[c,...Nh(e.props),u]:[c+u]}function Nh(e){const t=[],i=Object.keys(e);return i.slice(0,3).forEach(r=>{t.push(...fl(r,e[r]))}),i.length>3&&t.push(" ..."),t}function fl(e,t,i){return je(t)?(t=JSON.stringify(t),i?t:[`${e}=${t}`]):typeof t=="number"||typeof t=="boolean"||t==null?i?t:[`${e}=${t}`]:ke(t)?(t=fl(e,be(t.value),!0),i?t:[`${e}=Ref<`,t,">"]):Se(t)?[`${e}=fn${t.name?`<${t.name}>`:""}`]:(t=be(t),i?t:[`${e}=`,t])}const Rs={sp:"serverPrefetch hook",bc:"beforeCreate hook",c:"created hook",bm:"beforeMount hook",m:"mounted hook",bu:"beforeUpdate hook",u:"updated",bum:"beforeUnmount hook",um:"unmounted hook",a:"activated hook",da:"deactivated hook",ec:"errorCaptured hook",rtc:"renderTracked hook",rtg:"renderTriggered hook",[0]:"setup function",[1]:"render function",[2]:"watcher getter",[3]:"watcher callback",[4]:"watcher cleanup function",[5]:"native event handler",[6]:"component event handler",[7]:"vnode hook",[8]:"directive hook",[9]:"transition hook",[10]:"app errorHandler",[11]:"app warnHandler",[12]:"ref function",[13]:"async component loader",[14]:"scheduler flush. This is likely a Vue internals bug. Please open an issue at https://new-issue.vuejs.org/?repo=vuejs/core"};function Bt(e,t,i,r){let c;try{c=r?e(...r):e()}catch(u){br(u,t,i)}return c}function ut(e,t,i,r){if(Se(e)){const u=Bt(e,t,i,r);return u&&Cs(u)&&u.catch(g=>{br(g,t,i)}),u}const c=[];for(let u=0;u<e.length;u++)c.push(ut(e[u],t,i,r));return c}function br(e,t,i,r=!0){const c=t?t.vnode:null;if(t){let u=t.parent;const g=t.proxy,v=Rs[i];for(;u;){const S=u.ec;if(S){for(let w=0;w<S.length;w++)if(S[w](e,g,v)===!1)return}u=u.parent}const b=t.appContext.config.errorHandler;if(b){Bt(b,null,10,[e,g,v]);return}}Vh(e,i,c,r)}function Vh(e,t,i,r=!0){{const c=Rs[t];if(i&&Un(i),de(`Unhandled error${c?` during execution of ${c}`:""}`),i&&Gn(),r)throw e;console.error(e)}}let un=!1,$r=!1;const qe=[];let St=0;const Ni=[];let bt=null,Yt=0;const gl=Promise.resolve();let Ds=null;const Uh=100;function tr(e){const t=Ds||gl;return e?t.then(this?e.bind(this):e):t}function Gh(e){let t=St+1,i=qe.length;for(;t<i;){const r=t+i>>>1;dn(qe[r])<e?t=r+1:i=r}return t}function Sr(e){(!qe.length||!qe.includes(e,un&&e.allowRecurse?St+1:St))&&(e.id==null?qe.push(e):qe.splice(Gh(e.id),0,e),pl())}function pl(){!un&&!$r&&($r=!0,Ds=gl.then(vl))}function Wh(e){const t=qe.indexOf(e);t>St&&qe.splice(t,1)}function _l(e){ve(e)?Ni.push(...e):(!bt||!bt.includes(e,e.allowRecurse?Yt+1:Yt))&&Ni.push(e),pl()}function oo(e,t=un?St+1:0){for(e=e||new Map;t<qe.length;t++){const i=qe[t];if(i&&i.pre){if(Ms(e,i))continue;qe.splice(t,1),t--,i()}}}function ml(e){if(Ni.length){const t=[...new Set(Ni)];if(Ni.length=0,bt){bt.push(...t);return}for(bt=t,e=e||new Map,bt.sort((i,r)=>dn(i)-dn(r)),Yt=0;Yt<bt.length;Yt++)Ms(e,bt[Yt])||bt[Yt]();bt=null,Yt=0}}const dn=e=>e.id==null?1/0:e.id,Hh=(e,t)=>{const i=dn(e)-dn(t);if(i===0){if(e.pre&&!t.pre)return-1;if(t.pre&&!e.pre)return 1}return i};function vl(e){$r=!1,un=!0,e=e||new Map,qe.sort(Hh);const t=i=>Ms(e,i);try{for(St=0;St<qe.length;St++){const i=qe[St];if(i&&i.active!==!1){if(t(i))continue;Bt(i,null,14)}}}finally{St=0,qe.length=0,ml(e),un=!1,Ds=null,(qe.length||Ni.length)&&vl(e)}}function Ms(e,t){if(!e.has(t))e.set(t,1);else{const i=e.get(t);if(i>Uh){const r=t.ownerInstance,c=r&&Gs(r.type);return de(`Maximum recursive updates exceeded${c?` in component <${c}>`:""}. This means you have a reactive effect that is mutating its own dependencies and thus recursively triggering itself. Possible sources include component template, render function, updated hook or watcher source function.`),!0}else e.set(t,i+1)}}let pi=!1;const Li=new Set;Ya().__VUE_HMR_RUNTIME__={createRecord:Dr(yl),rerender:Dr($h),reload:Dr(zh)};const bi=new Map;function Yh(e){const t=e.type.__hmrId;let i=bi.get(t);i||(yl(t,e.type),i=bi.get(t)),i.instances.add(e)}function Xh(e){bi.get(e.type.__hmrId).instances.delete(e)}function yl(e,t){return bi.has(e)?!1:(bi.set(e,{initialDef:nn(t),instances:new Set}),!0)}function nn(e){return Jl(e)?e.__vccOpts:e}function $h(e,t){const i=bi.get(e);!i||(i.initialDef.render=t,[...i.instances].forEach(r=>{t&&(r.render=t,nn(r.type).render=t),r.renderCache=[],pi=!0,r.update(),pi=!1}))}function zh(e,t){const i=bi.get(e);if(!i)return;t=nn(t),ao(i.initialDef,t);const r=[...i.instances];for(const c of r){const u=nn(c.type);Li.has(u)||(u!==i.initialDef&&ao(u,t),Li.add(u)),c.appContext.optionsCache.delete(c.type),c.ceReload?(Li.add(u),c.ceReload(t.styles),Li.delete(u)):c.parent?Sr(c.parent.update):c.appContext.reload?c.appContext.reload():typeof window<"u"?window.location.reload():console.warn("[HMR] Root or manually mounted instance modified. Full reload required.")}_l(()=>{for(const c of r)Li.delete(nn(c.type))})}function ao(e,t){Fe(e,t);for(const i in e)i!=="__file"&&!(i in t)&&delete e[i]}function Dr(e){return(t,i)=>{try{return e(t,i)}catch(r){console.error(r),console.warn("[HMR] Something went wrong during Vue component hot-reload. Full reload required.")}}}let Ct,tn=[],zr=!1;function wn(e,...t){Ct?Ct.emit(e,...t):zr||tn.push({event:e,args:t})}function bl(e,t){var i,r;Ct=e,Ct?(Ct.enabled=!0,tn.forEach(({event:c,args:u})=>Ct.emit(c,...u)),tn=[]):typeof window<"u"&&window.HTMLElement&&!(!((r=(i=window.navigator)===null||i===void 0?void 0:i.userAgent)===null||r===void 0)&&r.includes("jsdom"))?((t.__VUE_DEVTOOLS_HOOK_REPLAY__=t.__VUE_DEVTOOLS_HOOK_REPLAY__||[]).push(u=>{bl(u,t)}),setTimeout(()=>{Ct||(t.__VUE_DEVTOOLS_HOOK_REPLAY__=null,zr=!0,tn=[])},3e3)):(zr=!0,tn=[])}function qh(e,t){wn("app:init",e,t,{Fragment:We,Text:xn,Comment:Ye,Static:sn})}function Jh(e){wn("app:unmount",e)}const Kh=Ls("component:added"),Sl=Ls("component:updated"),Qh=Ls("component:removed"),Zh=e=>{Ct&&typeof Ct.cleanupBuffer=="function"&&!Ct.cleanupBuffer(e)&&Qh(e)};function Ls(e){return t=>{wn(e,t.appContext.app,t.uid,t.parent?t.parent.uid:void 0,t)}}const eu=Cl("perf:start"),tu=Cl("perf:end");function Cl(e){return(t,i,r)=>{wn(e,t.appContext.app,t.uid,t,i,r)}}function iu(e,t,i){wn("component:emit",e.appContext.app,e,t,i)}function nu(e,t,...i){if(e.isUnmounted)return;const r=e.vnode.props||De;{const{emitsOptions:w,propsOptions:[E]}=e;if(w)if(!(t in w))(!E||!(si(t)in E))&&de(`Component emitted event "${t}" but it is neither declared in the emits option nor as an "${si(t)}" prop.`);else{const A=w[t];Se(A)&&(A(...i)||de(`Invalid event arguments: event validation failed for event "${t}".`))}}let c=i;const u=t.startsWith("update:"),g=u&&t.slice(7);if(g&&g in r){const w=`${g==="modelValue"?"model":g}Modifiers`,{number:E,trim:A}=r[w]||De;A&&(c=i.map(B=>je(B)?B.trim():B)),E&&(c=i.map(xs))}iu(e,t,c);{const w=t.toLowerCase();w!==t&&r[si(w)]&&de(`Event "${w}" is emitted in component ${Er(e,e.type)} but the handler is registered for "${t}". Note that HTML attributes are case-insensitive and you cannot use v-on to listen to camelCase events when using in-DOM templates. You should probably use "${Jt(t)}" instead of "${t}".`)}let v,b=r[v=si(t)]||r[v=si(It(t))];!b&&u&&(b=r[v=si(Jt(t))]),b&&ut(b,e,6,c);const S=r[v+"Once"];if(S){if(!e.emitted)e.emitted={};else if(e.emitted[v])return;e.emitted[v]=!0,ut(S,e,6,c)}}function wl(e,t,i=!1){const r=t.emitsCache,c=r.get(e);if(c!==void 0)return c;const u=e.emits;let g={},v=!1;if(!Se(e)){const b=S=>{const w=wl(S,t,!0);w&&(v=!0,Fe(g,w))};!i&&t.mixins.length&&t.mixins.forEach(b),e.extends&&b(e.extends),e.mixins&&e.mixins.forEach(b)}return!u&&!v?(Oe(e)&&r.set(e,null),null):(ve(u)?u.forEach(b=>g[b]=null):Fe(g,u),Oe(e)&&r.set(e,g),g)}function Cr(e,t){return!e||!Sn(t)?!1:(t=t.slice(2).replace(/Once$/,""),we(e,t[0].toLowerCase()+t.slice(1))||we(e,Jt(t))||we(e,t))}let He=null,wr=null;function ir(e){const t=He;return He=e,wr=e&&e.type.__scopeId||null,t}function Tl(e){wr=e}function xl(){wr=null}function Vi(e,t=He,i){if(!t||e._n)return e;const r=(...c)=>{r._d&&bo(-1);const u=ir(t);let g;try{g=e(...c)}finally{ir(u),r._d&&bo(1)}return Sl(t),g};return r._n=!0,r._c=!0,r._d=!0,r}let qr=!1;function nr(){qr=!0}function Mr(e){const{type:t,vnode:i,proxy:r,withProxy:c,props:u,propsOptions:[g],slots:v,attrs:b,emit:S,render:w,renderCache:E,data:A,setupState:B,ctx:z,inheritAttrs:q}=e;let J,Z;const ee=ir(e);qr=!1;try{if(i.shapeFlag&4){const pe=c||r;J=_t(w.call(pe,pe,E,u,B,A,z)),Z=b}else{const pe=t;b===u&&nr(),J=_t(pe.length>1?pe(u,{get attrs(){return nr(),b},slots:v,emit:S}):pe(u,null)),Z=t.props?b:su(b)}}catch(pe){on.length=0,br(pe,e,1),J=Pe(Ye)}let K=J,oe;if(J.patchFlag>0&&J.patchFlag&2048&&([K,oe]=ru(J)),Z&&q!==!1){const pe=Object.keys(Z),{shapeFlag:ye}=K;if(pe.length){if(ye&7)g&&pe.some(Jn)&&(Z=ou(Z,g)),K=Ot(K,Z);else if(!qr&&K.type!==Ye){const _e=Object.keys(b),y=[],le=[];for(let te=0,he=_e.length;te<he;te++){const a=_e[te];Sn(a)?Jn(a)||y.push(a[2].toLowerCase()+a.slice(3)):le.push(a)}le.length&&de(`Extraneous non-props attributes (${le.join(", ")}) were passed to component but could not be automatically inherited because component renders fragment or text root nodes.`),y.length&&de(`Extraneous non-emits event listeners (${y.join(", ")}) were passed to component but could not be automatically inherited because component renders fragment or text root nodes. If the listener is intended to be a component custom event listener only, declare it using the "emits" option.`)}}}return i.dirs&&(lo(K)||de("Runtime directive used on component with non-element root node. The directives will not function as intended."),K=Ot(K),K.dirs=K.dirs?K.dirs.concat(i.dirs):i.dirs),i.transition&&(lo(K)||de("Component inside <Transition> renders non-element root node that cannot be animated."),K.transition=i.transition),oe?oe(K):J=K,ir(ee),J}const ru=e=>{const t=e.children,i=e.dynamicChildren,r=El(t);if(!r)return[e,void 0];const c=t.indexOf(r),u=i?i.indexOf(r):-1,g=v=>{t[c]=v,i&&(u>-1?i[u]=v:v.patchFlag>0&&(e.dynamicChildren=[...i,v]))};return[_t(r),g]};function El(e){let t;for(let i=0;i<e.length;i++){const r=e[i];if(Ui(r)){if(r.type!==Ye||r.children==="v-if"){if(t)return;t=r}}else return}return t}const su=e=>{let t;for(const i in e)(i==="class"||i==="style"||Sn(i))&&((t||(t={}))[i]=e[i]);return t},ou=(e,t)=>{const i={};for(const r in e)(!Jn(r)||!(r.slice(9)in t))&&(i[r]=e[r]);return i},lo=e=>e.shapeFlag&7||e.type===Ye;function au(e,t,i){const{props:r,children:c,component:u}=e,{props:g,children:v,patchFlag:b}=t,S=u.emitsOptions;if((c||v)&&pi||t.dirs||t.transition)return!0;if(i&&b>=0){if(b&1024)return!0;if(b&16)return r?co(r,g,S):!!g;if(b&8){const w=t.dynamicProps;for(let E=0;E<w.length;E++){const A=w[E];if(g[A]!==r[A]&&!Cr(S,A))return!0}}}else return(c||v)&&(!v||!v.$stable)?!0:r===g?!1:r?g?co(r,g,S):!0:!!g;return!1}function co(e,t,i){const r=Object.keys(t);if(r.length!==Object.keys(e).length)return!0;for(let c=0;c<r.length;c++){const u=r[c];if(t[u]!==e[u]&&!Cr(i,u))return!0}return!1}function lu({vnode:e,parent:t},i){for(;t&&t.subTree===e;)(e=t.vnode).el=i,t=t.parent}const cu=e=>e.__isSuspense;function hu(e,t){t&&t.pendingBranch?ve(e)?t.effects.push(...e):t.effects.push(e):_l(e)}function Wn(e,t){if(!Ve)de("provide() can only be used inside setup().");else{let i=Ve.provides;const r=Ve.parent&&Ve.parent.provides;r===i&&(i=Ve.provides=Object.create(r)),i[e]=t}}function xt(e,t,i=!1){const r=Ve||He;if(r){const c=r.parent==null?r.vnode.appContext&&r.vnode.appContext.provides:r.parent.provides;if(c&&e in c)return c[e];if(arguments.length>1)return i&&Se(t)?t.call(r.proxy):t;de(`injection "${String(e)}" not found.`)}else de("inject() can only be used inside setup() or functional components.")}function uu(e,t){return Ps(e,null,t)}const Pn={};function Et(e,t,i){return Se(t)||de("`watch(fn, options?)` signature has been moved to a separate API. Use `watchEffect(fn, options?)` instead. `watch` now only supports `watch(source, cb, options?) signature."),Ps(e,t,i)}function Ps(e,t,{immediate:i,deep:r,flush:c,onTrack:u,onTrigger:g}=De){t||(i!==void 0&&de('watch() "immediate" option is only respected when using the watch(source, callback, options?) signature.'),r!==void 0&&de('watch() "deep" option is only respected when using the watch(source, callback, options?) signature.'));const v=oe=>{de("Invalid watch source: ",oe,"A watch source can only be a getter/effect function, a ref, a reactive object, or an array of these types.")},b=Ve;let S,w=!1,E=!1;if(ke(e)?(S=()=>e.value,w=Zn(e)):Tt(e)?(S=()=>e,r=!0):ve(e)?(E=!0,w=e.some(oe=>Tt(oe)||Zn(oe)),S=()=>e.map(oe=>{if(ke(oe))return oe.value;if(Tt(oe))return ki(oe);if(Se(oe))return Bt(oe,b,2);v(oe)})):Se(e)?t?S=()=>Bt(e,b,2):S=()=>{if(!(b&&b.isUnmounted))return A&&A(),ut(e,b,3,[B])}:(S=st,v(e)),t&&r){const oe=S;S=()=>ki(oe())}let A,B=oe=>{A=ee.onStop=()=>{Bt(oe,b,4)}},z;if(_n)if(B=st,t?i&&ut(t,b,3,[S(),E?[]:void 0,B]):S(),c==="sync"){const oe=vd();z=oe.__watcherHandles||(oe.__watcherHandles=[])}else return st;let q=E?new Array(e.length).fill(Pn):Pn;const J=()=>{if(!!ee.active)if(t){const oe=ee.run();(r||w||(E?oe.some((pe,ye)=>cn(pe,q[ye])):cn(oe,q)))&&(A&&A(),ut(t,b,3,[oe,q===Pn?void 0:E&&q[0]===Pn?[]:q,B]),q=oe)}else ee.run()};J.allowRecurse=!!t;let Z;c==="sync"?Z=J:c==="post"?Z=()=>nt(J,b&&b.suspense):(J.pre=!0,b&&(J.id=b.uid),Z=()=>Sr(J));const ee=new As(S,Z);ee.onTrack=u,ee.onTrigger=g,t?i?J():q=ee.run():c==="post"?nt(ee.run.bind(ee),b&&b.suspense):ee.run();const K=()=>{ee.stop(),b&&b.scope&&bs(b.scope.effects,ee)};return z&&z.push(K),K}function du(e,t,i){const r=this.proxy,c=je(e)?e.includes(".")?Al(r,e):()=>r[e]:e.bind(r,r);let u;Se(t)?u=t:(u=t.handler,i=t);const g=Ve;Gi(this);const v=Ps(c,u.bind(r),i);return g?Gi(g):mi(),v}function Al(e,t){const i=t.split(".");return()=>{let r=e;for(let c=0;c<i.length&&r;c++)r=r[i[c]];return r}}function ki(e,t){if(!Oe(e)||e.__v_skip||(t=t||new Set,t.has(e)))return e;if(t.add(e),ke(e))ki(e.value,t);else if(ve(e))for(let i=0;i<e.length;i++)ki(e[i],t);else if(Ga(e)||di(e))e.forEach(i=>{ki(i,t)});else if(Ha(e))for(const i in e)ki(e[i],t);return e}function Il(){const e={isMounted:!1,isLeaving:!1,isUnmounting:!1,leavingVNodes:new Map};return Fs(()=>{e.isMounted=!0}),Ml(()=>{e.isUnmounting=!0}),e}const ht=[Function,Array],fu={name:"BaseTransition",props:{mode:String,appear:Boolean,persisted:Boolean,onBeforeEnter:ht,onEnter:ht,onAfterEnter:ht,onEnterCancelled:ht,onBeforeLeave:ht,onLeave:ht,onAfterLeave:ht,onLeaveCancelled:ht,onBeforeAppear:ht,onAppear:ht,onAfterAppear:ht,onAppearCancelled:ht},setup(e,{slots:t}){const i=En(),r=Il();let c;return()=>{const u=t.default&&ks(t.default(),!0);if(!u||!u.length)return;let g=u[0];if(u.length>1){let q=!1;for(const J of u)if(J.type!==Ye){if(q){de("<transition> can only be used on a single element or component. Use <transition-group> for lists.");break}g=J,q=!0}}const v=be(e),{mode:b}=v;if(b&&b!=="in-out"&&b!=="out-in"&&b!=="default"&&de(`invalid <transition> mode: ${b}`),r.isLeaving)return Lr(g);const S=ho(g);if(!S)return Lr(g);const w=fn(S,v,r,i);gn(S,w);const E=i.subTree,A=E&&ho(E);let B=!1;const{getTransitionKey:z}=S.type;if(z){const q=z();c===void 0?c=q:q!==c&&(c=q,B=!0)}if(A&&A.type!==Ye&&(!li(S,A)||B)){const q=fn(A,v,r,i);if(gn(A,q),b==="out-in")return r.isLeaving=!0,q.afterLeave=()=>{r.isLeaving=!1,i.update.active!==!1&&i.update()},Lr(g);b==="in-out"&&S.type!==Ye&&(q.delayLeave=(J,Z,ee)=>{const K=Ol(r,A);K[String(A.key)]=A,J._leaveCb=()=>{Z(),J._leaveCb=void 0,delete w.delayedLeave},w.delayedLeave=ee})}return g}}},gu=fu;function Ol(e,t){const{leavingVNodes:i}=e;let r=i.get(t.type);return r||(r=Object.create(null),i.set(t.type,r)),r}function fn(e,t,i,r){const{appear:c,mode:u,persisted:g=!1,onBeforeEnter:v,onEnter:b,onAfterEnter:S,onEnterCancelled:w,onBeforeLeave:E,onLeave:A,onAfterLeave:B,onLeaveCancelled:z,onBeforeAppear:q,onAppear:J,onAfterAppear:Z,onAppearCancelled:ee}=t,K=String(e.key),oe=Ol(i,e),pe=(y,le)=>{y&&ut(y,r,9,le)},ye=(y,le)=>{const te=le[1];pe(y,le),ve(y)?y.every(he=>he.length<=1)&&te():y.length<=1&&te()},_e={mode:u,persisted:g,beforeEnter(y){let le=v;if(!i.isMounted)if(c)le=q||v;else return;y._leaveCb&&y._leaveCb(!0);const te=oe[K];te&&li(e,te)&&te.el._leaveCb&&te.el._leaveCb(),pe(le,[y])},enter(y){let le=b,te=S,he=w;if(!i.isMounted)if(c)le=J||b,te=Z||S,he=ee||w;else return;let a=!1;const o=y._enterCb=l=>{a||(a=!0,l?pe(he,[y]):pe(te,[y]),_e.delayedLeave&&_e.delayedLeave(),y._enterCb=void 0)};le?ye(le,[y,o]):o()},leave(y,le){const te=String(e.key);if(y._enterCb&&y._enterCb(!0),i.isUnmounting)return le();pe(E,[y]);let he=!1;const a=y._leaveCb=o=>{he||(he=!0,le(),o?pe(z,[y]):pe(B,[y]),y._leaveCb=void 0,oe[te]===e&&delete oe[te])};oe[te]=e,A?ye(A,[y,a]):a()},clone(y){return fn(y,t,i,r)}};return _e}function Lr(e){if(Tn(e))return e=Ot(e),e.children=null,e}function ho(e){return Tn(e)?e.children?e.children[0]:void 0:e}function gn(e,t){e.shapeFlag&6&&e.component?gn(e.component.subTree,t):e.shapeFlag&128?(e.ssContent.transition=t.clone(e.ssContent),e.ssFallback.transition=t.clone(e.ssFallback)):e.transition=t}function ks(e,t=!1,i){let r=[],c=0;for(let u=0;u<e.length;u++){let g=e[u];const v=i==null?g.key:String(i)+String(g.key!=null?g.key:u);g.type===We?(g.patchFlag&128&&c++,r=r.concat(ks(g.children,t,v))):(t||g.type!==Ye)&&r.push(v!=null?Ot(g,{key:v}):g)}if(c>1)for(let u=0;u<r.length;u++)r[u].patchFlag=-2;return r}function Nt(e){return Se(e)?{setup:e,name:e.name}:e}const rn=e=>!!e.type.__asyncLoader,Tn=e=>e.type.__isKeepAlive;function pu(e,t){Rl(e,"a",t)}function _u(e,t){Rl(e,"da",t)}function Rl(e,t,i=Ve){const r=e.__wdc||(e.__wdc=()=>{let c=i;for(;c;){if(c.isDeactivated)return;c=c.parent}return e()});if(Tr(t,r,i),i){let c=i.parent;for(;c&&c.parent;)Tn(c.parent.vnode)&&mu(r,t,i,c),c=c.parent}}function mu(e,t,i,r){const c=Tr(t,e,r,!0);Ll(()=>{bs(r[t],c)},i)}function Tr(e,t,i=Ve,r=!1){if(i){const c=i[e]||(i[e]=[]),u=t.__weh||(t.__weh=(...g)=>{if(i.isUnmounted)return;Ci(),Gi(i);const v=ut(t,i,e,g);return mi(),wi(),v});return r?c.unshift(u):c.push(u),u}else{const c=si(Rs[e].replace(/ hook$/,""));de(`${c} is called when there is no active component instance to be associated with. Lifecycle injection APIs can only be used during execution of setup(). If you are using async setup(), make sure to register lifecycle hooks before the first await statement.`)}}const Vt=e=>(t,i=Ve)=>(!_n||e==="sp")&&Tr(e,(...r)=>t(...r),i),vu=Vt("bm"),Fs=Vt("m"),yu=Vt("bu"),Dl=Vt("u"),Ml=Vt("bum"),Ll=Vt("um"),bu=Vt("sp"),Su=Vt("rtg"),Cu=Vt("rtc");function wu(e,t=Ve){Tr("ec",e,t)}function Pl(e){Kc(e)&&de("Do not use built-in directive ids as custom directive id: "+e)}function ii(e,t,i,r){const c=e.dirs,u=t&&t.dirs;for(let g=0;g<c.length;g++){const v=c[g];u&&(v.oldValue=u[g].value);let b=v.dir[r];b&&(Ci(),ut(b,i,8,[e.el,v,e,t]),wi())}}const Jr="components";function g_(e,t){return xu(Jr,e,!0,t)||e}const Tu=Symbol();function xu(e,t,i=!0,r=!1){const c=He||Ve;if(c){const u=c.type;if(e===Jr){const v=Gs(u,!1);if(v&&(v===t||v===It(t)||v===yi(It(t))))return u}const g=uo(c[e]||u[e],t)||uo(c.appContext[e],t);if(!g&&r)return u;if(i&&!g){const v=e===Jr?`
If this is a native custom element, make sure to exclude it from component resolution via compilerOptions.isCustomElement.`:"";de(`Failed to resolve ${e.slice(0,-1)}: ${t}${v}`)}return g}else de(`resolve${yi(e.slice(0,-1))} can only be used in render() or setup().`)}function uo(e,t){return e&&(e[t]||e[It(t)]||e[yi(It(t))])}function Kr(e,t,i,r){let c;const u=i&&i[r];if(ve(e)||je(e)){c=new Array(e.length);for(let g=0,v=e.length;g<v;g++)c[g]=t(e[g],g,void 0,u&&u[g])}else if(typeof e=="number"){Number.isInteger(e)||de(`The v-for range expect an integer value but got ${e}.`),c=new Array(e);for(let g=0;g<e;g++)c[g]=t(g+1,g,void 0,u&&u[g])}else if(Oe(e))if(e[Symbol.iterator])c=Array.from(e,(g,v)=>t(g,v,void 0,u&&u[v]));else{const g=Object.keys(e);c=new Array(g.length);for(let v=0,b=g.length;v<b;v++){const S=g[v];c[v]=t(e[S],S,v,u&&u[v])}}else c=[];return i&&(i[r]=c),c}function p_(e,t,i={},r,c){if(He.isCE||He.parent&&rn(He.parent)&&He.parent.isCE)return t!=="default"&&(i.name=t),Pe("slot",i,r&&r());let u=e[t];u&&u.length>1&&(de("SSR-optimized slot function detected in a non-SSR-optimized render function. You need to mark this component with $dynamic-slots in the parent template."),u=()=>[]),u&&u._c&&(u._d=!1),Je();const g=u&&kl(u(i)),v=or(We,{key:i.key||g&&g.key||`_${t}`},g||(r?r():[]),g&&e._===1?64:-2);return!c&&v.scopeId&&(v.slotScopeIds=[v.scopeId+"-s"]),u&&u._c&&(u._d=!0),v}function kl(e){return e.some(t=>Ui(t)?!(t.type===Ye||t.type===We&&!kl(t.children)):!0)?e:null}const Qr=e=>e?zl(e)?Us(e)||e.proxy:Qr(e.parent):null,_i=Fe(Object.create(null),{$:e=>e,$el:e=>e.vnode.el,$data:e=>e.data,$props:e=>Pi(e.props),$attrs:e=>Pi(e.attrs),$slots:e=>Pi(e.slots),$refs:e=>Pi(e.refs),$parent:e=>Qr(e.parent),$root:e=>Qr(e.root),$emit:e=>e.emit,$options:e=>js(e),$forceUpdate:e=>e.f||(e.f=()=>Sr(e.update)),$nextTick:e=>e.n||(e.n=tr.bind(e.proxy)),$watch:e=>du.bind(e)}),Bs=e=>e==="_"||e==="$",Pr=(e,t)=>e!==De&&!e.__isScriptSetup&&we(e,t),Fl={get({_:e},t){const{ctx:i,setupState:r,data:c,props:u,accessCache:g,type:v,appContext:b}=e;if(t==="__isVue")return!0;let S;if(t[0]!=="$"){const B=g[t];if(B!==void 0)switch(B){case 1:return r[t];case 2:return c[t];case 4:return i[t];case 3:return u[t]}else{if(Pr(r,t))return g[t]=1,r[t];if(c!==De&&we(c,t))return g[t]=2,c[t];if((S=e.propsOptions[0])&&we(S,t))return g[t]=3,u[t];if(i!==De&&we(i,t))return g[t]=4,i[t];Zr&&(g[t]=0)}}const w=_i[t];let E,A;if(w)return t==="$attrs"&&(at(e,"get",t),nr()),w(e);if((E=v.__cssModules)&&(E=E[t]))return E;if(i!==De&&we(i,t))return g[t]=4,i[t];if(A=b.config.globalProperties,we(A,t))return A[t];He&&(!je(t)||t.indexOf("__v")!==0)&&(c!==De&&Bs(t[0])&&we(c,t)?de(`Property ${JSON.stringify(t)} must be accessed via $data because it starts with a reserved character ("$" or "_") and is not proxied on the render context.`):e===He&&de(`Property ${JSON.stringify(t)} was accessed during render but is not defined on instance.`))},set({_:e},t,i){const{data:r,setupState:c,ctx:u}=e;return Pr(c,t)?(c[t]=i,!0):c.__isScriptSetup&&we(c,t)?(de(`Cannot mutate <script setup> binding "${t}" from Options API.`),!1):r!==De&&we(r,t)?(r[t]=i,!0):we(e.props,t)?(de(`Attempting to mutate prop "${t}". Props are readonly.`),!1):t[0]==="$"&&t.slice(1)in e?(de(`Attempting to mutate public property "${t}". Properties starting with $ are reserved and readonly.`),!1):(t in e.appContext.config.globalProperties?Object.defineProperty(u,t,{enumerable:!0,configurable:!0,value:i}):u[t]=i,!0)},has({_:{data:e,setupState:t,accessCache:i,ctx:r,appContext:c,propsOptions:u}},g){let v;return!!i[g]||e!==De&&we(e,g)||Pr(t,g)||(v=u[0])&&we(v,g)||we(r,g)||we(_i,g)||we(c.config.globalProperties,g)},defineProperty(e,t,i){return i.get!=null?e._.accessCache[t]=0:we(i,"value")&&this.set(e,t,i.value,null),Reflect.defineProperty(e,t,i)}};Fl.ownKeys=e=>(de("Avoid app logic that relies on enumerating keys on a component instance. The keys will be empty in production mode to avoid performance overhead."),Reflect.ownKeys(e));function Eu(e){const t={};return Object.defineProperty(t,"_",{configurable:!0,enumerable:!1,get:()=>e}),Object.keys(_i).forEach(i=>{Object.defineProperty(t,i,{configurable:!0,enumerable:!1,get:()=>_i[i](e),set:st})}),t}function Au(e){const{ctx:t,propsOptions:[i]}=e;i&&Object.keys(i).forEach(r=>{Object.defineProperty(t,r,{enumerable:!0,configurable:!0,get:()=>e.props[r],set:st})})}function Iu(e){const{ctx:t,setupState:i}=e;Object.keys(be(i)).forEach(r=>{if(!i.__isScriptSetup){if(Bs(r[0])){de(`setup() return property ${JSON.stringify(r)} should not start with "$" or "_" which are reserved prefixes for Vue internals.`);return}Object.defineProperty(t,r,{enumerable:!0,configurable:!0,get:()=>i[r],set:st})}})}function Ou(){const e=Object.create(null);return(t,i)=>{e[i]?de(`${t} property "${i}" is already defined in ${e[i]}.`):e[i]=t}}let Zr=!0;function Ru(e){const t=js(e),i=e.proxy,r=e.ctx;Zr=!1,t.beforeCreate&&fo(t.beforeCreate,e,"bc");const{data:c,computed:u,methods:g,watch:v,provide:b,inject:S,created:w,beforeMount:E,mounted:A,beforeUpdate:B,updated:z,activated:q,deactivated:J,beforeDestroy:Z,beforeUnmount:ee,destroyed:K,unmounted:oe,render:pe,renderTracked:ye,renderTriggered:_e,errorCaptured:y,serverPrefetch:le,expose:te,inheritAttrs:he,components:a,directives:o,filters:l}=t,d=Ou();{const[s]=e.propsOptions;if(s)for(const h in s)d("Props",h)}if(S&&Du(S,r,d,e.appContext.config.unwrapInjectedRef),g)for(const s in g){const h=g[s];Se(h)?(Object.defineProperty(r,s,{value:h.bind(i),configurable:!0,enumerable:!0,writable:!0}),d("Methods",s)):de(`Method "${s}" has type "${typeof h}" in the component definition. Did you reference the function correctly?`)}if(c){Se(c)||de("The data option must be a function. Plain object usage is no longer supported.");const s=c.call(i,i);if(Cs(s)&&de("data() returned a Promise - note data() cannot be async; If you intend to perform data fetching before component renders, use async setup() + <Suspense>."),!Oe(s))de("data() should return an object.");else{e.data=mt(s);for(const h in s)d("Data",h),Bs(h[0])||Object.defineProperty(r,h,{configurable:!0,enumerable:!0,get:()=>s[h],set:st})}}if(Zr=!0,u)for(const s in u){const h=u[s],_=Se(h)?h.bind(i,i):Se(h.get)?h.get.bind(i,i):st;_===st&&de(`Computed property "${s}" has no getter.`);const f=!Se(h)&&Se(h.set)?h.set.bind(i):()=>{de(`Write operation failed: computed property "${s}" is readonly.`)},p=rt({get:_,set:f});Object.defineProperty(r,s,{enumerable:!0,configurable:!0,get:()=>p.value,set:m=>p.value=m}),d("Computed",s)}if(v)for(const s in v)Bl(v[s],r,i,s);if(b){const s=Se(b)?b.call(i):b;Reflect.ownKeys(s).forEach(h=>{Wn(h,s[h])})}w&&fo(w,e,"c");function n(s,h){ve(h)?h.forEach(_=>s(_.bind(i))):h&&s(h.bind(i))}if(n(vu,E),n(Fs,A),n(yu,B),n(Dl,z),n(pu,q),n(_u,J),n(wu,y),n(Cu,ye),n(Su,_e),n(Ml,ee),n(Ll,oe),n(bu,le),ve(te))if(te.length){const s=e.exposed||(e.exposed={});te.forEach(h=>{Object.defineProperty(s,h,{get:()=>i[h],set:_=>i[h]=_})})}else e.exposed||(e.exposed={});pe&&e.render===st&&(e.render=pe),he!=null&&(e.inheritAttrs=he),a&&(e.components=a),o&&(e.directives=o)}function Du(e,t,i=st,r=!1){ve(e)&&(e=es(e));for(const c in e){const u=e[c];let g;Oe(u)?"default"in u?g=xt(u.from||c,u.default,!0):g=xt(u.from||c):g=xt(u),ke(g)?r?Object.defineProperty(t,c,{enumerable:!0,configurable:!0,get:()=>g.value,set:v=>g.value=v}):(de(`injected property "${c}" is a ref and will be auto-unwrapped and no longer needs \`.value\` in the next minor release. To opt-in to the new behavior now, set \`app.config.unwrapInjectedRef = true\` (this config is temporary and will not be needed in the future.)`),t[c]=g):t[c]=g,i("Inject",c)}}function fo(e,t,i){ut(ve(e)?e.map(r=>r.bind(t.proxy)):e.bind(t.proxy),t,i)}function Bl(e,t,i,r){const c=r.includes(".")?Al(i,r):()=>i[r];if(je(e)){const u=t[e];Se(u)?Et(c,u):de(`Invalid watch handler specified by key "${e}"`,u)}else if(Se(e))Et(c,e.bind(i));else if(Oe(e))if(ve(e))e.forEach(u=>Bl(u,t,i,r));else{const u=Se(e.handler)?e.handler.bind(i):t[e.handler];Se(u)?Et(c,u,e):de(`Invalid watch handler specified by key "${e.handler}"`,u)}else de(`Invalid watch option: "${r}"`,e)}function js(e){const t=e.type,{mixins:i,extends:r}=t,{mixins:c,optionsCache:u,config:{optionMergeStrategies:g}}=e.appContext,v=u.get(t);let b;return v?b=v:!c.length&&!i&&!r?b=t:(b={},c.length&&c.forEach(S=>rr(b,S,g,!0)),rr(b,t,g)),Oe(t)&&u.set(t,b),b}function rr(e,t,i,r=!1){const{mixins:c,extends:u}=t;u&&rr(e,u,i,!0),c&&c.forEach(g=>rr(e,g,i,!0));for(const g in t)if(r&&g==="expose")de('"expose" option is ignored when declared in mixins or extends. It should only be declared in the base component itself.');else{const v=Mu[g]||i&&i[g];e[g]=v?v(e[g],t[g]):t[g]}return e}const Mu={data:go,props:oi,emits:oi,methods:oi,computed:oi,beforeCreate:Ze,created:Ze,beforeMount:Ze,mounted:Ze,beforeUpdate:Ze,updated:Ze,beforeDestroy:Ze,beforeUnmount:Ze,destroyed:Ze,unmounted:Ze,activated:Ze,deactivated:Ze,errorCaptured:Ze,serverPrefetch:Ze,components:oi,directives:oi,watch:Pu,provide:go,inject:Lu};function go(e,t){return t?e?function(){return Fe(Se(e)?e.call(this,this):e,Se(t)?t.call(this,this):t)}:t:e}function Lu(e,t){return oi(es(e),es(t))}function es(e){if(ve(e)){const t={};for(let i=0;i<e.length;i++)t[e[i]]=e[i];return t}return e}function Ze(e,t){return e?[...new Set([].concat(e,t))]:t}function oi(e,t){return e?Fe(Fe(Object.create(null),e),t):t}function Pu(e,t){if(!e)return t;if(!t)return e;const i=Fe(Object.create(null),e);for(const r in t)i[r]=Ze(e[r],t[r]);return i}function ku(e,t,i,r=!1){const c={},u={};Kn(u,xr,1),e.propsDefaults=Object.create(null),jl(e,t,c,u);for(const g in e.propsOptions[0])g in c||(c[g]=void 0);Vl(t||{},c,e),i?e.props=r?c:Oh(c):e.type.props?e.props=c:e.props=u,e.attrs=u}function Fu(e){for(;e;){if(e.type.__hmrId)return!0;e=e.parent}}function Bu(e,t,i,r){const{props:c,attrs:u,vnode:{patchFlag:g}}=e,v=be(c),[b]=e.propsOptions;let S=!1;if(!Fu(e)&&(r||g>0)&&!(g&16)){if(g&8){const w=e.vnode.dynamicProps;for(let E=0;E<w.length;E++){let A=w[E];if(Cr(e.emitsOptions,A))continue;const B=t[A];if(b)if(we(u,A))B!==u[A]&&(u[A]=B,S=!0);else{const z=It(A);c[z]=ts(b,v,z,B,e,!1)}else B!==u[A]&&(u[A]=B,S=!0)}}}else{jl(e,t,c,u)&&(S=!0);let w;for(const E in v)(!t||!we(t,E)&&((w=Jt(E))===E||!we(t,w)))&&(b?i&&(i[E]!==void 0||i[w]!==void 0)&&(c[E]=ts(b,v,E,void 0,e,!0)):delete c[E]);if(u!==v)for(const E in u)(!t||!we(t,E)&&!0)&&(delete u[E],S=!0)}S&&jt(e,"set","$attrs"),Vl(t||{},c,e)}function jl(e,t,i,r){const[c,u]=e.propsOptions;let g=!1,v;if(t)for(let b in t){if(Nn(b))continue;const S=t[b];let w;c&&we(c,w=It(b))?!u||!u.includes(w)?i[w]=S:(v||(v={}))[w]=S:Cr(e.emitsOptions,b)||(!(b in r)||S!==r[b])&&(r[b]=S,g=!0)}if(u){const b=be(i),S=v||De;for(let w=0;w<u.length;w++){const E=u[w];i[E]=ts(c,b,E,S[E],e,!we(S,E))}}return g}function ts(e,t,i,r,c,u){const g=e[i];if(g!=null){const v=we(g,"default");if(v&&r===void 0){const b=g.default;if(g.type!==Function&&Se(b)){const{propsDefaults:S}=c;i in S?r=S[i]:(Gi(c),r=S[i]=b.call(null,t),mi())}else r=b}g[0]&&(u&&!v?r=!1:g[1]&&(r===""||r===Jt(i))&&(r=!0))}return r}function Nl(e,t,i=!1){const r=t.propsCache,c=r.get(e);if(c)return c;const u=e.props,g={},v=[];let b=!1;if(!Se(e)){const w=E=>{b=!0;const[A,B]=Nl(E,t,!0);Fe(g,A),B&&v.push(...B)};!i&&t.mixins.length&&t.mixins.forEach(w),e.extends&&w(e.extends),e.mixins&&e.mixins.forEach(w)}if(!u&&!b)return Oe(e)&&r.set(e,ji),ji;if(ve(u))for(let w=0;w<u.length;w++){je(u[w])||de("props must be strings when using array syntax.",u[w]);const E=It(u[w]);po(E)&&(g[E]=De)}else if(u){Oe(u)||de("invalid props options",u);for(const w in u){const E=It(w);if(po(E)){const A=u[w],B=g[E]=ve(A)||Se(A)?{type:A}:Object.assign({},A);if(B){const z=mo(Boolean,B.type),q=mo(String,B.type);B[0]=z>-1,B[1]=q<0||z<q,(z>-1||we(B,"default"))&&v.push(E)}}}}const S=[g,v];return Oe(e)&&r.set(e,S),S}function po(e){return e[0]!=="$"?!0:(de(`Invalid prop name: "${e}" is a reserved property.`),!1)}function is(e){const t=e&&e.toString().match(/^\s*function (\w+)/);return t?t[1]:e===null?"null":""}function _o(e,t){return is(e)===is(t)}function mo(e,t){return ve(t)?t.findIndex(i=>_o(i,e)):Se(t)&&_o(t,e)?0:-1}function Vl(e,t,i){const r=be(t),c=i.propsOptions[0];for(const u in c){let g=c[u];g!=null&&ju(u,r[u],g,!we(e,u)&&!we(e,Jt(u)))}}function ju(e,t,i,r){const{type:c,required:u,validator:g}=i;if(u&&r){de('Missing required prop: "'+e+'"');return}if(!(t==null&&!i.required)){if(c!=null&&c!==!0){let v=!1;const b=ve(c)?c:[c],S=[];for(let w=0;w<b.length&&!v;w++){const{valid:E,expectedType:A}=Vu(t,b[w]);S.push(A||""),v=E}if(!v){de(Uu(e,t,S));return}}g&&!g(t)&&de('Invalid prop: custom validator check failed for prop "'+e+'".')}}const Nu=ei("String,Number,Boolean,Function,Symbol,BigInt");function Vu(e,t){let i;const r=is(t);if(Nu(r)){const c=typeof e;i=c===r.toLowerCase(),!i&&c==="object"&&(i=e instanceof t)}else r==="Object"?i=Oe(e):r==="Array"?i=ve(e):r==="null"?i=e===null:i=e instanceof t;return{valid:i,expectedType:r}}function Uu(e,t,i){let r=`Invalid prop: type check failed for prop "${e}". Expected ${i.map(yi).join(" | ")}`;const c=i[0],u=ws(t),g=vo(t,c),v=vo(t,u);return i.length===1&&yo(c)&&!Gu(c,u)&&(r+=` with value ${g}`),r+=`, got ${u} `,yo(u)&&(r+=`with value ${v}.`),r}function vo(e,t){return t==="String"?`"${e}"`:t==="Number"?`${Number(e)}`:`${e}`}function yo(e){return["string","number","boolean"].some(i=>e.toLowerCase()===i)}function Gu(...e){return e.some(t=>t.toLowerCase()==="boolean")}const Ul=e=>e[0]==="_"||e==="$stable",Ns=e=>ve(e)?e.map(_t):[_t(e)],Wu=(e,t,i)=>{if(t._n)return t;const r=Vi((...c)=>(Ve&&de(`Slot "${e}" invoked outside of the render function: this will not track dependencies used in the slot. Invoke the slot function inside the render function instead.`),Ns(t(...c))),i);return r._c=!1,r},Gl=(e,t,i)=>{const r=e._ctx;for(const c in e){if(Ul(c))continue;const u=e[c];if(Se(u))t[c]=Wu(c,u,r);else if(u!=null){de(`Non-function value encountered for slot "${c}". Prefer function slots for better performance.`);const g=Ns(u);t[c]=()=>g}}},Wl=(e,t)=>{Tn(e.vnode)||de("Non-function value encountered for default slot. Prefer function slots for better performance.");const i=Ns(t);e.slots.default=()=>i},Hu=(e,t)=>{if(e.vnode.shapeFlag&32){const i=t._;i?(e.slots=be(t),Kn(t,"_",i)):Gl(t,e.slots={})}else e.slots={},t&&Wl(e,t);Kn(e.slots,xr,1)},Yu=(e,t,i)=>{const{vnode:r,slots:c}=e;let u=!0,g=De;if(r.shapeFlag&32){const v=t._;v?pi?Fe(c,t):i&&v===1?u=!1:(Fe(c,t),!i&&v===1&&delete c._):(u=!t.$stable,Gl(t,c)),g=t}else t&&(Wl(e,t),g={default:1});if(u)for(const v in c)!Ul(v)&&!(v in g)&&delete c[v]};function Hl(){return{app:null,config:{isNativeTag:Ua,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let Xu=0;function $u(e,t){return function(r,c=null){Se(r)||(r=Object.assign({},r)),c!=null&&!Oe(c)&&(de("root props passed to app.mount() must be an object."),c=null);const u=Hl(),g=new Set;let v=!1;const b=u.app={_uid:Xu++,_component:r,_props:c,_container:null,_context:u,_instance:null,version:Co,get config(){return u.config},set config(S){de("app.config cannot be replaced. Modify individual options instead.")},use(S,...w){return g.has(S)?de("Plugin has already been applied to target app."):S&&Se(S.install)?(g.add(S),S.install(b,...w)):Se(S)?(g.add(S),S(b,...w)):de('A plugin must either be a function or an object with an "install" function.'),b},mixin(S){return u.mixins.includes(S)?de("Mixin has already been applied to target app"+(S.name?`: ${S.name}`:"")):u.mixins.push(S),b},component(S,w){return rs(S,u.config),w?(u.components[S]&&de(`Component "${S}" has already been registered in target app.`),u.components[S]=w,b):u.components[S]},directive(S,w){return Pl(S),w?(u.directives[S]&&de(`Directive "${S}" has already been registered in target app.`),u.directives[S]=w,b):u.directives[S]},mount(S,w,E){if(v)de("App has already been mounted.\nIf you want to remount the same app, move your app creation logic into a factory function and create fresh app instances for each mount - e.g. `const createMyApp = () => createApp(App)`");else{S.__vue_app__&&de("There is already an app instance mounted on the host container.\n If you want to mount another app on the same host container, you need to unmount the previous app by calling `app.unmount()` first.");const A=Pe(r,c);return A.appContext=u,u.reload=()=>{e(Ot(A),S,E)},w&&t?t(A,S):e(A,S,E),v=!0,b._container=S,S.__vue_app__=b,b._instance=A.component,qh(b,Co),Us(A.component)||A.component.proxy}},unmount(){v?(e(null,b._container),b._instance=null,Jh(b),delete b._container.__vue_app__):de("Cannot unmount an app that is not mounted.")},provide(S,w){return S in u.provides&&de(`App already provides property with key "${String(S)}". It will be overwritten with the new value.`),u.provides[S]=w,b}};return b}}function ns(e,t,i,r,c=!1){if(ve(e)){e.forEach((A,B)=>ns(A,t&&(ve(t)?t[B]:t),i,r,c));return}if(rn(r)&&!c)return;const u=r.shapeFlag&4?Us(r.component)||r.component.proxy:r.el,g=c?null:u,{i:v,r:b}=e;if(!v){de("Missing ref owner context. ref cannot be used on hoisted vnodes. A vnode with ref must be created inside the render function.");return}const S=t&&t.r,w=v.refs===De?v.refs={}:v.refs,E=v.setupState;if(S!=null&&S!==b&&(je(S)?(w[S]=null,we(E,S)&&(E[S]=null)):ke(S)&&(S.value=null)),Se(b))Bt(b,v,12,[g,w]);else{const A=je(b),B=ke(b);if(A||B){const z=()=>{if(e.f){const q=A?we(E,b)?E[b]:w[b]:b.value;c?ve(q)&&bs(q,u):ve(q)?q.includes(u)||q.push(u):A?(w[b]=[u],we(E,b)&&(E[b]=w[b])):(b.value=[u],e.k&&(w[e.k]=b.value))}else A?(w[b]=g,we(E,b)&&(E[b]=g)):B?(b.value=g,e.k&&(w[e.k]=g)):de("Invalid template ref type:",b,`(${typeof b})`)};g?(z.id=-1,nt(z,i)):z()}else de("Invalid template ref type:",b,`(${typeof b})`)}}let zi,zt;function Mt(e,t){e.appContext.config.performance&&sr()&&zt.mark(`vue-${t}-${e.uid}`),eu(e,t,sr()?zt.now():Date.now())}function Lt(e,t){if(e.appContext.config.performance&&sr()){const i=`vue-${t}-${e.uid}`,r=i+":end";zt.mark(r),zt.measure(`<${Er(e,e.type)}> ${t}`,i,r),zt.clearMarks(i),zt.clearMarks(r)}tu(e,t,sr()?zt.now():Date.now())}function sr(){return zi!==void 0||(typeof window<"u"&&window.performance?(zi=!0,zt=window.performance):zi=!1),zi}function zu(){const e=[];if(e.length){const t=e.length>1;console.warn(`Feature flag${t?"s":""} ${e.join(", ")} ${t?"are":"is"} not explicitly defined. You are running the esm-bundler build of Vue, which expects these compile-time feature flags to be globally injected via the bundler config in order to get better tree-shaking in the production bundle.

For more details, see https://link.vuejs.org/feature-flags.`)}}const nt=hu;function qu(e){return Ju(e)}function Ju(e,t){zu();const i=Ya();i.__VUE__=!0,bl(i.__VUE_DEVTOOLS_GLOBAL_HOOK__,i);const{insert:r,remove:c,patchProp:u,createElement:g,createText:v,createComment:b,setText:S,setElementText:w,parentNode:E,nextSibling:A,setScopeId:B=st,insertStaticContent:z}=e,q=(O,R,M,F=null,j=null,G=null,k=!1,P=null,N=pi?!1:!!R.dynamicChildren)=>{if(O===R)return;O&&!li(O,R)&&(F=L(O),C(O,j,G,!0),O=null),R.patchFlag===-2&&(N=!1,R.dynamicChildren=null);const{type:U,ref:Y,shapeFlag:Q}=R;switch(U){case xn:J(O,R,M,F);break;case Ye:Z(O,R,M,F);break;case sn:O==null?ee(R,M,F,k):K(O,R,M,k);break;case We:o(O,R,M,F,j,G,k,P,N);break;default:Q&1?ye(O,R,M,F,j,G,k,P,N):Q&6?l(O,R,M,F,j,G,k,P,N):Q&64||Q&128?U.process(O,R,M,F,j,G,k,P,N,H):de("Invalid VNode type:",U,`(${typeof U})`)}Y!=null&&j&&ns(Y,O&&O.ref,G,R||O,!R)},J=(O,R,M,F)=>{if(O==null)r(R.el=v(R.children),M,F);else{const j=R.el=O.el;R.children!==O.children&&S(j,R.children)}},Z=(O,R,M,F)=>{O==null?r(R.el=b(R.children||""),M,F):R.el=O.el},ee=(O,R,M,F)=>{[O.el,O.anchor]=z(O.children,R,M,F,O.el,O.anchor)},K=(O,R,M,F)=>{if(R.children!==O.children){const j=A(O.anchor);pe(O),[R.el,R.anchor]=z(R.children,M,j,F)}else R.el=O.el,R.anchor=O.anchor},oe=({el:O,anchor:R},M,F)=>{let j;for(;O&&O!==R;)j=A(O),r(O,M,F),O=j;r(R,M,F)},pe=({el:O,anchor:R})=>{let M;for(;O&&O!==R;)M=A(O),c(O),O=M;c(R)},ye=(O,R,M,F,j,G,k,P,N)=>{k=k||R.type==="svg",O==null?_e(R,M,F,j,G,k,P,N):te(O,R,j,G,k,P,N)},_e=(O,R,M,F,j,G,k,P)=>{let N,U;const{type:Y,props:Q,shapeFlag:ie,transition:re,dirs:ne}=O;if(N=O.el=g(O.type,G,Q&&Q.is,Q),ie&8?w(N,O.children):ie&16&&le(O.children,N,null,F,j,G&&Y!=="foreignObject",k,P),ne&&ii(O,null,F,"created"),Q){for(const se in Q)se!=="value"&&!Nn(se)&&u(N,se,null,Q[se],G,O.children,F,j,D);"value"in Q&&u(N,"value",null,Q.value),(U=Q.onVnodeBeforeMount)&&yt(U,F,O)}y(N,O,O.scopeId,k,F),Object.defineProperty(N,"__vnode",{value:O,enumerable:!1}),Object.defineProperty(N,"__vueParentComponent",{value:F,enumerable:!1}),ne&&ii(O,null,F,"beforeMount");const ae=(!j||j&&!j.pendingBranch)&&re&&!re.persisted;ae&&re.beforeEnter(N),r(N,R,M),((U=Q&&Q.onVnodeMounted)||ae||ne)&&nt(()=>{U&&yt(U,F,O),ae&&re.enter(N),ne&&ii(O,null,F,"mounted")},j)},y=(O,R,M,F,j)=>{if(M&&B(O,M),F)for(let G=0;G<F.length;G++)B(O,F[G]);if(j){let G=j.subTree;if(G.patchFlag>0&&G.patchFlag&2048&&(G=El(G.children)||G),R===G){const k=j.vnode;y(O,k,k.scopeId,k.slotScopeIds,j.parent)}}},le=(O,R,M,F,j,G,k,P,N=0)=>{for(let U=N;U<O.length;U++){const Y=O[U]=P?Xt(O[U]):_t(O[U]);q(null,Y,R,M,F,j,G,k,P)}},te=(O,R,M,F,j,G,k)=>{const P=R.el=O.el;let{patchFlag:N,dynamicChildren:U,dirs:Y}=R;N|=O.patchFlag&16;const Q=O.props||De,ie=R.props||De;let re;M&&ni(M,!1),(re=ie.onVnodeBeforeUpdate)&&yt(re,M,R,O),Y&&ii(R,O,M,"beforeUpdate"),M&&ni(M,!0),pi&&(N=0,k=!1,U=null);const ne=j&&R.type!=="foreignObject";if(U?(he(O.dynamicChildren,U,P,M,F,ne,G),M&&M.type.__hmrId&&Hn(O,R)):k||_(O,R,P,null,M,F,ne,G,!1),N>0){if(N&16)a(P,R,Q,ie,M,F,j);else if(N&2&&Q.class!==ie.class&&u(P,"class",null,ie.class,j),N&4&&u(P,"style",Q.style,ie.style,j),N&8){const ae=R.dynamicProps;for(let se=0;se<ae.length;se++){const ue=ae[se],me=Q[ue],ge=ie[ue];(ge!==me||ue==="value")&&u(P,ue,me,ge,j,O.children,M,F,D)}}N&1&&O.children!==R.children&&w(P,R.children)}else!k&&U==null&&a(P,R,Q,ie,M,F,j);((re=ie.onVnodeUpdated)||Y)&&nt(()=>{re&&yt(re,M,R,O),Y&&ii(R,O,M,"updated")},F)},he=(O,R,M,F,j,G,k)=>{for(let P=0;P<R.length;P++){const N=O[P],U=R[P],Y=N.el&&(N.type===We||!li(N,U)||N.shapeFlag&70)?E(N.el):M;q(N,U,Y,null,F,j,G,k,!0)}},a=(O,R,M,F,j,G,k)=>{if(M!==F){if(M!==De)for(const P in M)!Nn(P)&&!(P in F)&&u(O,P,M[P],null,k,R.children,j,G,D);for(const P in F){if(Nn(P))continue;const N=F[P],U=M[P];N!==U&&P!=="value"&&u(O,P,U,N,k,R.children,j,G,D)}"value"in F&&u(O,"value",M.value,F.value)}},o=(O,R,M,F,j,G,k,P,N)=>{const U=R.el=O?O.el:v(""),Y=R.anchor=O?O.anchor:v("");let{patchFlag:Q,dynamicChildren:ie,slotScopeIds:re}=R;(pi||Q&2048)&&(Q=0,N=!1,ie=null),re&&(P=P?P.concat(re):re),O==null?(r(U,M,F),r(Y,M,F),le(R.children,M,Y,j,G,k,P,N)):Q>0&&Q&64&&ie&&O.dynamicChildren?(he(O.dynamicChildren,ie,M,j,G,k,P),j&&j.type.__hmrId?Hn(O,R):(R.key!=null||j&&R===j.subTree)&&Hn(O,R,!0)):_(O,R,M,Y,j,G,k,P,N)},l=(O,R,M,F,j,G,k,P,N)=>{R.slotScopeIds=P,O==null?R.shapeFlag&512?j.ctx.activate(R,M,F,k,N):d(R,M,F,j,G,k,N):n(O,R,N)},d=(O,R,M,F,j,G,k)=>{const P=O.component=ld(O,F,j);if(P.type.__hmrId&&Yh(P),Un(O),Mt(P,"mount"),Tn(O)&&(P.ctx.renderer=H),Mt(P,"init"),hd(P),Lt(P,"init"),P.asyncDep){if(j&&j.registerDep(P,s),!O.el){const N=P.subTree=Pe(Ye);Z(null,N,R,M)}return}s(P,O,R,M,j,G,k),Gn(),Lt(P,"mount")},n=(O,R,M)=>{const F=R.component=O.component;if(au(O,R,M))if(F.asyncDep&&!F.asyncResolved){Un(R),h(F,R,M),Gn();return}else F.next=R,Wh(F.update),F.update();else R.el=O.el,F.vnode=R},s=(O,R,M,F,j,G,k)=>{const P=()=>{if(O.isMounted){let{next:Y,bu:Q,u:ie,parent:re,vnode:ne}=O,ae=Y,se;Un(Y||O.vnode),ni(O,!1),Y?(Y.el=ne.el,h(O,Y,k)):Y=ne,Q&&$i(Q),(se=Y.props&&Y.props.onVnodeBeforeUpdate)&&yt(se,re,Y,ne),ni(O,!0),Mt(O,"render");const ue=Mr(O);Lt(O,"render");const me=O.subTree;O.subTree=ue,Mt(O,"patch"),q(me,ue,E(me.el),L(me),O,j,G),Lt(O,"patch"),Y.el=ue.el,ae===null&&lu(O,ue.el),ie&&nt(ie,j),(se=Y.props&&Y.props.onVnodeUpdated)&&nt(()=>yt(se,re,Y,ne),j),Sl(O),Gn()}else{let Y;const{el:Q,props:ie}=R,{bm:re,m:ne,parent:ae}=O,se=rn(R);if(ni(O,!1),re&&$i(re),!se&&(Y=ie&&ie.onVnodeBeforeMount)&&yt(Y,ae,R),ni(O,!0),Q&&X){const ue=()=>{Mt(O,"render"),O.subTree=Mr(O),Lt(O,"render"),Mt(O,"hydrate"),X(Q,O.subTree,O,j,null),Lt(O,"hydrate")};se?R.type.__asyncLoader().then(()=>!O.isUnmounted&&ue()):ue()}else{Mt(O,"render");const ue=O.subTree=Mr(O);Lt(O,"render"),Mt(O,"patch"),q(null,ue,M,F,O,j,G),Lt(O,"patch"),R.el=ue.el}if(ne&&nt(ne,j),!se&&(Y=ie&&ie.onVnodeMounted)){const ue=R;nt(()=>yt(Y,ae,ue),j)}(R.shapeFlag&256||ae&&rn(ae.vnode)&&ae.vnode.shapeFlag&256)&&O.a&&nt(O.a,j),O.isMounted=!0,Kh(O),R=M=F=null}},N=O.effect=new As(P,()=>Sr(U),O.scope),U=O.update=()=>N.run();U.id=O.uid,ni(O,!0),N.onTrack=O.rtc?Y=>$i(O.rtc,Y):void 0,N.onTrigger=O.rtg?Y=>$i(O.rtg,Y):void 0,U.ownerInstance=O,U()},h=(O,R,M)=>{R.component=O;const F=O.vnode.props;O.vnode=R,O.next=null,Bu(O,R.props,F,M),Yu(O,R.children,M),Ci(),oo(),wi()},_=(O,R,M,F,j,G,k,P,N=!1)=>{const U=O&&O.children,Y=O?O.shapeFlag:0,Q=R.children,{patchFlag:ie,shapeFlag:re}=R;if(ie>0){if(ie&128){p(U,Q,M,F,j,G,k,P,N);return}else if(ie&256){f(U,Q,M,F,j,G,k,P,N);return}}re&8?(Y&16&&D(U,j,G),Q!==U&&w(M,Q)):Y&16?re&16?p(U,Q,M,F,j,G,k,P,N):D(U,j,G,!0):(Y&8&&w(M,""),re&16&&le(Q,M,F,j,G,k,P,N))},f=(O,R,M,F,j,G,k,P,N)=>{O=O||ji,R=R||ji;const U=O.length,Y=R.length,Q=Math.min(U,Y);let ie;for(ie=0;ie<Q;ie++){const re=R[ie]=N?Xt(R[ie]):_t(R[ie]);q(O[ie],re,M,null,j,G,k,P,N)}U>Y?D(O,j,G,!0,!1,Q):le(R,M,F,j,G,k,P,N,Q)},p=(O,R,M,F,j,G,k,P,N)=>{let U=0;const Y=R.length;let Q=O.length-1,ie=Y-1;for(;U<=Q&&U<=ie;){const re=O[U],ne=R[U]=N?Xt(R[U]):_t(R[U]);if(li(re,ne))q(re,ne,M,null,j,G,k,P,N);else break;U++}for(;U<=Q&&U<=ie;){const re=O[Q],ne=R[ie]=N?Xt(R[ie]):_t(R[ie]);if(li(re,ne))q(re,ne,M,null,j,G,k,P,N);else break;Q--,ie--}if(U>Q){if(U<=ie){const re=ie+1,ne=re<Y?R[re].el:F;for(;U<=ie;)q(null,R[U]=N?Xt(R[U]):_t(R[U]),M,ne,j,G,k,P,N),U++}}else if(U>ie)for(;U<=Q;)C(O[U],j,G,!0),U++;else{const re=U,ne=U,ae=new Map;for(U=ne;U<=ie;U++){const Le=R[U]=N?Xt(R[U]):_t(R[U]);Le.key!=null&&(ae.has(Le.key)&&de("Duplicate keys found during update:",JSON.stringify(Le.key),"Make sure keys are unique."),ae.set(Le.key,U))}let se,ue=0;const me=ie-ne+1;let ge=!1,Ce=0;const Te=new Array(me);for(U=0;U<me;U++)Te[U]=0;for(U=re;U<=Q;U++){const Le=O[U];if(ue>=me){C(Le,j,G,!0);continue}let Xe;if(Le.key!=null)Xe=ae.get(Le.key);else for(se=ne;se<=ie;se++)if(Te[se-ne]===0&&li(Le,R[se])){Xe=se;break}Xe===void 0?C(Le,j,G,!0):(Te[Xe-ne]=U+1,Xe>=Ce?Ce=Xe:ge=!0,q(Le,R[Xe],M,null,j,G,k,P,N),ue++)}const Qe=ge?Ku(Te):ji;for(se=Qe.length-1,U=me-1;U>=0;U--){const Le=ne+U,Xe=R[Le],Re=Le+1<Y?R[Le+1].el:F;Te[U]===0?q(null,Xe,M,Re,j,G,k,P,N):ge&&(se<0||U!==Qe[se]?m(Xe,M,Re,2):se--)}}},m=(O,R,M,F,j=null)=>{const{el:G,type:k,transition:P,children:N,shapeFlag:U}=O;if(U&6){m(O.component.subTree,R,M,F);return}if(U&128){O.suspense.move(R,M,F);return}if(U&64){k.move(O,R,M,H);return}if(k===We){r(G,R,M);for(let Q=0;Q<N.length;Q++)m(N[Q],R,M,F);r(O.anchor,R,M);return}if(k===sn){oe(O,R,M);return}if(F!==2&&U&1&&P)if(F===0)P.beforeEnter(G),r(G,R,M),nt(()=>P.enter(G),j);else{const{leave:Q,delayLeave:ie,afterLeave:re}=P,ne=()=>r(G,R,M),ae=()=>{Q(G,()=>{ne(),re&&re()})};ie?ie(G,ne,ae):ae()}else r(G,R,M)},C=(O,R,M,F=!1,j=!1)=>{const{type:G,props:k,ref:P,children:N,dynamicChildren:U,shapeFlag:Y,patchFlag:Q,dirs:ie}=O;if(P!=null&&ns(P,null,M,O,!0),Y&256){R.ctx.deactivate(O);return}const re=Y&1&&ie,ne=!rn(O);let ae;if(ne&&(ae=k&&k.onVnodeBeforeUnmount)&&yt(ae,R,O),Y&6)I(O.component,M,F);else{if(Y&128){O.suspense.unmount(M,F);return}re&&ii(O,null,R,"beforeUnmount"),Y&64?O.type.remove(O,R,M,j,H,F):U&&(G!==We||Q>0&&Q&64)?D(U,R,M,!1,!0):(G===We&&Q&384||!j&&Y&16)&&D(N,R,M),F&&T(O)}(ne&&(ae=k&&k.onVnodeUnmounted)||re)&&nt(()=>{ae&&yt(ae,R,O),re&&ii(O,null,R,"unmounted")},M)},T=O=>{const{type:R,el:M,anchor:F,transition:j}=O;if(R===We){O.patchFlag>0&&O.patchFlag&2048&&j&&!j.persisted?O.children.forEach(k=>{k.type===Ye?c(k.el):T(k)}):x(M,F);return}if(R===sn){pe(O);return}const G=()=>{c(M),j&&!j.persisted&&j.afterLeave&&j.afterLeave()};if(O.shapeFlag&1&&j&&!j.persisted){const{leave:k,delayLeave:P}=j,N=()=>k(M,G);P?P(O.el,G,N):N()}else G()},x=(O,R)=>{let M;for(;O!==R;)M=A(O),c(O),O=M;c(R)},I=(O,R,M)=>{O.type.__hmrId&&Xh(O);const{bum:F,scope:j,update:G,subTree:k,um:P}=O;F&&$i(F),j.stop(),G&&(G.active=!1,C(k,O,R,M)),P&&nt(P,R),nt(()=>{O.isUnmounted=!0},R),R&&R.pendingBranch&&!R.isUnmounted&&O.asyncDep&&!O.asyncResolved&&O.suspenseId===R.pendingId&&(R.deps--,R.deps===0&&R.resolve()),Zh(O)},D=(O,R,M,F=!1,j=!1,G=0)=>{for(let k=G;k<O.length;k++)C(O[k],R,M,F,j)},L=O=>O.shapeFlag&6?L(O.component.subTree):O.shapeFlag&128?O.suspense.next():A(O.anchor||O.el),V=(O,R,M)=>{O==null?R._vnode&&C(R._vnode,null,null,!0):q(R._vnode||null,O,R,null,null,null,M),oo(),ml(),R._vnode=O},H={p:q,um:C,m,r:T,mt:d,mc:le,pc:_,pbc:he,n:L,o:e};let $,X;return t&&([$,X]=t(H)),{render:V,hydrate:$,createApp:$u(V,$)}}function ni({effect:e,update:t},i){e.allowRecurse=t.allowRecurse=i}function Hn(e,t,i=!1){const r=e.children,c=t.children;if(ve(r)&&ve(c))for(let u=0;u<r.length;u++){const g=r[u];let v=c[u];v.shapeFlag&1&&!v.dynamicChildren&&((v.patchFlag<=0||v.patchFlag===32)&&(v=c[u]=Xt(c[u]),v.el=g.el),i||Hn(g,v)),v.type===xn&&(v.el=g.el),v.type===Ye&&!v.el&&(v.el=g.el)}}function Ku(e){const t=e.slice(),i=[0];let r,c,u,g,v;const b=e.length;for(r=0;r<b;r++){const S=e[r];if(S!==0){if(c=i[i.length-1],e[c]<S){t[r]=c,i.push(r);continue}for(u=0,g=i.length-1;u<g;)v=u+g>>1,e[i[v]]<S?u=v+1:g=v;S<e[i[u]]&&(u>0&&(t[r]=i[u-1]),i[u]=r)}}for(u=i.length,g=i[u-1];u-- >0;)i[u]=g,g=t[g];return i}const Qu=e=>e.__isTeleport,We=Symbol("Fragment"),xn=Symbol("Text"),Ye=Symbol("Comment"),sn=Symbol("Static"),on=[];let vt=null;function Je(e=!1){on.push(vt=e?null:[])}function Zu(){on.pop(),vt=on[on.length-1]||null}let pn=1;function bo(e){pn+=e}function Yl(e){return e.dynamicChildren=pn>0?vt||ji:null,Zu(),pn>0&&vt&&vt.push(e),e}function dt(e,t,i,r,c,u){return Yl(Me(e,t,i,r,c,u,!0))}function or(e,t,i,r,c){return Yl(Pe(e,t,i,r,c,!0))}function Ui(e){return e?e.__v_isVNode===!0:!1}function li(e,t){return t.shapeFlag&6&&Li.has(t.type)?(e.shapeFlag&=-257,t.shapeFlag&=-513,!1):e.type===t.type&&e.key===t.key}const ed=(...e)=>td(...e),xr="__vInternal",Xl=({key:e})=>e!=null?e:null,Yn=({ref:e,ref_key:t,ref_for:i})=>e!=null?je(e)||ke(e)||Se(e)?{i:He,r:e,k:t,f:!!i}:e:null;function Me(e,t=null,i=null,r=0,c=null,u=e===We?0:1,g=!1,v=!1){const b={__v_isVNode:!0,__v_skip:!0,type:e,props:t,key:t&&Xl(t),ref:t&&Yn(t),scopeId:wr,slotScopeIds:null,children:i,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:u,patchFlag:r,dynamicProps:c,dynamicChildren:null,appContext:null,ctx:He};return v?(Vs(b,i),u&128&&e.normalize(b)):i&&(b.shapeFlag|=je(i)?8:16),b.key!==b.key&&de("VNode created with invalid key (NaN). VNode type:",b.type),pn>0&&!g&&vt&&(b.patchFlag>0||u&6)&&b.patchFlag!==32&&vt.push(b),b}const Pe=ed;function td(e,t=null,i=null,r=0,c=null,u=!1){if((!e||e===Tu)&&(e||de(`Invalid vnode type when creating vnode: ${e}.`),e=Ye),Ui(e)){const v=Ot(e,t,!0);return i&&Vs(v,i),pn>0&&!u&&vt&&(v.shapeFlag&6?vt[vt.indexOf(e)]=v:vt.push(v)),v.patchFlag|=-2,v}if(Jl(e)&&(e=e.__vccOpts),t){t=id(t);let{class:v,style:b}=t;v&&!je(v)&&(t.class=ys(v)),Oe(b)&&(er(b)&&!ve(b)&&(b=Fe({},b)),t.style=vs(b))}const g=je(e)?1:cu(e)?128:Qu(e)?64:Oe(e)?4:Se(e)?2:0;return g&4&&er(e)&&(e=be(e),de("Vue received a Component which was made a reactive object. This can lead to unnecessary performance overhead, and should be avoided by marking the component with `markRaw` or using `shallowRef` instead of `ref`.",`
Component that was made reactive: `,e)),Me(e,t,i,r,c,g,u,!0)}function id(e){return e?er(e)||xr in e?Fe({},e):e:null}function Ot(e,t,i=!1){const{props:r,ref:c,patchFlag:u,children:g}=e,v=t?sd(r||{},t):r;return{__v_isVNode:!0,__v_skip:!0,type:e.type,props:v,key:v&&Xl(v),ref:t&&t.ref?i&&c?ve(c)?c.concat(Yn(t)):[c,Yn(t)]:Yn(t):c,scopeId:e.scopeId,slotScopeIds:e.slotScopeIds,children:u===-1&&ve(g)?g.map($l):g,target:e.target,targetAnchor:e.targetAnchor,staticCount:e.staticCount,shapeFlag:e.shapeFlag,patchFlag:t&&e.type!==We?u===-1?16:u|16:u,dynamicProps:e.dynamicProps,dynamicChildren:e.dynamicChildren,appContext:e.appContext,dirs:e.dirs,transition:e.transition,component:e.component,suspense:e.suspense,ssContent:e.ssContent&&Ot(e.ssContent),ssFallback:e.ssFallback&&Ot(e.ssFallback),el:e.el,anchor:e.anchor,ctx:e.ctx}}function $l(e){const t=Ot(e);return ve(e.children)&&(t.children=e.children.map($l)),t}function nd(e=" ",t=0){return Pe(xn,null,e,t)}function __(e,t){const i=Pe(sn,null,e);return i.staticCount=t,i}function rd(e="",t=!1){return t?(Je(),or(Ye,null,e)):Pe(Ye,null,e)}function _t(e){return e==null||typeof e=="boolean"?Pe(Ye):ve(e)?Pe(We,null,e.slice()):typeof e=="object"?Xt(e):Pe(xn,null,String(e))}function Xt(e){return e.el===null&&e.patchFlag!==-1||e.memo?e:Ot(e)}function Vs(e,t){let i=0;const{shapeFlag:r}=e;if(t==null)t=null;else if(ve(t))i=16;else if(typeof t=="object")if(r&65){const c=t.default;c&&(c._c&&(c._d=!1),Vs(e,c()),c._c&&(c._d=!0));return}else{i=32;const c=t._;!c&&!(xr in t)?t._ctx=He:c===3&&He&&(He.slots._===1?t._=1:(t._=2,e.patchFlag|=1024))}else Se(t)?(t={default:t,_ctx:He},i=32):(t=String(t),r&64?(i=16,t=[nd(t)]):i=8);e.children=t,e.shapeFlag|=i}function sd(...e){const t={};for(let i=0;i<e.length;i++){const r=e[i];for(const c in r)if(c==="class")t.class!==r.class&&(t.class=ys([t.class,r.class]));else if(c==="style")t.style=vs([t.style,r.style]);else if(Sn(c)){const u=t[c],g=r[c];g&&u!==g&&!(ve(u)&&u.includes(g))&&(t[c]=u?[].concat(u,g):g)}else c!==""&&(t[c]=r[c])}return t}function yt(e,t,i,r=null){ut(e,t,7,[i,r])}const od=Hl();let ad=0;function ld(e,t,i){const r=e.type,c=(t?t.appContext:e.appContext)||od,u={uid:ad++,vnode:e,type:r,parent:t,appContext:c,root:null,next:null,subTree:null,effect:null,update:null,scope:new Xa(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(c.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:Nl(r,c),emitsOptions:wl(r,c),emit:null,emitted:null,propsDefaults:De,inheritAttrs:r.inheritAttrs,ctx:De,data:De,props:De,attrs:De,slots:De,refs:De,setupState:De,setupContext:null,suspense:i,suspenseId:i?i.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return u.ctx=Eu(u),u.root=t?t.root:u,u.emit=nu.bind(null,u),e.ce&&e.ce(u),u}let Ve=null;const En=()=>Ve||He,Gi=e=>{Ve=e,e.scope.on()},mi=()=>{Ve&&Ve.scope.off(),Ve=null},cd=ei("slot,component");function rs(e,t){const i=t.isNativeTag||Ua;(cd(e)||i(e))&&de("Do not use built-in or reserved HTML elements as component id: "+e)}function zl(e){return e.vnode.shapeFlag&4}let _n=!1;function hd(e,t=!1){_n=t;const{props:i,children:r}=e.vnode,c=zl(e);ku(e,i,c,t),Hu(e,r);const u=c?ud(e,t):void 0;return _n=!1,u}function ud(e,t){var i;const r=e.type;{if(r.name&&rs(r.name,e.appContext.config),r.components){const u=Object.keys(r.components);for(let g=0;g<u.length;g++)rs(u[g],e.appContext.config)}if(r.directives){const u=Object.keys(r.directives);for(let g=0;g<u.length;g++)Pl(u[g])}r.compilerOptions&&dd()&&de('"compilerOptions" is only supported when using a build of Vue that includes the runtime compiler. Since you are using a runtime-only build, the options should be passed via your build tool config instead.')}e.accessCache=Object.create(null),e.proxy=pt(new Proxy(e.ctx,Fl)),Au(e);const{setup:c}=r;if(c){const u=e.setupContext=c.length>1?gd(e):null;Gi(e),Ci();const g=Bt(c,e,0,[Pi(e.props),u]);if(wi(),mi(),Cs(g)){if(g.then(mi,mi),t)return g.then(v=>{So(e,v,t)}).catch(v=>{br(v,e,0)});if(e.asyncDep=g,!e.suspense){const v=(i=r.name)!==null&&i!==void 0?i:"Anonymous";de(`Component <${v}>: setup function returned a promise, but no <Suspense> boundary was found in the parent component tree. A component with async setup() must be nested in a <Suspense> in order to be rendered.`)}}else So(e,g,t)}else ql(e,t)}function So(e,t,i){Se(t)?e.type.__ssrInlineRender?e.ssrRender=t:e.render=t:Oe(t)?(Ui(t)&&de("setup() should not return VNodes directly - return a render function instead."),e.devtoolsRawSetupState=t,e.setupState=ul(t),Iu(e)):t!==void 0&&de(`setup() should return an object. Received: ${t===null?"null":typeof t}`),ql(e,i)}let ss;const dd=()=>!ss;function ql(e,t,i){const r=e.type;if(!e.render){if(!t&&ss&&!r.render){const c=r.template||js(e).template;if(c){Mt(e,"compile");const{isCustomElement:u,compilerOptions:g}=e.appContext.config,{delimiters:v,compilerOptions:b}=r,S=Fe(Fe({isCustomElement:u,delimiters:v},g),b);r.render=ss(c,S),Lt(e,"compile")}}e.render=r.render||st}Gi(e),Ci(),Ru(e),wi(),mi(),!r.render&&e.render===st&&!t&&(r.template?de('Component provided template option but runtime compilation is not supported in this build of Vue. Configure your bundler to alias "vue" to "vue/dist/vue.esm-bundler.js".'):de("Component is missing template or render function."))}function fd(e){return new Proxy(e.attrs,{get(t,i){return nr(),at(e,"get","$attrs"),t[i]},set(){return de("setupContext.attrs is readonly."),!1},deleteProperty(){return de("setupContext.attrs is readonly."),!1}})}function gd(e){const t=r=>{e.exposed&&de("expose() should be called only once per setup()."),e.exposed=r||{}};let i;return Object.freeze({get attrs(){return i||(i=fd(e))},get slots(){return Pi(e.slots)},get emit(){return(r,...c)=>e.emit(r,...c)},expose:t})}function Us(e){if(e.exposed)return e.exposeProxy||(e.exposeProxy=new Proxy(ul(pt(e.exposed)),{get(t,i){if(i in t)return t[i];if(i in _i)return _i[i](e)},has(t,i){return i in t||i in _i}}))}const pd=/(?:^|[-_])(\w)/g,_d=e=>e.replace(pd,t=>t.toUpperCase()).replace(/[-_]/g,"");function Gs(e,t=!0){return Se(e)?e.displayName||e.name:e.name||t&&e.__name}function Er(e,t,i=!1){let r=Gs(t);if(!r&&t.__file){const c=t.__file.match(/([^/\\]+)\.\w+$/);c&&(r=c[1])}if(!r&&e&&e.parent){const c=u=>{for(const g in u)if(u[g]===t)return g};r=c(e.components||e.parent.type.components)||c(e.appContext.components)}return r?_d(r):i?"App":"Anonymous"}function Jl(e){return Se(e)&&"__vccOpts"in e}const rt=(e,t)=>kh(e,t,_n);function Kl(e,t,i){const r=arguments.length;return r===2?Oe(t)&&!ve(t)?Ui(t)?Pe(e,null,[t]):Pe(e,t):Pe(e,null,t):(r>3?i=Array.prototype.slice.call(arguments,2):r===3&&Ui(i)&&(i=[i]),Pe(e,t,i))}const md=Symbol("ssrContext"),vd=()=>{{const e=xt(md);return e||de("Server rendering context not provided. Make sure to only call useSSRContext() conditionally in the server build."),e}};function kr(e){return!!(e&&e.__v_isShallow)}function yd(){if(typeof window>"u")return;const e={style:"color:#3ba776"},t={style:"color:#0b1bc9"},i={style:"color:#b62e24"},r={style:"color:#9d288c"},c={header(E){return Oe(E)?E.__isVue?["div",e,"VueInstance"]:ke(E)?["div",{},["span",e,w(E)],"<",v(E.value),">"]:Tt(E)?["div",{},["span",e,kr(E)?"ShallowReactive":"Reactive"],"<",v(E),`>${Qt(E)?" (readonly)":""}`]:Qt(E)?["div",{},["span",e,kr(E)?"ShallowReadonly":"Readonly"],"<",v(E),">"]:null:null},hasBody(E){return E&&E.__isVue},body(E){if(E&&E.__isVue)return["div",{},...u(E.$)]}};function u(E){const A=[];E.type.props&&E.props&&A.push(g("props",be(E.props))),E.setupState!==De&&A.push(g("setup",E.setupState)),E.data!==De&&A.push(g("data",be(E.data)));const B=b(E,"computed");B&&A.push(g("computed",B));const z=b(E,"inject");return z&&A.push(g("injected",z)),A.push(["div",{},["span",{style:r.style+";opacity:0.66"},"$ (internal): "],["object",{object:E}]]),A}function g(E,A){return A=Fe({},A),Object.keys(A).length?["div",{style:"line-height:1.25em;margin-bottom:0.6em"},["div",{style:"color:#476582"},E],["div",{style:"padding-left:1.25em"},...Object.keys(A).map(B=>["div",{},["span",r,B+": "],v(A[B],!1)])]]:["span",{}]}function v(E,A=!0){return typeof E=="number"?["span",t,E]:typeof E=="string"?["span",i,JSON.stringify(E)]:typeof E=="boolean"?["span",r,E]:Oe(E)?["object",{object:A?be(E):E}]:["span",i,String(E)]}function b(E,A){const B=E.type;if(Se(B))return;const z={};for(const q in E.ctx)S(B,q,A)&&(z[q]=E.ctx[q]);return z}function S(E,A,B){const z=E[B];if(ve(z)&&z.includes(A)||Oe(z)&&A in z||E.extends&&S(E.extends,A,B)||E.mixins&&E.mixins.some(q=>S(q,A,B)))return!0}function w(E){return kr(E)?"ShallowRef":E.effect?"ComputedRef":"Ref"}window.devtoolsFormatters?window.devtoolsFormatters.push(c):window.devtoolsFormatters=[c]}const Co="3.2.45",bd="http://www.w3.org/2000/svg",ci=typeof document<"u"?document:null,wo=ci&&ci.createElement("template"),Sd={insert:(e,t,i)=>{t.insertBefore(e,i||null)},remove:e=>{const t=e.parentNode;t&&t.removeChild(e)},createElement:(e,t,i,r)=>{const c=t?ci.createElementNS(bd,e):ci.createElement(e,i?{is:i}:void 0);return e==="select"&&r&&r.multiple!=null&&c.setAttribute("multiple",r.multiple),c},createText:e=>ci.createTextNode(e),createComment:e=>ci.createComment(e),setText:(e,t)=>{e.nodeValue=t},setElementText:(e,t)=>{e.textContent=t},parentNode:e=>e.parentNode,nextSibling:e=>e.nextSibling,querySelector:e=>ci.querySelector(e),setScopeId(e,t){e.setAttribute(t,"")},insertStaticContent(e,t,i,r,c,u){const g=i?i.previousSibling:t.lastChild;if(c&&(c===u||c.nextSibling))for(;t.insertBefore(c.cloneNode(!0),i),!(c===u||!(c=c.nextSibling)););else{wo.innerHTML=r?`<svg>${e}</svg>`:e;const v=wo.content;if(r){const b=v.firstChild;for(;b.firstChild;)v.appendChild(b.firstChild);v.removeChild(b)}t.insertBefore(v,i)}return[g?g.nextSibling:t.firstChild,i?i.previousSibling:t.lastChild]}};function Cd(e,t,i){const r=e._vtc;r&&(t=(t?[t,...r]:[...r]).join(" ")),t==null?e.removeAttribute("class"):i?e.setAttribute("class",t):e.className=t}function wd(e,t,i){const r=e.style,c=je(i);if(i&&!c){for(const u in i)os(r,u,i[u]);if(t&&!je(t))for(const u in t)i[u]==null&&os(r,u,"")}else{const u=r.display;c?t!==i&&(r.cssText=i):t&&e.removeAttribute("style"),"_vod"in e&&(r.display=u)}}const Td=/[^\\];\s*$/,To=/\s*!important$/;function os(e,t,i){if(ve(i))i.forEach(r=>os(e,t,r));else if(i==null&&(i=""),Td.test(i)&&de(`Unexpected semicolon at the end of '${t}' style value: '${i}'`),t.startsWith("--"))e.setProperty(t,i);else{const r=xd(e,t);To.test(i)?e.setProperty(Jt(r),i.replace(To,""),"important"):e[r]=i}}const xo=["Webkit","Moz","ms"],Fr={};function xd(e,t){const i=Fr[t];if(i)return i;let r=It(t);if(r!=="filter"&&r in e)return Fr[t]=r;r=yi(r);for(let c=0;c<xo.length;c++){const u=xo[c]+r;if(u in e)return Fr[t]=u}return t}const Eo="http://www.w3.org/1999/xlink";function Ed(e,t,i,r,c){if(r&&t.startsWith("xlink:"))i==null?e.removeAttributeNS(Eo,t.slice(6,t.length)):e.setAttributeNS(Eo,t,i);else{const u=zc(t);i==null||u&&!Na(i)?e.removeAttribute(t):e.setAttribute(t,u?"":i)}}function Ad(e,t,i,r,c,u,g){if(t==="innerHTML"||t==="textContent"){r&&g(r,c,u),e[t]=i==null?"":i;return}if(t==="value"&&e.tagName!=="PROGRESS"&&!e.tagName.includes("-")){e._value=i;const b=i==null?"":i;(e.value!==b||e.tagName==="OPTION")&&(e.value=b),i==null&&e.removeAttribute(t);return}let v=!1;if(i===""||i==null){const b=typeof e[t];b==="boolean"?i=Na(i):i==null&&b==="string"?(i="",v=!0):b==="number"&&(i=0,v=!0)}try{e[t]=i}catch(b){v||de(`Failed setting prop "${t}" on <${e.tagName.toLowerCase()}>: value ${i} is invalid.`,b)}v&&e.removeAttribute(t)}function Id(e,t,i,r){e.addEventListener(t,i,r)}function Od(e,t,i,r){e.removeEventListener(t,i,r)}function Rd(e,t,i,r,c=null){const u=e._vei||(e._vei={}),g=u[t];if(r&&g)g.value=r;else{const[v,b]=Dd(t);if(r){const S=u[t]=Pd(r,c);Id(e,v,S,b)}else g&&(Od(e,v,g,b),u[t]=void 0)}}const Ao=/(?:Once|Passive|Capture)$/;function Dd(e){let t;if(Ao.test(e)){t={};let r;for(;r=e.match(Ao);)e=e.slice(0,e.length-r[0].length),t[r[0].toLowerCase()]=!0}return[e[2]===":"?e.slice(3):Jt(e.slice(2)),t]}let Br=0;const Md=Promise.resolve(),Ld=()=>Br||(Md.then(()=>Br=0),Br=Date.now());function Pd(e,t){const i=r=>{if(!r._vts)r._vts=Date.now();else if(r._vts<=i.attached)return;ut(kd(r,i.value),t,5,[r])};return i.value=e,i.attached=Ld(),i}function kd(e,t){if(ve(t)){const i=e.stopImmediatePropagation;return e.stopImmediatePropagation=()=>{i.call(e),e._stopped=!0},t.map(r=>c=>!c._stopped&&r&&r(c))}else return t}const Io=/^on[a-z]/,Fd=(e,t,i,r,c=!1,u,g,v,b)=>{t==="class"?Cd(e,r,c):t==="style"?wd(e,i,r):Sn(t)?Jn(t)||Rd(e,t,i,r,g):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):Bd(e,t,r,c))?Ad(e,t,r,u,g,v,b):(t==="true-value"?e._trueValue=r:t==="false-value"&&(e._falseValue=r),Ed(e,t,r,c))};function Bd(e,t,i,r){return r?!!(t==="innerHTML"||t==="textContent"||t in e&&Io.test(t)&&Se(i)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&e.tagName==="INPUT"||t==="type"&&e.tagName==="TEXTAREA"||Io.test(t)&&je(i)?!1:t in e}const Gt="transition",qi="animation",Ql={name:String,type:String,css:{type:Boolean,default:!0},duration:[String,Number,Object],enterFromClass:String,enterActiveClass:String,enterToClass:String,appearFromClass:String,appearActiveClass:String,appearToClass:String,leaveFromClass:String,leaveActiveClass:String,leaveToClass:String},jd=Fe({},gu.props,Ql),ri=(e,t=[])=>{ve(e)?e.forEach(i=>i(...t)):e&&e(...t)},Oo=e=>e?ve(e)?e.some(t=>t.length>1):e.length>1:!1;function Nd(e){const t={};for(const a in e)a in Ql||(t[a]=e[a]);if(e.css===!1)return t;const{name:i="v",type:r,duration:c,enterFromClass:u=`${i}-enter-from`,enterActiveClass:g=`${i}-enter-active`,enterToClass:v=`${i}-enter-to`,appearFromClass:b=u,appearActiveClass:S=g,appearToClass:w=v,leaveFromClass:E=`${i}-leave-from`,leaveActiveClass:A=`${i}-leave-active`,leaveToClass:B=`${i}-leave-to`}=e,z=Vd(c),q=z&&z[0],J=z&&z[1],{onBeforeEnter:Z,onEnter:ee,onEnterCancelled:K,onLeave:oe,onLeaveCancelled:pe,onBeforeAppear:ye=Z,onAppear:_e=ee,onAppearCancelled:y=K}=t,le=(a,o,l)=>{Ht(a,o?w:v),Ht(a,o?S:g),l&&l()},te=(a,o)=>{a._isLeaving=!1,Ht(a,E),Ht(a,B),Ht(a,A),o&&o()},he=a=>(o,l)=>{const d=a?_e:ee,n=()=>le(o,a,l);ri(d,[o,n]),Ro(()=>{Ht(o,a?b:u),Pt(o,a?w:v),Oo(d)||Do(o,r,q,n)})};return Fe(t,{onBeforeEnter(a){ri(Z,[a]),Pt(a,u),Pt(a,g)},onBeforeAppear(a){ri(ye,[a]),Pt(a,b),Pt(a,S)},onEnter:he(!1),onAppear:he(!0),onLeave(a,o){a._isLeaving=!0;const l=()=>te(a,o);Pt(a,E),ec(),Pt(a,A),Ro(()=>{!a._isLeaving||(Ht(a,E),Pt(a,B),Oo(oe)||Do(a,r,J,l))}),ri(oe,[a,l])},onEnterCancelled(a){le(a,!1),ri(K,[a])},onAppearCancelled(a){le(a,!0),ri(y,[a])},onLeaveCancelled(a){te(a),ri(pe,[a])}})}function Vd(e){if(e==null)return null;if(Oe(e))return[jr(e.enter),jr(e.leave)];{const t=jr(e);return[t,t]}}function jr(e){const t=xs(e);return Ud(t),t}function Ud(e){typeof e!="number"?de(`<transition> explicit duration is not a valid number - got ${JSON.stringify(e)}.`):isNaN(e)&&de("<transition> explicit duration is NaN - the duration expression might be incorrect.")}function Pt(e,t){t.split(/\s+/).forEach(i=>i&&e.classList.add(i)),(e._vtc||(e._vtc=new Set)).add(t)}function Ht(e,t){t.split(/\s+/).forEach(r=>r&&e.classList.remove(r));const{_vtc:i}=e;i&&(i.delete(t),i.size||(e._vtc=void 0))}function Ro(e){requestAnimationFrame(()=>{requestAnimationFrame(e)})}let Gd=0;function Do(e,t,i,r){const c=e._endId=++Gd,u=()=>{c===e._endId&&r()};if(i)return setTimeout(u,i);const{type:g,timeout:v,propCount:b}=Zl(e,t);if(!g)return r();const S=g+"end";let w=0;const E=()=>{e.removeEventListener(S,A),u()},A=B=>{B.target===e&&++w>=b&&E()};setTimeout(()=>{w<b&&E()},v+1),e.addEventListener(S,A)}function Zl(e,t){const i=window.getComputedStyle(e),r=z=>(i[z]||"").split(", "),c=r(`${Gt}Delay`),u=r(`${Gt}Duration`),g=Mo(c,u),v=r(`${qi}Delay`),b=r(`${qi}Duration`),S=Mo(v,b);let w=null,E=0,A=0;t===Gt?g>0&&(w=Gt,E=g,A=u.length):t===qi?S>0&&(w=qi,E=S,A=b.length):(E=Math.max(g,S),w=E>0?g>S?Gt:qi:null,A=w?w===Gt?u.length:b.length:0);const B=w===Gt&&/\b(transform|all)(,|$)/.test(r(`${Gt}Property`).toString());return{type:w,timeout:E,propCount:A,hasTransform:B}}function Mo(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max(...t.map((i,r)=>Lo(i)+Lo(e[r])))}function Lo(e){return Number(e.slice(0,-1).replace(",","."))*1e3}function ec(){return document.body.offsetHeight}const tc=new WeakMap,ic=new WeakMap,Wd={name:"TransitionGroup",props:Fe({},jd,{tag:String,moveClass:String}),setup(e,{slots:t}){const i=En(),r=Il();let c,u;return Dl(()=>{if(!c.length)return;const g=e.moveClass||`${e.name||"v"}-move`;if(!zd(c[0].el,i.vnode.el,g))return;c.forEach(Yd),c.forEach(Xd);const v=c.filter($d);ec(),v.forEach(b=>{const S=b.el,w=S.style;Pt(S,g),w.transform=w.webkitTransform=w.transitionDuration="";const E=S._moveCb=A=>{A&&A.target!==S||(!A||/transform$/.test(A.propertyName))&&(S.removeEventListener("transitionend",E),S._moveCb=null,Ht(S,g))};S.addEventListener("transitionend",E)})}),()=>{const g=be(e),v=Nd(g);let b=g.tag||We;c=u,u=t.default?ks(t.default()):[];for(let S=0;S<u.length;S++){const w=u[S];w.key!=null?gn(w,fn(w,v,r,i)):de("<TransitionGroup> children must be keyed.")}if(c)for(let S=0;S<c.length;S++){const w=c[S];gn(w,fn(w,v,r,i)),tc.set(w,w.el.getBoundingClientRect())}return Pe(b,null,u)}}},Hd=Wd;function Yd(e){const t=e.el;t._moveCb&&t._moveCb(),t._enterCb&&t._enterCb()}function Xd(e){ic.set(e,e.el.getBoundingClientRect())}function $d(e){const t=tc.get(e),i=ic.get(e),r=t.left-i.left,c=t.top-i.top;if(r||c){const u=e.el.style;return u.transform=u.webkitTransform=`translate(${r}px,${c}px)`,u.transitionDuration="0s",e}}function zd(e,t,i){const r=e.cloneNode();e._vtc&&e._vtc.forEach(g=>{g.split(/\s+/).forEach(v=>v&&r.classList.remove(v))}),i.split(/\s+/).forEach(g=>g&&r.classList.add(g)),r.style.display="none";const c=t.nodeType===1?t:t.parentNode;c.appendChild(r);const{hasTransform:u}=Zl(r);return c.removeChild(r),u}const qd=Fe({patchProp:Fd},Sd);let Po;function Jd(){return Po||(Po=qu(qd))}const Kd=(...e)=>{const t=Jd().createApp(...e);Qd(t),Zd(t);const{mount:i}=t;return t.mount=r=>{const c=ef(r);if(!c)return;const u=t._component;!Se(u)&&!u.render&&!u.template&&(u.template=c.innerHTML),c.innerHTML="";const g=i(c,!1,c instanceof SVGElement);return c instanceof Element&&(c.removeAttribute("v-cloak"),c.setAttribute("data-v-app","")),g},t};function Qd(e){Object.defineProperty(e.config,"isNativeTag",{value:t=>Yc(t)||Xc(t),writable:!1})}function Zd(e){{const t=e.config.isCustomElement;Object.defineProperty(e.config,"isCustomElement",{get(){return t},set(){de("The `isCustomElement` config option is deprecated. Use `compilerOptions.isCustomElement` instead.")}});const i=e.config.compilerOptions,r='The `compilerOptions` config option is only respected when using a build of Vue.js that includes the runtime compiler (aka "full build"). Since you are using the runtime-only build, `compilerOptions` must be passed to `@vue/compiler-dom` in the build setup instead.\n- For vue-loader: pass it via vue-loader\'s `compilerOptions` loader option.\n- For vue-cli: see https://cli.vuejs.org/guide/webpack.html#modifying-options-of-a-loader\n- For vite: pass it via @vitejs/plugin-vue options. See https://github.com/vitejs/vite/tree/main/packages/plugin-vue#example-for-passing-options-to-vuecompiler-dom';Object.defineProperty(e.config,"compilerOptions",{get(){return de(r),i},set(){de(r)}})}}function ef(e){if(je(e)){const t=document.querySelector(e);return t||de(`Failed to mount app: mount target selector "${e}" returned null.`),t}return window.ShadowRoot&&e instanceof window.ShadowRoot&&e.mode==="closed"&&de('mounting on a ShadowRoot with `{mode: "closed"}` may lead to unpredictable bugs'),e}function tf(){yd()}tf();var nf=!1;function kn(e,t,i){return Array.isArray(e)?(e.length=Math.max(e.length,t),e.splice(t,1,i),i):(e[t]=i,i)}function Nr(e,t){if(Array.isArray(e)){e.splice(t,1);return}delete e[t]}function rf(){return nc().__VUE_DEVTOOLS_GLOBAL_HOOK__}function nc(){return typeof navigator<"u"&&typeof window<"u"?window:typeof global<"u"?global:{}}const sf=typeof Proxy=="function",of="devtools-plugin:setup",af="plugin:settings:set";let Ii,as;function lf(){var e;return Ii!==void 0||(typeof window<"u"&&window.performance?(Ii=!0,as=window.performance):typeof global<"u"&&((e=global.perf_hooks)===null||e===void 0?void 0:e.performance)?(Ii=!0,as=global.perf_hooks.performance):Ii=!1),Ii}function cf(){return lf()?as.now():Date.now()}class hf{constructor(t,i){this.target=null,this.targetQueue=[],this.onQueue=[],this.plugin=t,this.hook=i;const r={};if(t.settings)for(const g in t.settings){const v=t.settings[g];r[g]=v.defaultValue}const c=`__vue-devtools-plugin-settings__${t.id}`;let u=Object.assign({},r);try{const g=localStorage.getItem(c),v=JSON.parse(g);Object.assign(u,v)}catch{}this.fallbacks={getSettings(){return u},setSettings(g){try{localStorage.setItem(c,JSON.stringify(g))}catch{}u=g},now(){return cf()}},i&&i.on(af,(g,v)=>{g===this.plugin.id&&this.fallbacks.setSettings(v)}),this.proxiedOn=new Proxy({},{get:(g,v)=>this.target?this.target.on[v]:(...b)=>{this.onQueue.push({method:v,args:b})}}),this.proxiedTarget=new Proxy({},{get:(g,v)=>this.target?this.target[v]:v==="on"?this.proxiedOn:Object.keys(this.fallbacks).includes(v)?(...b)=>(this.targetQueue.push({method:v,args:b,resolve:()=>{}}),this.fallbacks[v](...b)):(...b)=>new Promise(S=>{this.targetQueue.push({method:v,args:b,resolve:S})})})}async setRealTarget(t){this.target=t;for(const i of this.onQueue)this.target.on[i.method](...i.args);for(const i of this.targetQueue)i.resolve(await this.target[i.method](...i.args))}}function Ws(e,t){const i=e,r=nc(),c=rf(),u=sf&&i.enableEarlyProxy;if(c&&(r.__VUE_DEVTOOLS_PLUGIN_API_AVAILABLE__||!u))c.emit(of,e,t);else{const g=u?new hf(i,c):null;(r.__VUE_DEVTOOLS_PLUGINS__=r.__VUE_DEVTOOLS_PLUGINS__||[]).push({pluginDescriptor:i,setupFn:t,proxy:g}),g&&t(g.proxiedTarget)}}/*!
  * pinia v2.0.27
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */let ls;const mn=e=>ls=e,rc=Symbol("pinia");function Si(e){return e&&typeof e=="object"&&Object.prototype.toString.call(e)==="[object Object]"&&typeof e.toJSON!="function"}var At;(function(e){e.direct="direct",e.patchObject="patch object",e.patchFunction="patch function"})(At||(At={}));const Ar=typeof window<"u",ar=Ar,ko=(()=>typeof window=="object"&&window.window===window?window:typeof self=="object"&&self.self===self?self:typeof global=="object"&&global.global===global?global:typeof globalThis=="object"?globalThis:{HTMLElement:null})();function uf(e,{autoBom:t=!1}={}){return t&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob([String.fromCharCode(65279),e],{type:e.type}):e}function Hs(e,t,i){const r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){ac(r.response,t,i)},r.onerror=function(){console.error("could not download file")},r.send()}function sc(e){const t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function Xn(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{const i=document.createEvent("MouseEvents");i.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(i)}}const $n=typeof navigator=="object"?navigator:{userAgent:""},oc=(()=>/Macintosh/.test($n.userAgent)&&/AppleWebKit/.test($n.userAgent)&&!/Safari/.test($n.userAgent))(),ac=Ar?typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype&&!oc?df:"msSaveOrOpenBlob"in $n?ff:gf:()=>{};function df(e,t="download",i){const r=document.createElement("a");r.download=t,r.rel="noopener",typeof e=="string"?(r.href=e,r.origin!==location.origin?sc(r.href)?Hs(e,t,i):(r.target="_blank",Xn(r)):Xn(r)):(r.href=URL.createObjectURL(e),setTimeout(function(){URL.revokeObjectURL(r.href)},4e4),setTimeout(function(){Xn(r)},0))}function ff(e,t="download",i){if(typeof e=="string")if(sc(e))Hs(e,t,i);else{const r=document.createElement("a");r.href=e,r.target="_blank",setTimeout(function(){Xn(r)})}else navigator.msSaveOrOpenBlob(uf(e,i),t)}function gf(e,t,i,r){if(r=r||open("","_blank"),r&&(r.document.title=r.document.body.innerText="downloading..."),typeof e=="string")return Hs(e,t,i);const c=e.type==="application/octet-stream",u=/constructor/i.test(String(ko.HTMLElement))||"safari"in ko,g=/CriOS\/[\d]+/.test(navigator.userAgent);if((g||c&&u||oc)&&typeof FileReader<"u"){const v=new FileReader;v.onloadend=function(){let b=v.result;if(typeof b!="string")throw r=null,new Error("Wrong reader.result type");b=g?b:b.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=b:location.assign(b),r=null},v.readAsDataURL(e)}else{const v=URL.createObjectURL(e);r?r.location.assign(v):location.href=v,r=null,setTimeout(function(){URL.revokeObjectURL(v)},4e4)}}function Ge(e,t){const i="\u{1F34D} "+e;typeof __VUE_DEVTOOLS_TOAST__=="function"?__VUE_DEVTOOLS_TOAST__(i,t):t==="error"?console.error(i):t==="warn"?console.warn(i):console.log(i)}function Ys(e){return"_a"in e&&"install"in e}function lc(){if(!("clipboard"in navigator))return Ge("Your browser doesn't support the Clipboard API","error"),!0}function cc(e){return e instanceof Error&&e.message.toLowerCase().includes("document is not focused")?(Ge('You need to activate the "Emulate a focused page" setting in the "Rendering" panel of devtools.',"warn"),!0):!1}async function pf(e){if(!lc())try{await navigator.clipboard.writeText(JSON.stringify(e.state.value)),Ge("Global state copied to clipboard.")}catch(t){if(cc(t))return;Ge("Failed to serialize the state. Check the console for more details.","error"),console.error(t)}}async function _f(e){if(!lc())try{e.state.value=JSON.parse(await navigator.clipboard.readText()),Ge("Global state pasted from clipboard.")}catch(t){if(cc(t))return;Ge("Failed to deserialize the state from clipboard. Check the console for more details.","error"),console.error(t)}}async function mf(e){try{ac(new Blob([JSON.stringify(e.state.value)],{type:"text/plain;charset=utf-8"}),"pinia-state.json")}catch(t){Ge("Failed to export the state as JSON. Check the console for more details.","error"),console.error(t)}}let Rt;function vf(){Rt||(Rt=document.createElement("input"),Rt.type="file",Rt.accept=".json");function e(){return new Promise((t,i)=>{Rt.onchange=async()=>{const r=Rt.files;if(!r)return t(null);const c=r.item(0);return t(c?{text:await c.text(),file:c}:null)},Rt.oncancel=()=>t(null),Rt.onerror=i,Rt.click()})}return e}async function yf(e){try{const i=await(await vf())();if(!i)return;const{text:r,file:c}=i;e.state.value=JSON.parse(r),Ge(`Global state imported from "${c.name}".`)}catch(t){Ge("Failed to export the state as JSON. Check the console for more details.","error"),console.error(t)}}function ft(e){return{_custom:{display:e}}}const hc="\u{1F34D} Pinia (root)",cs="_root";function bf(e){return Ys(e)?{id:cs,label:hc}:{id:e.$id,label:e.$id}}function Sf(e){if(Ys(e)){const i=Array.from(e._s.keys()),r=e._s;return{state:i.map(u=>({editable:!0,key:u,value:e.state.value[u]})),getters:i.filter(u=>r.get(u)._getters).map(u=>{const g=r.get(u);return{editable:!1,key:u,value:g._getters.reduce((v,b)=>(v[b]=g[b],v),{})}})}}const t={state:Object.keys(e.$state).map(i=>({editable:!0,key:i,value:e.$state[i]}))};return e._getters&&e._getters.length&&(t.getters=e._getters.map(i=>({editable:!1,key:i,value:e[i]}))),e._customProperties.size&&(t.customProperties=Array.from(e._customProperties).map(i=>({editable:!0,key:i,value:e[i]}))),t}function Cf(e){return e?Array.isArray(e)?e.reduce((t,i)=>(t.keys.push(i.key),t.operations.push(i.type),t.oldValue[i.key]=i.oldValue,t.newValue[i.key]=i.newValue,t),{oldValue:{},keys:[],operations:[],newValue:{}}):{operation:ft(e.type),key:ft(e.key),oldValue:e.oldValue,newValue:e.newValue}:{}}function wf(e){switch(e){case At.direct:return"mutation";case At.patchFunction:return"$patch";case At.patchObject:return"$patch";default:return"unknown"}}let Fi=!0;const zn=[],ai="pinia:mutations",$e="pinia",lr=e=>"\u{1F34D} "+e;function Tf(e,t){Ws({id:"dev.esm.pinia",label:"Pinia \u{1F34D}",logo:"https://pinia.vuejs.org/logo.svg",packageName:"pinia",homepage:"https://pinia.vuejs.org",componentStateTypes:zn,app:e},i=>{typeof i.now!="function"&&Ge("You seem to be using an outdated version of Vue Devtools. Are you still using the Beta release instead of the stable one? You can find the links at https://devtools.vuejs.org/guide/installation.html."),i.addTimelineLayer({id:ai,label:"Pinia \u{1F34D}",color:15064968}),i.addInspector({id:$e,label:"Pinia \u{1F34D}",icon:"storage",treeFilterPlaceholder:"Search stores",actions:[{icon:"content_copy",action:()=>{pf(t)},tooltip:"Serialize and copy the state"},{icon:"content_paste",action:async()=>{await _f(t),i.sendInspectorTree($e),i.sendInspectorState($e)},tooltip:"Replace the state with the content of your clipboard"},{icon:"save",action:()=>{mf(t)},tooltip:"Save the state as a JSON file"},{icon:"folder_open",action:async()=>{await yf(t),i.sendInspectorTree($e),i.sendInspectorState($e)},tooltip:"Import the state from a JSON file"}],nodeActions:[{icon:"restore",tooltip:"Reset the state (option store only)",action:r=>{const c=t._s.get(r);c?c._isOptionsAPI?(c.$reset(),Ge(`Store "${r}" reset.`)):Ge(`Cannot reset "${r}" store because it's a setup store.`,"warn"):Ge(`Cannot reset "${r}" store because it wasn't found.`,"warn")}}]}),i.on.inspectComponent((r,c)=>{const u=r.componentInstance&&r.componentInstance.proxy;if(u&&u._pStores){const g=r.componentInstance.proxy._pStores;Object.values(g).forEach(v=>{r.instanceData.state.push({type:lr(v.$id),key:"state",editable:!0,value:v._isOptionsAPI?{_custom:{value:be(v.$state),actions:[{icon:"restore",tooltip:"Reset the state of this store",action:()=>v.$reset()}]}}:Object.keys(v.$state).reduce((b,S)=>(b[S]=v.$state[S],b),{})}),v._getters&&v._getters.length&&r.instanceData.state.push({type:lr(v.$id),key:"getters",editable:!1,value:v._getters.reduce((b,S)=>{try{b[S]=v[S]}catch(w){b[S]=w}return b},{})})})}}),i.on.getInspectorTree(r=>{if(r.app===e&&r.inspectorId===$e){let c=[t];c=c.concat(Array.from(t._s.values())),r.rootNodes=(r.filter?c.filter(u=>"$id"in u?u.$id.toLowerCase().includes(r.filter.toLowerCase()):hc.toLowerCase().includes(r.filter.toLowerCase())):c).map(bf)}}),i.on.getInspectorState(r=>{if(r.app===e&&r.inspectorId===$e){const c=r.nodeId===cs?t:t._s.get(r.nodeId);if(!c)return;c&&(r.state=Sf(c))}}),i.on.editInspectorState((r,c)=>{if(r.app===e&&r.inspectorId===$e){const u=r.nodeId===cs?t:t._s.get(r.nodeId);if(!u)return Ge(`store "${r.nodeId}" not found`,"error");const{path:g}=r;Ys(u)?g.unshift("state"):(g.length!==1||!u._customProperties.has(g[0])||g[0]in u.$state)&&g.unshift("$state"),Fi=!1,r.set(u,g,r.state.value),Fi=!0}}),i.on.editComponentState(r=>{if(r.type.startsWith("\u{1F34D}")){const c=r.type.replace(/^\s*/,""),u=t._s.get(c);if(!u)return Ge(`store "${c}" not found`,"error");const{path:g}=r;if(g[0]!=="state")return Ge(`Invalid path for store "${c}":
${g}
Only state can be modified.`);g[0]="$state",Fi=!1,r.set(u,g,r.state.value),Fi=!0}})})}function xf(e,t){zn.includes(lr(t.$id))||zn.push(lr(t.$id)),Ws({id:"dev.esm.pinia",label:"Pinia \u{1F34D}",logo:"https://pinia.vuejs.org/logo.svg",packageName:"pinia",homepage:"https://pinia.vuejs.org",componentStateTypes:zn,app:e,settings:{logStoreChanges:{label:"Notify about new/deleted stores",type:"boolean",defaultValue:!0}}},i=>{const r=typeof i.now=="function"?i.now.bind(i):Date.now;t.$onAction(({after:g,onError:v,name:b,args:S})=>{const w=uc++;i.addTimelineEvent({layerId:ai,event:{time:r(),title:"\u{1F6EB} "+b,subtitle:"start",data:{store:ft(t.$id),action:ft(b),args:S},groupId:w}}),g(E=>{hi=void 0,i.addTimelineEvent({layerId:ai,event:{time:r(),title:"\u{1F6EC} "+b,subtitle:"end",data:{store:ft(t.$id),action:ft(b),args:S,result:E},groupId:w}})}),v(E=>{hi=void 0,i.addTimelineEvent({layerId:ai,event:{time:r(),logType:"error",title:"\u{1F4A5} "+b,subtitle:"end",data:{store:ft(t.$id),action:ft(b),args:S,error:E},groupId:w}})})},!0),t._customProperties.forEach(g=>{Et(()=>Ke(t[g]),(v,b)=>{i.notifyComponentUpdate(),i.sendInspectorState($e),Fi&&i.addTimelineEvent({layerId:ai,event:{time:r(),title:"Change",subtitle:g,data:{newValue:v,oldValue:b},groupId:hi}})},{deep:!0})}),t.$subscribe(({events:g,type:v},b)=>{if(i.notifyComponentUpdate(),i.sendInspectorState($e),!Fi)return;const S={time:r(),title:wf(v),data:{store:ft(t.$id),...Cf(g)},groupId:hi};hi=void 0,v===At.patchFunction?S.subtitle="\u2935\uFE0F":v===At.patchObject?S.subtitle="\u{1F9E9}":g&&!Array.isArray(g)&&(S.subtitle=g.type),g&&(S.data["rawEvent(s)"]={_custom:{display:"DebuggerEvent",type:"object",tooltip:"raw DebuggerEvent[]",value:g}}),i.addTimelineEvent({layerId:ai,event:S})},{detached:!0,flush:"sync"});const c=t._hotUpdate;t._hotUpdate=pt(g=>{c(g),i.addTimelineEvent({layerId:ai,event:{time:r(),title:"\u{1F525} "+t.$id,subtitle:"HMR update",data:{store:ft(t.$id),info:ft("HMR update")}}}),i.notifyComponentUpdate(),i.sendInspectorTree($e),i.sendInspectorState($e)});const{$dispose:u}=t;t.$dispose=()=>{u(),i.notifyComponentUpdate(),i.sendInspectorTree($e),i.sendInspectorState($e),i.getSettings().logStoreChanges&&Ge(`Disposed "${t.$id}" store \u{1F5D1}`)},i.notifyComponentUpdate(),i.sendInspectorTree($e),i.sendInspectorState($e),i.getSettings().logStoreChanges&&Ge(`"${t.$id}" store installed \u{1F195}`)})}let uc=0,hi;function Fo(e,t){const i=t.reduce((r,c)=>(r[c]=be(e)[c],r),{});for(const r in i)e[r]=function(){const c=uc,u=new Proxy(e,{get(...g){return hi=c,Reflect.get(...g)},set(...g){return hi=c,Reflect.set(...g)}});return i[r].apply(u,arguments)}}function Ef({app:e,store:t,options:i}){if(!t.$id.startsWith("__hot:")){if(i.state&&(t._isOptionsAPI=!0),typeof i.state=="function"){Fo(t,Object.keys(i.actions));const r=t._hotUpdate;be(t)._hotUpdate=function(c){r.apply(this,arguments),Fo(t,Object.keys(c._hmrPayload.actions))}}xf(e,t)}}function Af(){const e=$a(!0),t=e.run(()=>Cn({}));let i=[],r=[];const c=pt({install(u){mn(c),c._a=u,u.provide(rc,c),u.config.globalProperties.$pinia=c,ar&&Tf(u,c),r.forEach(g=>i.push(g)),r=[]},use(u){return!this._a&&!nf?r.push(u):i.push(u),this},_p:i,_a:null,_e:e,_s:new Map,state:t});return ar&&typeof Proxy<"u"&&c.use(Ef),c}function dc(e,t){for(const i in t){const r=t[i];if(!(i in e))continue;const c=e[i];Si(c)&&Si(r)&&!ke(r)&&!Tt(r)?e[i]=dc(c,r):e[i]=r}return e}const If=()=>{};function Bo(e,t,i,r=If){e.push(t);const c=()=>{const u=e.indexOf(t);u>-1&&(e.splice(u,1),r())};return!i&&th()&&ih(c),c}function Oi(e,...t){e.slice().forEach(i=>{i(...t)})}function hs(e,t){e instanceof Map&&t instanceof Map&&t.forEach((i,r)=>e.set(r,i)),e instanceof Set&&t instanceof Set&&t.forEach(e.add,e);for(const i in t){if(!t.hasOwnProperty(i))continue;const r=t[i],c=e[i];Si(c)&&Si(r)&&e.hasOwnProperty(i)&&!ke(r)&&!Tt(r)?e[i]=hs(c,r):e[i]=r}return e}const Of=Symbol("pinia:skipHydration");function Rf(e){return!Si(e)||!e.hasOwnProperty(Of)}const{assign:gt}=Object;function jo(e){return!!(ke(e)&&e.effect)}function No(e,t,i,r){const{state:c,actions:u,getters:g}=t,v=i.state.value[e];let b;function S(){!v&&!r&&(i.state.value[e]=c?c():{});const w=so(r?Cn(c?c():{}).value:i.state.value[e]);return gt(w,u,Object.keys(g||{}).reduce((E,A)=>(A in w&&console.warn(`[\u{1F34D}]: A getter cannot have the same name as another state property. Rename one of them. Found with "${A}" in store "${e}".`),E[A]=pt(rt(()=>{mn(i);const B=i._s.get(e);return g[A].call(B,B)})),E),{}))}return b=us(e,S,t,i,r,!0),b.$reset=function(){const E=c?c():{};this.$patch(A=>{gt(A,E)})},b}function us(e,t,i={},r,c,u){let g;const v=gt({actions:{}},i);if(!r._e.active)throw new Error("Pinia destroyed");const b={deep:!0};b.onTrigger=le=>{S?B=le:S==!1&&!_e._hotUpdating&&(Array.isArray(B)?B.push(le):console.error("\u{1F34D} debuggerEvents should be an array. This is most likely an internal Pinia bug."))};let S,w,E=pt([]),A=pt([]),B;const z=r.state.value[e];!u&&!z&&!c&&(r.state.value[e]={});const q=Cn({});let J;function Z(le){let te;S=w=!1,B=[],typeof le=="function"?(le(r.state.value[e]),te={type:At.patchFunction,storeId:e,events:B}):(hs(r.state.value[e],le),te={type:At.patchObject,payload:le,storeId:e,events:B});const he=J=Symbol();tr().then(()=>{J===he&&(S=!0)}),w=!0,Oi(E,te,r.state.value[e])}const ee=()=>{throw new Error(`\u{1F34D}: Store "${e}" is built using the setup syntax and does not implement $reset().`)};function K(){g.stop(),E=[],A=[],r._s.delete(e)}function oe(le,te){return function(){mn(r);const he=Array.from(arguments),a=[],o=[];function l(s){a.push(s)}function d(s){o.push(s)}Oi(A,{args:he,name:le,store:_e,after:l,onError:d});let n;try{n=te.apply(this&&this.$id===e?this:_e,he)}catch(s){throw Oi(o,s),s}return n instanceof Promise?n.then(s=>(Oi(a,s),s)).catch(s=>(Oi(o,s),Promise.reject(s))):(Oi(a,n),n)}}const pe=pt({actions:{},getters:{},state:[],hotState:q}),ye={_p:r,$id:e,$onAction:Bo.bind(null,A),$patch:Z,$reset:ee,$subscribe(le,te={}){const he=Bo(E,le,te.detached,()=>a()),a=g.run(()=>Et(()=>r.state.value[e],o=>{(te.flush==="sync"?w:S)&&le({storeId:e,type:At.direct,events:B},o)},gt({},b,te)));return he},$dispose:K},_e=mt(gt({_hmrPayload:pe,_customProperties:pt(new Set)},ye));r._s.set(e,_e);const y=r._e.run(()=>(g=$a(),g.run(()=>t())));for(const le in y){const te=y[le];if(ke(te)&&!jo(te)||Tt(te))c?kn(q.value,le,Vn(y,le)):u||(z&&Rf(te)&&(ke(te)?te.value=z[le]:hs(te,z[le])),r.state.value[e][le]=te),pe.state.push(le);else if(typeof te=="function"){const he=c?te:oe(le,te);y[le]=he,pe.actions[le]=te,v.actions[le]=te}else jo(te)&&(pe.getters[le]=u?i.getters[le]:te,Ar&&(y._getters||(y._getters=pt([]))).push(le))}if(gt(_e,y),gt(be(_e),y),Object.defineProperty(_e,"$state",{get:()=>c?q.value:r.state.value[e],set:le=>{if(c)throw new Error("cannot set hotState");Z(te=>{gt(te,le)})}}),_e._hotUpdate=pt(le=>{_e._hotUpdating=!0,le._hmrPayload.state.forEach(te=>{if(te in _e.$state){const he=le.$state[te],a=_e.$state[te];typeof he=="object"&&Si(he)&&Si(a)?dc(he,a):le.$state[te]=a}kn(_e,te,Vn(le.$state,te))}),Object.keys(_e.$state).forEach(te=>{te in le.$state||Nr(_e,te)}),S=!1,w=!1,r.state.value[e]=Vn(le._hmrPayload,"hotState"),w=!0,tr().then(()=>{S=!0});for(const te in le._hmrPayload.actions){const he=le[te];kn(_e,te,oe(te,he))}for(const te in le._hmrPayload.getters){const he=le._hmrPayload.getters[te],a=u?rt(()=>(mn(r),he.call(_e,_e))):he;kn(_e,te,a)}Object.keys(_e._hmrPayload.getters).forEach(te=>{te in le._hmrPayload.getters||Nr(_e,te)}),Object.keys(_e._hmrPayload.actions).forEach(te=>{te in le._hmrPayload.actions||Nr(_e,te)}),_e._hmrPayload=le._hmrPayload,_e._getters=le._getters,_e._hotUpdating=!1}),ar){const le={writable:!0,configurable:!0,enumerable:!1};["_p","_hmrPayload","_getters","_customProperties"].forEach(te=>{Object.defineProperty(_e,te,{value:_e[te],...le})})}return r._p.forEach(le=>{if(ar){const te=g.run(()=>le({store:_e,app:r._a,pinia:r,options:v}));Object.keys(te||{}).forEach(he=>_e._customProperties.add(he)),gt(_e,te)}else gt(_e,g.run(()=>le({store:_e,app:r._a,pinia:r,options:v})))}),_e.$state&&typeof _e.$state=="object"&&typeof _e.$state.constructor=="function"&&!_e.$state.constructor.toString().includes("[native code]")&&console.warn(`[\u{1F34D}]: The "state" must be a plain object. It cannot be
	state: () => new MyClass()
Found in store "${_e.$id}".`),z&&u&&i.hydrate&&i.hydrate(_e.$state,z),S=!0,w=!0,_e}function Df(e,t,i){let r,c;const u=typeof t=="function";typeof e=="string"?(r=e,c=u?i:t):(c=e,r=e.id);function g(v,b){const S=En();if(v=v||S&&xt(rc),v&&mn(v),!ls)throw new Error(`[\u{1F34D}]: getActivePinia was called with no active Pinia. Did you forget to install pinia?
	const pinia = createPinia()
	app.use(pinia)
This will fail in production.`);v=ls,v._s.has(r)||(u?us(r,t,c,v):No(r,c,v),g._pinia=v);const w=v._s.get(r);if(b){const E="__hot:"+r,A=u?us(E,t,c,v,!0):No(E,gt({},c),v,!0);b._hotUpdate(A),delete v.state.value[E],v._s.delete(E)}if(Ar&&S&&S.proxy&&!b){const E=S.proxy,A="_pStores"in E?E._pStores:E._pStores={};A[r]=w}return w}return g.$id=r,g}/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */function Mf(e,t,i,r){e.prototype._pos=[0,0,0],e.prototype._orientation=[0,0,-1,0,1,0],e.prototype.stereo=function(u){var g=this;if(!g.ctx||!g.ctx.listener)return g;for(var v=g._howls.length-1;v>=0;v--)g._howls[v].stereo(u);return g},e.prototype.pos=function(u,g,v){var b=this;if(!b.ctx||!b.ctx.listener)return b;if(g=typeof g!="number"?b._pos[1]:g,v=typeof v!="number"?b._pos[2]:v,typeof u=="number")b._pos=[u,g,v],typeof b.ctx.listener.positionX<"u"?(b.ctx.listener.positionX.setTargetAtTime(b._pos[0],t.ctx.currentTime,.1),b.ctx.listener.positionY.setTargetAtTime(b._pos[1],t.ctx.currentTime,.1),b.ctx.listener.positionZ.setTargetAtTime(b._pos[2],t.ctx.currentTime,.1)):b.ctx.listener.setPosition(b._pos[0],b._pos[1],b._pos[2]);else return b._pos;return b},e.prototype.orientation=function(u,g,v,b,S,w){var E=this;if(!E.ctx||!E.ctx.listener)return E;var A=E._orientation;if(g=typeof g!="number"?A[1]:g,v=typeof v!="number"?A[2]:v,b=typeof b!="number"?A[3]:b,S=typeof S!="number"?A[4]:S,w=typeof w!="number"?A[5]:w,typeof u=="number")E._orientation=[u,g,v,b,S,w],typeof E.ctx.listener.forwardX<"u"?(E.ctx.listener.forwardX.setTargetAtTime(u,t.ctx.currentTime,.1),E.ctx.listener.forwardY.setTargetAtTime(g,t.ctx.currentTime,.1),E.ctx.listener.forwardZ.setTargetAtTime(v,t.ctx.currentTime,.1),E.ctx.listener.upX.setTargetAtTime(b,t.ctx.currentTime,.1),E.ctx.listener.upY.setTargetAtTime(S,t.ctx.currentTime,.1),E.ctx.listener.upZ.setTargetAtTime(w,t.ctx.currentTime,.1)):E.ctx.listener.setOrientation(u,g,v,b,S,w);else return A;return E},i.prototype.init=function(u){return function(g){var v=this;return v._orientation=g.orientation||[1,0,0],v._stereo=g.stereo||null,v._pos=g.pos||null,v._pannerAttr={coneInnerAngle:typeof g.coneInnerAngle<"u"?g.coneInnerAngle:360,coneOuterAngle:typeof g.coneOuterAngle<"u"?g.coneOuterAngle:360,coneOuterGain:typeof g.coneOuterGain<"u"?g.coneOuterGain:0,distanceModel:typeof g.distanceModel<"u"?g.distanceModel:"inverse",maxDistance:typeof g.maxDistance<"u"?g.maxDistance:1e4,panningModel:typeof g.panningModel<"u"?g.panningModel:"HRTF",refDistance:typeof g.refDistance<"u"?g.refDistance:1,rolloffFactor:typeof g.rolloffFactor<"u"?g.rolloffFactor:1},v._onstereo=g.onstereo?[{fn:g.onstereo}]:[],v._onpos=g.onpos?[{fn:g.onpos}]:[],v._onorientation=g.onorientation?[{fn:g.onorientation}]:[],u.call(this,g)}}(i.prototype.init),i.prototype.stereo=function(u,g){var v=this;if(!v._webAudio)return v;if(v._state!=="loaded")return v._queue.push({event:"stereo",action:function(){v.stereo(u,g)}}),v;var b=typeof t.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof g>"u")if(typeof u=="number")v._stereo=u,v._pos=[u,0,0];else return v._stereo;for(var S=v._getSoundIds(g),w=0;w<S.length;w++){var E=v._soundById(S[w]);if(E)if(typeof u=="number")E._stereo=u,E._pos=[u,0,0],E._node&&(E._pannerAttr.panningModel="equalpower",(!E._panner||!E._panner.pan)&&c(E,b),b==="spatial"?typeof E._panner.positionX<"u"?(E._panner.positionX.setValueAtTime(u,t.ctx.currentTime),E._panner.positionY.setValueAtTime(0,t.ctx.currentTime),E._panner.positionZ.setValueAtTime(0,t.ctx.currentTime)):E._panner.setPosition(u,0,0):E._panner.pan.setValueAtTime(u,t.ctx.currentTime)),v._emit("stereo",E._id);else return E._stereo}return v},i.prototype.pos=function(u,g,v,b){var S=this;if(!S._webAudio)return S;if(S._state!=="loaded")return S._queue.push({event:"pos",action:function(){S.pos(u,g,v,b)}}),S;if(g=typeof g!="number"?0:g,v=typeof v!="number"?-.5:v,typeof b>"u")if(typeof u=="number")S._pos=[u,g,v];else return S._pos;for(var w=S._getSoundIds(b),E=0;E<w.length;E++){var A=S._soundById(w[E]);if(A)if(typeof u=="number")A._pos=[u,g,v],A._node&&((!A._panner||A._panner.pan)&&c(A,"spatial"),typeof A._panner.positionX<"u"?(A._panner.positionX.setValueAtTime(u,t.ctx.currentTime),A._panner.positionY.setValueAtTime(g,t.ctx.currentTime),A._panner.positionZ.setValueAtTime(v,t.ctx.currentTime)):A._panner.setPosition(u,g,v)),S._emit("pos",A._id);else return A._pos}return S},i.prototype.orientation=function(u,g,v,b){var S=this;if(!S._webAudio)return S;if(S._state!=="loaded")return S._queue.push({event:"orientation",action:function(){S.orientation(u,g,v,b)}}),S;if(g=typeof g!="number"?S._orientation[1]:g,v=typeof v!="number"?S._orientation[2]:v,typeof b>"u")if(typeof u=="number")S._orientation=[u,g,v];else return S._orientation;for(var w=S._getSoundIds(b),E=0;E<w.length;E++){var A=S._soundById(w[E]);if(A)if(typeof u=="number")A._orientation=[u,g,v],A._node&&(A._panner||(A._pos||(A._pos=S._pos||[0,0,-.5]),c(A,"spatial")),typeof A._panner.orientationX<"u"?(A._panner.orientationX.setValueAtTime(u,t.ctx.currentTime),A._panner.orientationY.setValueAtTime(g,t.ctx.currentTime),A._panner.orientationZ.setValueAtTime(v,t.ctx.currentTime)):A._panner.setOrientation(u,g,v)),S._emit("orientation",A._id);else return A._orientation}return S},i.prototype.pannerAttr=function(){var u=this,g=arguments,v,b,S;if(!u._webAudio)return u;if(g.length===0)return u._pannerAttr;if(g.length===1)if(typeof g[0]=="object")v=g[0],typeof b>"u"&&(v.pannerAttr||(v.pannerAttr={coneInnerAngle:v.coneInnerAngle,coneOuterAngle:v.coneOuterAngle,coneOuterGain:v.coneOuterGain,distanceModel:v.distanceModel,maxDistance:v.maxDistance,refDistance:v.refDistance,rolloffFactor:v.rolloffFactor,panningModel:v.panningModel}),u._pannerAttr={coneInnerAngle:typeof v.pannerAttr.coneInnerAngle<"u"?v.pannerAttr.coneInnerAngle:u._coneInnerAngle,coneOuterAngle:typeof v.pannerAttr.coneOuterAngle<"u"?v.pannerAttr.coneOuterAngle:u._coneOuterAngle,coneOuterGain:typeof v.pannerAttr.coneOuterGain<"u"?v.pannerAttr.coneOuterGain:u._coneOuterGain,distanceModel:typeof v.pannerAttr.distanceModel<"u"?v.pannerAttr.distanceModel:u._distanceModel,maxDistance:typeof v.pannerAttr.maxDistance<"u"?v.pannerAttr.maxDistance:u._maxDistance,refDistance:typeof v.pannerAttr.refDistance<"u"?v.pannerAttr.refDistance:u._refDistance,rolloffFactor:typeof v.pannerAttr.rolloffFactor<"u"?v.pannerAttr.rolloffFactor:u._rolloffFactor,panningModel:typeof v.pannerAttr.panningModel<"u"?v.pannerAttr.panningModel:u._panningModel});else return S=u._soundById(parseInt(g[0],10)),S?S._pannerAttr:u._pannerAttr;else g.length===2&&(v=g[0],b=parseInt(g[1],10));for(var w=u._getSoundIds(b),E=0;E<w.length;E++)if(S=u._soundById(w[E]),S){var A=S._pannerAttr;A={coneInnerAngle:typeof v.coneInnerAngle<"u"?v.coneInnerAngle:A.coneInnerAngle,coneOuterAngle:typeof v.coneOuterAngle<"u"?v.coneOuterAngle:A.coneOuterAngle,coneOuterGain:typeof v.coneOuterGain<"u"?v.coneOuterGain:A.coneOuterGain,distanceModel:typeof v.distanceModel<"u"?v.distanceModel:A.distanceModel,maxDistance:typeof v.maxDistance<"u"?v.maxDistance:A.maxDistance,refDistance:typeof v.refDistance<"u"?v.refDistance:A.refDistance,rolloffFactor:typeof v.rolloffFactor<"u"?v.rolloffFactor:A.rolloffFactor,panningModel:typeof v.panningModel<"u"?v.panningModel:A.panningModel};var B=S._panner;B||(S._pos||(S._pos=u._pos||[0,0,-.5]),c(S,"spatial"),B=S._panner),B.coneInnerAngle=A.coneInnerAngle,B.coneOuterAngle=A.coneOuterAngle,B.coneOuterGain=A.coneOuterGain,B.distanceModel=A.distanceModel,B.maxDistance=A.maxDistance,B.refDistance=A.refDistance,B.rolloffFactor=A.rolloffFactor,B.panningModel=A.panningModel}return u},r.prototype.init=function(u){return function(){var g=this,v=g._parent;g._orientation=v._orientation,g._stereo=v._stereo,g._pos=v._pos,g._pannerAttr=v._pannerAttr,u.call(this),g._stereo?v.stereo(g._stereo):g._pos&&v.pos(g._pos[0],g._pos[1],g._pos[2],g._id)}}(r.prototype.init),r.prototype.reset=function(u){return function(){var g=this,v=g._parent;return g._orientation=v._orientation,g._stereo=v._stereo,g._pos=v._pos,g._pannerAttr=v._pannerAttr,g._stereo?v.stereo(g._stereo):g._pos?v.pos(g._pos[0],g._pos[1],g._pos[2],g._id):g._panner&&(g._panner.disconnect(0),g._panner=void 0,v._refreshBuffer(g)),u.call(this)}}(r.prototype.reset);var c=function(u,g){g=g||"spatial",g==="spatial"?(u._panner=t.ctx.createPanner(),u._panner.coneInnerAngle=u._pannerAttr.coneInnerAngle,u._panner.coneOuterAngle=u._pannerAttr.coneOuterAngle,u._panner.coneOuterGain=u._pannerAttr.coneOuterGain,u._panner.distanceModel=u._pannerAttr.distanceModel,u._panner.maxDistance=u._pannerAttr.maxDistance,u._panner.refDistance=u._pannerAttr.refDistance,u._panner.rolloffFactor=u._pannerAttr.rolloffFactor,u._panner.panningModel=u._pannerAttr.panningModel,typeof u._panner.positionX<"u"?(u._panner.positionX.setValueAtTime(u._pos[0],t.ctx.currentTime),u._panner.positionY.setValueAtTime(u._pos[1],t.ctx.currentTime),u._panner.positionZ.setValueAtTime(u._pos[2],t.ctx.currentTime)):u._panner.setPosition(u._pos[0],u._pos[1],u._pos[2]),typeof u._panner.orientationX<"u"?(u._panner.orientationX.setValueAtTime(u._orientation[0],t.ctx.currentTime),u._panner.orientationY.setValueAtTime(u._orientation[1],t.ctx.currentTime),u._panner.orientationZ.setValueAtTime(u._orientation[2],t.ctx.currentTime)):u._panner.setOrientation(u._orientation[0],u._orientation[1],u._orientation[2])):(u._panner=t.ctx.createStereoPanner(),u._panner.pan.setValueAtTime(u._stereo,t.ctx.currentTime)),u._panner.connect(u._node),u._paused||u._parent.pause(u._id,!0).play(u._id,!0)}}/*!
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */var Xs=function(){this.init()};Xs.prototype={init:function(){var e=this||ce;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator=typeof window<"u"&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var t=this||ce;if(e=parseFloat(e),t.ctx||qn(),typeof e<"u"&&e>=0&&e<=1){if(t._volume=e,t._muted)return t;t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e,ce.ctx.currentTime);for(var i=0;i<t._howls.length;i++)if(!t._howls[i]._webAudio)for(var r=t._howls[i]._getSoundIds(),c=0;c<r.length;c++){var u=t._howls[i]._soundById(r[c]);u&&u._node&&(u._node.volume=u._volume*e)}return t}return t._volume},mute:function(e){var t=this||ce;t.ctx||qn(),t._muted=e,t.usingWebAudio&&t.masterGain.gain.setValueAtTime(e?0:t._volume,ce.ctx.currentTime);for(var i=0;i<t._howls.length;i++)if(!t._howls[i]._webAudio)for(var r=t._howls[i]._getSoundIds(),c=0;c<r.length;c++){var u=t._howls[i]._soundById(r[c]);u&&u._node&&(u._node.muted=e?!0:u._muted)}return t},stop:function(){for(var e=this||ce,t=0;t<e._howls.length;t++)e._howls[t].stop();return e},unload:function(){for(var e=this||ce,t=e._howls.length-1;t>=0;t--)e._howls[t].unload();return e.usingWebAudio&&e.ctx&&typeof e.ctx.close<"u"&&(e.ctx.close(),e.ctx=null,qn()),e},codecs:function(e){return(this||ce)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||ce;if(e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio)if(typeof Audio<"u")try{var t=new Audio;typeof t.oncanplaythrough>"u"&&(e._canPlayEvent="canplay")}catch{e.noAudio=!0}else e.noAudio=!0;try{var t=new Audio;t.muted&&(e.noAudio=!0)}catch{}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||ce,t=null;try{t=typeof Audio<"u"?new Audio:null}catch{return e}if(!t||typeof t.canPlayType!="function")return e;var i=t.canPlayType("audio/mpeg;").replace(/^no$/,""),r=e._navigator?e._navigator.userAgent:"",c=r.match(/OPR\/([0-6].)/g),u=c&&parseInt(c[0].split("/")[1],10)<33,g=r.indexOf("Safari")!==-1&&r.indexOf("Chrome")===-1,v=r.match(/Version\/(.*?) /),b=g&&v&&parseInt(v[1],10)<15;return e._codecs={mp3:!!(!u&&(i||t.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!i,opus:!!t.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!t.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(t.canPlayType('audio/wav; codecs="1"')||t.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!t.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!t.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(t.canPlayType("audio/x-m4a;")||t.canPlayType("audio/m4a;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(t.canPlayType("audio/x-m4b;")||t.canPlayType("audio/m4b;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(t.canPlayType("audio/x-mp4;")||t.canPlayType("audio/mp4;")||t.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!b&&t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!b&&t.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!t.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(t.canPlayType("audio/x-flac;")||t.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||ce;if(!(e._audioUnlocked||!e.ctx)){e._audioUnlocked=!1,e.autoUnlock=!1,!e._mobileUnloaded&&e.ctx.sampleRate!==44100&&(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var t=function(i){for(;e._html5AudioPool.length<e.html5PoolSize;)try{var r=new Audio;r._unlocked=!0,e._releaseHtml5Audio(r)}catch{e.noAudio=!0;break}for(var c=0;c<e._howls.length;c++)if(!e._howls[c]._webAudio)for(var u=e._howls[c]._getSoundIds(),g=0;g<u.length;g++){var v=e._howls[c]._soundById(u[g]);v&&v._node&&!v._node._unlocked&&(v._node._unlocked=!0,v._node.load())}e._autoResume();var b=e.ctx.createBufferSource();b.buffer=e._scratchBuffer,b.connect(e.ctx.destination),typeof b.start>"u"?b.noteOn(0):b.start(0),typeof e.ctx.resume=="function"&&e.ctx.resume(),b.onended=function(){b.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",t,!0),document.removeEventListener("touchend",t,!0),document.removeEventListener("click",t,!0),document.removeEventListener("keydown",t,!0);for(var S=0;S<e._howls.length;S++)e._howls[S]._emit("unlock")}};return document.addEventListener("touchstart",t,!0),document.addEventListener("touchend",t,!0),document.addEventListener("click",t,!0),document.addEventListener("keydown",t,!0),e}},_obtainHtml5Audio:function(){var e=this||ce;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var t=new Audio().play();return t&&typeof Promise<"u"&&(t instanceof Promise||typeof t.then=="function")&&t.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(e){var t=this||ce;return e._unlocked&&t._html5AudioPool.push(e),t},_autoSuspend:function(){var e=this;if(!(!e.autoSuspend||!e.ctx||typeof e.ctx.suspend>"u"||!ce.usingWebAudio)){for(var t=0;t<e._howls.length;t++)if(e._howls[t]._webAudio){for(var i=0;i<e._howls[t]._sounds.length;i++)if(!e._howls[t]._sounds[i]._paused)return e}return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout(function(){if(!!e.autoSuspend){e._suspendTimer=null,e.state="suspending";var r=function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())};e.ctx.suspend().then(r,r)}},3e4),e}},_autoResume:function(){var e=this;if(!(!e.ctx||typeof e.ctx.resume>"u"||!ce.usingWebAudio))return e.state==="running"&&e.ctx.state!=="interrupted"&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):e.state==="suspended"||e.state==="running"&&e.ctx.state==="interrupted"?(e.ctx.resume().then(function(){e.state="running";for(var t=0;t<e._howls.length;t++)e._howls[t]._emit("resume")}),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):e.state==="suspending"&&(e._resumeAfterSuspend=!0),e}};var ce=new Xs,cr=function(e){var t=this;if(!e.src||e.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}t.init(e)};cr.prototype={init:function(e){var t=this;return ce.ctx||qn(),t._autoplay=e.autoplay||!1,t._format=typeof e.format!="string"?e.format:[e.format],t._html5=e.html5||!1,t._muted=e.mute||!1,t._loop=e.loop||!1,t._pool=e.pool||5,t._preload=typeof e.preload=="boolean"||e.preload==="metadata"?e.preload:!0,t._rate=e.rate||1,t._sprite=e.sprite||{},t._src=typeof e.src!="string"?e.src:[e.src],t._volume=e.volume!==void 0?e.volume:1,t._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:"GET",headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:e.xhr&&e.xhr.withCredentials?e.xhr.withCredentials:!1},t._duration=0,t._state="unloaded",t._sounds=[],t._endTimers={},t._queue=[],t._playLock=!1,t._onend=e.onend?[{fn:e.onend}]:[],t._onfade=e.onfade?[{fn:e.onfade}]:[],t._onload=e.onload?[{fn:e.onload}]:[],t._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],t._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],t._onpause=e.onpause?[{fn:e.onpause}]:[],t._onplay=e.onplay?[{fn:e.onplay}]:[],t._onstop=e.onstop?[{fn:e.onstop}]:[],t._onmute=e.onmute?[{fn:e.onmute}]:[],t._onvolume=e.onvolume?[{fn:e.onvolume}]:[],t._onrate=e.onrate?[{fn:e.onrate}]:[],t._onseek=e.onseek?[{fn:e.onseek}]:[],t._onunlock=e.onunlock?[{fn:e.onunlock}]:[],t._onresume=[],t._webAudio=ce.usingWebAudio&&!t._html5,typeof ce.ctx<"u"&&ce.ctx&&ce.autoUnlock&&ce._unlockAudio(),ce._howls.push(t),t._autoplay&&t._queue.push({event:"play",action:function(){t.play()}}),t._preload&&t._preload!=="none"&&t.load(),t},load:function(){var e=this,t=null;if(ce.noAudio){e._emit("loaderror",null,"No audio support.");return}typeof e._src=="string"&&(e._src=[e._src]);for(var i=0;i<e._src.length;i++){var r,c;if(e._format&&e._format[i])r=e._format[i];else{if(c=e._src[i],typeof c!="string"){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}r=/^data:audio\/([^;,]+);/i.exec(c),r||(r=/\.([^.]+)$/.exec(c.split("?",1)[0])),r&&(r=r[1].toLowerCase())}if(r||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),r&&ce.codecs(r)){t=e._src[i];break}}if(!t){e._emit("loaderror",null,"No codec support for selected audio sources.");return}return e._src=t,e._state="loading",window.location.protocol==="https:"&&t.slice(0,5)==="http:"&&(e._html5=!0,e._webAudio=!1),new hr(e),e._webAudio&&Lf(e),e},play:function(e,t){var i=this,r=null;if(typeof e=="number")r=e,e=null;else{if(typeof e=="string"&&i._state==="loaded"&&!i._sprite[e])return null;if(typeof e>"u"&&(e="__default",!i._playLock)){for(var c=0,u=0;u<i._sounds.length;u++)i._sounds[u]._paused&&!i._sounds[u]._ended&&(c++,r=i._sounds[u]._id);c===1?e=null:r=null}}var g=r?i._soundById(r):i._inactiveSound();if(!g)return null;if(r&&!e&&(e=g._sprite||"__default"),i._state!=="loaded"){g._sprite=e,g._ended=!1;var v=g._id;return i._queue.push({event:"play",action:function(){i.play(v)}}),v}if(r&&!g._paused)return t||i._loadQueue("play"),g._id;i._webAudio&&ce._autoResume();var b=Math.max(0,g._seek>0?g._seek:i._sprite[e][0]/1e3),S=Math.max(0,(i._sprite[e][0]+i._sprite[e][1])/1e3-b),w=S*1e3/Math.abs(g._rate),E=i._sprite[e][0]/1e3,A=(i._sprite[e][0]+i._sprite[e][1])/1e3;g._sprite=e,g._ended=!1;var B=function(){g._paused=!1,g._seek=b,g._start=E,g._stop=A,g._loop=!!(g._loop||i._sprite[e][2])};if(b>=A){i._ended(g);return}var z=g._node;if(i._webAudio){var q=function(){i._playLock=!1,B(),i._refreshBuffer(g);var K=g._muted||i._muted?0:g._volume;z.gain.setValueAtTime(K,ce.ctx.currentTime),g._playStart=ce.ctx.currentTime,typeof z.bufferSource.start>"u"?g._loop?z.bufferSource.noteGrainOn(0,b,86400):z.bufferSource.noteGrainOn(0,b,S):g._loop?z.bufferSource.start(0,b,86400):z.bufferSource.start(0,b,S),w!==1/0&&(i._endTimers[g._id]=setTimeout(i._ended.bind(i,g),w)),t||setTimeout(function(){i._emit("play",g._id),i._loadQueue()},0)};ce.state==="running"&&ce.ctx.state!=="interrupted"?q():(i._playLock=!0,i.once("resume",q),i._clearTimer(g._id))}else{var J=function(){z.currentTime=b,z.muted=g._muted||i._muted||ce._muted||z.muted,z.volume=g._volume*ce.volume(),z.playbackRate=g._rate;try{var K=z.play();if(K&&typeof Promise<"u"&&(K instanceof Promise||typeof K.then=="function")?(i._playLock=!0,B(),K.then(function(){i._playLock=!1,z._unlocked=!0,t?i._loadQueue():i._emit("play",g._id)}).catch(function(){i._playLock=!1,i._emit("playerror",g._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),g._ended=!0,g._paused=!0})):t||(i._playLock=!1,B(),i._emit("play",g._id)),z.playbackRate=g._rate,z.paused){i._emit("playerror",g._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}e!=="__default"||g._loop?i._endTimers[g._id]=setTimeout(i._ended.bind(i,g),w):(i._endTimers[g._id]=function(){i._ended(g),z.removeEventListener("ended",i._endTimers[g._id],!1)},z.addEventListener("ended",i._endTimers[g._id],!1))}catch(oe){i._emit("playerror",g._id,oe)}};z.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(z.src=i._src,z.load());var Z=window&&window.ejecta||!z.readyState&&ce._navigator.isCocoonJS;if(z.readyState>=3||Z)J();else{i._playLock=!0,i._state="loading";var ee=function(){i._state="loaded",J(),z.removeEventListener(ce._canPlayEvent,ee,!1)};z.addEventListener(ce._canPlayEvent,ee,!1),i._clearTimer(g._id)}}return g._id},pause:function(e){var t=this;if(t._state!=="loaded"||t._playLock)return t._queue.push({event:"pause",action:function(){t.pause(e)}}),t;for(var i=t._getSoundIds(e),r=0;r<i.length;r++){t._clearTimer(i[r]);var c=t._soundById(i[r]);if(c&&!c._paused&&(c._seek=t.seek(i[r]),c._rateSeek=0,c._paused=!0,t._stopFade(i[r]),c._node))if(t._webAudio){if(!c._node.bufferSource)continue;typeof c._node.bufferSource.stop>"u"?c._node.bufferSource.noteOff(0):c._node.bufferSource.stop(0),t._cleanBuffer(c._node)}else(!isNaN(c._node.duration)||c._node.duration===1/0)&&c._node.pause();arguments[1]||t._emit("pause",c?c._id:null)}return t},stop:function(e,t){var i=this;if(i._state!=="loaded"||i._playLock)return i._queue.push({event:"stop",action:function(){i.stop(e)}}),i;for(var r=i._getSoundIds(e),c=0;c<r.length;c++){i._clearTimer(r[c]);var u=i._soundById(r[c]);u&&(u._seek=u._start||0,u._rateSeek=0,u._paused=!0,u._ended=!0,i._stopFade(r[c]),u._node&&(i._webAudio?u._node.bufferSource&&(typeof u._node.bufferSource.stop>"u"?u._node.bufferSource.noteOff(0):u._node.bufferSource.stop(0),i._cleanBuffer(u._node)):(!isNaN(u._node.duration)||u._node.duration===1/0)&&(u._node.currentTime=u._start||0,u._node.pause(),u._node.duration===1/0&&i._clearSound(u._node))),t||i._emit("stop",u._id))}return i},mute:function(e,t){var i=this;if(i._state!=="loaded"||i._playLock)return i._queue.push({event:"mute",action:function(){i.mute(e,t)}}),i;if(typeof t>"u")if(typeof e=="boolean")i._muted=e;else return i._muted;for(var r=i._getSoundIds(t),c=0;c<r.length;c++){var u=i._soundById(r[c]);u&&(u._muted=e,u._interval&&i._stopFade(u._id),i._webAudio&&u._node?u._node.gain.setValueAtTime(e?0:u._volume,ce.ctx.currentTime):u._node&&(u._node.muted=ce._muted?!0:e),i._emit("mute",u._id))}return i},volume:function(){var e=this,t=arguments,i,r;if(t.length===0)return e._volume;if(t.length===1||t.length===2&&typeof t[1]>"u"){var c=e._getSoundIds(),u=c.indexOf(t[0]);u>=0?r=parseInt(t[0],10):i=parseFloat(t[0])}else t.length>=2&&(i=parseFloat(t[0]),r=parseInt(t[1],10));var g;if(typeof i<"u"&&i>=0&&i<=1){if(e._state!=="loaded"||e._playLock)return e._queue.push({event:"volume",action:function(){e.volume.apply(e,t)}}),e;typeof r>"u"&&(e._volume=i),r=e._getSoundIds(r);for(var v=0;v<r.length;v++)g=e._soundById(r[v]),g&&(g._volume=i,t[2]||e._stopFade(r[v]),e._webAudio&&g._node&&!g._muted?g._node.gain.setValueAtTime(i,ce.ctx.currentTime):g._node&&!g._muted&&(g._node.volume=i*ce.volume()),e._emit("volume",g._id))}else return g=r?e._soundById(r):e._sounds[0],g?g._volume:0;return e},fade:function(e,t,i,r){var c=this;if(c._state!=="loaded"||c._playLock)return c._queue.push({event:"fade",action:function(){c.fade(e,t,i,r)}}),c;e=Math.min(Math.max(0,parseFloat(e)),1),t=Math.min(Math.max(0,parseFloat(t)),1),i=parseFloat(i),c.volume(e,r);for(var u=c._getSoundIds(r),g=0;g<u.length;g++){var v=c._soundById(u[g]);if(v){if(r||c._stopFade(u[g]),c._webAudio&&!v._muted){var b=ce.ctx.currentTime,S=b+i/1e3;v._volume=e,v._node.gain.setValueAtTime(e,b),v._node.gain.linearRampToValueAtTime(t,S)}c._startFadeInterval(v,e,t,i,u[g],typeof r>"u")}}return c},_startFadeInterval:function(e,t,i,r,c,u){var g=this,v=t,b=i-t,S=Math.abs(b/.01),w=Math.max(4,S>0?r/S:r),E=Date.now();e._fadeTo=i,e._interval=setInterval(function(){var A=(Date.now()-E)/r;E=Date.now(),v+=b*A,v=Math.round(v*100)/100,b<0?v=Math.max(i,v):v=Math.min(i,v),g._webAudio?e._volume=v:g.volume(v,e._id,!0),u&&(g._volume=v),(i<t&&v<=i||i>t&&v>=i)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,g.volume(i,e._id),g._emit("fade",e._id))},w)},_stopFade:function(e){var t=this,i=t._soundById(e);return i&&i._interval&&(t._webAudio&&i._node.gain.cancelScheduledValues(ce.ctx.currentTime),clearInterval(i._interval),i._interval=null,t.volume(i._fadeTo,e),i._fadeTo=null,t._emit("fade",e)),t},loop:function(){var e=this,t=arguments,i,r,c;if(t.length===0)return e._loop;if(t.length===1)if(typeof t[0]=="boolean")i=t[0],e._loop=i;else return c=e._soundById(parseInt(t[0],10)),c?c._loop:!1;else t.length===2&&(i=t[0],r=parseInt(t[1],10));for(var u=e._getSoundIds(r),g=0;g<u.length;g++)c=e._soundById(u[g]),c&&(c._loop=i,e._webAudio&&c._node&&c._node.bufferSource&&(c._node.bufferSource.loop=i,i&&(c._node.bufferSource.loopStart=c._start||0,c._node.bufferSource.loopEnd=c._stop,e.playing(u[g])&&(e.pause(u[g],!0),e.play(u[g],!0)))));return e},rate:function(){var e=this,t=arguments,i,r;if(t.length===0)r=e._sounds[0]._id;else if(t.length===1){var c=e._getSoundIds(),u=c.indexOf(t[0]);u>=0?r=parseInt(t[0],10):i=parseFloat(t[0])}else t.length===2&&(i=parseFloat(t[0]),r=parseInt(t[1],10));var g;if(typeof i=="number"){if(e._state!=="loaded"||e._playLock)return e._queue.push({event:"rate",action:function(){e.rate.apply(e,t)}}),e;typeof r>"u"&&(e._rate=i),r=e._getSoundIds(r);for(var v=0;v<r.length;v++)if(g=e._soundById(r[v]),g){e.playing(r[v])&&(g._rateSeek=e.seek(r[v]),g._playStart=e._webAudio?ce.ctx.currentTime:g._playStart),g._rate=i,e._webAudio&&g._node&&g._node.bufferSource?g._node.bufferSource.playbackRate.setValueAtTime(i,ce.ctx.currentTime):g._node&&(g._node.playbackRate=i);var b=e.seek(r[v]),S=(e._sprite[g._sprite][0]+e._sprite[g._sprite][1])/1e3-b,w=S*1e3/Math.abs(g._rate);(e._endTimers[r[v]]||!g._paused)&&(e._clearTimer(r[v]),e._endTimers[r[v]]=setTimeout(e._ended.bind(e,g),w)),e._emit("rate",g._id)}}else return g=e._soundById(r),g?g._rate:e._rate;return e},seek:function(){var e=this,t=arguments,i,r;if(t.length===0)e._sounds.length&&(r=e._sounds[0]._id);else if(t.length===1){var c=e._getSoundIds(),u=c.indexOf(t[0]);u>=0?r=parseInt(t[0],10):e._sounds.length&&(r=e._sounds[0]._id,i=parseFloat(t[0]))}else t.length===2&&(i=parseFloat(t[0]),r=parseInt(t[1],10));if(typeof r>"u")return 0;if(typeof i=="number"&&(e._state!=="loaded"||e._playLock))return e._queue.push({event:"seek",action:function(){e.seek.apply(e,t)}}),e;var g=e._soundById(r);if(g)if(typeof i=="number"&&i>=0){var v=e.playing(r);v&&e.pause(r,!0),g._seek=i,g._ended=!1,e._clearTimer(r),!e._webAudio&&g._node&&!isNaN(g._node.duration)&&(g._node.currentTime=i);var b=function(){v&&e.play(r,!0),e._emit("seek",r)};if(v&&!e._webAudio){var S=function(){e._playLock?setTimeout(S,0):b()};setTimeout(S,0)}else b()}else if(e._webAudio){var w=e.playing(r)?ce.ctx.currentTime-g._playStart:0,E=g._rateSeek?g._rateSeek-g._seek:0;return g._seek+(E+w*Math.abs(g._rate))}else return g._node.currentTime;return e},playing:function(e){var t=this;if(typeof e=="number"){var i=t._soundById(e);return i?!i._paused:!1}for(var r=0;r<t._sounds.length;r++)if(!t._sounds[r]._paused)return!0;return!1},duration:function(e){var t=this,i=t._duration,r=t._soundById(e);return r&&(i=t._sprite[r._sprite][1]/1e3),i},state:function(){return this._state},unload:function(){for(var e=this,t=e._sounds,i=0;i<t.length;i++)t[i]._paused||e.stop(t[i]._id),e._webAudio||(e._clearSound(t[i]._node),t[i]._node.removeEventListener("error",t[i]._errorFn,!1),t[i]._node.removeEventListener(ce._canPlayEvent,t[i]._loadFn,!1),t[i]._node.removeEventListener("ended",t[i]._endFn,!1),ce._releaseHtml5Audio(t[i]._node)),delete t[i]._node,e._clearTimer(t[i]._id);var r=ce._howls.indexOf(e);r>=0&&ce._howls.splice(r,1);var c=!0;for(i=0;i<ce._howls.length;i++)if(ce._howls[i]._src===e._src||e._src.indexOf(ce._howls[i]._src)>=0){c=!1;break}return vi&&c&&delete vi[e._src],ce.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,t,i,r){var c=this,u=c["_on"+e];return typeof t=="function"&&u.push(r?{id:i,fn:t,once:r}:{id:i,fn:t}),c},off:function(e,t,i){var r=this,c=r["_on"+e],u=0;if(typeof t=="number"&&(i=t,t=null),t||i)for(u=0;u<c.length;u++){var g=i===c[u].id;if(t===c[u].fn&&g||!t&&g){c.splice(u,1);break}}else if(e)r["_on"+e]=[];else{var v=Object.keys(r);for(u=0;u<v.length;u++)v[u].indexOf("_on")===0&&Array.isArray(r[v[u]])&&(r[v[u]]=[])}return r},once:function(e,t,i){var r=this;return r.on(e,t,i,1),r},_emit:function(e,t,i){for(var r=this,c=r["_on"+e],u=c.length-1;u>=0;u--)(!c[u].id||c[u].id===t||e==="load")&&(setTimeout(function(g){g.call(this,t,i)}.bind(r,c[u].fn),0),c[u].once&&r.off(e,c[u].fn,c[u].id));return r._loadQueue(e),r},_loadQueue:function(e){var t=this;if(t._queue.length>0){var i=t._queue[0];i.event===e&&(t._queue.shift(),t._loadQueue()),e||i.action()}return t},_ended:function(e){var t=this,i=e._sprite;if(!t._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(t._ended.bind(t,e),100),t;var r=!!(e._loop||t._sprite[i][2]);if(t._emit("end",e._id),!t._webAudio&&r&&t.stop(e._id,!0).play(e._id),t._webAudio&&r){t._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=ce.ctx.currentTime;var c=(e._stop-e._start)*1e3/Math.abs(e._rate);t._endTimers[e._id]=setTimeout(t._ended.bind(t,e),c)}return t._webAudio&&!r&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,t._clearTimer(e._id),t._cleanBuffer(e._node),ce._autoSuspend()),!t._webAudio&&!r&&t.stop(e._id,!0),t},_clearTimer:function(e){var t=this;if(t._endTimers[e]){if(typeof t._endTimers[e]!="function")clearTimeout(t._endTimers[e]);else{var i=t._soundById(e);i&&i._node&&i._node.removeEventListener("ended",t._endTimers[e],!1)}delete t._endTimers[e]}return t},_soundById:function(e){for(var t=this,i=0;i<t._sounds.length;i++)if(e===t._sounds[i]._id)return t._sounds[i];return null},_inactiveSound:function(){var e=this;e._drain();for(var t=0;t<e._sounds.length;t++)if(e._sounds[t]._ended)return e._sounds[t].reset();return new hr(e)},_drain:function(){var e=this,t=e._pool,i=0,r=0;if(!(e._sounds.length<t)){for(r=0;r<e._sounds.length;r++)e._sounds[r]._ended&&i++;for(r=e._sounds.length-1;r>=0;r--){if(i<=t)return;e._sounds[r]._ended&&(e._webAudio&&e._sounds[r]._node&&e._sounds[r]._node.disconnect(0),e._sounds.splice(r,1),i--)}}},_getSoundIds:function(e){var t=this;if(typeof e>"u"){for(var i=[],r=0;r<t._sounds.length;r++)i.push(t._sounds[r]._id);return i}else return[e]},_refreshBuffer:function(e){var t=this;return e._node.bufferSource=ce.ctx.createBufferSource(),e._node.bufferSource.buffer=vi[t._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,ce.ctx.currentTime),t},_cleanBuffer:function(e){var t=this,i=ce._navigator&&ce._navigator.vendor.indexOf("Apple")>=0;if(!e.bufferSource)return t;if(ce._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),i))try{e.bufferSource.buffer=ce._scratchBuffer}catch{}return e.bufferSource=null,t},_clearSound:function(e){var t=/MSIE |Trident\//.test(ce._navigator&&ce._navigator.userAgent);t||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var hr=function(e){this._parent=e,this.init()};hr.prototype={init:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++ce._counter,t._sounds.push(e),e.create(),e},create:function(){var e=this,t=e._parent,i=ce._muted||e._muted||e._parent._muted?0:e._volume;return t._webAudio?(e._node=typeof ce.ctx.createGain>"u"?ce.ctx.createGainNode():ce.ctx.createGain(),e._node.gain.setValueAtTime(i,ce.ctx.currentTime),e._node.paused=!0,e._node.connect(ce.masterGain)):ce.noAudio||(e._node=ce._obtainHtml5Audio(),e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(ce._canPlayEvent,e._loadFn,!1),e._endFn=e._endListener.bind(e),e._node.addEventListener("ended",e._endFn,!1),e._node.src=t._src,e._node.preload=t._preload===!0?"auto":t._preload,e._node.volume=i*ce.volume(),e._node.load()),e},reset:function(){var e=this,t=e._parent;return e._muted=t._muted,e._loop=t._loop,e._volume=t._volume,e._rate=t._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++ce._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,t=e._parent;t._duration=Math.ceil(e._node.duration*10)/10,Object.keys(t._sprite).length===0&&(t._sprite={__default:[0,t._duration*1e3]}),t._state!=="loaded"&&(t._state="loaded",t._emit("load"),t._loadQueue()),e._node.removeEventListener(ce._canPlayEvent,e._loadFn,!1)},_endListener:function(){var e=this,t=e._parent;t._duration===1/0&&(t._duration=Math.ceil(e._node.duration*10)/10,t._sprite.__default[1]===1/0&&(t._sprite.__default[1]=t._duration*1e3),t._ended(e)),e._node.removeEventListener("ended",e._endFn,!1)}};var vi={},Lf=function(e){var t=e._src;if(vi[t]){e._duration=vi[t].duration,fc(e);return}if(/^data:[^;]+;base64,/.test(t)){for(var i=atob(t.split(",")[1]),r=new Uint8Array(i.length),c=0;c<i.length;++c)r[c]=i.charCodeAt(c);Vo(r.buffer,e)}else{var u=new XMLHttpRequest;u.open(e._xhr.method,t,!0),u.withCredentials=e._xhr.withCredentials,u.responseType="arraybuffer",e._xhr.headers&&Object.keys(e._xhr.headers).forEach(function(g){u.setRequestHeader(g,e._xhr.headers[g])}),u.onload=function(){var g=(u.status+"")[0];if(g!=="0"&&g!=="2"&&g!=="3"){e._emit("loaderror",null,"Failed loading audio file with status: "+u.status+".");return}Vo(u.response,e)},u.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete vi[t],e.load())},Pf(u)}},Pf=function(e){try{e.send()}catch{e.onerror()}},Vo=function(e,t){var i=function(){t._emit("loaderror",null,"Decoding audio data failed.")},r=function(c){c&&t._sounds.length>0?(vi[t._src]=c,fc(t,c)):i()};typeof Promise<"u"&&ce.ctx.decodeAudioData.length===1?ce.ctx.decodeAudioData(e).then(r).catch(i):ce.ctx.decodeAudioData(e,r,i)},fc=function(e,t){t&&!e._duration&&(e._duration=t.duration),Object.keys(e._sprite).length===0&&(e._sprite={__default:[0,e._duration*1e3]}),e._state!=="loaded"&&(e._state="loaded",e._emit("load"),e._loadQueue())},qn=function(){if(!!ce.usingWebAudio){try{typeof AudioContext<"u"?ce.ctx=new AudioContext:typeof webkitAudioContext<"u"?ce.ctx=new webkitAudioContext:ce.usingWebAudio=!1}catch{ce.usingWebAudio=!1}ce.ctx||(ce.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(ce._navigator&&ce._navigator.platform),t=ce._navigator&&ce._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),i=t?parseInt(t[1],10):null;if(e&&i&&i<9){var r=/safari/.test(ce._navigator&&ce._navigator.userAgent.toLowerCase());ce._navigator&&!r&&(ce.usingWebAudio=!1)}ce.usingWebAudio&&(ce.masterGain=typeof ce.ctx.createGain>"u"?ce.ctx.createGainNode():ce.ctx.createGain(),ce.masterGain.gain.setValueAtTime(ce._muted?0:ce._volume,ce.ctx.currentTime),ce.masterGain.connect(ce.ctx.destination)),ce._setup()}};Mf(Xs,ce,cr,hr);/*!
 * Dynamsoft JavaScript Library
 * @product Dynamsoft Barcode Reader JS Edition
 * @website http://www.dynamsoft.com
 * @copyright Copyright 2022, Dynamsoft Corporation
 * @author Dynamsoft
 * @version 9.3.1 (js 20220930)
 * @fileoverview Dynamsoft JavaScript Library for Barcode Reader
 * More info on DBR JS: https://www.dynamsoft.com/barcode-reader/sdk-javascript/
 */const Ti=typeof self>"u";let Ri,et,Fn,ur,Ue;if(typeof navigator<"u"&&(Ri=navigator,et=Ri.userAgent,Fn=Ri.platform,ur=Ri.mediaDevices),!Ti){const e={init:function(){this.browser=this.searchString(this.dataBrowser)||"unknownBrowser",this.version=this.searchVersion(et)||this.searchVersion(Ri.appVersion)||0,this.OS=this.searchString(this.dataOS)||"unknownOS",this.OS=="Linux"&&et.indexOf("Windows NT")!=-1&&(this.OS="HarmonyOS")},searchString:function(t){for(let i=0;i<t.length;i++){let r=t[i].string,c=t[i].prop;if(this.versionSearchString=t[i].versionSearch||t[i].identity,r){if(r.indexOf(t[i].subString)!=-1)return t[i].identity}else if(c)return t[i].identity}},searchVersion:function(t){let i=t.indexOf(this.versionSearchString);if(i!=-1)return parseFloat(t.substring(i+this.versionSearchString.length+1))},dataBrowser:[{string:et,subString:"Edge",identity:"Edge"},{string:et,subString:"OPR",identity:"OPR"},{string:et,subString:"Chrome",identity:"Chrome"},{string:Ri.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{string:et,subString:"Firefox",identity:"Firefox"},{string:et,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"}],dataOS:[{string:et,subString:"HarmonyOS",identity:"HarmonyOS"},{string:et,subString:"Android",identity:"Android"},{string:et,subString:"iPhone",identity:"iPhone"},{string:Fn,subString:"Win",identity:"Windows"},{string:Fn,subString:"Mac",identity:"Mac"},{string:Fn,subString:"Linux",identity:"Linux"}]};e.init(),Ue={browser:e.browser,version:e.version,OS:e.OS}}Ti&&(Ue={browser:"ssr",version:0,OS:"ssr"});const kf=typeof WebAssembly<"u"&&et&&!(/Safari/.test(et)&&!/Chrome/.test(et)&&/\(.+\s11_2_([2-6]).*\)/.test(et)),Ff=!(typeof Worker>"u"),gc=!(!ur||!ur.getUserMedia),Bf=async()=>{let e=!1;if(gc)try{(await ur.getUserMedia({video:!0})).getTracks().forEach(t=>{t.stop()}),e=!0}catch{}return e};Ue.browser==="Chrome"&&Ue.version>66||Ue.browser==="Safari"&&Ue.version>13||Ue.browser==="OPR"&&Ue.version>43||Ue.browser==="Edge"&&Ue.version;const jf=(()=>{if(!Ti&&document.currentScript){let e=document.currentScript.src,t=e.indexOf("?");if(t!=-1)e=e.substring(0,t);else{let i=e.indexOf("#");i!=-1&&(e=e.substring(0,i))}return e.substring(0,e.lastIndexOf("/")+1)}return"./"})(),Ji=" is not allowed to change after `createInstance` or `loadWasm` is called.",Nf=!Ti&&document.currentScript&&(document.currentScript.getAttribute("data-license")||document.currentScript.getAttribute("data-productKeys")||document.currentScript.getAttribute("data-licenseKey")||document.currentScript.getAttribute("data-handshakeCode")||document.currentScript.getAttribute("data-organizationID"))||"",Vf=!Ti&&document.currentScript&&document.currentScript.getAttribute("data-sessionPassword")||"",Uo=e=>{if(e==null)e=[];else{e=e instanceof Array?[...e]:[e];for(let t=0;t<e.length;++t){if(!Ti){let i=document.createElement("a");i.href=e[t],e[t]=i.href}e[t].endsWith("/")||(e[t]+="/")}}return e};var Be,dr,ds,wt;(function(e){e[e.IPF_Binary=0]="IPF_Binary",e[e.IPF_BinaryInverted=1]="IPF_BinaryInverted",e[e.IPF_GrayScaled=2]="IPF_GrayScaled",e[e.IPF_NV21=3]="IPF_NV21",e[e.IPF_RGB_565=4]="IPF_RGB_565",e[e.IPF_RGB_555=5]="IPF_RGB_555",e[e.IPF_RGB_888=6]="IPF_RGB_888",e[e.IPF_ARGB_8888=7]="IPF_ARGB_8888",e[e.IPF_RGB_161616=8]="IPF_RGB_161616",e[e.IPF_ARGB_16161616=9]="IPF_ARGB_16161616",e[e.IPF_ABGR_8888=10]="IPF_ABGR_8888",e[e.IPF_ABGR_16161616=11]="IPF_ABGR_16161616",e[e.IPF_BGR_888=12]="IPF_BGR_888"})(Be||(Be={})),function(e){e[e.DBR_SYSTEM_EXCEPTION=1]="DBR_SYSTEM_EXCEPTION",e[e.DBR_SUCCESS=0]="DBR_SUCCESS",e[e.DBR_UNKNOWN=-1e4]="DBR_UNKNOWN",e[e.DBR_NO_MEMORY=-10001]="DBR_NO_MEMORY",e[e.DBR_NULL_REFERENCE=-10002]="DBR_NULL_REFERENCE",e[e.DBR_LICENSE_INVALID=-10003]="DBR_LICENSE_INVALID",e[e.DBR_LICENSE_EXPIRED=-10004]="DBR_LICENSE_EXPIRED",e[e.DBR_FILE_NOT_FOUND=-10005]="DBR_FILE_NOT_FOUND",e[e.DBR_FILETYPE_NOT_SUPPORTED=-10006]="DBR_FILETYPE_NOT_SUPPORTED",e[e.DBR_BPP_NOT_SUPPORTED=-10007]="DBR_BPP_NOT_SUPPORTED",e[e.DBR_INDEX_INVALID=-10008]="DBR_INDEX_INVALID",e[e.DBR_BARCODE_FORMAT_INVALID=-10009]="DBR_BARCODE_FORMAT_INVALID",e[e.DBR_CUSTOM_REGION_INVALID=-10010]="DBR_CUSTOM_REGION_INVALID",e[e.DBR_MAX_BARCODE_NUMBER_INVALID=-10011]="DBR_MAX_BARCODE_NUMBER_INVALID",e[e.DBR_IMAGE_READ_FAILED=-10012]="DBR_IMAGE_READ_FAILED",e[e.DBR_TIFF_READ_FAILED=-10013]="DBR_TIFF_READ_FAILED",e[e.DBR_QR_LICENSE_INVALID=-10016]="DBR_QR_LICENSE_INVALID",e[e.DBR_1D_LICENSE_INVALID=-10017]="DBR_1D_LICENSE_INVALID",e[e.DBR_DIB_BUFFER_INVALID=-10018]="DBR_DIB_BUFFER_INVALID",e[e.DBR_PDF417_LICENSE_INVALID=-10019]="DBR_PDF417_LICENSE_INVALID",e[e.DBR_DATAMATRIX_LICENSE_INVALID=-10020]="DBR_DATAMATRIX_LICENSE_INVALID",e[e.DBR_PDF_READ_FAILED=-10021]="DBR_PDF_READ_FAILED",e[e.DBR_PDF_DLL_MISSING=-10022]="DBR_PDF_DLL_MISSING",e[e.DBR_PAGE_NUMBER_INVALID=-10023]="DBR_PAGE_NUMBER_INVALID",e[e.DBR_CUSTOM_SIZE_INVALID=-10024]="DBR_CUSTOM_SIZE_INVALID",e[e.DBR_CUSTOM_MODULESIZE_INVALID=-10025]="DBR_CUSTOM_MODULESIZE_INVALID",e[e.DBR_RECOGNITION_TIMEOUT=-10026]="DBR_RECOGNITION_TIMEOUT",e[e.DBR_JSON_PARSE_FAILED=-10030]="DBR_JSON_PARSE_FAILED",e[e.DBR_JSON_TYPE_INVALID=-10031]="DBR_JSON_TYPE_INVALID",e[e.DBR_JSON_KEY_INVALID=-10032]="DBR_JSON_KEY_INVALID",e[e.DBR_JSON_VALUE_INVALID=-10033]="DBR_JSON_VALUE_INVALID",e[e.DBR_JSON_NAME_KEY_MISSING=-10034]="DBR_JSON_NAME_KEY_MISSING",e[e.DBR_JSON_NAME_VALUE_DUPLICATED=-10035]="DBR_JSON_NAME_VALUE_DUPLICATED",e[e.DBR_TEMPLATE_NAME_INVALID=-10036]="DBR_TEMPLATE_NAME_INVALID",e[e.DBR_JSON_NAME_REFERENCE_INVALID=-10037]="DBR_JSON_NAME_REFERENCE_INVALID",e[e.DBR_PARAMETER_VALUE_INVALID=-10038]="DBR_PARAMETER_VALUE_INVALID",e[e.DBR_DOMAIN_NOT_MATCHED=-10039]="DBR_DOMAIN_NOT_MATCHED",e[e.DBR_RESERVEDINFO_NOT_MATCHED=-10040]="DBR_RESERVEDINFO_NOT_MATCHED",e[e.DBR_AZTEC_LICENSE_INVALID=-10041]="DBR_AZTEC_LICENSE_INVALID",e[e.DBR_LICENSE_DLL_MISSING=-10042]="DBR_LICENSE_DLL_MISSING",e[e.DBR_LICENSEKEY_NOT_MATCHED=-10043]="DBR_LICENSEKEY_NOT_MATCHED",e[e.DBR_REQUESTED_FAILED=-10044]="DBR_REQUESTED_FAILED",e[e.DBR_LICENSE_INIT_FAILED=-10045]="DBR_LICENSE_INIT_FAILED",e[e.DBR_PATCHCODE_LICENSE_INVALID=-10046]="DBR_PATCHCODE_LICENSE_INVALID",e[e.DBR_POSTALCODE_LICENSE_INVALID=-10047]="DBR_POSTALCODE_LICENSE_INVALID",e[e.DBR_DPM_LICENSE_INVALID=-10048]="DBR_DPM_LICENSE_INVALID",e[e.DBR_FRAME_DECODING_THREAD_EXISTS=-10049]="DBR_FRAME_DECODING_THREAD_EXISTS",e[e.DBR_STOP_DECODING_THREAD_FAILED=-10050]="DBR_STOP_DECODING_THREAD_FAILED",e[e.DBR_SET_MODE_ARGUMENT_ERROR=-10051]="DBR_SET_MODE_ARGUMENT_ERROR",e[e.DBR_LICENSE_CONTENT_INVALID=-10052]="DBR_LICENSE_CONTENT_INVALID",e[e.DBR_LICENSE_KEY_INVALID=-10053]="DBR_LICENSE_KEY_INVALID",e[e.DBR_LICENSE_DEVICE_RUNS_OUT=-10054]="DBR_LICENSE_DEVICE_RUNS_OUT",e[e.DBR_GET_MODE_ARGUMENT_ERROR=-10055]="DBR_GET_MODE_ARGUMENT_ERROR",e[e.DBR_IRT_LICENSE_INVALID=-10056]="DBR_IRT_LICENSE_INVALID",e[e.DBR_MAXICODE_LICENSE_INVALID=-10057]="DBR_MAXICODE_LICENSE_INVALID",e[e.DBR_GS1_DATABAR_LICENSE_INVALID=-10058]="DBR_GS1_DATABAR_LICENSE_INVALID",e[e.DBR_GS1_COMPOSITE_LICENSE_INVALID=-10059]="DBR_GS1_COMPOSITE_LICENSE_INVALID",e[e.DBR_DOTCODE_LICENSE_INVALID=-10061]="DBR_DOTCODE_LICENSE_INVALID",e[e.DMERR_NO_LICENSE=-2e4]="DMERR_NO_LICENSE",e[e.DMERR_LICENSE_SYNC_FAILED=-20003]="DMERR_LICENSE_SYNC_FAILED",e[e.DMERR_TRIAL_LICENSE=-20010]="DMERR_TRIAL_LICENSE",e[e.DMERR_FAILED_TO_REACH_LTS=-20200]="DMERR_FAILED_TO_REACH_LTS"}(dr||(dr={})),function(e){e[e.IMRDT_IMAGE=1]="IMRDT_IMAGE",e[e.IMRDT_CONTOUR=2]="IMRDT_CONTOUR",e[e.IMRDT_LINESEGMENT=4]="IMRDT_LINESEGMENT",e[e.IMRDT_LOCALIZATIONRESULT=8]="IMRDT_LOCALIZATIONRESULT",e[e.IMRDT_REGIONOFINTEREST=16]="IMRDT_REGIONOFINTEREST",e[e.IMRDT_QUADRILATERAL=32]="IMRDT_QUADRILATERAL"}(ds||(ds={})),function(e){e[e.BF_ALL=4265607167]="BF_ALL",e[e.BF_ONED=3147775]="BF_ONED",e[e.BF_GS1_DATABAR=260096]="BF_GS1_DATABAR",e[e.BF_CODE_39=1]="BF_CODE_39",e[e.BF_CODE_128=2]="BF_CODE_128",e[e.BF_CODE_93=4]="BF_CODE_93",e[e.BF_CODABAR=8]="BF_CODABAR",e[e.BF_ITF=16]="BF_ITF",e[e.BF_EAN_13=32]="BF_EAN_13",e[e.BF_EAN_8=64]="BF_EAN_8",e[e.BF_UPC_A=128]="BF_UPC_A",e[e.BF_UPC_E=256]="BF_UPC_E",e[e.BF_INDUSTRIAL_25=512]="BF_INDUSTRIAL_25",e[e.BF_CODE_39_EXTENDED=1024]="BF_CODE_39_EXTENDED",e[e.BF_GS1_DATABAR_OMNIDIRECTIONAL=2048]="BF_GS1_DATABAR_OMNIDIRECTIONAL",e[e.BF_GS1_DATABAR_TRUNCATED=4096]="BF_GS1_DATABAR_TRUNCATED",e[e.BF_GS1_DATABAR_STACKED=8192]="BF_GS1_DATABAR_STACKED",e[e.BF_GS1_DATABAR_STACKED_OMNIDIRECTIONAL=16384]="BF_GS1_DATABAR_STACKED_OMNIDIRECTIONAL",e[e.BF_GS1_DATABAR_EXPANDED=32768]="BF_GS1_DATABAR_EXPANDED",e[e.BF_GS1_DATABAR_EXPANDED_STACKED=65536]="BF_GS1_DATABAR_EXPANDED_STACKED",e[e.BF_GS1_DATABAR_LIMITED=131072]="BF_GS1_DATABAR_LIMITED",e[e.BF_PATCHCODE=262144]="BF_PATCHCODE",e[e.BF_PDF417=33554432]="BF_PDF417",e[e.BF_QR_CODE=67108864]="BF_QR_CODE",e[e.BF_DATAMATRIX=134217728]="BF_DATAMATRIX",e[e.BF_AZTEC=268435456]="BF_AZTEC",e[e.BF_MAXICODE=536870912]="BF_MAXICODE",e[e.BF_MICRO_QR=1073741824]="BF_MICRO_QR",e[e.BF_MICRO_PDF417=524288]="BF_MICRO_PDF417",e[e.BF_GS1_COMPOSITE=2147483648]="BF_GS1_COMPOSITE",e[e.BF_MSI_CODE=1048576]="BF_MSI_CODE",e[e.BF_CODE_11=2097152]="BF_CODE_11",e[e.BF_NULL=0]="BF_NULL"}(wt||(wt={}));const Go=e=>e&&typeof e=="object"&&typeof e.then=="function",Wo=Ue.OS=="iPhone"||Ue.OS=="Android"||Ue.OS=="HarmonyOS"?2048:4096;class W{constructor(){this._instanceID=void 0,this._ifSaveOriginalImageInACanvas=!1,this.oriCanvas=null,this.oriCanvasData=null,this.canvas=null,this.bFilterRegionInJs=!1,this._region=null,this._timeStartDecode=null,this._timeEnterInnerDBR=null,this._timeGetMessage=null,this.decodeRecords={},this.bDestroyed=!1,this._lastErrorCode=0,this._lastErrorString="",this._lastInnerDecodeDuration=0,this.intervalTime=0,this._intervalGetVideoFrame=0,this.array_getFrameTimeCost=[],this.array_decodeFrameTimeCost=[],this._indexCurrentDecodingFrame=0,this._arrPolygons=[],this._bPauseScan=!1,this._intervalDetectVideoPause=1e3,this._soundSource="data:audio/mpeg;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjI5LjEwMAAAAAAAAAAAAAAA/+M4wAAAAAAAAAAAAEluZm8AAAAPAAAABQAAAkAAgICAgICAgICAgICAgICAgICAgKCgoKCgoKCgoKCgoKCgoKCgoKCgwMDAwMDAwMDAwMDAwMDAwMDAwMDg4ODg4ODg4ODg4ODg4ODg4ODg4P//////////////////////////AAAAAExhdmM1OC41NAAAAAAAAAAAAAAAACQEUQAAAAAAAAJAk0uXRQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+MYxAANQAbGeUEQAAHZYZ3fASqD4P5TKBgocg+Bw/8+CAYBA4XB9/4EBAEP4nB9+UOf/6gfUCAIKyjgQ/Kf//wfswAAAwQA/+MYxAYOqrbdkZGQAMA7DJLCsQxNOij///////////+tv///3RWiZGBEhsf/FO/+LoCSFs1dFVS/g8f/4Mhv0nhqAieHleLy/+MYxAYOOrbMAY2gABf/////////////////usPJ66R0wI4boY9/8jQYg//g2SPx1M0N3Z0kVJLIs///Uw4aMyvHJJYmPBYG/+MYxAgPMALBucAQAoGgaBoFQVBUFQWDv6gZBUFQVBUGgaBr5YSgqCoKhIGg7+IQVBUFQVBoGga//SsFSoKnf/iVTEFNRTMu/+MYxAYAAANIAAAAADEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV",this.beepSound=new cr({src:["data:audio/mpeg;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjI5LjEwMAAAAAAAAAAAAAAA/+M4wAAAAAAAAAAAAEluZm8AAAAPAAAABQAAAkAAgICAgICAgICAgICAgICAgICAgKCgoKCgoKCgoKCgoKCgoKCgoKCgwMDAwMDAwMDAwMDAwMDAwMDAwMDg4ODg4ODg4ODg4ODg4ODg4ODg4P//////////////////////////AAAAAExhdmM1OC41NAAAAAAAAAAAAAAAACQEUQAAAAAAAAJAk0uXRQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+MYxAANQAbGeUEQAAHZYZ3fASqD4P5TKBgocg+Bw/8+CAYBA4XB9/4EBAEP4nB9+UOf/6gfUCAIKyjgQ/Kf//wfswAAAwQA/+MYxAYOqrbdkZGQAMA7DJLCsQxNOij///////////+tv///3RWiZGBEhsf/FO/+LoCSFs1dFVS/g8f/4Mhv0nhqAieHleLy/+MYxAYOOrbMAY2gABf/////////////////usPJ66R0wI4boY9/8jQYg//g2SPx1M0N3Z0kVJLIs///Uw4aMyvHJJYmPBYG/+MYxAgPMALBucAQAoGgaBoFQVBUFQWDv6gZBUFQVBUGgaBr5YSgqCoKhIGg7+IQVBUFQVBoGga//SsFSoKnf/iVTEFNRTMu/+MYxAYAAANIAAAAADEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV"],onplayerror:(t,i)=>{console.warn(`Sound '${t}' playback failure: ${i}`)}}),this.bPlaySoundOnSuccessfulRead=!1,this.bVibrateOnSuccessfulRead=!1,this.vibrateDuration=300,this.captureAndDecodeInParallel=!0,this._dce=null,this._imgSource=null,this._maxCvsSideLength=Wo,this._tempSolutionStatus="closed"}static get version(){return this._version}static get license(){return this._license}static set license(t){((i,r)=>{const c=i;if(!c._pLoad.isEmpty)throw new Error("`license`"+Ji);c._license=r})(W,t)}static get productKeys(){return this._license}static set productKeys(t){W.license=t}static get handshakeCode(){return this._license}static set handshakeCode(t){W.license=t}static get organizationID(){return this._license}static set organizationID(t){W.license=t}static set sessionPassword(t){((i,r)=>{const c=i;if(!c._pLoad.isEmpty)throw new Error("`sessionPassword`"+Ji);c._sessionPassword=r})(W,t)}static get sessionPassword(){return this._sessionPassword}static async detectEnvironment(){return await(async()=>({wasm:kf,worker:Ff,getUserMedia:gc,camera:await Bf(),browser:Ue.browser,version:Ue.version,OS:Ue.OS}))()}static get engineResourcePath(){return this._engineResourcePath}static set engineResourcePath(t){if(!this._pLoad.isEmpty)throw new Error("`engineResourcePath` is not allowed to change after `createInstance` or `loadWasm` is called.");W._engineResourcePath=(i=>{if(i==null&&(i="./"),!Ti){let r=document.createElement("a");r.href=i,i=r.href}return i.endsWith("/")||(i+="/"),i})(t)}static get licenseServer(){return this._licenseServer}static set licenseServer(t){((i,r)=>{const c=i;if(!c._pLoad.isEmpty)throw new Error("`licenseServer`"+Ji);c._licenseServer=Uo(r)})(W,t)}static get deviceFriendlyName(){return this._deviceFriendlyName}static set deviceFriendlyName(t){((i,r)=>{const c=i;if(!c._pLoad.isEmpty)throw new Error("`deviceFriendlyName`"+Ji);c._deviceFriendlyName=r||""})(W,t)}static get _bUseFullFeature(){return this.__bUseFullFeature}static set _bUseFullFeature(t){if(!this._pLoad.isEmpty)throw new Error("`_bUseFullFeature` is not allowed to change after `createInstance` or `loadWasm` is called.");W.__bUseFullFeature=t}static isImageSource(t){return!(!t||typeof t!="object"||Array.isArray(t))&&"getImage"in t}static isDSImage(t){return!(!t||typeof t!="object"||Array.isArray(t))&&"data"in t&&"width"in t&&"height"in t&&"pixelFormat"in t}static isDCEFrame(t){return!(!t||typeof t!="object"||Array.isArray(t))&&"data"in t&&"region"in t&&"sx"in t&&"sy"in t&&"width"in t&&"height"in t&&"colorMode"in t&&"timeSpent"in t&&"timeStamp"in t&&"isCropped"in t&&"toCanvas"in t&&"_sWidth"in t&&"_sHeight"in t&&"_bUseWebGL"in t}get ifSaveOriginalImageInACanvas(){return this._ifSaveOriginalImageInACanvas}set ifSaveOriginalImageInACanvas(t){this._ifSaveOriginalImageInACanvas=t}getOriginalImageInACanvas(){return!this.oriCanvas&&this.oriCanvasData?this.oriCanvasData.toCanvas():this.oriCanvas}set region(t){this._region=t,this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0}get region(){return this._region}static isWasmLoaded(){return this._pLoad.isFulfilled}isContextDestroyed(){return this.bDestroyed}static get lastErrorCode(){return this._lastErrorCode}static get lastErrorString(){return this._lastErrorString}get lastErrorCode(){return this._lastErrorCode}get lastErrorString(){return this._lastErrorString}static get defaultUIElementURL(){var t;return(t=W._defaultUIElementURL)===null||t===void 0?void 0:t.replace("@engineResourcePath/",W.engineResourcePath)}static set defaultUIElementURL(t){W._defaultUIElementURL=t}static _fireHTTPSWarnning(){W.onWarning&&location&&location.protocol!=="https:"&&setTimeout(()=>{W.onWarning&&W.onWarning({id:2,message:"Not connected via SSL (HTTPS), the SDK may not work correctly."})},0)}get soundSource(){return this._soundSource}set soundSource(t){this._soundSource=t,this.beepSound=new cr({src:[this._soundSource],onplayerror:(i,r)=>{console.warn(`Sound '${i}' playback failure: ${r}`)}})}get whenToPlaySoundforSuccessfulRead(){return this.bPlaySoundOnSuccessfulRead===!0?"frame":this.bPlaySoundOnSuccessfulRead?this.bPlaySoundOnSuccessfulRead:"never"}set whenToPlaySoundforSuccessfulRead(t){this.bPlaySoundOnSuccessfulRead=t!=="never"&&t}get whenToVibrateforSuccessfulRead(){return this.bVibrateOnSuccessfulRead===!0?"frame":this.bVibrateOnSuccessfulRead?this.bVibrateOnSuccessfulRead:"never"}set whenToVibrateforSuccessfulRead(t){this.bVibrateOnSuccessfulRead=t!=="never"&&t}set dce(t){this._dce=t}get dce(){return!this._dce||this._dce.isDisposed?null:this._dce}set maxCvsSideLength(t){this._maxCvsSideLength=t,this._dceControler&&this._dceControler.setDisiredValue(this,"maxCvsSideLength",t)}get maxCvsSideLength(){return this._maxCvsSideLength}async _registerDCEControler(){if(!this.dce)return;W._onLog&&W._onLog("_registerDCEControler()");const t=this.dce;this._dceControler=t._createControler();const i=this._dceControler;i.register(this),i.setDisiredValue(this,"refreshInterval",200),i.setDisiredValue(this,"maxCvsSideLength",this._maxCvsSideLength),this._styleIdBeforeVerification=this.dce.createDrawingStyle({fillStyle:"rgba(248,252,0,0.2)",strokeStyle:"transparent",paintMode:"strokeAndFill"});try{}catch(u){u.name==="ReferenceError"&&window&&(window.ResizeObserver=void 0)}const r=t.getUIElement(),c=this.dce.constructor;if(c._defaultUIElementURL==="@engineResourcePath/dce.ui.html")try{r?r===i._innerSetUI&&(await t.setUIElement(`${c.engineResourcePath}dce.ui.html`),i._innerSetUI=t.getUIElement()):(await t.setUIElement(`${c.engineResourcePath}dbr.ui.html`),i._innerSetUI=t.getUIElement())}catch{await t.setUIElement(c.defaultUIElementURL)}else r||await t.setUIElement(c.defaultUIElementURL);this.callbackCameraChange=()=>{this._drawResults(null),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0},this.callbackResolutionChange=()=>{this._drawResults(null),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0},this.callbackCameraClose=()=>{this.stopScanning(!0),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0,this._bPauseScan=!1},this.callbackSingleFrameAcquired=async u=>{let g=await this._decode_DCEFrame(u,{bCopyData:!1}),v=null;if(g&&g.length){const{sx:b,sy:S,width:w,height:E,_sWidth:A,_sHeight:B}=u;v=g.map(z=>({localizationResult:JSON.parse(JSON.stringify(z.localizationResult))})),W.recalculateResultLocation(v,b,S,A,B,w,E)}if(this._drawResults(v),await this.clearMapDecodeRecord(),this.onImageRead&&this.dce.isOpen()&&!this._bPauseScan){let b=this._cloneDecodeResults(g);this.onImageRead(b)}if(this.onUniqueRead&&this.dce.isOpen()&&!this._bPauseScan)for(let b of g)this.onUniqueRead(b.barcodeText,this._cloneDecodeResults(b))},t.on("cameraChange",this.callbackCameraChange),t.on("resolutionChange",this.callbackResolutionChange),t.on("cameraClose",this.callbackCameraClose),t.on("singleFrameAcquired",this.callbackSingleFrameAcquired)}_logoutDCEControler(){this.dce&&this._dceControler&&(W._onLog&&W._onLog("_logoutDCEControler()"),this._dceControler.logout(this),this.dce.off("cameraChange",this.callbackCameraChange),this.dce.off("resolutionChange",this.callbackResolutionChange),this.dce.off("cameraClose",this.callbackCameraClose),this.dce.off("singleFrameAcquired",this.callbackSingleFrameAcquired),this._dceControler=null,this.dce=null)}async setImageSource(t,i){if(t==null)return this._imgSource=null,this._logoutDCEControler(),void(this._drawingItemNamespace=null);if(t&&t.isCameraEnhancer)this.dce=t,await this._registerDCEControler(),this._imgSource=null;else{if(!W.isImageSource(t))throw new Error("Invalid value.");this._logoutDCEControler(),this._imgSource=t}i&&i.resultsHighlightBaseShapes&&(this._drawingItemNamespace=i.resultsHighlightBaseShapes)}static async loadWasm(){if(this._pLoad.isEmpty){let{lt:t,l:i,ls:r,sp:c,rmk:u}=(g=>{const v=g;if(v._pLoad.isEmpty){let b,S,w=v._license||"",E=JSON.parse(JSON.stringify(v._licenseServer)),A=v._sessionPassword,B=0;if(w.startsWith("t")||w.startsWith("f"))B=0;else if(w.length===0||w.startsWith("P")||w.startsWith("L")||w.startsWith("Y")||w.startsWith("A"))B=1;else{B=2;const z=w.indexOf(":");if(z!=-1&&(w=w.substring(z+1)),w.startsWith("DLS2")){let q=w.substring(4);try{q=atob(q)}catch{throw new Error("Format Error: The license string you specified is invalid, please check to make sure it is correct.")}const J=JSON.parse(q);if(w=J.handshakeCode?J.handshakeCode:J.organizationID?J.organizationID:"",typeof w=="number"&&(w=JSON.stringify(w)),E.length===0){let Z=[];J.mainServerURL&&(Z[0]=J.mainServerURL),J.standbyServerURL&&(Z[1]=J.standbyServerURL),E=Uo(Z)}!A&&J.sessionPassword&&(A=J.sessionPassword),b=J.remark}(w==="200001"||w.startsWith("200001-"))&&(E&&E.length||(w="")),w||(B=1)}if(B&&(globalThis.crypto||(S="Please upgrade your browser to support online key."),globalThis.crypto.subtle||(S="Require https to use online key in this browser.")),S){if(B!==1)throw new Error(S);B=0,console.warn(S),v._lastErrorCode=-1,v._lastErrorString=S}return B===1&&(w="",console.warn("Applying for a public trial license ...")),{lt:B,l:w,ls:E,sp:A,rmk:b}}throw new Error("Can't preprocess license again"+Ji)})(W);this._pLoad.task=async(g,v)=>{let b=W.engineResourcePath+W._workerName;W.engineResourcePath.startsWith(location.origin)||(b=await fetch(b).then(S=>S.blob()).then(S=>URL.createObjectURL(S))),W._dbrWorker=new Worker(b),W._dbrWorker.onerror=S=>{let w=new Error(S.message);v(w)},W._dbrWorker.onmessage=async S=>{let w=S.data?S.data:S;switch(w.type){case"log":W._onLog&&W._onLog(w.message);break;case"load":{w.message&&(w.message=w.message.replace("(https://www.dynamsoft.com/purchase-center/)","(https://www.dynamsoft.com/store/dynamsoft-barcode-reader/#javascript)"));let E,A=!1;t===1&&(A=!0),w.success?(W._dbrWorker.onerror=null,W._version=w.version+"(JS "+W._jsVersion+"."+W._jsEditVersion+")",W._onLog&&W._onLog("load dbr worker success"),w.message&&console.warn(w.message)):(E=new Error(w.message),E.stack=w.stack+`
`+E.stack,A||w.ltsErrorCode==111&&w.message.toLowerCase().indexOf("trial license")!=-1&&(A=!0)),A&&W.showDialog(w.success?"warn":"error",w.message),w.success?g():v(E);break}case"task":{let E=w.id,A=w.body;try{W._taskCallbackMap.get(E)(A),W._taskCallbackMap.delete(E)}catch(B){throw W._taskCallbackMap.delete(E),B}break}default:W._onLog&&W._onLog(S)}},W._dbrWorker.postMessage({type:"loadWasm",engineResourcePath:W.engineResourcePath,bUseFullFeature:W._bUseFullFeature,bd:W._bWasmDebug,v:W._jsVersion,brtk:!!t,bptk:t===1,l:i,dm:location.origin.startsWith("http")?location.origin:"https://localhost",os:Ue,fn:W.deviceFriendlyName,ls:r,sp:c,rmk:u})}}await this._pLoad}static async showDialog(t,i){await(async(r,c,u)=>{if(!r._bNeverShowDialog)try{let g=await fetch(r.engineResourcePath+"dls.license.dialog.html");if(!g.ok)throw Error("Get license dialog fail. Network Error: "+g.statusText);let v=await g.text();if(!v.trim().startsWith("<"))throw Error("Get license dialog fail. Can't get valid HTMLElement.");let b=document.createElement("div");b.innerHTML=v;let S=[];for(let ee=0;ee<b.childElementCount;++ee){let K=b.children[ee];K instanceof HTMLStyleElement&&(S.push(K),document.head.append(K))}let w=b.childElementCount==1?b.children[0]:b;w.remove();let E,A,B,z,q,J=[w],Z=w.children;for(let ee of Z)J.push(ee);for(let ee=0;ee<J.length;++ee)for(let K of J[ee].children)J.push(K);for(let ee of J)if(!E&&ee.classList.contains("dls-license-mask"))E=ee,ee.addEventListener("click",K=>{if(ee==K.target){w.remove();for(let oe of S)oe.remove()}});else if(!A&&ee.classList.contains("dls-license-icon-close"))A=ee,ee.addEventListener("click",()=>{w.remove();for(let K of S)K.remove()});else if(!B&&ee.classList.contains("dls-license-icon-error"))B=ee,c!="error"&&ee.remove();else if(!z&&ee.classList.contains("dls-license-icon-warn"))z=ee,c!="warn"&&ee.remove();else if(!q&&ee.classList.contains("dls-license-msg-content")){q=ee;let K=u;for(;K;){let oe=K.indexOf("["),pe=K.indexOf("]",oe),ye=K.indexOf("(",pe),_e=K.indexOf(")",ye);if(oe==-1||pe==-1||ye==-1||_e==-1){ee.appendChild(new Text(K));break}oe>0&&ee.appendChild(new Text(K.substring(0,oe)));let y=document.createElement("a"),le=K.substring(oe+1,pe);y.innerText=le;let te=K.substring(ye+1,_e);y.setAttribute("href",te),y.setAttribute("target","_blank"),ee.appendChild(y),K=K.substring(_e+1)}}document.body.appendChild(w)}catch(g){r._onLog&&r._onLog(g.message||g)}})(this,t,i)}static async createInstanceInWorker(t=!1){return await W.loadWasm(),await new Promise((i,r)=>{let c=W._nextTaskID++;W._taskCallbackMap.set(c,u=>{if(u.success)return i(u.instanceID);{let g=new Error(u.message);return g.stack=u.stack+`
`+g.stack,r(g)}}),W._dbrWorker.postMessage({type:"createInstance",id:c,bScanner:t})})}static async createInstance(){let t=new W;return t._instanceID=await W.createInstanceInWorker(),W._fireHTTPSWarnning(),t}async clearMapDecodeRecord(){return await new Promise((t,i)=>{let r=W._nextTaskID++;W._taskCallbackMap.set(r,c=>{if(c.success)return t();{let u=new Error(c.message);return u.stack=c.stack+`
`+u.stack,i(u)}}),W._dbrWorker.postMessage({type:"clearMapDecodeRecord",id:r,instanceID:this._instanceID})})}async decode(t){W._onLog&&W._onLog("decode(source: any)"),W._onLog&&(this._timeStartDecode=Date.now());{let i={};return!this.region||this.region instanceof Array||(i.region=JSON.parse(JSON.stringify(this.region))),t instanceof Blob?await this._decode_Blob(t,i):t instanceof ArrayBuffer?await this._decode_ArrayBuffer(t,i):t instanceof Uint8Array||t instanceof Uint8ClampedArray?await this._decode_Uint8Array(t,i):t instanceof HTMLImageElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap?await this._decode_Image(t,i):t instanceof HTMLCanvasElement?await this._decode_Canvas(t,i):t instanceof HTMLVideoElement?await this._decode_Video(t,i):typeof t=="string"?t.substring(0,11)=="data:image/"?await this._decode_Base64(t,i):await this._decode_Url(t,i):W.isDCEFrame(t)?(i.bCopyData=!0,await this._decode_DCEFrame(t,i)):W.isDSImage(t)?(i.bCopyData=!0,await this._decode_DSImage(t,i)):await Promise.reject(TypeError("'_decode(source, config)': Type of 'source' should be 'Blob', 'ArrayBuffer', 'Uint8Array', 'HTMLImageElement', 'HTMLCanvasElement', 'HTMLVideoElement', 'String(base64 with image mime)' or 'String(url)'."))}}async decodeBase64String(t){let i={};return!this.region||this.region instanceof Array||(i.region=JSON.parse(JSON.stringify(this.region))),this._decode_Base64(t,i)}async decodeUrl(t){let i={};return!this.region||this.region instanceof Array||(i.region=JSON.parse(JSON.stringify(this.region))),this._decode_Url(t,i)}async _decodeBuffer_Uint8Array(t,i,r,c,u,g){return await new Promise((v,b)=>{let S=W._nextTaskID++;W._taskCallbackMap.set(S,w=>{if(w.success){let E,A=W._onLog?Date.now():0;W._onLog&&W._onLog("worker return result: "+A),this._lastInnerDecodeDuration=w.duration;try{E=this._handleRetJsonString(w.decodeReturn)}catch(B){return b(B)}if(W._onLog){let B=Date.now();W._onLog("DBR getting message from worker timestamp: "+A),W._onLog("From DBR staring decoding to entering worker costs: "+(this._timeEnterInnerDBR-this._timeStartDecode)),W._onLog("From DBR entering worker to returning message from worker costs: "+(A-this._timeEnterInnerDBR)),W._onLog("Handling results from DBR worker costs: "+(B-A)),W._onLog("Total decoding image costs: "+(B-this._timeStartDecode))}return v(E)}{let E=new Error(w.message);return E.stack=w.stack+`
`+E.stack,b(E)}}),this._timeEnterInnerDBR=Date.now(),W._onLog&&W._onLog("Sending buffer to worker timestamp:"+this._timeEnterInnerDBR),W._dbrWorker.postMessage({type:"decodeBuffer",id:S,instanceID:this._instanceID,body:{buffer:t,width:i,height:r,stride:c,format:u,config:g}},[t.buffer]),W._onLog&&g&&g.timeStamp&&W._onLog("Delay of decoding image: "+(this._timeEnterInnerDBR-g.timeStamp))})}async _decodeBuffer_Blob(t,i,r,c,u,g){W._onLog&&W._onLog("_decodeBuffer_Blob(buffer,width,height,stride,format)");const v=t.arrayBuffer?await t.arrayBuffer():await new Promise((b,S)=>{let w=new FileReader;w.readAsArrayBuffer(t),w.onload=()=>{b(w.result)},w.onerror=()=>{S(w.error)}});return await this._decodeBuffer_Uint8Array(new Uint8Array(v),i,r,c,u,g)}async decodeBuffer(t,i,r,c,u,g){let v;return W._onLog&&W._onLog("decodeBuffer(buffer,width,height,stride,format)"),W._onLog&&(this._timeStartDecode=Date.now()),t instanceof Uint8Array||t instanceof Uint8ClampedArray?v=await this._decodeBuffer_Uint8Array(t,i,r,c,u,g):t instanceof ArrayBuffer?v=await this._decodeBuffer_Uint8Array(new Uint8Array(t),i,r,c,u,g):t instanceof Blob&&(v=await this._decodeBuffer_Blob(t,i,r,c,u,g)),v}async _decodeFileInMemory_Uint8Array(t){return await new Promise((i,r)=>{let c=W._nextTaskID++;W._taskCallbackMap.set(c,u=>{if(u.success){let g;this._lastInnerDecodeDuration=u.duration;try{g=this._handleRetJsonString(u.decodeReturn)}catch(v){return r(v)}return i(g)}{let g=new Error(u.message);return g.stack=u.stack+`
`+g.stack,r(g)}}),W._dbrWorker.postMessage({type:"decodeFileInMemory",id:c,instanceID:this._instanceID,body:{bytes:t}})})}async getRuntimeSettings(){return await new Promise((t,i)=>{let r=W._nextTaskID++;W._taskCallbackMap.set(r,c=>{if(c.success){let u=JSON.parse(c.results);return this.userDefinedRegion!=null&&(u.region=JSON.parse(JSON.stringify(this.userDefinedRegion))),t(u)}{let u=new Error(c.message);return u.stack=c.stack+`
`+u.stack,i(u)}}),W._dbrWorker.postMessage({type:"getRuntimeSettings",id:r,instanceID:this._instanceID})})}async updateRuntimeSettings(t){let i;if(typeof t=="string")if(t=="speed"){let r=await this.getRuntimeSettings();await this.resetRuntimeSettings(),i=await this.getRuntimeSettings(),i.barcodeFormatIds=r.barcodeFormatIds,i.barcodeFormatIds_2=r.barcodeFormatIds_2,i.region=r.region,i.deblurLevel=3,i.expectedBarcodesCount=0,i.localizationModes=[2,0,0,0,0,0,0,0]}else if(t=="balance"){let r=await this.getRuntimeSettings();await this.resetRuntimeSettings(),i=await this.getRuntimeSettings(),i.barcodeFormatIds=r.barcodeFormatIds,i.barcodeFormatIds_2=r.barcodeFormatIds_2,i.region=r.region,i.deblurLevel=5,i.expectedBarcodesCount=512,i.localizationModes=[2,16,0,0,0,0,0,0]}else if(t=="coverage"){let r=await this.getRuntimeSettings();await this.resetRuntimeSettings(),i=await this.getRuntimeSettings(),i.barcodeFormatIds=r.barcodeFormatIds,i.barcodeFormatIds_2=r.barcodeFormatIds_2,i.region=r.region}else if(t=="dense"){let r=await this.getRuntimeSettings();await this.resetRuntimeSettings(),this.maxCvsSideLength=4096,i=await this.getRuntimeSettings(),i.barcodeFormatIds=r.barcodeFormatIds,i.barcodeFormatIds_2=r.barcodeFormatIds_2,i.region=r.region,i.deblurLevel=9,i.expectedBarcodesCount=0,i.localizationModes=[2,8,0,0,0,0,0,0]}else if(t=="distance"){let r=await this.getRuntimeSettings();await this.resetRuntimeSettings(),this.maxCvsSideLength=4096,i=await this.getRuntimeSettings(),i.barcodeFormatIds=r.barcodeFormatIds,i.barcodeFormatIds_2=r.barcodeFormatIds_2,i.region=r.region,i.deblurLevel=3,i.expectedBarcodesCount=0,i.localizationModes=[2,8,0,0,0,0,0,0]}else i=JSON.parse(t);else{if(typeof t!="object")throw TypeError("'UpdateRuntimeSettings(settings)': Type of 'settings' should be 'string' or 'PlainObject'.");if(i=JSON.parse(JSON.stringify(t)),i.region instanceof Array){let r=i.region;[r.regionLeft,r.regionTop,r.regionLeft,r.regionBottom,r.regionMeasuredByPercentage].some(c=>c!==void 0)&&(i.region={regionLeft:r.regionLeft||0,regionTop:r.regionTop||0,regionRight:r.regionRight||0,regionBottom:r.regionBottom||0,regionMeasuredByPercentage:r.regionMeasuredByPercentage||0})}}if(!W._bUseFullFeature){if((i.barcodeFormatIds&~(wt.BF_ONED|wt.BF_QR_CODE|wt.BF_PDF417|wt.BF_DATAMATRIX))!=0||i.barcodeFormatIds_2!=0)throw Error("Some of the specified barcode formats are not supported in the compact version. Please try the full-featured version.");if(i.intermediateResultTypes!=0)throw Error("Intermediate results is not supported in the compact version. Please try the full-featured version.")}if(this.bFilterRegionInJs){let r=i.region;if(r instanceof Array)throw Error("The `region` of type `Array` is only allowed in `BarcodeScanner`.");this.userDefinedRegion=JSON.parse(JSON.stringify(r)),(r.regionLeft||r.regionTop||r.regionRight||r.regionBottom||r.regionMeasuredByPercentage)&&(r.regionLeft||r.regionTop||r.regionRight!=100||r.regionBottom!=100||!r.regionMeasuredByPercentage)?this.region=r:this.region=null,i.region={regionLeft:0,regionTop:0,regionRight:0,regionBottom:0,regionMeasuredByPercentage:0}}else this.userDefinedRegion=null,this.region=null;return await new Promise((r,c)=>{let u=W._nextTaskID++;W._taskCallbackMap.set(u,g=>{if(g.success){try{this._handleRetJsonString(g.updateReturn)}catch(v){c(v)}return r()}{let v=new Error(g.message);return v.stack=g.stack+`
`+v.stack,c(v)}}),W._dbrWorker.postMessage({type:"updateRuntimeSettings",id:u,instanceID:this._instanceID,body:{settings:JSON.stringify(i)}})})}async resetRuntimeSettings(){return this.userDefinedRegion=null,this.region=null,this.maxCvsSideLength=Wo,await new Promise((t,i)=>{let r=W._nextTaskID++;W._taskCallbackMap.set(r,c=>{if(c.success)return t();{let u=new Error(c.message);return u.stack=c.stack+`
`+u.stack,i(u)}}),W._dbrWorker.postMessage({type:"resetRuntimeSettings",id:r,instanceID:this._instanceID})})}async outputRuntimeSettingsToString(){if(!W._bUseFullFeature)throw Error("outputRuntimeSettingsToString() is not supported in the compact version. Please try the full-featured version.");return await new Promise((t,i)=>{let r=W._nextTaskID++;W._taskCallbackMap.set(r,c=>{if(c.success)return t(c.results);{let u=new Error(c.message);return u.stack=c.stack+`
`+u.stack,i(u)}}),W._dbrWorker.postMessage({type:"outputRuntimeSettingsToString",id:r,instanceID:this._instanceID})})}async initRuntimeSettingsWithString(t){if(!W._bUseFullFeature)throw Error("initRuntimeSettingsWithString() is not supported in the compact version. Please try the full-featured version.");if(typeof t=="string")t=t;else{if(typeof t!="object")throw TypeError("'initRuntimeSettingstWithString(settings)': Type of 'settings' should be 'string' or 'PlainObject'.");t=JSON.stringify(t)}return await new Promise((i,r)=>{let c=W._nextTaskID++;W._taskCallbackMap.set(c,u=>{if(u.success){try{this._handleRetJsonString(u.initReturn)}catch(g){r(g)}return i()}{let g=new Error(u.message);return g.stack=u.stack+`
`+g.stack,r(g)}}),W._dbrWorker.postMessage({type:"initRuntimeSettingsWithString",id:c,instanceID:this._instanceID,body:{settings:t}})})}async _decode_Blob(t,i){W._onLog&&W._onLog("_decode_Blob(blob: Blob)");let r=null,c=null;if(typeof createImageBitmap<"u")try{r=await createImageBitmap(t)}catch{}r||(c=await function(g){return new Promise((v,b)=>{let S=URL.createObjectURL(g),w=new Image;w.dbrObjUrl=S,w.src=S,w.onload=()=>{v(w)},w.onerror=E=>{b(new Error("Can't convert blob to image : "+(E instanceof Event?E.type:E)))}})}(t));let u=await this._decode_Image(r||c,i);return r&&r.close(),u}async _decode_ArrayBuffer(t,i){return await this._decode_Blob(new Blob([t]),i)}async _decode_Uint8Array(t,i){return await this._decode_Blob(new Blob([t]),i)}async _decode_Image(t,i){W._onLog&&W._onLog("_decode_Image(image: HTMLImageElement|ImageBitmap)"),i=i||{};let r,c,u=t instanceof HTMLImageElement?t.naturalWidth:t.width,g=t instanceof HTMLImageElement?t.naturalHeight:t.height,v=Math.max(u,g);if(v>this._maxCvsSideLength){let S=this._maxCvsSideLength/v;r=Math.round(u*S),c=Math.round(g*S)}else r=u,c=g;this.canvas||(this.canvas=document.createElement("canvas"));const b=this.canvas;return b.width===r&&b.height===c||(b.width=r,b.height=c),b.ctx2d||(b.ctx2d=b.getContext("2d")),b.ctx2d.drawImage(t,0,0,u,g,0,0,r,c),t.dbrObjUrl&&URL.revokeObjectURL(t.dbrObjUrl),await this._decode_Canvas(b,i)}async _decode_Canvas(t,i){if(W._onLog&&W._onLog("_decode_Canvas(canvas:HTMLCanvasElement)"),t.crossOrigin&&t.crossOrigin!="anonymous")throw"cors";if(t.width===0||t.height===0)throw Error("The width or height of the 'canvas' is 0.");this.ifSaveOriginalImageInACanvas&&(this.oriCanvas=t,this.oriCanvasData=null);let r=(t.ctx2d||t.getContext("2d")).getImageData(0,0,t.width,t.height).data;return await this._decodeBuffer_Uint8Array(r,t.width,t.height,4*t.width,Be.IPF_ABGR_8888,i)}async _decode_Video(t,i){if(W._onLog&&W._onLog("_decode_Video(video)"),!(t instanceof HTMLVideoElement))throw TypeError("'_decode_Video(video [, config] )': Type of 'video' should be 'HTMLVideoElement'.");if(t.crossOrigin&&t.crossOrigin!="anonymous")throw"cors";i=i||{};let r,c,u=t.videoWidth,g=t.videoHeight,v=Math.max(u,g);if(v>this._maxCvsSideLength){let S=this._maxCvsSideLength/v;r=Math.round(u*S),c=Math.round(g*S)}else r=u,c=g;this.canvas||(this.canvas=document.createElement("canvas"));const b=this.canvas;return b.width===r&&b.height===c||(b.width=r,b.height=c),b.ctx2d||(b.ctx2d=b.getContext("2d")),b.ctx2d.drawImage(t,0,0,u,g,0,0,r,c),await this._decode_Canvas(b,i)}async _decode_DCEFrame(t,i){if(W._onLog&&W._onLog("_decode_DCEFrame(dceFrame)"),!W.isDCEFrame(t))return[];let r=[];this.ifSaveOriginalImageInACanvas&&(this.oriCanvas=null,this.oriCanvasData={width:t.width,height:t.height,colorMode:t.colorMode,data:new Uint8Array(t.data),toCanvas:t.toCanvas});const{width:c,height:u,colorMode:g,timeStamp:v}=t;let b;b=i&&i.bCopyData?new Uint8Array(t.data):t.data;let S=null;if(i?(S=JSON.parse(JSON.stringify(i)),S.timeStamp=v):S={timeStamp:v},g==="grey")r=await this._decodeBuffer_Uint8Array(b,c,u,c,Be.IPF_GrayScaled,S);else if(g==="rgba")r=await this._decodeBuffer_Uint8Array(b,c,u,4*c,Be.IPF_ABGR_8888,S);else{if(g!=="bgra")throw new Error(`Color mode '${g}' is not supported to decode.`);r=await this._decodeBuffer_Uint8Array(b,c,u,4*c,Be.IPF_ARGB_8888,S)}return r}async _decode_DSImage(t,i){if(W._onLog&&W._onLog("_decode_DSImage(dsImage)"),!W.isDSImage(t))return null;this.ifSaveOriginalImageInACanvas&&(this.oriCanvas=null,this.oriCanvasData={width:t.width,height:t.height,pixelFormat:t.pixelFormat.toLowerCase(),data:new Uint8Array(t.data),toCanvas:function(){const S=document.createElement("canvas");let w;switch(S.width=this.width,S.height=this.height,this.pixelFormat){case"grey":w=new Uint8ClampedArray(this.width*this.height*4);for(let A=0;A<w.length;A+=4)w[A]=this.data[A/4],w[A+1]=this.data[A/4],w[A+2]=this.data[A/4],w[A+3]=255;break;case"rgb":w=new Uint8ClampedArray(this.width*this.height*4);for(let A=0;A<w.length;A+=4)w[A]=this.data[A],w[A+1]=this.data[A+1],w[A+2]=this.data[A+2],w[A+3]=255;break;case"bgr":w=new Uint8ClampedArray(this.width*this.height*4);for(let A=0;A<w.length;A+=4)w[A]=this.data[A],w[A+1]=this.data[A+1],w[A+2]=this.data[A+2],w[A+3]=255;break;case"rgba":case"bgra":w=new Uint8ClampedArray(this.data);break;default:throw new Error("The content of 2D Canvas is currently limited to the sRGB color space.")}const E=new ImageData(w,this.width,this.height);return S.getContext("2d").putImageData(E,0,0),S}});const{width:r,height:c}=t;let u,g,v,b=t.pixelFormat.toLowerCase();switch(u=i&&i.bCopyData?new Uint8Array(t.data):t.data,b){case"grey":v=Be.IPF_GrayScaled,g=r;break;case"rgb":v=Be.IPF_BGR_888,g=3*r;break;case"bgr":v=Be.IPF_RGB_888,g=3*r;break;case"rgba":v=Be.IPF_ABGR_8888,g=4*r;break;case"bgra":v=Be.IPF_ARGB_8888,g=4*r;break;default:throw new Error("The pixel format is not supported to decode.")}return await this._decodeBuffer_Uint8Array(u,r,c,g,v,i)}async _decode_Base64(t,i){if(W._onLog&&W._onLog("_decode_Base64(base64Str)"),typeof t!="string")return Promise.reject("'_decode_Base64(base64Str, config)': Type of 'base64Str' should be 'string'.");t.substring(0,11)=="data:image/"&&(t=t.substring(t.indexOf(",")+1));{let r=atob(t),c=r.length,u=new Uint8Array(c);for(;c--;)u[c]=r.charCodeAt(c);return await this._decode_Blob(new Blob([u]),i)}}async _decode_Url(t,i){if(W._onLog&&W._onLog("_decode_Url(url)"),typeof t!="string")throw TypeError("'_decode_Url(url, config)': Type of 'url' should be 'string'.");t=t;{let r=await new Promise((c,u)=>{let g=new XMLHttpRequest;g.open("GET",t,!0),g.responseType="blob",g.send(),g.onloadend=async()=>{c(g.response)},g.onerror=()=>{u(new Error("Network Error: "+g.statusText))}});return await this._decode_Blob(r,i)}}async _decode_FilePath(t,i){throw W._onLog&&W._onLog("_decode_FilePath(path)"),Error("'_decode_FilePath(path, config)': The method is only supported in node environment.")}static recalculateResultLocation(t,i,r,c,u,g,v){if(t.length>0)for(let b of t){let S=b.localizationResult;S.resultCoordinateType==2&&(S.x1*=.01*g,S.x2*=.01*g,S.x3*=.01*g,S.x4*=.01*g,S.y1*=.01*v,S.y2*=.01*v,S.y3*=.01*v,S.y4*=.01*v);let w=g/c,E=v/u;S.x1=S.x1/w+i,S.x2=S.x2/w+i,S.x3=S.x3/w+i,S.x4=S.x4/w+i,S.y1=S.y1/E+r,S.y2=S.y2/E+r,S.y3=S.y3/E+r,S.y4=S.y4/E+r,S.resultCoordinateType==2&&(S.x1*=100/c,S.x2*=100/c,S.x3*=100/c,S.x4*=100/c,S.y1*=100/u,S.y2*=100/u,S.y3*=100/u,S.y4*=100/u)}}static BarcodeReaderException(t,i){let r,c=dr.DBR_UNKNOWN;return typeof t=="number"?(c=t,r=new Error(i)):r=new Error(t),r.code=c,r}_handleRetJsonString(t){let i=dr;if(t.textResults){for(let r=0;r<t.textResults.length;r++){let c=t.textResults[r];try{let u=c.barcodeText,g="";for(let v=0;v<u.length;v++)g+=String.fromCharCode(u[v]);try{c.barcodeText=decodeURIComponent(escape(g))}catch{c.barcodeText=g}}catch{c.barcodeText=""}if(c.exception!=null){W._setWarnnedEx.has(c.exception)||(W._setWarnnedEx.add(c.exception),console.warn(c.exception));let u={};c.exception.split(";").forEach(g=>{let v=g.indexOf(":");u[g.substring(0,v)]=g.substring(v+1)}),c.exception=u}}return t.decodeRecords?this.decodeRecords=t.decodeRecords:this.decodeRecords={},this._lastErrorCode=t.exception,this._lastErrorString=t.description,t.exception&&!W._setWarnnedEx.has(t.description)&&(W._setWarnnedEx.add(t.description),console.warn(t.description)),t.textResults}if(t.exception==i.DBR_SUCCESS)return t.data;throw W.BarcodeReaderException(t.exception,t.description)}async setModeArgument(t,i,r,c){return await new Promise((u,g)=>{let v=W._nextTaskID++;W._taskCallbackMap.set(v,b=>{if(b.success){try{this._handleRetJsonString(b.setReturn)}catch(S){return g(S)}return u()}{let S=new Error(b.message);return S.stack=b.stack+`
`+S.stack,g(S)}}),W._dbrWorker.postMessage({type:"setModeArgument",id:v,instanceID:this._instanceID,body:{modeName:t,index:i,argumentName:r,argumentValue:c}})})}async getModeArgument(t,i,r){return await new Promise((c,u)=>{let g=W._nextTaskID++;W._taskCallbackMap.set(g,v=>{if(v.success){let b;try{b=this._handleRetJsonString(v.getReturn)}catch(S){return u(S)}return c(b)}{let b=new Error(v.message);return b.stack=v.stack+`
`+b.stack,u(b)}}),W._dbrWorker.postMessage({type:"getModeArgument",id:g,instanceID:this._instanceID,body:{modeName:t,index:i,argumentName:r}})})}async getIntermediateResults(){return await new Promise((t,i)=>{let r=W._nextTaskID++;W._taskCallbackMap.set(r,c=>{if(c.success)return t(c.results);{let u=new Error(c.message);return u.stack=c.stack+`
`+u.stack,i(u)}}),W._dbrWorker.postMessage({type:"getIntermediateResults",id:r,instanceID:this._instanceID})})}async getIntermediateCanvas(){let t=await this.getIntermediateResults(),i=[];for(let r of t)if(r.dataType==ds.IMRDT_IMAGE)for(let c of r.results){const u=c.bytes;let g;switch(W._onLog&&W._onLog(" "+u.length+" "+u.byteLength+" "+c.width+" "+c.height+" "+c.stride+" "+c.format),c.format){case Be.IPF_ABGR_8888:g=new Uint8ClampedArray(u);break;case Be.IPF_RGB_888:{const S=u.length/3;g=new Uint8ClampedArray(4*S);for(let w=0;w<S;++w)g[4*w]=u[3*w+2],g[4*w+1]=u[3*w+1],g[4*w+2]=u[3*w],g[4*w+3]=255;break}case Be.IPF_GrayScaled:{const S=u.length;g=new Uint8ClampedArray(4*S);for(let w=0;w<S;w++)g[4*w]=g[4*w+1]=g[4*w+2]=u[w],g[4*w+3]=255;break}case Be.IPF_Binary:case Be.IPF_BinaryInverted:{c.width=8*c.stride,c.height=u.length/c.stride;const S=u.length;g=new Uint8ClampedArray(8*S*4);for(let w=0;w<S;w++){let E=u[w];for(let A=0;A<8;++A)g[4*(8*w+A)]=g[4*(8*w+A)+1]=g[4*(8*w+A)+2]=(128&E)/128*255,g[4*(8*w+A)+3]=255,E<<=1}break}default:console.warn("unknow intermediate image",c)}if(!g)continue;let v=new ImageData(g,c.width,c.height),b=document.createElement("canvas");b.width=c.width,b.height=c.height,b.getContext("2d").putImageData(v,0,0),i.push(b)}return i}async keepAlive(){W._dbrWorker.postMessage({type:"keepAlive"})}async getScanSettings(){return await new Promise((t,i)=>{let r=W._nextTaskID++;W._taskCallbackMap.set(r,c=>{if(c.success){let u=c.results;return u.intervalTime=this.intervalTime,u.whenToPlaySoundforSuccessfulRead=this.whenToPlaySoundforSuccessfulRead,u.soundOnSuccessfullRead=this.soundSource,u.whenToVibrateforSuccessfulRead=this.whenToVibrateforSuccessfulRead,u.vibrateDuration=this.vibrateDuration,u.captureAndDecodeInParallel=this.captureAndDecodeInParallel,t(u)}{let u=new Error(c.message);return u.stack+=`
`+c.stack,i(u)}}),W._dbrWorker.postMessage({type:"getScanSettings",id:r,instanceID:this._instanceID})})}async updateScanSettings(t){if(!t)return;const i=JSON.parse(JSON.stringify(t));return i.hasOwnProperty("intervalTime")&&(this.intervalTime=Math.max(i.intervalTime,0),delete i.intervalTime),i.hasOwnProperty("whenToPlaySoundforSuccessfulRead")&&(this.whenToPlaySoundforSuccessfulRead=i.whenToPlaySoundforSuccessfulRead,delete i.whenToPlaySoundforSuccessfulRead),i.hasOwnProperty("soundOnSuccessfullRead")&&(this.soundSource=i.soundOnSuccessfullRead,delete i.soundOnSuccessfullRead),i.hasOwnProperty("whenToVibrateforSuccessfulRead")&&(this.whenToVibrateforSuccessfulRead=i.whenToVibrateforSuccessfulRead,delete i.whenToVibrateforSuccessfulRead),i.hasOwnProperty("vibrateDuration")&&(this.vibrateDuration=i.vibrateDuration,delete i.vibrateDuration),i.hasOwnProperty("captureAndDecodeInParallel")&&(this.captureAndDecodeInParallel=i.captureAndDecodeInParallel,delete i.captureAndDecodeInParallel),await new Promise((r,c)=>{let u=W._nextTaskID++;W._taskCallbackMap.set(u,g=>{if(g.success)return r();{let v=new Error(g.message);return v.stack+=`
`+g.stack,c(v)}}),W._dbrWorker.postMessage({type:"updateScanSettings",id:u,instanceID:this._instanceID,body:{settings:i}})})}_cloneDecodeResults(t){if(t instanceof Array){let i=[];for(let r of t)i.push(this._cloneDecodeResults(r));return i}{let i=t;return JSON.parse(JSON.stringify(i,(c,u)=>c=="oriVideoCanvas"||c=="searchRegionCanvas"?void 0:u))}}async _loopReadVideo(){if(this.bDestroyed)return this.dce&&this._dceControler&&this._dceControler.setDisiredAction(this,"stopFetchingLoop"),void this._drawResults(null);if(this.dce&&!this.dce.isOpen())return this._drawResults(null),void await this.clearMapDecodeRecord();if(!this.dce&&!this._imgSource||this._bPauseScan)return W._onLog&&W._onLog("Scan is paused, or imageSource is not set. Ask in 1s."),await this.clearMapDecodeRecord(),this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),void(this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},this._intervalDetectVideoPause));W._onLog&&W._onLog("======= once read ======="),W._onLog&&(this._timeStartDecode=Date.now());let t=null,i=null;if(this.dce)t=this._getVideoFrame();else if(this._imgSource&&(i=await this._imgSource.getImage(),!W.isDSImage(i)))throw new Error("Invalid DSImage.");if(!t&&!i)return W._onLog&&W._onLog("Get invalid frame."),this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),void(this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},0));(async()=>{let r=[];if(t){r=await this._decode_DCEFrame(t,{bScanner:!0,bCopyData:!1});let c=null;if(r&&r.length){const{sx:u,sy:g,width:v,height:b,_sWidth:S,_sHeight:w}=t;c=r.map(E=>({resultState:E.resultState,localizationResult:JSON.parse(JSON.stringify(E.localizationResult))})),W.recalculateResultLocation(c,u,g,S,w,v,b)}this._drawResults(c)}else i&&(r=await this._decode_DSImage(i,{bScanner:!0,bCopyData:!1}));return r})().then(r=>{if(W._onLog&&W._onLog(r),this.dce&&this.captureAndDecodeInParallel){let c=this.array_decodeFrameTimeCost,u=this.array_getFrameTimeCost;const g=()=>{let v=0;if(u&&u.length){let b=Math.min(...c),S=Math.max(...u);b&&S&&(v=b-S)}else v=0;return v>0?v:0};(()=>{for(;c.length>=5;)c.shift();c.push(this._lastInnerDecodeDuration)})(),this._intervalGetVideoFrame=g()+this.intervalTime}if((this.dce&&this.dce.isOpen()||this._imgSource)&&!this._bPauseScan){if(this.bPlaySoundOnSuccessfulRead&&r.length){let c=!1;this.bPlaySoundOnSuccessfulRead===!0||this.bPlaySoundOnSuccessfulRead==="frame"?c=!0:this.bPlaySoundOnSuccessfulRead==="unique"&&(c=r.some(u=>u.resultState===0)),c&&(this.beepSound.stop(),this.beepSound.play())}if(navigator.vibrate&&this.bVibrateOnSuccessfulRead&&r.length){let c=!1;if(this.bVibrateOnSuccessfulRead===!0||this.bVibrateOnSuccessfulRead==="frame"?c=!0:this.bVibrateOnSuccessfulRead==="unique"&&(c=r.some(u=>u.resultState===0)),c)try{navigator.vibrate(this.vibrateDuration)}catch(u){console.warn("Vibration not allowed. User interaction required: "+(u.message||u))}}if(this.onImageRead){r=r.filter(u=>u.resultState>=0);const c=this._cloneDecodeResults(r);this.onImageRead(c)}if(this.onUniqueRead){r=r.filter(u=>u.resultState==0);const c=this._cloneDecodeResults(r);for(let u of c)this.onUniqueRead(u.barcodeText,u)}}this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this.intervalTime?this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},this.intervalTime):this._loopReadVideo()}).catch(r=>{this.dce&&this._dceControler&&this._dceControler.setDisiredAction(this,"stopFetchingLoop"),W._onLog&&W._onLog(r.message||r),this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this._loopReadVideoTimeoutId=setTimeout(()=>{this.dce&&(this.dce.startFetchingLoop(),this._dceControler&&this._dceControler.clearUserDisiredAction({user:this,actionName:"stopFetchingLoop"})),this._loopReadVideo()},Math.max(this.intervalTime,1e3)),r.message=="platform error"||console.warn(r.message)})}_getVideoFrame(){if(!this.dce)return null;let t;if(this.captureAndDecodeInParallel){if(W._onLog&&W._onLog("Get frame in parallel."),this._dceControler&&this._dceControler.setDisiredValue(this,"loopInterval",this._intervalGetVideoFrame),!this.dce.numberOfFramesInBuffer)return this._dceControler&&this._dceControler.setDisiredValue(this,"loopInterval",0),null;t=this.dce.getFrameFromBuffer(),(r=>{if(!r)return;let c=r.timeSpent,u=this.array_getFrameTimeCost;for(;u.length>=5;)u.shift();u.push(c)})(t)}else W._onLog&&W._onLog("Get frame in serial."),this._dceControler&&this._dceControler.setDisiredAction(this,"stopFetchingLoop"),t=this.dce.getFrame();return t}_drawResults(t){if(!this.dce||this._bPauseScan||!this._drawingItemNamespace||!this._drawingItemNamespace.DT_Polygon)return;if(!this._dbrDrawingLayer){if(!this.dce.isOpen())return;this._dbrDrawingLayer=this.dce.getDrawingLayer(3)}const i=this._dbrDrawingLayer;t||(t=[]);let r=this._arrPolygons;for(let c=0;c<t.length;c++){let u,g=t[c].localizationResult;r[c]?(u=r[c],i.hasDrawingItem(u)||i.addDrawingItem(u),u.set("vertices",[{x:g.x1,y:g.y1},{x:g.x2,y:g.y2},{x:g.x3,y:g.y3},{x:g.x4,y:g.y4}])):(u=new this._drawingItemNamespace.DT_Polygon([{x:g.x1,y:g.y1},{x:g.x2,y:g.y2},{x:g.x3,y:g.y3},{x:g.x4,y:g.y4}]),i.addDrawingItem(u),r[c]=u),t[c].resultState===-1?(u.styleId=this._styleIdBeforeVerification,u._mapStyle.set("default",this.dce.getDrawingStyle(this._styleIdBeforeVerification)),u._mapStyle.set("selected",this.dce.getDrawingStyle(this._styleIdBeforeVerification))):(u.styleId=null,u._mapStyle.set("default",this.dce.getDrawingStyle(3)),u._mapStyle.set("selected",this.dce.getDrawingStyle(7))),u.tag=t[c]}for(let c=t.length;c<r.length;c++)i.removeDrawingItem(r[c]);i.renderAll()}async startScanning(t){if(!this.dce&&!this._imgSource)throw new Error("'imageSource' is not set. call 'setImageSource()' before 'startScanning()'.");if(this._tempSolutionStatus!="closed"||(this._tempSolutionStatus="opening",this._tempSolutionStatus!="opening"))return;let i=null;return this.dce&&(this.dce.isOpen()?(t&&this.dce.appendAndShowUI(),i=JSON.parse(JSON.stringify(this.dce.playCallbackInfo))):i=await this.dce.open(t),this._dceControler&&(this._dceControler.clearUserDisiredAction({user:this,actionName:"close"}),this._dceControler.clearUserDisiredValue({property:"ifShowScanRegionLaser"}),this._dceControler.setDisiredValue(this,"ifShowScanRegionLaser",!0),this.dce.ifShowScanRegionLaser&&this.dce.showScanRegionLaser())),this._tempSolutionStatus=="opening"?(this._bPauseScan=!1,this.dce&&this.dce.singleFrameMode||(this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this._loopReadVideoTimeoutId=setTimeout(()=>{this.dce&&(this.dce.startFetchingLoop(),this._dceControler&&this._dceControler.clearUserDisiredAction({user:this,actionName:"stopFetchingLoop"})),this._loopReadVideo()},0)),this._tempSolutionStatus="opened",this.keepAlive(),i):void 0}stopScanning(t){this.dce&&(this._drawResults(null),this._dceControler&&(this._dceControler.setDisiredValue(this,"ifShowScanRegionLaser",!1),this.dce.ifShowScanRegionLaser||this.dce.hideScanRegionLaser(),this._dceControler.setDisiredAction(this,"close",[t]))),this._bPauseScan=!0,this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0,this._tempSolutionStatus="closed"}pauseScanning(t){if(t&&t.keepResultsHighlighted||this._drawResults(null),this._bPauseScan=!0,this.dce){if(this.dce.singleFrameMode)throw new Error("'pauseScanning()' is unavailable when property 'singleFrameMode' of the 'CameraEnhancer' instance is true.");this._dceControler&&(this._dceControler.setDisiredValue(this,"ifShowScanRegionLaser",!1),this.dce.ifShowScanRegionLaser||this.dce.hideScanRegionLaser(),this._dceControler.setDisiredAction(this,"stopFetchingLoop"))}}resumeScanning(){if(this._bPauseScan=!1,this.dce){if(this.dce.singleFrameMode)throw new Error("'resumeScanning()' is unavailable when property 'singleFrameMode' of the 'CameraEnhancer' instance is true.");this.dce.startFetchingLoop(),this._dceControler&&(this._dceControler.clearUserDisiredAction({user:this,actionName:"stopFetchingLoop"}),this._dceControler.clearUserDisiredValue({property:"ifShowScanRegionLaser"}),this._dceControler.setDisiredValue(this,"ifShowScanRegionLaser",!0),this.dce.ifShowScanRegionLaser&&this.dce.showScanRegionLaser())}}destroyContext(){if(W._onLog&&W._onLog("destroyContext()"),this.bDestroyed)return;this.bDestroyed=!0,(this.dce||this._tempSolutionStatus==="opening")&&this.stopScanning(),this.setImageSource(null);let t=W._nextTaskID++;W._taskCallbackMap.set(t,i=>{if(!i.success){let r=new Error(i.message);throw r.stack=i.stack+`
`+r.stack,r}}),W._dbrWorker.postMessage({type:"destroyContext",id:t,instanceID:this._instanceID})}}W._jsVersion="9.3.1",W._jsEditVersion="20220930",W._version=`loading...(JS ${W._jsVersion}.${W._jsEditVersion})`,W._license=Nf,W._sessionPassword=Vf,W.browserInfo=Ue,W._workerName=`dbr-${W._jsVersion}.browser.worker.js`,W._engineResourcePath=jf,W._licenseServer=[],W._deviceFriendlyName="",W._isShowRelDecodeTimeInResults=!1,W._bWasmDebug=!1,W._bNeverShowDialog=!1,W.__bUseFullFeature=!0,W._nextTaskID=0,W._taskCallbackMap=new Map,W._pLoad=new class extends Promise{constructor(e){let t,i;super((r,c)=>{t=r,i=c}),this._s="pending",this.resolve=r=>{this.isPending&&(Go(r)?this.task=r:(this._s="fulfilled",t(r)))},this.reject=r=>{this.isPending&&(this._s="rejected",i(r))},this.task=e}get status(){return this._s}get isPending(){return this._s==="pending"}get isFulfilled(){return this._s==="fulfilled"}get isRejected(){return this._s==="rejected"}get task(){return this._task}set task(e){let t;this._task=e,Go(e)?t=e:typeof e=="function"&&(t=new Promise(e)),t&&(async()=>{try{const i=await t;e===this._task&&this.resolve(i)}catch(i){e===this._task&&this.reject(i)}})()}get isEmpty(){return this._task==null}},W._lastErrorCode=0,W._lastErrorString="",W._setWarnnedEx=new Set,W._defaultUIElementURL="@engineResourcePath/dbr.ui.html";var Uf={653:(e,t,i)=>{var r,c,u,g,v,b,S,w,E,A,B,z,q,J,Z,ee,K,oe,pe,ye,_e,y=y||{version:"5.2.1"};if(t.fabric=y,typeof document<"u"&&typeof window<"u")document instanceof(typeof HTMLDocument<"u"?HTMLDocument:Document)?y.document=document:y.document=document.implementation.createHTMLDocument(""),y.window=window;else{var le=new(i(192)).JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;y.document=le.document,y.jsdomImplForWrapper=i(898).implForWrapper,y.nodeCanvas=i(245).Canvas,y.window=le,DOMParser=y.window.DOMParser}function te(a,o){var l=a.canvas,d=o.targetCanvas,n=d.getContext("2d");n.translate(0,d.height),n.scale(1,-1);var s=l.height-d.height;n.drawImage(l,0,s,d.width,d.height,0,0,d.width,d.height)}function he(a,o){var l=o.targetCanvas.getContext("2d"),d=o.destinationWidth,n=o.destinationHeight,s=d*n*4,h=new Uint8Array(this.imageBuffer,0,s),_=new Uint8ClampedArray(this.imageBuffer,0,s);a.readPixels(0,0,d,n,a.RGBA,a.UNSIGNED_BYTE,h);var f=new ImageData(_,d,n);l.putImageData(f,0,0)}y.isTouchSupported="ontouchstart"in y.window||"ontouchstart"in y.document||y.window&&y.window.navigator&&y.window.navigator.maxTouchPoints>0,y.isLikelyNode=typeof Buffer<"u"&&typeof window>"u",y.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],y.DPI=96,y.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",y.commaWsp="(?:\\s+,?\\s*|,\\s*)",y.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/gi,y.reNonWord=/[ \n\.,;!\?\-]/,y.fontPaths={},y.iMatrix=[1,0,0,1,0,0],y.svgNS="http://www.w3.org/2000/svg",y.perfLimitSizeTotal=2097152,y.maxCacheSideLimit=4096,y.minCacheSideLimit=256,y.charWidthsCache={},y.textureSize=2048,y.disableStyleCopyPaste=!1,y.enableGLFiltering=!0,y.devicePixelRatio=y.window.devicePixelRatio||y.window.webkitDevicePixelRatio||y.window.mozDevicePixelRatio||1,y.browserShadowBlurConstant=1,y.arcToSegmentsCache={},y.boundsOfCurveCache={},y.cachesBoundsOfCurve=!0,y.forceGLPutImageData=!1,y.initFilterBackend=function(){return y.enableGLFiltering&&y.isWebglSupported&&y.isWebglSupported(y.textureSize)?(console.log("max texture size: "+y.maxTextureSize),new y.WebglFilterBackend({tileSize:y.textureSize})):y.Canvas2dFilterBackend?new y.Canvas2dFilterBackend:void 0},typeof document<"u"&&typeof window<"u"&&(window.fabric=y),function(){function a(l,d){if(this.__eventListeners[l]){var n=this.__eventListeners[l];d?n[n.indexOf(d)]=!1:y.util.array.fill(n,!1)}}function o(l,d){var n=function(){d.apply(this,arguments),this.off(l,n)}.bind(this);this.on(l,n)}y.Observable={fire:function(l,d){if(!this.__eventListeners)return this;var n=this.__eventListeners[l];if(!n)return this;for(var s=0,h=n.length;s<h;s++)n[s]&&n[s].call(this,d||{});return this.__eventListeners[l]=n.filter(function(_){return _!==!1}),this},on:function(l,d){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var n in l)this.on(n,l[n]);else this.__eventListeners[l]||(this.__eventListeners[l]=[]),this.__eventListeners[l].push(d);return this},once:function(l,d){if(arguments.length===1)for(var n in l)o.call(this,n,l[n]);else o.call(this,l,d);return this},off:function(l,d){if(!this.__eventListeners)return this;if(arguments.length===0)for(l in this.__eventListeners)a.call(this,l);else if(arguments.length===1&&typeof arguments[0]=="object")for(var n in l)a.call(this,n,l[n]);else a.call(this,l,d);return this}}}(),y.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var a=0,o=arguments.length;a<o;a++)this._onObjectAdded(arguments[a]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(a,o,l){var d=this._objects;return l?d[o]=a:d.splice(o,0,a),this._onObjectAdded&&this._onObjectAdded(a),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var a,o=this._objects,l=!1,d=0,n=arguments.length;d<n;d++)(a=o.indexOf(arguments[d]))!==-1&&(l=!0,o.splice(a,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[d]));return this.renderOnAddRemove&&l&&this.requestRenderAll(),this},forEachObject:function(a,o){for(var l=this.getObjects(),d=0,n=l.length;d<n;d++)a.call(o,l[d],d,l);return this},getObjects:function(a){return a===void 0?this._objects.concat():this._objects.filter(function(o){return o.type===a})},item:function(a){return this._objects[a]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(a,o){return this._objects.indexOf(a)>-1||!!o&&this._objects.some(function(l){return typeof l.contains=="function"&&l.contains(a,!0)})},complexity:function(){return this._objects.reduce(function(a,o){return a+(o.complexity?o.complexity():0)},0)}},y.CommonMethods={_setOptions:function(a){for(var o in a)this.set(o,a[o])},_initGradient:function(a,o){!a||!a.colorStops||a instanceof y.Gradient||this.set(o,new y.Gradient(a))},_initPattern:function(a,o,l){!a||!a.source||a instanceof y.Pattern?l&&l():this.set(o,new y.Pattern(a,l))},_setObject:function(a){for(var o in a)this._set(o,a[o])},set:function(a,o){return typeof a=="object"?this._setObject(a):this._set(a,o),this},_set:function(a,o){this[a]=o},toggle:function(a){var o=this.get(a);return typeof o=="boolean"&&this.set(a,!o),this},get:function(a){return this[a]}},r=t,c=Math.sqrt,u=Math.atan2,g=Math.pow,v=Math.PI/180,b=Math.PI/2,y.util={cos:function(a){if(a===0)return 1;switch(a<0&&(a=-a),a/b){case 1:case 3:return 0;case 2:return-1}return Math.cos(a)},sin:function(a){if(a===0)return 0;var o=1;switch(a<0&&(o=-1),a/b){case 1:return o;case 2:return 0;case 3:return-o}return Math.sin(a)},removeFromArray:function(a,o){var l=a.indexOf(o);return l!==-1&&a.splice(l,1),a},getRandomInt:function(a,o){return Math.floor(Math.random()*(o-a+1))+a},degreesToRadians:function(a){return a*v},radiansToDegrees:function(a){return a/v},rotatePoint:function(a,o,l){var d=new y.Point(a.x-o.x,a.y-o.y),n=y.util.rotateVector(d,l);return new y.Point(n.x,n.y).addEquals(o)},rotateVector:function(a,o){var l=y.util.sin(o),d=y.util.cos(o);return{x:a.x*d-a.y*l,y:a.x*l+a.y*d}},createVector:function(a,o){return new y.Point(o.x-a.x,o.y-a.y)},calcAngleBetweenVectors:function(a,o){return Math.acos((a.x*o.x+a.y*o.y)/(Math.hypot(a.x,a.y)*Math.hypot(o.x,o.y)))},getHatVector:function(a){return new y.Point(a.x,a.y).multiply(1/Math.hypot(a.x,a.y))},getBisector:function(a,o,l){var d=y.util.createVector(a,o),n=y.util.createVector(a,l),s=y.util.calcAngleBetweenVectors(d,n),h=s*(y.util.calcAngleBetweenVectors(y.util.rotateVector(d,s),n)===0?1:-1)/2;return{vector:y.util.getHatVector(y.util.rotateVector(d,h)),angle:s}},projectStrokeOnPoints:function(a,o,l){var d=[],n=o.strokeWidth/2,s=o.strokeUniform?new y.Point(1/o.scaleX,1/o.scaleY):new y.Point(1,1),h=function(_){var f=n/Math.hypot(_.x,_.y);return new y.Point(_.x*f*s.x,_.y*f*s.y)};return a.length<=1||a.forEach(function(_,f){var p,m,C=new y.Point(_.x,_.y);f===0?(m=a[f+1],p=l?h(y.util.createVector(m,C)).addEquals(C):a[a.length-1]):f===a.length-1?(p=a[f-1],m=l?h(y.util.createVector(p,C)).addEquals(C):a[0]):(p=a[f-1],m=a[f+1]);var T,x,I=y.util.getBisector(C,p,m),D=I.vector,L=I.angle;if(o.strokeLineJoin==="miter"&&(T=-n/Math.sin(L/2),x=new y.Point(D.x*T*s.x,D.y*T*s.y),Math.hypot(x.x,x.y)/n<=o.strokeMiterLimit))return d.push(C.add(x)),void d.push(C.subtract(x));T=-n*Math.SQRT2,x=new y.Point(D.x*T*s.x,D.y*T*s.y),d.push(C.add(x)),d.push(C.subtract(x))}),d},transformPoint:function(a,o,l){return l?new y.Point(o[0]*a.x+o[2]*a.y,o[1]*a.x+o[3]*a.y):new y.Point(o[0]*a.x+o[2]*a.y+o[4],o[1]*a.x+o[3]*a.y+o[5])},makeBoundingBoxFromPoints:function(a,o){if(o)for(var l=0;l<a.length;l++)a[l]=y.util.transformPoint(a[l],o);var d=[a[0].x,a[1].x,a[2].x,a[3].x],n=y.util.array.min(d),s=y.util.array.max(d)-n,h=[a[0].y,a[1].y,a[2].y,a[3].y],_=y.util.array.min(h);return{left:n,top:_,width:s,height:y.util.array.max(h)-_}},invertTransform:function(a){var o=1/(a[0]*a[3]-a[1]*a[2]),l=[o*a[3],-o*a[1],-o*a[2],o*a[0]],d=y.util.transformPoint({x:a[4],y:a[5]},l,!0);return l[4]=-d.x,l[5]=-d.y,l},toFixed:function(a,o){return parseFloat(Number(a).toFixed(o))},parseUnit:function(a,o){var l=/\D{0,2}$/.exec(a),d=parseFloat(a);switch(o||(o=y.Text.DEFAULT_SVG_FONT_SIZE),l[0]){case"mm":return d*y.DPI/25.4;case"cm":return d*y.DPI/2.54;case"in":return d*y.DPI;case"pt":return d*y.DPI/72;case"pc":return d*y.DPI/72*12;case"em":return d*o;default:return d}},falseFunction:function(){return!1},getKlass:function(a,o){return a=y.util.string.camelize(a.charAt(0).toUpperCase()+a.slice(1)),y.util.resolveNamespace(o)[a]},getSvgAttributes:function(a){var o=["instantiated_by_use","style","id","class"];switch(a){case"linearGradient":o=o.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":o=o.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":o=o.concat(["offset","stop-color","stop-opacity"])}return o},resolveNamespace:function(a){if(!a)return y;var o,l=a.split("."),d=l.length,n=r||y.window;for(o=0;o<d;++o)n=n[l[o]];return n},loadImage:function(a,o,l,d){if(a){var n=y.util.createImage(),s=function(){o&&o.call(l,n,!1),n=n.onload=n.onerror=null};n.onload=s,n.onerror=function(){y.log("Error loading "+n.src),o&&o.call(l,null,!0),n=n.onload=n.onerror=null},a.indexOf("data")!==0&&d!=null&&(n.crossOrigin=d),a.substring(0,14)==="data:image/svg"&&(n.onload=null,y.util.loadImageInDom(n,s)),n.src=a}else o&&o.call(l,a)},loadImageInDom:function(a,o){var l=y.document.createElement("div");l.style.width=l.style.height="1px",l.style.left=l.style.top="-100%",l.style.position="absolute",l.appendChild(a),y.document.querySelector("body").appendChild(l),a.onload=function(){o(),l.parentNode.removeChild(l),l=null}},enlivenObjects:function(a,o,l,d){var n=[],s=0,h=(a=a||[]).length;function _(){++s===h&&o&&o(n.filter(function(f){return f}))}h?a.forEach(function(f,p){f&&f.type?y.util.getKlass(f.type,l).fromObject(f,function(m,C){C||(n[p]=m),d&&d(f,m,C),_()}):_()}):o&&o(n)},enlivenObjectEnlivables:function(a,o,l){var d=y.Object.ENLIVEN_PROPS.filter(function(n){return!!a[n]});y.util.enlivenObjects(d.map(function(n){return a[n]}),function(n){var s={};d.forEach(function(h,_){s[h]=n[_],o&&(o[h]=n[_])}),l&&l(s)})},enlivenPatterns:function(a,o){function l(){++n===s&&o&&o(d)}var d=[],n=0,s=(a=a||[]).length;s?a.forEach(function(h,_){h&&h.source?new y.Pattern(h,function(f){d[_]=f,l()}):(d[_]=h,l())}):o&&o(d)},groupSVGElements:function(a,o,l){var d;return a&&a.length===1?a[0]:(o&&(o.width&&o.height?o.centerPoint={x:o.width/2,y:o.height/2}:(delete o.width,delete o.height)),d=new y.Group(a,o),l!==void 0&&(d.sourcePath=l),d)},populateWithProperties:function(a,o,l){if(l&&Array.isArray(l))for(var d=0,n=l.length;d<n;d++)l[d]in a&&(o[l[d]]=a[l[d]])},createCanvasElement:function(){return y.document.createElement("canvas")},copyCanvasElement:function(a){var o=y.util.createCanvasElement();return o.width=a.width,o.height=a.height,o.getContext("2d").drawImage(a,0,0),o},toDataURL:function(a,o,l){return a.toDataURL("image/"+o,l)},createImage:function(){return y.document.createElement("img")},multiplyTransformMatrices:function(a,o,l){return[a[0]*o[0]+a[2]*o[1],a[1]*o[0]+a[3]*o[1],a[0]*o[2]+a[2]*o[3],a[1]*o[2]+a[3]*o[3],l?0:a[0]*o[4]+a[2]*o[5]+a[4],l?0:a[1]*o[4]+a[3]*o[5]+a[5]]},qrDecompose:function(a){var o=u(a[1],a[0]),l=g(a[0],2)+g(a[1],2),d=c(l),n=(a[0]*a[3]-a[2]*a[1])/d,s=u(a[0]*a[2]+a[1]*a[3],l);return{angle:o/v,scaleX:d,scaleY:n,skewX:s/v,skewY:0,translateX:a[4],translateY:a[5]}},calcRotateMatrix:function(a){if(!a.angle)return y.iMatrix.concat();var o=y.util.degreesToRadians(a.angle),l=y.util.cos(o),d=y.util.sin(o);return[l,d,-d,l,0,0]},calcDimensionsMatrix:function(a){var o=a.scaleX===void 0?1:a.scaleX,l=a.scaleY===void 0?1:a.scaleY,d=[a.flipX?-o:o,0,0,a.flipY?-l:l,0,0],n=y.util.multiplyTransformMatrices,s=y.util.degreesToRadians;return a.skewX&&(d=n(d,[1,0,Math.tan(s(a.skewX)),1],!0)),a.skewY&&(d=n(d,[1,Math.tan(s(a.skewY)),0,1],!0)),d},composeMatrix:function(a){var o=[1,0,0,1,a.translateX||0,a.translateY||0],l=y.util.multiplyTransformMatrices;return a.angle&&(o=l(o,y.util.calcRotateMatrix(a))),(a.scaleX!==1||a.scaleY!==1||a.skewX||a.skewY||a.flipX||a.flipY)&&(o=l(o,y.util.calcDimensionsMatrix(a))),o},resetObjectTransform:function(a){a.scaleX=1,a.scaleY=1,a.skewX=0,a.skewY=0,a.flipX=!1,a.flipY=!1,a.rotate(0)},saveObjectTransform:function(a){return{scaleX:a.scaleX,scaleY:a.scaleY,skewX:a.skewX,skewY:a.skewY,angle:a.angle,left:a.left,flipX:a.flipX,flipY:a.flipY,top:a.top}},isTransparent:function(a,o,l,d){d>0&&(o>d?o-=d:o=0,l>d?l-=d:l=0);var n,s=!0,h=a.getImageData(o,l,2*d||1,2*d||1),_=h.data.length;for(n=3;n<_&&(s=h.data[n]<=0)!=0;n+=4);return h=null,s},parsePreserveAspectRatioAttribute:function(a){var o,l="meet",d=a.split(" ");return d&&d.length&&((l=d.pop())!=="meet"&&l!=="slice"?(o=l,l="meet"):d.length&&(o=d.pop())),{meetOrSlice:l,alignX:o!=="none"?o.slice(1,4):"none",alignY:o!=="none"?o.slice(5,8):"none"}},clearFabricFontCache:function(a){(a=(a||"").toLowerCase())?y.charWidthsCache[a]&&delete y.charWidthsCache[a]:y.charWidthsCache={}},limitDimsByArea:function(a,o){var l=Math.sqrt(o*a),d=Math.floor(o/l);return{x:Math.floor(l),y:d}},capValue:function(a,o,l){return Math.max(a,Math.min(o,l))},findScaleToFit:function(a,o){return Math.min(o.width/a.width,o.height/a.height)},findScaleToCover:function(a,o){return Math.max(o.width/a.width,o.height/a.height)},matrixToSVG:function(a){return"matrix("+a.map(function(o){return y.util.toFixed(o,y.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(a,o){var l=y.util.invertTransform(o),d=y.util.multiplyTransformMatrices(l,a.calcOwnMatrix());y.util.applyTransformToObject(a,d)},addTransformToObject:function(a,o){y.util.applyTransformToObject(a,y.util.multiplyTransformMatrices(o,a.calcOwnMatrix()))},applyTransformToObject:function(a,o){var l=y.util.qrDecompose(o),d=new y.Point(l.translateX,l.translateY);a.flipX=!1,a.flipY=!1,a.set("scaleX",l.scaleX),a.set("scaleY",l.scaleY),a.skewX=l.skewX,a.skewY=l.skewY,a.angle=l.angle,a.setPositionByOrigin(d,"center","center")},sizeAfterTransform:function(a,o,l){var d=a/2,n=o/2,s=[{x:-d,y:-n},{x:d,y:-n},{x:-d,y:n},{x:d,y:n}],h=y.util.calcDimensionsMatrix(l),_=y.util.makeBoundingBoxFromPoints(s,h);return{x:_.width,y:_.height}},mergeClipPaths:function(a,o){var l=a,d=o;l.inverted&&!d.inverted&&(l=o,d=a),y.util.applyTransformToObject(d,y.util.multiplyTransformMatrices(y.util.invertTransform(l.calcTransformMatrix()),d.calcTransformMatrix()));var n=l.inverted&&d.inverted;return n&&(l.inverted=d.inverted=!1),new y.Group([l],{clipPath:d,inverted:n})}},function(){var a=Array.prototype.join,o={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},l={m:"l",M:"L"};function d(x,I,D,L,V,H,$,X,O,R,M){var F=y.util.cos(x),j=y.util.sin(x),G=y.util.cos(I),k=y.util.sin(I),P=D*V*G-L*H*k+$,N=L*V*G+D*H*k+X;return["C",R+O*(-D*V*j-L*H*F),M+O*(-L*V*j+D*H*F),P+O*(D*V*k+L*H*G),N+O*(L*V*k-D*H*G),P,N]}function n(x,I,D,L){var V=Math.atan2(I,x),H=Math.atan2(L,D);return H>=V?H-V:2*Math.PI-(V-H)}function s(x,I,D){for(var L=D[1],V=D[2],H=D[3],$=D[4],X=D[5],O=function(F,j,G,k,P,N,U){var Y=Math.PI,Q=U*Y/180,ie=y.util.sin(Q),re=y.util.cos(Q),ne=0,ae=0,se=-re*F*.5-ie*j*.5,ue=-re*j*.5+ie*F*.5,me=(G=Math.abs(G))*G,ge=(k=Math.abs(k))*k,Ce=ue*ue,Te=se*se,Qe=me*ge-me*Ce-ge*Te,Le=0;if(Qe<0){var Xe=Math.sqrt(1-Qe/(me*ge));G*=Xe,k*=Xe}else Le=(P===N?-1:1)*Math.sqrt(Qe/(me*Ce+ge*Te));var Re=Le*G*ue/k,ct=-Le*k*se/G,Hi=re*Re-ie*ct+.5*F,Ei=ie*Re+re*ct+.5*j,ti=n(1,0,(se-Re)/G,(ue-ct)/k),Ai=n((se-Re)/G,(ue-ct)/k,(-se-Re)/G,(-ue-ct)/k);N===0&&Ai>0?Ai-=2*Y:N===1&&Ai<0&&(Ai+=2*Y);for(var Js=Math.ceil(Math.abs(Ai/Y*2)),In=[],Yi=Ai/Js,jc=8/3*Math.sin(Yi/4)*Math.sin(Yi/4)/Math.sin(Yi/2),Rr=ti+Yi,Xi=0;Xi<Js;Xi++)In[Xi]=d(ti,Rr,re,ie,G,k,Hi,Ei,jc,ne,ae),ne=In[Xi][5],ae=In[Xi][6],ti=Rr,Rr+=Yi;return In}(D[6]-x,D[7]-I,L,V,$,X,H),R=0,M=O.length;R<M;R++)O[R][1]+=x,O[R][2]+=I,O[R][3]+=x,O[R][4]+=I,O[R][5]+=x,O[R][6]+=I;return O}function h(x,I,D,L){return Math.sqrt((D-x)*(D-x)+(L-I)*(L-I))}function _(x,I,D,L,V,H,$,X){return function(O){var R,M=(R=O)*R*R,F=function(k){return 3*k*k*(1-k)}(O),j=function(k){return 3*k*(1-k)*(1-k)}(O),G=function(k){return(1-k)*(1-k)*(1-k)}(O);return{x:$*M+V*F+D*j+x*G,y:X*M+H*F+L*j+I*G}}}function f(x,I,D,L,V,H,$,X){return function(O){var R=1-O,M=3*R*R*(D-x)+6*R*O*(V-D)+3*O*O*($-V),F=3*R*R*(L-I)+6*R*O*(H-L)+3*O*O*(X-H);return Math.atan2(F,M)}}function p(x,I,D,L,V,H){return function($){var X,O=(X=$)*X,R=function(F){return 2*F*(1-F)}($),M=function(F){return(1-F)*(1-F)}($);return{x:V*O+D*R+x*M,y:H*O+L*R+I*M}}}function m(x,I,D,L,V,H){return function($){var X=1-$,O=2*X*(D-x)+2*$*(V-D),R=2*X*(L-I)+2*$*(H-L);return Math.atan2(R,O)}}function C(x,I,D){var L,V,H={x:I,y:D},$=0;for(V=1;V<=100;V+=1)L=x(V/100),$+=h(H.x,H.y,L.x,L.y),H=L;return $}function T(x){for(var I,D,L,V,H=0,$=x.length,X=0,O=0,R=0,M=0,F=[],j=0;j<$;j++){switch(L={x:X,y:O,command:(I=x[j])[0]},I[0]){case"M":L.length=0,R=X=I[1],M=O=I[2];break;case"L":L.length=h(X,O,I[1],I[2]),X=I[1],O=I[2];break;case"C":D=_(X,O,I[1],I[2],I[3],I[4],I[5],I[6]),V=f(X,O,I[1],I[2],I[3],I[4],I[5],I[6]),L.iterator=D,L.angleFinder=V,L.length=C(D,X,O),X=I[5],O=I[6];break;case"Q":D=p(X,O,I[1],I[2],I[3],I[4]),V=m(X,O,I[1],I[2],I[3],I[4]),L.iterator=D,L.angleFinder=V,L.length=C(D,X,O),X=I[3],O=I[4];break;case"Z":case"z":L.destX=R,L.destY=M,L.length=h(X,O,R,M),X=R,O=M}H+=L.length,F.push(L)}return F.push({length:H,x:X,y:O}),F}y.util.joinPath=function(x){return x.map(function(I){return I.join(" ")}).join(" ")},y.util.parsePath=function(x){var I,D,L,V,H,$=[],X=[],O=y.rePathCommand,R="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",M="("+R+")"+y.commaWsp,F="([01])"+y.commaWsp+"?",j=new RegExp(M+"?"+M+"?"+M+F+F+M+"?("+R+")","g");if(!x||!x.match)return $;for(var G,k=0,P=(H=x.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi)).length;k<P;k++){V=(I=H[k]).slice(1).trim(),X.length=0;var N=I.charAt(0);if(G=[N],N.toLowerCase()==="a")for(var U;U=j.exec(V);)for(var Y=1;Y<U.length;Y++)X.push(U[Y]);else for(;L=O.exec(V);)X.push(L[0]);Y=0;for(var Q=X.length;Y<Q;Y++)D=parseFloat(X[Y]),isNaN(D)||G.push(D);var ie=o[N.toLowerCase()],re=l[N]||N;if(G.length-1>ie)for(var ne=1,ae=G.length;ne<ae;ne+=ie)$.push([N].concat(G.slice(ne,ne+ie))),N=re;else $.push(G)}return $},y.util.makePathSimpler=function(x){var I,D,L,V,H,$,X=0,O=0,R=x.length,M=0,F=0,j=[];for(D=0;D<R;++D){switch(L=!1,(I=x[D].slice(0))[0]){case"l":I[0]="L",I[1]+=X,I[2]+=O;case"L":X=I[1],O=I[2];break;case"h":I[1]+=X;case"H":I[0]="L",I[2]=O,X=I[1];break;case"v":I[1]+=O;case"V":I[0]="L",O=I[1],I[1]=X,I[2]=O;break;case"m":I[0]="M",I[1]+=X,I[2]+=O;case"M":X=I[1],O=I[2],M=I[1],F=I[2];break;case"c":I[0]="C",I[1]+=X,I[2]+=O,I[3]+=X,I[4]+=O,I[5]+=X,I[6]+=O;case"C":H=I[3],$=I[4],X=I[5],O=I[6];break;case"s":I[0]="S",I[1]+=X,I[2]+=O,I[3]+=X,I[4]+=O;case"S":V==="C"?(H=2*X-H,$=2*O-$):(H=X,$=O),X=I[3],O=I[4],I[0]="C",I[5]=I[3],I[6]=I[4],I[3]=I[1],I[4]=I[2],I[1]=H,I[2]=$,H=I[3],$=I[4];break;case"q":I[0]="Q",I[1]+=X,I[2]+=O,I[3]+=X,I[4]+=O;case"Q":H=I[1],$=I[2],X=I[3],O=I[4];break;case"t":I[0]="T",I[1]+=X,I[2]+=O;case"T":V==="Q"?(H=2*X-H,$=2*O-$):(H=X,$=O),I[0]="Q",X=I[1],O=I[2],I[1]=H,I[2]=$,I[3]=X,I[4]=O;break;case"a":I[0]="A",I[6]+=X,I[7]+=O;case"A":L=!0,j=j.concat(s(X,O,I)),X=I[6],O=I[7];break;case"z":case"Z":X=M,O=F}L||j.push(I),V=I[0]}return j},y.util.getSmoothPathFromPoints=function(x,I){var D,L=[],V=new y.Point(x[0].x,x[0].y),H=new y.Point(x[1].x,x[1].y),$=x.length,X=1,O=0,R=$>2;for(I=I||0,R&&(X=x[2].x<H.x?-1:x[2].x===H.x?0:1,O=x[2].y<H.y?-1:x[2].y===H.y?0:1),L.push(["M",V.x-X*I,V.y-O*I]),D=1;D<$;D++){if(!V.eq(H)){var M=V.midPointFrom(H);L.push(["Q",V.x,V.y,M.x,M.y])}V=x[D],D+1<x.length&&(H=x[D+1])}return R&&(X=V.x>x[D-2].x?1:V.x===x[D-2].x?0:-1,O=V.y>x[D-2].y?1:V.y===x[D-2].y?0:-1),L.push(["L",V.x+X*I,V.y+O*I]),L},y.util.getPathSegmentsInfo=T,y.util.getBoundsOfCurve=function(x,I,D,L,V,H,$,X){var O;if(y.cachesBoundsOfCurve&&(O=a.call(arguments),y.boundsOfCurveCache[O]))return y.boundsOfCurveCache[O];var R,M,F,j,G,k,P,N,U=Math.sqrt,Y=Math.min,Q=Math.max,ie=Math.abs,re=[],ne=[[],[]];M=6*x-12*D+6*V,R=-3*x+9*D-9*V+3*$,F=3*D-3*x;for(var ae=0;ae<2;++ae)if(ae>0&&(M=6*I-12*L+6*H,R=-3*I+9*L-9*H+3*X,F=3*L-3*I),ie(R)<1e-12){if(ie(M)<1e-12)continue;0<(j=-F/M)&&j<1&&re.push(j)}else(P=M*M-4*F*R)<0||(0<(G=(-M+(N=U(P)))/(2*R))&&G<1&&re.push(G),0<(k=(-M-N)/(2*R))&&k<1&&re.push(k));for(var se,ue,me,ge=re.length,Ce=ge;ge--;)se=(me=1-(j=re[ge]))*me*me*x+3*me*me*j*D+3*me*j*j*V+j*j*j*$,ne[0][ge]=se,ue=me*me*me*I+3*me*me*j*L+3*me*j*j*H+j*j*j*X,ne[1][ge]=ue;ne[0][Ce]=x,ne[1][Ce]=I,ne[0][Ce+1]=$,ne[1][Ce+1]=X;var Te=[{x:Y.apply(null,ne[0]),y:Y.apply(null,ne[1])},{x:Q.apply(null,ne[0]),y:Q.apply(null,ne[1])}];return y.cachesBoundsOfCurve&&(y.boundsOfCurveCache[O]=Te),Te},y.util.getPointOnPath=function(x,I,D){D||(D=T(x));for(var L=0;I-D[L].length>0&&L<D.length-2;)I-=D[L].length,L++;var V,H=D[L],$=I/H.length,X=H.command,O=x[L];switch(X){case"M":return{x:H.x,y:H.y,angle:0};case"Z":case"z":return(V=new y.Point(H.x,H.y).lerp(new y.Point(H.destX,H.destY),$)).angle=Math.atan2(H.destY-H.y,H.destX-H.x),V;case"L":return(V=new y.Point(H.x,H.y).lerp(new y.Point(O[1],O[2]),$)).angle=Math.atan2(O[2]-H.y,O[1]-H.x),V;case"C":case"Q":return function(R,M){for(var F,j,G,k=0,P=0,N=R.iterator,U={x:R.x,y:R.y},Y=.01,Q=R.angleFinder;P<M&&Y>1e-4;)F=N(k),G=k,(j=h(U.x,U.y,F.x,F.y))+P>M?(k-=Y,Y/=2):(U=F,k+=Y,P+=j);return F.angle=Q(G),F}(H,I)}},y.util.transformPath=function(x,I,D){return D&&(I=y.util.multiplyTransformMatrices(I,[1,0,0,1,-D.x,-D.y])),x.map(function(L){for(var V=L.slice(0),H={},$=1;$<L.length-1;$+=2)H.x=L[$],H.y=L[$+1],H=y.util.transformPoint(H,I),V[$]=H.x,V[$+1]=H.y;return V})}}(),function(){var a=Array.prototype.slice;function o(l,d,n){if(l&&l.length!==0){var s=l.length-1,h=d?l[s][d]:l[s];if(d)for(;s--;)n(l[s][d],h)&&(h=l[s][d]);else for(;s--;)n(l[s],h)&&(h=l[s]);return h}}y.util.array={fill:function(l,d){for(var n=l.length;n--;)l[n]=d;return l},invoke:function(l,d){for(var n=a.call(arguments,2),s=[],h=0,_=l.length;h<_;h++)s[h]=n.length?l[h][d].apply(l[h],n):l[h][d].call(l[h]);return s},min:function(l,d){return o(l,d,function(n,s){return n<s})},max:function(l,d){return o(l,d,function(n,s){return n>=s})}}}(),function(){function a(o,l,d){if(d)if(!y.isLikelyNode&&l instanceof Element)o=l;else if(l instanceof Array){o=[];for(var n=0,s=l.length;n<s;n++)o[n]=a({},l[n],d)}else if(l&&typeof l=="object")for(var h in l)h==="canvas"||h==="group"?o[h]=null:l.hasOwnProperty(h)&&(o[h]=a({},l[h],d));else o=l;else for(var h in l)o[h]=l[h];return o}y.util.object={extend:a,clone:function(o,l){return a({},o,l)}},y.util.object.extend(y.util,y.Observable)}(),function(){function a(o,l){var d=o.charCodeAt(l);if(isNaN(d))return"";if(d<55296||d>57343)return o.charAt(l);if(55296<=d&&d<=56319){if(o.length<=l+1)throw"High surrogate without following low surrogate";var n=o.charCodeAt(l+1);if(56320>n||n>57343)throw"High surrogate without following low surrogate";return o.charAt(l)+o.charAt(l+1)}if(l===0)throw"Low surrogate without preceding high surrogate";var s=o.charCodeAt(l-1);if(55296>s||s>56319)throw"Low surrogate without preceding high surrogate";return!1}y.util.string={camelize:function(o){return o.replace(/-+(.)?/g,function(l,d){return d?d.toUpperCase():""})},capitalize:function(o,l){return o.charAt(0).toUpperCase()+(l?o.slice(1):o.slice(1).toLowerCase())},escapeXml:function(o){return o.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},graphemeSplit:function(o){var l,d=0,n=[];for(d=0;d<o.length;d++)(l=a(o,d))!==!1&&n.push(l);return n}}}(),function(){var a=Array.prototype.slice,o=function(){},l=function(){for(var h in{toString:1})if(h==="toString")return!1;return!0}(),d=function(h,_,f){for(var p in _)p in h.prototype&&typeof h.prototype[p]=="function"&&(_[p]+"").indexOf("callSuper")>-1?h.prototype[p]=function(m){return function(){var C=this.constructor.superclass;this.constructor.superclass=f;var T=_[m].apply(this,arguments);if(this.constructor.superclass=C,m!=="initialize")return T}}(p):h.prototype[p]=_[p],l&&(_.toString!==Object.prototype.toString&&(h.prototype.toString=_.toString),_.valueOf!==Object.prototype.valueOf&&(h.prototype.valueOf=_.valueOf))};function n(){}function s(h){for(var _=null,f=this;f.constructor.superclass;){var p=f.constructor.superclass.prototype[h];if(f[h]!==p){_=p;break}f=f.constructor.superclass.prototype}return _?arguments.length>1?_.apply(this,a.call(arguments,1)):_.call(this):console.log("tried to callSuper "+h+", method not found in prototype chain",this)}y.util.createClass=function(){var h=null,_=a.call(arguments,0);function f(){this.initialize.apply(this,arguments)}typeof _[0]=="function"&&(h=_.shift()),f.superclass=h,f.subclasses=[],h&&(n.prototype=h.prototype,f.prototype=new n,h.subclasses.push(f));for(var p=0,m=_.length;p<m;p++)d(f,_[p],h);return f.prototype.initialize||(f.prototype.initialize=o),f.prototype.constructor=f,f.prototype.callSuper=s,f}}(),S=!!y.document.createElement("div").attachEvent,w=["touchstart","touchmove","touchend"],y.util.addListener=function(a,o,l,d){a&&a.addEventListener(o,l,!S&&d)},y.util.removeListener=function(a,o,l,d){a&&a.removeEventListener(o,l,!S&&d)},y.util.getPointer=function(a){var o=a.target,l=y.util.getScrollLeftTop(o),d=function(n){var s=n.changedTouches;return s&&s[0]?s[0]:n}(a);return{x:d.clientX+l.left,y:d.clientY+l.top}},y.util.isTouchEvent=function(a){return w.indexOf(a.type)>-1||a.pointerType==="touch"},A=typeof(E=y.document.createElement("div")).style.opacity=="string",B=typeof E.style.filter=="string",z=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,q=function(a){return a},A?q=function(a,o){return a.style.opacity=o,a}:B&&(q=function(a,o){var l=a.style;return a.currentStyle&&!a.currentStyle.hasLayout&&(l.zoom=1),z.test(l.filter)?(o=o>=.9999?"":"alpha(opacity="+100*o+")",l.filter=l.filter.replace(z,o)):l.filter+=" alpha(opacity="+100*o+")",a}),y.util.setStyle=function(a,o){var l=a.style;if(!l)return a;if(typeof o=="string")return a.style.cssText+=";"+o,o.indexOf("opacity")>-1?q(a,o.match(/opacity:\s*(\d?\.?\d*)/)[1]):a;for(var d in o)d==="opacity"?q(a,o[d]):l[d==="float"||d==="cssFloat"?l.styleFloat===void 0?"cssFloat":"styleFloat":d]=o[d];return a},function(){var a,o,l,d,n=Array.prototype.slice,s=function(f){return n.call(f,0)};try{a=s(y.document.childNodes)instanceof Array}catch{}function h(f,p){var m=y.document.createElement(f);for(var C in p)C==="class"?m.className=p[C]:C==="for"?m.htmlFor=p[C]:m.setAttribute(C,p[C]);return m}function _(f){for(var p=0,m=0,C=y.document.documentElement,T=y.document.body||{scrollLeft:0,scrollTop:0};f&&(f.parentNode||f.host)&&((f=f.parentNode||f.host)===y.document?(p=T.scrollLeft||C.scrollLeft||0,m=T.scrollTop||C.scrollTop||0):(p+=f.scrollLeft||0,m+=f.scrollTop||0),f.nodeType!==1||f.style.position!=="fixed"););return{left:p,top:m}}a||(s=function(f){for(var p=new Array(f.length),m=f.length;m--;)p[m]=f[m];return p}),o=y.document.defaultView&&y.document.defaultView.getComputedStyle?function(f,p){var m=y.document.defaultView.getComputedStyle(f,null);return m?m[p]:void 0}:function(f,p){var m=f.style[p];return!m&&f.currentStyle&&(m=f.currentStyle[p]),m},l=y.document.documentElement.style,d="userSelect"in l?"userSelect":"MozUserSelect"in l?"MozUserSelect":"WebkitUserSelect"in l?"WebkitUserSelect":"KhtmlUserSelect"in l?"KhtmlUserSelect":"",y.util.makeElementUnselectable=function(f){return f.onselectstart!==void 0&&(f.onselectstart=y.util.falseFunction),d?f.style[d]="none":typeof f.unselectable=="string"&&(f.unselectable="on"),f},y.util.makeElementSelectable=function(f){return f.onselectstart!==void 0&&(f.onselectstart=null),d?f.style[d]="":typeof f.unselectable=="string"&&(f.unselectable=""),f},y.util.setImageSmoothing=function(f,p){f.imageSmoothingEnabled=f.imageSmoothingEnabled||f.webkitImageSmoothingEnabled||f.mozImageSmoothingEnabled||f.msImageSmoothingEnabled||f.oImageSmoothingEnabled,f.imageSmoothingEnabled=p},y.util.getById=function(f){return typeof f=="string"?y.document.getElementById(f):f},y.util.toArray=s,y.util.addClass=function(f,p){f&&(" "+f.className+" ").indexOf(" "+p+" ")===-1&&(f.className+=(f.className?" ":"")+p)},y.util.makeElement=h,y.util.wrapElement=function(f,p,m){return typeof p=="string"&&(p=h(p,m)),f.parentNode&&f.parentNode.replaceChild(p,f),p.appendChild(f),p},y.util.getScrollLeftTop=_,y.util.getElementOffset=function(f){var p,m,C=f&&f.ownerDocument,T={left:0,top:0},x={left:0,top:0},I={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!C)return x;for(var D in I)x[I[D]]+=parseInt(o(f,D),10)||0;return p=C.documentElement,f.getBoundingClientRect!==void 0&&(T=f.getBoundingClientRect()),m=_(f),{left:T.left+m.left-(p.clientLeft||0)+x.left,top:T.top+m.top-(p.clientTop||0)+x.top}},y.util.getNodeCanvas=function(f){var p=y.jsdomImplForWrapper(f);return p._canvas||p._image},y.util.cleanUpJsdomNode=function(f){if(y.isLikelyNode){var p=y.jsdomImplForWrapper(f);p&&(p._image=null,p._canvas=null,p._currentSrc=null,p._attributes=null,p._classList=null)}}}(),function(){function a(){}y.util.request=function(o,l){l||(l={});var d=l.method?l.method.toUpperCase():"GET",n=l.onComplete||function(){},s=new y.window.XMLHttpRequest,h=l.body||l.parameters;return s.onreadystatechange=function(){s.readyState===4&&(n(s),s.onreadystatechange=a)},d==="GET"&&(h=null,typeof l.parameters=="string"&&(o=function(_,f){return _+(/\?/.test(_)?"&":"?")+f}(o,l.parameters))),s.open(d,o,!0),d!=="POST"&&d!=="PUT"||s.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),s.send(h),s}}(),y.log=console.log,y.warn=console.warn,function(){var a=y.util.object.extend,o=y.util.object.clone,l=[];function d(){return!1}function n(f,p,m,C){return-m*Math.cos(f/C*(Math.PI/2))+m+p}y.util.object.extend(l,{cancelAll:function(){var f=this.splice(0);return f.forEach(function(p){p.cancel()}),f},cancelByCanvas:function(f){if(!f)return[];var p=this.filter(function(m){return typeof m.target=="object"&&m.target.canvas===f});return p.forEach(function(m){m.cancel()}),p},cancelByTarget:function(f){var p=this.findAnimationsByTarget(f);return p.forEach(function(m){m.cancel()}),p},findAnimationIndex:function(f){return this.indexOf(this.findAnimation(f))},findAnimation:function(f){return this.find(function(p){return p.cancel===f})},findAnimationsByTarget:function(f){return f?this.filter(function(p){return p.target===f}):[]}});var s=y.window.requestAnimationFrame||y.window.webkitRequestAnimationFrame||y.window.mozRequestAnimationFrame||y.window.oRequestAnimationFrame||y.window.msRequestAnimationFrame||function(f){return y.window.setTimeout(f,1e3/60)},h=y.window.cancelAnimationFrame||y.window.clearTimeout;function _(){return s.apply(y.window,arguments)}y.util.animate=function(f){f||(f={});var p,m=!1,C=function(){var T=y.runningAnimations.indexOf(p);return T>-1&&y.runningAnimations.splice(T,1)[0]};return p=a(o(f),{cancel:function(){return m=!0,C()},currentValue:"startValue"in f?f.startValue:0,completionRate:0,durationRate:0}),y.runningAnimations.push(p),_(function(T){var x,I=T||+new Date,D=f.duration||500,L=I+D,V=f.onChange||d,H=f.abort||d,$=f.onComplete||d,X=f.easing||n,O="startValue"in f&&f.startValue.length>0,R="startValue"in f?f.startValue:0,M="endValue"in f?f.endValue:100,F=f.byValue||(O?R.map(function(j,G){return M[G]-R[G]}):M-R);f.onStart&&f.onStart(),function j(G){var k=(x=G||+new Date)>L?D:x-I,P=k/D,N=O?R.map(function(Y,Q){return X(k,R[Q],F[Q],D)}):X(k,R,F,D),U=Math.abs(O?(N[0]-R[0])/F[0]:(N-R)/F);if(p.currentValue=O?N.slice():N,p.completionRate=U,p.durationRate=P,!m){if(!H(N,U,P))return x>L?(p.currentValue=O?M.slice():M,p.completionRate=1,p.durationRate=1,V(O?M.slice():M,1,1),$(M,1,1),void C()):(V(N,U,P),void _(j));C()}}(I)}),p.cancel},y.util.requestAnimFrame=_,y.util.cancelAnimFrame=function(){return h.apply(y.window,arguments)},y.runningAnimations=l}(),function(){function a(o,l,d){var n="rgba("+parseInt(o[0]+d*(l[0]-o[0]),10)+","+parseInt(o[1]+d*(l[1]-o[1]),10)+","+parseInt(o[2]+d*(l[2]-o[2]),10);return(n+=","+(o&&l?parseFloat(o[3]+d*(l[3]-o[3])):1))+")"}y.util.animateColor=function(o,l,d,n){var s=new y.Color(o).getSource(),h=new y.Color(l).getSource(),_=n.onComplete,f=n.onChange;return n=n||{},y.util.animate(y.util.object.extend(n,{duration:d||500,startValue:s,endValue:h,byValue:h,easing:function(p,m,C,T){return a(m,C,n.colorEasing?n.colorEasing(p,T):1-Math.cos(p/T*(Math.PI/2)))},onComplete:function(p,m,C){if(_)return _(a(h,h,0),m,C)},onChange:function(p,m,C){if(f){if(Array.isArray(p))return f(a(p,p,0),m,C);f(p,m,C)}}}))}}(),function(){function a(n,s,h,_){return n<Math.abs(s)?(n=s,_=h/4):_=s===0&&n===0?h/(2*Math.PI)*Math.asin(1):h/(2*Math.PI)*Math.asin(s/n),{a:n,c:s,p:h,s:_}}function o(n,s,h){return n.a*Math.pow(2,10*(s-=1))*Math.sin((s*h-n.s)*(2*Math.PI)/n.p)}function l(n,s,h,_){return h-d(_-n,0,h,_)+s}function d(n,s,h,_){return(n/=_)<1/2.75?h*(7.5625*n*n)+s:n<2/2.75?h*(7.5625*(n-=1.5/2.75)*n+.75)+s:n<2.5/2.75?h*(7.5625*(n-=2.25/2.75)*n+.9375)+s:h*(7.5625*(n-=2.625/2.75)*n+.984375)+s}y.util.ease={easeInQuad:function(n,s,h,_){return h*(n/=_)*n+s},easeOutQuad:function(n,s,h,_){return-h*(n/=_)*(n-2)+s},easeInOutQuad:function(n,s,h,_){return(n/=_/2)<1?h/2*n*n+s:-h/2*(--n*(n-2)-1)+s},easeInCubic:function(n,s,h,_){return h*(n/=_)*n*n+s},easeOutCubic:function(n,s,h,_){return h*((n=n/_-1)*n*n+1)+s},easeInOutCubic:function(n,s,h,_){return(n/=_/2)<1?h/2*n*n*n+s:h/2*((n-=2)*n*n+2)+s},easeInQuart:function(n,s,h,_){return h*(n/=_)*n*n*n+s},easeOutQuart:function(n,s,h,_){return-h*((n=n/_-1)*n*n*n-1)+s},easeInOutQuart:function(n,s,h,_){return(n/=_/2)<1?h/2*n*n*n*n+s:-h/2*((n-=2)*n*n*n-2)+s},easeInQuint:function(n,s,h,_){return h*(n/=_)*n*n*n*n+s},easeOutQuint:function(n,s,h,_){return h*((n=n/_-1)*n*n*n*n+1)+s},easeInOutQuint:function(n,s,h,_){return(n/=_/2)<1?h/2*n*n*n*n*n+s:h/2*((n-=2)*n*n*n*n+2)+s},easeInSine:function(n,s,h,_){return-h*Math.cos(n/_*(Math.PI/2))+h+s},easeOutSine:function(n,s,h,_){return h*Math.sin(n/_*(Math.PI/2))+s},easeInOutSine:function(n,s,h,_){return-h/2*(Math.cos(Math.PI*n/_)-1)+s},easeInExpo:function(n,s,h,_){return n===0?s:h*Math.pow(2,10*(n/_-1))+s},easeOutExpo:function(n,s,h,_){return n===_?s+h:h*(1-Math.pow(2,-10*n/_))+s},easeInOutExpo:function(n,s,h,_){return n===0?s:n===_?s+h:(n/=_/2)<1?h/2*Math.pow(2,10*(n-1))+s:h/2*(2-Math.pow(2,-10*--n))+s},easeInCirc:function(n,s,h,_){return-h*(Math.sqrt(1-(n/=_)*n)-1)+s},easeOutCirc:function(n,s,h,_){return h*Math.sqrt(1-(n=n/_-1)*n)+s},easeInOutCirc:function(n,s,h,_){return(n/=_/2)<1?-h/2*(Math.sqrt(1-n*n)-1)+s:h/2*(Math.sqrt(1-(n-=2)*n)+1)+s},easeInElastic:function(n,s,h,_){var f=0;return n===0?s:(n/=_)==1?s+h:(f||(f=.3*_),-o(a(h,h,f,1.70158),n,_)+s)},easeOutElastic:function(n,s,h,_){var f=0;if(n===0)return s;if((n/=_)==1)return s+h;f||(f=.3*_);var p=a(h,h,f,1.70158);return p.a*Math.pow(2,-10*n)*Math.sin((n*_-p.s)*(2*Math.PI)/p.p)+p.c+s},easeInOutElastic:function(n,s,h,_){var f=0;if(n===0)return s;if((n/=_/2)==2)return s+h;f||(f=_*(.3*1.5));var p=a(h,h,f,1.70158);return n<1?-.5*o(p,n,_)+s:p.a*Math.pow(2,-10*(n-=1))*Math.sin((n*_-p.s)*(2*Math.PI)/p.p)*.5+p.c+s},easeInBack:function(n,s,h,_,f){return f===void 0&&(f=1.70158),h*(n/=_)*n*((f+1)*n-f)+s},easeOutBack:function(n,s,h,_,f){return f===void 0&&(f=1.70158),h*((n=n/_-1)*n*((f+1)*n+f)+1)+s},easeInOutBack:function(n,s,h,_,f){return f===void 0&&(f=1.70158),(n/=_/2)<1?h/2*(n*n*((1+(f*=1.525))*n-f))+s:h/2*((n-=2)*n*((1+(f*=1.525))*n+f)+2)+s},easeInBounce:l,easeOutBounce:d,easeInOutBounce:function(n,s,h,_){return n<_/2?.5*l(2*n,0,h,_)+s:.5*d(2*n-_,0,h,_)+.5*h+s}}}(),function(a){var o=a.fabric||(a.fabric={}),l=o.util.object.extend,d=o.util.object.clone,n=o.util.toFixed,s=o.util.parseUnit,h=o.util.multiplyTransformMatrices,_={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},f={stroke:"strokeOpacity",fill:"fillOpacity"},p="font-size",m="clip-path";function C(R){return R in _?_[R]:R}function T(R,M,F,j){var G,k=Array.isArray(M);if(R!=="fill"&&R!=="stroke"||M!=="none"){if(R==="strokeUniform")return M==="non-scaling-stroke";if(R==="strokeDashArray")M=M==="none"?null:M.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(R==="transformMatrix")M=F&&F.transformMatrix?h(F.transformMatrix,o.parseTransformAttribute(M)):o.parseTransformAttribute(M);else if(R==="visible")M=M!=="none"&&M!=="hidden",F&&F.visible===!1&&(M=!1);else if(R==="opacity")M=parseFloat(M),F&&F.opacity!==void 0&&(M*=F.opacity);else if(R==="textAnchor")M=M==="start"?"left":M==="end"?"right":"center";else if(R==="charSpacing")G=s(M,j)/j*1e3;else if(R==="paintFirst"){var P=M.indexOf("fill"),N=M.indexOf("stroke");M="fill",(P>-1&&N>-1&&N<P||P===-1&&N>-1)&&(M="stroke")}else{if(R==="href"||R==="xlink:href"||R==="font")return M;if(R==="imageSmoothing")return M==="optimizeQuality";G=k?M.map(s):s(M,j)}}else M="";return!k&&isNaN(G)?M:G}function x(R){return new RegExp("^("+R.join("|")+")\\b","i")}function I(R,M){var F,j,G,k,P=[];for(G=0,k=M.length;G<k;G++)F=M[G],j=R.getElementsByTagName(F),P=P.concat(Array.prototype.slice.call(j));return P}function D(R,M){var F,j=!0;return(F=L(R,M.pop()))&&M.length&&(j=function(G,k){for(var P,N=!0;G.parentNode&&G.parentNode.nodeType===1&&k.length;)N&&(P=k.pop()),N=L(G=G.parentNode,P);return k.length===0}(R,M)),F&&j&&M.length===0}function L(R,M){var F,j,G=R.nodeName,k=R.getAttribute("class"),P=R.getAttribute("id");if(F=new RegExp("^"+G,"i"),M=M.replace(F,""),P&&M.length&&(F=new RegExp("#"+P+"(?![a-zA-Z\\-]+)","i"),M=M.replace(F,"")),k&&M.length)for(j=(k=k.split(" ")).length;j--;)F=new RegExp("\\."+k[j]+"(?![a-zA-Z\\-]+)","i"),M=M.replace(F,"");return M.length===0}function V(R,M){var F;if(R.getElementById&&(F=R.getElementById(M)),F)return F;var j,G,k,P=R.getElementsByTagName("*");for(G=0,k=P.length;G<k;G++)if(M===(j=P[G]).getAttribute("id"))return j}o.svgValidTagNamesRegEx=x(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),o.svgViewBoxElementsRegEx=x(["symbol","image","marker","pattern","view","svg"]),o.svgInvalidAncestorsRegEx=x(["pattern","defs","symbol","metadata","clipPath","mask","desc"]),o.svgValidParentsRegEx=x(["symbol","g","a","svg","clipPath","defs"]),o.cssRules={},o.gradientDefs={},o.clipPaths={},o.parseTransformAttribute=function(){function R(N,U,Y){N[Y]=Math.tan(o.util.degreesToRadians(U[0]))}var M=o.iMatrix,F=o.reNum,j=o.commaWsp,G="(?:(?:(matrix)\\s*\\(\\s*("+F+")"+j+"("+F+")"+j+"("+F+")"+j+"("+F+")"+j+"("+F+")"+j+"("+F+")\\s*\\))|(?:(translate)\\s*\\(\\s*("+F+")(?:"+j+"("+F+"))?\\s*\\))|(?:(scale)\\s*\\(\\s*("+F+")(?:"+j+"("+F+"))?\\s*\\))|(?:(rotate)\\s*\\(\\s*("+F+")(?:"+j+"("+F+")"+j+"("+F+"))?\\s*\\))|(?:(skewX)\\s*\\(\\s*("+F+")\\s*\\))|(?:(skewY)\\s*\\(\\s*("+F+")\\s*\\)))",k=new RegExp("^\\s*(?:(?:"+G+"(?:"+j+"*"+G+")*)?)\\s*$"),P=new RegExp(G,"g");return function(N){var U=M.concat(),Y=[];if(!N||N&&!k.test(N))return U;N.replace(P,function(ie){var re=new RegExp(G).exec(ie).filter(function(se){return!!se}),ne=re[1],ae=re.slice(2).map(parseFloat);switch(ne){case"translate":(function(se,ue){se[4]=ue[0],ue.length===2&&(se[5]=ue[1])})(U,ae);break;case"rotate":ae[0]=o.util.degreesToRadians(ae[0]),function(se,ue){var me=o.util.cos(ue[0]),ge=o.util.sin(ue[0]),Ce=0,Te=0;ue.length===3&&(Ce=ue[1],Te=ue[2]),se[0]=me,se[1]=ge,se[2]=-ge,se[3]=me,se[4]=Ce-(me*Ce-ge*Te),se[5]=Te-(ge*Ce+me*Te)}(U,ae);break;case"scale":(function(se,ue){var me=ue[0],ge=ue.length===2?ue[1]:ue[0];se[0]=me,se[3]=ge})(U,ae);break;case"skewX":R(U,ae,2);break;case"skewY":R(U,ae,1);break;case"matrix":U=ae}Y.push(U.concat()),U=M.concat()});for(var Q=Y[0];Y.length>1;)Y.shift(),Q=o.util.multiplyTransformMatrices(Q,Y[0]);return Q}}();var H=new RegExp("^\\s*("+o.reNum+"+)\\s*,?\\s*("+o.reNum+"+)\\s*,?\\s*("+o.reNum+"+)\\s*,?\\s*("+o.reNum+"+)\\s*$");function $(R){if(!o.svgViewBoxElementsRegEx.test(R.nodeName))return{};var M,F,j,G,k,P,N=R.getAttribute("viewBox"),U=1,Y=1,Q=R.getAttribute("width"),ie=R.getAttribute("height"),re=R.getAttribute("x")||0,ne=R.getAttribute("y")||0,ae=R.getAttribute("preserveAspectRatio")||"",se=!N||!(N=N.match(H)),ue=!Q||!ie||Q==="100%"||ie==="100%",me=se&&ue,ge={},Ce="",Te=0,Qe=0;if(ge.width=0,ge.height=0,ge.toBeParsed=me,se&&(re||ne)&&R.parentNode&&R.parentNode.nodeName!=="#document"&&(Ce=" translate("+s(re)+" "+s(ne)+") ",k=(R.getAttribute("transform")||"")+Ce,R.setAttribute("transform",k),R.removeAttribute("x"),R.removeAttribute("y")),me)return ge;if(se)return ge.width=s(Q),ge.height=s(ie),ge;if(M=-parseFloat(N[1]),F=-parseFloat(N[2]),j=parseFloat(N[3]),G=parseFloat(N[4]),ge.minX=M,ge.minY=F,ge.viewBoxWidth=j,ge.viewBoxHeight=G,ue?(ge.width=j,ge.height=G):(ge.width=s(Q),ge.height=s(ie),U=ge.width/j,Y=ge.height/G),(ae=o.util.parsePreserveAspectRatioAttribute(ae)).alignX!=="none"&&(ae.meetOrSlice==="meet"&&(Y=U=U>Y?Y:U),ae.meetOrSlice==="slice"&&(Y=U=U>Y?U:Y),Te=ge.width-j*U,Qe=ge.height-G*U,ae.alignX==="Mid"&&(Te/=2),ae.alignY==="Mid"&&(Qe/=2),ae.alignX==="Min"&&(Te=0),ae.alignY==="Min"&&(Qe=0)),U===1&&Y===1&&M===0&&F===0&&re===0&&ne===0)return ge;if((re||ne)&&R.parentNode.nodeName!=="#document"&&(Ce=" translate("+s(re)+" "+s(ne)+") "),k=Ce+" matrix("+U+" 0 0 "+Y+" "+(M*U+Te)+" "+(F*Y+Qe)+") ",R.nodeName==="svg"){for(P=R.ownerDocument.createElementNS(o.svgNS,"g");R.firstChild;)P.appendChild(R.firstChild);R.appendChild(P)}else(P=R).removeAttribute("x"),P.removeAttribute("y"),k=P.getAttribute("transform")+k;return P.setAttribute("transform",k),ge}function X(R,M){var F="xlink:href",j=V(R,M.getAttribute(F).slice(1));if(j&&j.getAttribute(F)&&X(R,j),["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"].forEach(function(k){j&&!M.hasAttribute(k)&&j.hasAttribute(k)&&M.setAttribute(k,j.getAttribute(k))}),!M.children.length)for(var G=j.cloneNode(!0);G.firstChild;)M.appendChild(G.firstChild);M.removeAttribute(F)}o.parseSVGDocument=function(R,M,F,j){if(R){(function(re){for(var ne=I(re,["use","svg:use"]),ae=0;ne.length&&ae<ne.length;){var se=ne[ae],ue=se.getAttribute("xlink:href")||se.getAttribute("href");if(ue===null)return;var me,ge,Ce,Te,Qe=ue.slice(1),Le=se.getAttribute("x")||0,Xe=se.getAttribute("y")||0,Re=V(re,Qe).cloneNode(!0),ct=(Re.getAttribute("transform")||"")+" translate("+Le+", "+Xe+")",Hi=ne.length,Ei=o.svgNS;if($(Re),/^svg$/i.test(Re.nodeName)){var ti=Re.ownerDocument.createElementNS(Ei,"g");for(ge=0,Te=(Ce=Re.attributes).length;ge<Te;ge++)me=Ce.item(ge),ti.setAttributeNS(Ei,me.nodeName,me.nodeValue);for(;Re.firstChild;)ti.appendChild(Re.firstChild);Re=ti}for(ge=0,Te=(Ce=se.attributes).length;ge<Te;ge++)(me=Ce.item(ge)).nodeName!=="x"&&me.nodeName!=="y"&&me.nodeName!=="xlink:href"&&me.nodeName!=="href"&&(me.nodeName==="transform"?ct=me.nodeValue+" "+ct:Re.setAttribute(me.nodeName,me.nodeValue));Re.setAttribute("transform",ct),Re.setAttribute("instantiated_by_use","1"),Re.removeAttribute("id"),se.parentNode.replaceChild(Re,se),ne.length===Hi&&ae++}})(R);var G,k,P=o.Object.__uid++,N=$(R),U=o.util.toArray(R.getElementsByTagName("*"));if(N.crossOrigin=j&&j.crossOrigin,N.svgUid=P,U.length===0&&o.isLikelyNode){var Y=[];for(G=0,k=(U=R.selectNodes('//*[name(.)!="svg"]')).length;G<k;G++)Y[G]=U[G];U=Y}var Q=U.filter(function(re){return $(re),o.svgValidTagNamesRegEx.test(re.nodeName.replace("svg:",""))&&!function(ne,ae){for(;ne&&(ne=ne.parentNode);)if(ne.nodeName&&ae.test(ne.nodeName.replace("svg:",""))&&!ne.getAttribute("instantiated_by_use"))return!0;return!1}(re,o.svgInvalidAncestorsRegEx)});if(!Q||Q&&!Q.length)M&&M([],{});else{var ie={};U.filter(function(re){return re.nodeName.replace("svg:","")==="clipPath"}).forEach(function(re){var ne=re.getAttribute("id");ie[ne]=o.util.toArray(re.getElementsByTagName("*")).filter(function(ae){return o.svgValidTagNamesRegEx.test(ae.nodeName.replace("svg:",""))})}),o.gradientDefs[P]=o.getGradientDefs(R),o.cssRules[P]=o.getCSSRules(R),o.clipPaths[P]=ie,o.parseElements(Q,function(re,ne){M&&(M(re,N,ne,U),delete o.gradientDefs[P],delete o.cssRules[P],delete o.clipPaths[P])},d(N),F,j)}}};var O=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+o.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+o.reNum+"))?\\s+(.*)");l(o,{parseFontDeclaration:function(R,M){var F=R.match(O);if(F){var j=F[1],G=F[3],k=F[4],P=F[5],N=F[6];j&&(M.fontStyle=j),G&&(M.fontWeight=isNaN(parseFloat(G))?G:parseFloat(G)),k&&(M.fontSize=s(k)),N&&(M.fontFamily=N),P&&(M.lineHeight=P==="normal"?1:P)}},getGradientDefs:function(R){var M,F=I(R,["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"]),j=0,G={};for(j=F.length;j--;)(M=F[j]).getAttribute("xlink:href")&&X(R,M),G[M.getAttribute("id")]=M;return G},parseAttributes:function(R,M,F){if(R){var j,G,k,P={};F===void 0&&(F=R.getAttribute("svgUid")),R.parentNode&&o.svgValidParentsRegEx.test(R.parentNode.nodeName)&&(P=o.parseAttributes(R.parentNode,M,F));var N=M.reduce(function(ae,se){return(j=R.getAttribute(se))&&(ae[se]=j),ae},{}),U=l(function(ae,se){var ue={};for(var me in o.cssRules[se])if(D(ae,me.split(" ")))for(var ge in o.cssRules[se][me])ue[ge]=o.cssRules[se][me][ge];return ue}(R,F),o.parseStyleAttribute(R));N=l(N,U),U[m]&&R.setAttribute(m,U[m]),G=k=P.fontSize||o.Text.DEFAULT_SVG_FONT_SIZE,N[p]&&(N[p]=G=s(N[p],k));var Y,Q,ie={};for(var re in N)Q=T(Y=C(re),N[re],P,G),ie[Y]=Q;ie&&ie.font&&o.parseFontDeclaration(ie.font,ie);var ne=l(P,ie);return o.svgValidParentsRegEx.test(R.nodeName)?ne:function(ae){for(var se in f)if(ae[f[se]]!==void 0&&ae[se]!==""){if(ae[se]===void 0){if(!o.Object.prototype[se])continue;ae[se]=o.Object.prototype[se]}if(ae[se].indexOf("url(")!==0){var ue=new o.Color(ae[se]);ae[se]=ue.setAlpha(n(ue.getAlpha()*ae[f[se]],2)).toRgba()}}return ae}(ne)}},parseElements:function(R,M,F,j,G){new o.ElementsParser(R,M,F,j,G).parse()},parseStyleAttribute:function(R){var M={},F=R.getAttribute("style");return F&&(typeof F=="string"?function(j,G){var k,P;j.replace(/;\s*$/,"").split(";").forEach(function(N){var U=N.split(":");k=U[0].trim().toLowerCase(),P=U[1].trim(),G[k]=P})}(F,M):function(j,G){var k,P;for(var N in j)j[N]!==void 0&&(k=N.toLowerCase(),P=j[N],G[k]=P)}(F,M)),M},parsePointsAttribute:function(R){if(!R)return null;var M,F,j=[];for(M=0,F=(R=(R=R.replace(/,/g," ").trim()).split(/\s+/)).length;M<F;M+=2)j.push({x:parseFloat(R[M]),y:parseFloat(R[M+1])});return j},getCSSRules:function(R){var M,F,j=R.getElementsByTagName("style"),G={};for(M=0,F=j.length;M<F;M++){var k=j[M].textContent;(k=k.replace(/\/\*[\s\S]*?\*\//g,"")).trim()!==""&&k.split("}").filter(function(P){return P.trim()}).forEach(function(P){var N=P.split("{"),U={},Y=N[1].trim().split(";").filter(function(ne){return ne.trim()});for(M=0,F=Y.length;M<F;M++){var Q=Y[M].split(":"),ie=Q[0].trim(),re=Q[1].trim();U[ie]=re}(P=N[0].trim()).split(",").forEach(function(ne){(ne=ne.replace(/^svg/i,"").trim())!==""&&(G[ne]?o.util.object.extend(G[ne],U):G[ne]=o.util.object.clone(U))})})}return G},loadSVGFromURL:function(R,M,F,j){R=R.replace(/^\n\s*/,"").trim(),new o.util.request(R,{method:"get",onComplete:function(G){var k=G.responseXML;if(!k||!k.documentElement)return M&&M(null),!1;o.parseSVGDocument(k.documentElement,function(P,N,U,Y){M&&M(P,N,U,Y)},F,j)}})},loadSVGFromString:function(R,M,F,j){var G=new o.window.DOMParser().parseFromString(R.trim(),"text/xml");o.parseSVGDocument(G.documentElement,function(k,P,N,U){M(k,P,N,U)},F,j)}})}(t),y.ElementsParser=function(a,o,l,d,n,s){this.elements=a,this.callback=o,this.options=l,this.reviver=d,this.svgUid=l&&l.svgUid||0,this.parsingOptions=n,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=s},(J=y.ElementsParser.prototype).parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},J.createObjects=function(){var a=this;this.elements.forEach(function(o,l){o.setAttribute("svgUid",a.svgUid),a.createObject(o,l)})},J.findTag=function(a){return y[y.util.string.capitalize(a.tagName.replace("svg:",""))]},J.createObject=function(a,o){var l=this.findTag(a);if(l&&l.fromElement)try{l.fromElement(a,this.createCallback(o,a),this.options)}catch(d){y.log(d)}else this.checkIfDone()},J.createCallback=function(a,o){var l=this;return function(d){var n;l.resolveGradient(d,o,"fill"),l.resolveGradient(d,o,"stroke"),d instanceof y.Image&&d._originalElement&&(n=d.parsePreserveAspectRatioAttribute(o)),d._removeTransformMatrix(n),l.resolveClipPath(d,o),l.reviver&&l.reviver(o,d),l.instances[a]=d,l.checkIfDone()}},J.extractPropertyDefinition=function(a,o,l){var d=a[o],n=this.regexUrl;if(n.test(d)){n.lastIndex=0;var s=n.exec(d)[1];return n.lastIndex=0,y[l][this.svgUid][s]}},J.resolveGradient=function(a,o,l){var d=this.extractPropertyDefinition(a,l,"gradientDefs");if(d){var n=o.getAttribute(l+"-opacity"),s=y.Gradient.fromElement(d,a,n,this.options);a.set(l,s)}},J.createClipPathCallback=function(a,o){return function(l){l._removeTransformMatrix(),l.fillRule=l.clipRule,o.push(l)}},J.resolveClipPath=function(a,o){var l,d,n,s,h=this.extractPropertyDefinition(a,"clipPath","clipPaths");if(h){n=[],d=y.util.invertTransform(a.calcTransformMatrix());for(var _=h[0].parentNode,f=o;f.parentNode&&f.getAttribute("clip-path")!==a.clipPath;)f=f.parentNode;f.parentNode.appendChild(_);for(var p=0;p<h.length;p++)l=h[p],this.findTag(l).fromElement(l,this.createClipPathCallback(a,n),this.options);h=n.length===1?n[0]:new y.Group(n),s=y.util.multiplyTransformMatrices(d,h.calcTransformMatrix()),h.clipPath&&this.resolveClipPath(h,f);var m=y.util.qrDecompose(s);h.flipX=!1,h.flipY=!1,h.set("scaleX",m.scaleX),h.set("scaleY",m.scaleY),h.angle=m.angle,h.skewX=m.skewX,h.skewY=0,h.setPositionByOrigin({x:m.translateX,y:m.translateY},"center","center"),a.clipPath=h}else delete a.clipPath},J.checkIfDone=function(){--this.numElements==0&&(this.instances=this.instances.filter(function(a){return a!=null}),this.callback(this.instances,this.elements))},function(a){var o=a.fabric||(a.fabric={});function l(d,n){this.x=d,this.y=n}o.Point?o.warn("fabric.Point is already defined"):(o.Point=l,l.prototype={type:"point",constructor:l,add:function(d){return new l(this.x+d.x,this.y+d.y)},addEquals:function(d){return this.x+=d.x,this.y+=d.y,this},scalarAdd:function(d){return new l(this.x+d,this.y+d)},scalarAddEquals:function(d){return this.x+=d,this.y+=d,this},subtract:function(d){return new l(this.x-d.x,this.y-d.y)},subtractEquals:function(d){return this.x-=d.x,this.y-=d.y,this},scalarSubtract:function(d){return new l(this.x-d,this.y-d)},scalarSubtractEquals:function(d){return this.x-=d,this.y-=d,this},multiply:function(d){return new l(this.x*d,this.y*d)},multiplyEquals:function(d){return this.x*=d,this.y*=d,this},divide:function(d){return new l(this.x/d,this.y/d)},divideEquals:function(d){return this.x/=d,this.y/=d,this},eq:function(d){return this.x===d.x&&this.y===d.y},lt:function(d){return this.x<d.x&&this.y<d.y},lte:function(d){return this.x<=d.x&&this.y<=d.y},gt:function(d){return this.x>d.x&&this.y>d.y},gte:function(d){return this.x>=d.x&&this.y>=d.y},lerp:function(d,n){return n===void 0&&(n=.5),n=Math.max(Math.min(1,n),0),new l(this.x+(d.x-this.x)*n,this.y+(d.y-this.y)*n)},distanceFrom:function(d){var n=this.x-d.x,s=this.y-d.y;return Math.sqrt(n*n+s*s)},midPointFrom:function(d){return this.lerp(d)},min:function(d){return new l(Math.min(this.x,d.x),Math.min(this.y,d.y))},max:function(d){return new l(Math.max(this.x,d.x),Math.max(this.y,d.y))},toString:function(){return this.x+","+this.y},setXY:function(d,n){return this.x=d,this.y=n,this},setX:function(d){return this.x=d,this},setY:function(d){return this.y=d,this},setFromPoint:function(d){return this.x=d.x,this.y=d.y,this},swap:function(d){var n=this.x,s=this.y;this.x=d.x,this.y=d.y,d.x=n,d.y=s},clone:function(){return new l(this.x,this.y)}})}(t),function(a){var o=a.fabric||(a.fabric={});function l(d){this.status=d,this.points=[]}o.Intersection?o.warn("fabric.Intersection is already defined"):(o.Intersection=l,o.Intersection.prototype={constructor:l,appendPoint:function(d){return this.points.push(d),this},appendPoints:function(d){return this.points=this.points.concat(d),this}},o.Intersection.intersectLineLine=function(d,n,s,h){var _,f=(h.x-s.x)*(d.y-s.y)-(h.y-s.y)*(d.x-s.x),p=(n.x-d.x)*(d.y-s.y)-(n.y-d.y)*(d.x-s.x),m=(h.y-s.y)*(n.x-d.x)-(h.x-s.x)*(n.y-d.y);if(m!==0){var C=f/m,T=p/m;0<=C&&C<=1&&0<=T&&T<=1?(_=new l("Intersection")).appendPoint(new o.Point(d.x+C*(n.x-d.x),d.y+C*(n.y-d.y))):_=new l}else _=new l(f===0||p===0?"Coincident":"Parallel");return _},o.Intersection.intersectLinePolygon=function(d,n,s){var h,_,f,p,m=new l,C=s.length;for(p=0;p<C;p++)h=s[p],_=s[(p+1)%C],f=l.intersectLineLine(d,n,h,_),m.appendPoints(f.points);return m.points.length>0&&(m.status="Intersection"),m},o.Intersection.intersectPolygonPolygon=function(d,n){var s,h=new l,_=d.length;for(s=0;s<_;s++){var f=d[s],p=d[(s+1)%_],m=l.intersectLinePolygon(f,p,n);h.appendPoints(m.points)}return h.points.length>0&&(h.status="Intersection"),h},o.Intersection.intersectPolygonRectangle=function(d,n,s){var h=n.min(s),_=n.max(s),f=new o.Point(_.x,h.y),p=new o.Point(h.x,_.y),m=l.intersectLinePolygon(h,f,d),C=l.intersectLinePolygon(f,_,d),T=l.intersectLinePolygon(_,p,d),x=l.intersectLinePolygon(p,h,d),I=new l;return I.appendPoints(m.points),I.appendPoints(C.points),I.appendPoints(T.points),I.appendPoints(x.points),I.points.length>0&&(I.status="Intersection"),I})}(t),function(a){var o=a.fabric||(a.fabric={});function l(n){n?this._tryParsingColor(n):this.setSource([0,0,0,1])}function d(n,s,h){return h<0&&(h+=1),h>1&&(h-=1),h<1/6?n+6*(s-n)*h:h<.5?s:h<2/3?n+(s-n)*(2/3-h)*6:n}o.Color?o.warn("fabric.Color is already defined."):(o.Color=l,o.Color.prototype={_tryParsingColor:function(n){var s;n in l.colorNameMap&&(n=l.colorNameMap[n]),n==="transparent"&&(s=[255,255,255,0]),s||(s=l.sourceFromHex(n)),s||(s=l.sourceFromRgb(n)),s||(s=l.sourceFromHsl(n)),s||(s=[0,0,0,1]),s&&this.setSource(s)},_rgbToHsl:function(n,s,h){n/=255,s/=255,h/=255;var _,f,p,m=o.util.array.max([n,s,h]),C=o.util.array.min([n,s,h]);if(p=(m+C)/2,m===C)_=f=0;else{var T=m-C;switch(f=p>.5?T/(2-m-C):T/(m+C),m){case n:_=(s-h)/T+(s<h?6:0);break;case s:_=(h-n)/T+2;break;case h:_=(n-s)/T+4}_/=6}return[Math.round(360*_),Math.round(100*f),Math.round(100*p)]},getSource:function(){return this._source},setSource:function(n){this._source=n},toRgb:function(){var n=this.getSource();return"rgb("+n[0]+","+n[1]+","+n[2]+")"},toRgba:function(){var n=this.getSource();return"rgba("+n[0]+","+n[1]+","+n[2]+","+n[3]+")"},toHsl:function(){var n=this.getSource(),s=this._rgbToHsl(n[0],n[1],n[2]);return"hsl("+s[0]+","+s[1]+"%,"+s[2]+"%)"},toHsla:function(){var n=this.getSource(),s=this._rgbToHsl(n[0],n[1],n[2]);return"hsla("+s[0]+","+s[1]+"%,"+s[2]+"%,"+n[3]+")"},toHex:function(){var n,s,h,_=this.getSource();return n=(n=_[0].toString(16)).length===1?"0"+n:n,s=(s=_[1].toString(16)).length===1?"0"+s:s,h=(h=_[2].toString(16)).length===1?"0"+h:h,n.toUpperCase()+s.toUpperCase()+h.toUpperCase()},toHexa:function(){var n,s=this.getSource();return n=(n=(n=Math.round(255*s[3])).toString(16)).length===1?"0"+n:n,this.toHex()+n.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(n){var s=this.getSource();return s[3]=n,this.setSource(s),this},toGrayscale:function(){var n=this.getSource(),s=parseInt((.3*n[0]+.59*n[1]+.11*n[2]).toFixed(0),10),h=n[3];return this.setSource([s,s,s,h]),this},toBlackWhite:function(n){var s=this.getSource(),h=(.3*s[0]+.59*s[1]+.11*s[2]).toFixed(0),_=s[3];return n=n||127,h=Number(h)<Number(n)?0:255,this.setSource([h,h,h,_]),this},overlayWith:function(n){n instanceof l||(n=new l(n));var s,h=[],_=this.getAlpha(),f=this.getSource(),p=n.getSource();for(s=0;s<3;s++)h.push(Math.round(.5*f[s]+.5*p[s]));return h[3]=_,this.setSource(h),this}},o.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,o.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,o.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,o.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"},o.Color.fromRgb=function(n){return l.fromSource(l.sourceFromRgb(n))},o.Color.sourceFromRgb=function(n){var s=n.match(l.reRGBa);if(s){var h=parseInt(s[1],10)/(/%$/.test(s[1])?100:1)*(/%$/.test(s[1])?255:1),_=parseInt(s[2],10)/(/%$/.test(s[2])?100:1)*(/%$/.test(s[2])?255:1),f=parseInt(s[3],10)/(/%$/.test(s[3])?100:1)*(/%$/.test(s[3])?255:1);return[parseInt(h,10),parseInt(_,10),parseInt(f,10),s[4]?parseFloat(s[4]):1]}},o.Color.fromRgba=l.fromRgb,o.Color.fromHsl=function(n){return l.fromSource(l.sourceFromHsl(n))},o.Color.sourceFromHsl=function(n){var s=n.match(l.reHSLa);if(s){var h,_,f,p=(parseFloat(s[1])%360+360)%360/360,m=parseFloat(s[2])/(/%$/.test(s[2])?100:1),C=parseFloat(s[3])/(/%$/.test(s[3])?100:1);if(m===0)h=_=f=C;else{var T=C<=.5?C*(m+1):C+m-C*m,x=2*C-T;h=d(x,T,p+1/3),_=d(x,T,p),f=d(x,T,p-1/3)}return[Math.round(255*h),Math.round(255*_),Math.round(255*f),s[4]?parseFloat(s[4]):1]}},o.Color.fromHsla=l.fromHsl,o.Color.fromHex=function(n){return l.fromSource(l.sourceFromHex(n))},o.Color.sourceFromHex=function(n){if(n.match(l.reHex)){var s=n.slice(n.indexOf("#")+1),h=s.length===3||s.length===4,_=s.length===8||s.length===4,f=h?s.charAt(0)+s.charAt(0):s.substring(0,2),p=h?s.charAt(1)+s.charAt(1):s.substring(2,4),m=h?s.charAt(2)+s.charAt(2):s.substring(4,6),C=_?h?s.charAt(3)+s.charAt(3):s.substring(6,8):"FF";return[parseInt(f,16),parseInt(p,16),parseInt(m,16),parseFloat((parseInt(C,16)/255).toFixed(2))]}},o.Color.fromSource=function(n){var s=new l;return s.setSource(n),s})}(t),function(a){var o=a.fabric||(a.fabric={}),l=["e","se","s","sw","w","nw","n","ne","e"],d=["ns","nesw","ew","nwse"],n={},s="left",h="top",_="right",f="bottom",p="center",m={top:f,bottom:h,left:_,right:s,center:p},C=o.util.radiansToDegrees,T=Math.sign||function(k){return(k>0)-(k<0)||+k};function x(k,P){var N=k.angle+C(Math.atan2(P.y,P.x))+360;return Math.round(N%360/45)}function I(k,P){var N=P.transform.target,U=N.canvas,Y=o.util.object.clone(P);Y.target=N,U&&U.fire("object:"+k,Y),N.fire(k,P)}function D(k,P){var N=P.canvas,U=k[N.uniScaleKey];return N.uniformScaling&&!U||!N.uniformScaling&&U}function L(k){return k.originX===p&&k.originY===p}function V(k,P,N){var U=k.lockScalingX,Y=k.lockScalingY;return!((!U||!Y)&&(P||!U&&!Y||!N)&&(!U||P!=="x")&&(!Y||P!=="y"))}function H(k,P,N,U){return{e:k,transform:P,pointer:{x:N,y:U}}}function $(k){return function(P,N,U,Y){var Q=N.target,ie=Q.getCenterPoint(),re=Q.translateToOriginPoint(ie,N.originX,N.originY),ne=k(P,N,U,Y);return Q.setPositionByOrigin(re,N.originX,N.originY),ne}}function X(k,P){return function(N,U,Y,Q){var ie=P(N,U,Y,Q);return ie&&I(k,H(N,U,Y,Q)),ie}}function O(k,P,N,U,Y){var Q=k.target,ie=Q.controls[k.corner],re=Q.canvas.getZoom(),ne=Q.padding/re,ae=Q.toLocalPoint(new o.Point(U,Y),P,N);return ae.x>=ne&&(ae.x-=ne),ae.x<=-ne&&(ae.x+=ne),ae.y>=ne&&(ae.y-=ne),ae.y<=ne&&(ae.y+=ne),ae.x-=ie.offsetX,ae.y-=ie.offsetY,ae}function R(k){return k.flipX!==k.flipY}function M(k,P,N,U,Y){if(k[P]!==0){var Q=Y/k._getTransformedDimensions()[U]*k[N];k.set(N,Q)}}function F(k,P,N,U){var Y,Q=P.target,ie=Q._getTransformedDimensions(0,Q.skewY),re=O(P,P.originX,P.originY,N,U),ne=Math.abs(2*re.x)-ie.x,ae=Q.skewX;ne<2?Y=0:(Y=C(Math.atan2(ne/Q.scaleX,ie.y/Q.scaleY)),P.originX===s&&P.originY===f&&(Y=-Y),P.originX===_&&P.originY===h&&(Y=-Y),R(Q)&&(Y=-Y));var se=ae!==Y;if(se){var ue=Q._getTransformedDimensions().y;Q.set("skewX",Y),M(Q,"skewY","scaleY","y",ue)}return se}function j(k,P,N,U){var Y,Q=P.target,ie=Q._getTransformedDimensions(Q.skewX,0),re=O(P,P.originX,P.originY,N,U),ne=Math.abs(2*re.y)-ie.y,ae=Q.skewY;ne<2?Y=0:(Y=C(Math.atan2(ne/Q.scaleY,ie.x/Q.scaleX)),P.originX===s&&P.originY===f&&(Y=-Y),P.originX===_&&P.originY===h&&(Y=-Y),R(Q)&&(Y=-Y));var se=ae!==Y;if(se){var ue=Q._getTransformedDimensions().x;Q.set("skewY",Y),M(Q,"skewX","scaleX","x",ue)}return se}function G(k,P,N,U,Y){Y=Y||{};var Q,ie,re,ne,ae,se,ue=P.target,me=ue.lockScalingX,ge=ue.lockScalingY,Ce=Y.by,Te=D(k,ue),Qe=V(ue,Ce,Te),Le=P.gestureScale;if(Qe)return!1;if(Le)ie=P.scaleX*Le,re=P.scaleY*Le;else{if(Q=O(P,P.originX,P.originY,N,U),ae=Ce!=="y"?T(Q.x):1,se=Ce!=="x"?T(Q.y):1,P.signX||(P.signX=ae),P.signY||(P.signY=se),ue.lockScalingFlip&&(P.signX!==ae||P.signY!==se))return!1;if(ne=ue._getTransformedDimensions(),Te&&!Ce){var Xe=Math.abs(Q.x)+Math.abs(Q.y),Re=P.original,ct=Xe/(Math.abs(ne.x*Re.scaleX/ue.scaleX)+Math.abs(ne.y*Re.scaleY/ue.scaleY));ie=Re.scaleX*ct,re=Re.scaleY*ct}else ie=Math.abs(Q.x*ue.scaleX/ne.x),re=Math.abs(Q.y*ue.scaleY/ne.y);L(P)&&(ie*=2,re*=2),P.signX!==ae&&Ce!=="y"&&(P.originX=m[P.originX],ie*=-1,P.signX=ae),P.signY!==se&&Ce!=="x"&&(P.originY=m[P.originY],re*=-1,P.signY=se)}var Hi=ue.scaleX,Ei=ue.scaleY;return Ce?(Ce==="x"&&ue.set("scaleX",ie),Ce==="y"&&ue.set("scaleY",re)):(!me&&ue.set("scaleX",ie),!ge&&ue.set("scaleY",re)),Hi!==ue.scaleX||Ei!==ue.scaleY}n.scaleCursorStyleHandler=function(k,P,N){var U=D(k,N),Y="";if(P.x!==0&&P.y===0?Y="x":P.x===0&&P.y!==0&&(Y="y"),V(N,Y,U))return"not-allowed";var Q=x(N,P);return l[Q]+"-resize"},n.skewCursorStyleHandler=function(k,P,N){var U="not-allowed";if(P.x!==0&&N.lockSkewingY||P.y!==0&&N.lockSkewingX)return U;var Y=x(N,P)%4;return d[Y]+"-resize"},n.scaleSkewCursorStyleHandler=function(k,P,N){return k[N.canvas.altActionKey]?n.skewCursorStyleHandler(k,P,N):n.scaleCursorStyleHandler(k,P,N)},n.rotationWithSnapping=X("rotating",$(function(k,P,N,U){var Y=P,Q=Y.target,ie=Q.translateToOriginPoint(Q.getCenterPoint(),Y.originX,Y.originY);if(Q.lockRotation)return!1;var re,ne=Math.atan2(Y.ey-ie.y,Y.ex-ie.x),ae=Math.atan2(U-ie.y,N-ie.x),se=C(ae-ne+Y.theta);if(Q.snapAngle>0){var ue=Q.snapAngle,me=Q.snapThreshold||ue,ge=Math.ceil(se/ue)*ue,Ce=Math.floor(se/ue)*ue;Math.abs(se-Ce)<me?se=Ce:Math.abs(se-ge)<me&&(se=ge)}return se<0&&(se=360+se),se%=360,re=Q.angle!==se,Q.angle=se,re})),n.scalingEqually=X("scaling",$(function(k,P,N,U){return G(k,P,N,U)})),n.scalingX=X("scaling",$(function(k,P,N,U){return G(k,P,N,U,{by:"x"})})),n.scalingY=X("scaling",$(function(k,P,N,U){return G(k,P,N,U,{by:"y"})})),n.scalingYOrSkewingX=function(k,P,N,U){return k[P.target.canvas.altActionKey]?n.skewHandlerX(k,P,N,U):n.scalingY(k,P,N,U)},n.scalingXOrSkewingY=function(k,P,N,U){return k[P.target.canvas.altActionKey]?n.skewHandlerY(k,P,N,U):n.scalingX(k,P,N,U)},n.changeWidth=X("resizing",$(function(k,P,N,U){var Y=P.target,Q=O(P,P.originX,P.originY,N,U),ie=Y.strokeWidth/(Y.strokeUniform?Y.scaleX:1),re=L(P)?2:1,ne=Y.width,ae=Math.abs(Q.x*re/Y.scaleX)-ie;return Y.set("width",Math.max(ae,0)),ne!==ae})),n.skewHandlerX=function(k,P,N,U){var Y,Q=P.target,ie=Q.skewX,re=P.originY;return!Q.lockSkewingX&&(ie===0?Y=O(P,p,p,N,U).x>0?s:_:(ie>0&&(Y=re===h?s:_),ie<0&&(Y=re===h?_:s),R(Q)&&(Y=Y===s?_:s)),P.originX=Y,X("skewing",$(F))(k,P,N,U))},n.skewHandlerY=function(k,P,N,U){var Y,Q=P.target,ie=Q.skewY,re=P.originX;return!Q.lockSkewingY&&(ie===0?Y=O(P,p,p,N,U).y>0?h:f:(ie>0&&(Y=re===s?h:f),ie<0&&(Y=re===s?f:h),R(Q)&&(Y=Y===h?f:h)),P.originY=Y,X("skewing",$(j))(k,P,N,U))},n.dragHandler=function(k,P,N,U){var Y=P.target,Q=N-P.offsetX,ie=U-P.offsetY,re=!Y.get("lockMovementX")&&Y.left!==Q,ne=!Y.get("lockMovementY")&&Y.top!==ie;return re&&Y.set("left",Q),ne&&Y.set("top",ie),(re||ne)&&I("moving",H(k,P,N,U)),re||ne},n.scaleOrSkewActionName=function(k,P,N){var U=k[N.canvas.altActionKey];return P.x===0?U?"skewX":"scaleY":P.y===0?U?"skewY":"scaleX":void 0},n.rotationStyleHandler=function(k,P,N){return N.lockRotation?"not-allowed":P.cursorStyle},n.fireEvent=I,n.wrapWithFixedAnchor=$,n.wrapWithFireEvent=X,n.getLocalPoint=O,o.controlsUtils=n}(t),function(a){var o=a.fabric||(a.fabric={}),l=o.util.degreesToRadians,d=o.controlsUtils;d.renderCircleControl=function(n,s,h,_,f){_=_||{};var p,m=this.sizeX||_.cornerSize||f.cornerSize,C=this.sizeY||_.cornerSize||f.cornerSize,T=_.transparentCorners!==void 0?_.transparentCorners:f.transparentCorners,x=T?"stroke":"fill",I=!T&&(_.cornerStrokeColor||f.cornerStrokeColor),D=s,L=h;n.save(),n.fillStyle=_.cornerColor||f.cornerColor,n.strokeStyle=_.cornerStrokeColor||f.cornerStrokeColor,m>C?(p=m,n.scale(1,C/m),L=h*m/C):C>m?(p=C,n.scale(m/C,1),D=s*C/m):p=m,n.lineWidth=1,n.beginPath(),n.arc(D,L,p/2,0,2*Math.PI,!1),n[x](),I&&n.stroke(),n.restore()},d.renderSquareControl=function(n,s,h,_,f){_=_||{};var p=this.sizeX||_.cornerSize||f.cornerSize,m=this.sizeY||_.cornerSize||f.cornerSize,C=_.transparentCorners!==void 0?_.transparentCorners:f.transparentCorners,T=C?"stroke":"fill",x=!C&&(_.cornerStrokeColor||f.cornerStrokeColor),I=p/2,D=m/2;n.save(),n.fillStyle=_.cornerColor||f.cornerColor,n.strokeStyle=_.cornerStrokeColor||f.cornerStrokeColor,n.lineWidth=1,n.translate(s,h),n.rotate(l(f.angle)),n[T+"Rect"](-I,-D,p,m),x&&n.strokeRect(-I,-D,p,m),n.restore()}}(t),function(a){var o=a.fabric||(a.fabric={});o.Control=function(l){for(var d in l)this[d]=l[d]},o.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(l,d){return d.cursorStyle},getActionName:function(l,d){return d.actionName},getVisibility:function(l,d){var n=l._controlsVisibility;return n&&n[d]!==void 0?n[d]:this.visible},setVisibility:function(l){this.visible=l},positionHandler:function(l,d){return o.util.transformPoint({x:this.x*l.x+this.offsetX,y:this.y*l.y+this.offsetY},d)},calcCornerCoords:function(l,d,n,s,h){var _,f,p,m,C=h?this.touchSizeX:this.sizeX,T=h?this.touchSizeY:this.sizeY;if(C&&T&&C!==T){var x=Math.atan2(T,C),I=Math.sqrt(C*C+T*T)/2,D=x-o.util.degreesToRadians(l),L=Math.PI/2-x-o.util.degreesToRadians(l);_=I*o.util.cos(D),f=I*o.util.sin(D),p=I*o.util.cos(L),m=I*o.util.sin(L)}else I=.7071067812*(C&&T?C:d),D=o.util.degreesToRadians(45-l),_=p=I*o.util.cos(D),f=m=I*o.util.sin(D);return{tl:{x:n-m,y:s-p},tr:{x:n+_,y:s-f},bl:{x:n-_,y:s+f},br:{x:n+m,y:s+p}}},render:function(l,d,n,s,h){((s=s||{}).cornerStyle||h.cornerStyle)==="circle"?o.controlsUtils.renderCircleControl.call(this,l,d,n,s,h):o.controlsUtils.renderSquareControl.call(this,l,d,n,s,h)}}}(t),function(){function a(l,d){var n,s,h,_,f=l.getAttribute("style"),p=l.getAttribute("offset")||0;if(p=(p=parseFloat(p)/(/%$/.test(p)?100:1))<0?0:p>1?1:p,f){var m=f.split(/\s*;\s*/);for(m[m.length-1]===""&&m.pop(),_=m.length;_--;){var C=m[_].split(/\s*:\s*/),T=C[0].trim(),x=C[1].trim();T==="stop-color"?n=x:T==="stop-opacity"&&(h=x)}}return n||(n=l.getAttribute("stop-color")||"rgb(0,0,0)"),h||(h=l.getAttribute("stop-opacity")),s=(n=new y.Color(n)).getAlpha(),h=isNaN(parseFloat(h))?1:parseFloat(h),h*=s*d,{offset:p,color:n.toRgb(),opacity:h}}var o=y.util.object.clone;y.Gradient=y.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(l){l||(l={}),l.coords||(l.coords={});var d,n=this;Object.keys(l).forEach(function(s){n[s]=l[s]}),this.id?this.id+="_"+y.Object.__uid++:this.id=y.Object.__uid++,d={x1:l.coords.x1||0,y1:l.coords.y1||0,x2:l.coords.x2||0,y2:l.coords.y2||0},this.type==="radial"&&(d.r1=l.coords.r1||0,d.r2=l.coords.r2||0),this.coords=d,this.colorStops=l.colorStops.slice()},addColorStop:function(l){for(var d in l){var n=new y.Color(l[d]);this.colorStops.push({offset:parseFloat(d),color:n.toRgb(),opacity:n.getAlpha()})}return this},toObject:function(l){var d={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return y.util.populateWithProperties(this,d,l),d},toSVG:function(l,d){var n,s,h,_,f=o(this.coords,!0),p=(d=d||{},o(this.colorStops,!0)),m=f.r1>f.r2,C=this.gradientTransform?this.gradientTransform.concat():y.iMatrix.concat(),T=-this.offsetX,x=-this.offsetY,I=!!d.additionalTransform,D=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(p.sort(function($,X){return $.offset-X.offset}),D==="objectBoundingBox"?(T/=l.width,x/=l.height):(T+=l.width/2,x+=l.height/2),l.type==="path"&&this.gradientUnits!=="percentage"&&(T-=l.pathOffset.x,x-=l.pathOffset.y),C[4]-=T,C[5]-=x,_='id="SVGID_'+this.id+'" gradientUnits="'+D+'"',_+=' gradientTransform="'+(I?d.additionalTransform+" ":"")+y.util.matrixToSVG(C)+'" ',this.type==="linear"?h=["<linearGradient ",_,' x1="',f.x1,'" y1="',f.y1,'" x2="',f.x2,'" y2="',f.y2,`">
`]:this.type==="radial"&&(h=["<radialGradient ",_,' cx="',m?f.x1:f.x2,'" cy="',m?f.y1:f.y2,'" r="',m?f.r1:f.r2,'" fx="',m?f.x2:f.x1,'" fy="',m?f.y2:f.y1,`">
`]),this.type==="radial"){if(m)for((p=p.concat()).reverse(),n=0,s=p.length;n<s;n++)p[n].offset=1-p[n].offset;var L=Math.min(f.r1,f.r2);if(L>0){var V=L/Math.max(f.r1,f.r2);for(n=0,s=p.length;n<s;n++)p[n].offset+=V*(1-p[n].offset)}}for(n=0,s=p.length;n<s;n++){var H=p[n];h.push("<stop ",'offset="',100*H.offset+"%",'" style="stop-color:',H.color,H.opacity!==void 0?";stop-opacity: "+H.opacity:";",`"/>
`)}return h.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),h.join("")},toLive:function(l){var d,n,s,h=y.util.object.clone(this.coords);if(this.type){for(this.type==="linear"?d=l.createLinearGradient(h.x1,h.y1,h.x2,h.y2):this.type==="radial"&&(d=l.createRadialGradient(h.x1,h.y1,h.r1,h.x2,h.y2,h.r2)),n=0,s=this.colorStops.length;n<s;n++){var _=this.colorStops[n].color,f=this.colorStops[n].opacity,p=this.colorStops[n].offset;f!==void 0&&(_=new y.Color(_).setAlpha(f).toRgba()),d.addColorStop(p,_)}return d}}}),y.util.object.extend(y.Gradient,{fromElement:function(l,d,n,s){var h=parseFloat(n)/(/%$/.test(n)?100:1);h=h<0?0:h>1?1:h,isNaN(h)&&(h=1);var _,f,p,m,C=l.getElementsByTagName("stop"),T=l.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",x=l.getAttribute("gradientTransform")||"",I=[],D=0,L=0;for(l.nodeName==="linearGradient"||l.nodeName==="LINEARGRADIENT"?(_="linear",f=function(V){return{x1:V.getAttribute("x1")||0,y1:V.getAttribute("y1")||0,x2:V.getAttribute("x2")||"100%",y2:V.getAttribute("y2")||0}}(l)):(_="radial",f=function(V){return{x1:V.getAttribute("fx")||V.getAttribute("cx")||"50%",y1:V.getAttribute("fy")||V.getAttribute("cy")||"50%",r1:0,x2:V.getAttribute("cx")||"50%",y2:V.getAttribute("cy")||"50%",r2:V.getAttribute("r")||"50%"}}(l)),p=C.length;p--;)I.push(a(C[p],h));return m=y.parseTransformAttribute(x),function(V,H,$,X){var O,R;Object.keys(H).forEach(function(M){(O=H[M])==="Infinity"?R=1:O==="-Infinity"?R=0:(R=parseFloat(H[M],10),typeof O=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(O)&&(R*=.01,X==="pixels"&&(M!=="x1"&&M!=="x2"&&M!=="r2"||(R*=$.viewBoxWidth||$.width),M!=="y1"&&M!=="y2"||(R*=$.viewBoxHeight||$.height)))),H[M]=R})}(0,f,s,T),T==="pixels"&&(D=-d.left,L=-d.top),new y.Gradient({id:l.getAttribute("id"),type:_,coords:f,colorStops:I,gradientUnits:T,gradientTransform:m,offsetX:D,offsetY:L})}})}(),Z=y.util.toFixed,y.Pattern=y.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(a,o){if(a||(a={}),this.id=y.Object.__uid++,this.setOptions(a),!a.source||a.source&&typeof a.source!="string")o&&o(this);else{var l=this;this.source=y.util.createImage(),y.util.loadImage(a.source,function(d,n){l.source=d,o&&o(l,n)},null,this.crossOrigin)}},toObject:function(a){var o,l,d=y.Object.NUM_FRACTION_DIGITS;return typeof this.source.src=="string"?o=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(o=this.source.toDataURL()),l={type:"pattern",source:o,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:Z(this.offsetX,d),offsetY:Z(this.offsetY,d),patternTransform:this.patternTransform?this.patternTransform.concat():null},y.util.populateWithProperties(this,l,a),l},toSVG:function(a){var o=typeof this.source=="function"?this.source():this.source,l=o.width/a.width,d=o.height/a.height,n=this.offsetX/a.width,s=this.offsetY/a.height,h="";return this.repeat!=="repeat-x"&&this.repeat!=="no-repeat"||(d=1,s&&(d+=Math.abs(s))),this.repeat!=="repeat-y"&&this.repeat!=="no-repeat"||(l=1,n&&(l+=Math.abs(n))),o.src?h=o.src:o.toDataURL&&(h=o.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+n+'" y="'+s+'" width="'+l+'" height="'+d+`">
<image x="0" y="0" width="`+o.width+'" height="'+o.height+'" xlink:href="'+h+`"></image>
</pattern>
`},setOptions:function(a){for(var o in a)this[o]=a[o]},toLive:function(a){var o=this.source;return!o||o.src!==void 0&&(!o.complete||o.naturalWidth===0||o.naturalHeight===0)?"":a.createPattern(o,this.repeat)}}),function(a){var o=a.fabric||(a.fabric={}),l=o.util.toFixed;o.Shadow?o.warn("fabric.Shadow is already defined."):(o.Shadow=o.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(d){for(var n in typeof d=="string"&&(d=this._parseShadow(d)),d)this[n]=d[n];this.id=o.Object.__uid++},_parseShadow:function(d){var n=d.trim(),s=o.Shadow.reOffsetsAndBlur.exec(n)||[];return{color:(n.replace(o.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)").trim(),offsetX:parseFloat(s[1],10)||0,offsetY:parseFloat(s[2],10)||0,blur:parseFloat(s[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(d){var n=40,s=40,h=o.Object.NUM_FRACTION_DIGITS,_=o.util.rotateVector({x:this.offsetX,y:this.offsetY},o.util.degreesToRadians(-d.angle)),f=new o.Color(this.color);return d.width&&d.height&&(n=100*l((Math.abs(_.x)+this.blur)/d.width,h)+20,s=100*l((Math.abs(_.y)+this.blur)/d.height,h)+20),d.flipX&&(_.x*=-1),d.flipY&&(_.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+s+'%" height="'+(100+2*s)+'%" x="-'+n+'%" width="'+(100+2*n)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+l(this.blur?this.blur/2:0,h)+`"></feGaussianBlur>
	<feOffset dx="`+l(_.x,h)+'" dy="'+l(_.y,h)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+f.toRgb()+'" flood-opacity="'+f.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var d={},n=o.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(s){this[s]!==n[s]&&(d[s]=this[s])},this),d}}),o.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/)}(t),function(){if(y.StaticCanvas)y.warn("fabric.StaticCanvas is already defined.");else{var a=y.util.object.extend,o=y.util.getElementOffset,l=y.util.removeFromArray,d=y.util.toFixed,n=y.util.transformPoint,s=y.util.invertTransform,h=y.util.getNodeCanvas,_=y.util.createCanvasElement,f=new Error("Could not initialize `canvas` element");y.StaticCanvas=y.util.createClass(y.CommonMethods,{initialize:function(p,m){m||(m={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(p,m)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:y.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(p,m){var C=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(p),this._initOptions(m),this.interactive||this._initRetinaScaling(),m.overlayImage&&this.setOverlayImage(m.overlayImage,C),m.backgroundImage&&this.setBackgroundImage(m.backgroundImage,C),m.backgroundColor&&this.setBackgroundColor(m.backgroundColor,C),m.overlayColor&&this.setOverlayColor(m.overlayColor,C),this.calcOffset()},_isRetinaScaling:function(){return y.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,y.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var p=y.devicePixelRatio;this.__initRetinaScaling(p,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(p,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(p,m,C){m.setAttribute("width",this.width*p),m.setAttribute("height",this.height*p),C.scale(p,p)},calcOffset:function(){return this._offset=o(this.lowerCanvasEl),this},setOverlayImage:function(p,m,C){return this.__setBgOverlayImage("overlayImage",p,m,C)},setBackgroundImage:function(p,m,C){return this.__setBgOverlayImage("backgroundImage",p,m,C)},setOverlayColor:function(p,m){return this.__setBgOverlayColor("overlayColor",p,m)},setBackgroundColor:function(p,m){return this.__setBgOverlayColor("backgroundColor",p,m)},__setBgOverlayImage:function(p,m,C,T){return typeof m=="string"?y.util.loadImage(m,function(x,I){if(x){var D=new y.Image(x,T);this[p]=D,D.canvas=this}C&&C(x,I)},this,T&&T.crossOrigin):(T&&m.setOptions(T),this[p]=m,m&&(m.canvas=this),C&&C(m,!1)),this},__setBgOverlayColor:function(p,m,C){return this[p]=m,this._initGradient(m,p),this._initPattern(m,p,C),this},_createCanvasElement:function(){var p=_();if(!p||(p.style||(p.style={}),p.getContext===void 0))throw f;return p},_initOptions:function(p){var m=this.lowerCanvasEl;this._setOptions(p),this.width=this.width||parseInt(m.width,10)||0,this.height=this.height||parseInt(m.height,10)||0,this.lowerCanvasEl.style&&(m.width=this.width,m.height=this.height,m.style.width=this.width+"px",m.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(p){p&&p.getContext?this.lowerCanvasEl=p:this.lowerCanvasEl=y.util.getById(p)||this._createCanvasElement(),y.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(p,m){return this.setDimensions({width:p},m)},setHeight:function(p,m){return this.setDimensions({height:p},m)},setDimensions:function(p,m){var C;for(var T in m=m||{},p)C=p[T],m.cssOnly||(this._setBackstoreDimension(T,p[T]),C+="px",this.hasLostContext=!0),m.backstoreOnly||this._setCssDimension(T,C);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),m.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(p,m){return this.lowerCanvasEl[p]=m,this.upperCanvasEl&&(this.upperCanvasEl[p]=m),this.cacheCanvasEl&&(this.cacheCanvasEl[p]=m),this[p]=m,this},_setCssDimension:function(p,m){return this.lowerCanvasEl.style[p]=m,this.upperCanvasEl&&(this.upperCanvasEl.style[p]=m),this.wrapperEl&&(this.wrapperEl.style[p]=m),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(p){var m,C,T,x=this._activeObject,I=this.backgroundImage,D=this.overlayImage;for(this.viewportTransform=p,C=0,T=this._objects.length;C<T;C++)(m=this._objects[C]).group||m.setCoords(!0);return x&&x.setCoords(),I&&I.setCoords(!0),D&&D.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(p,m){var C=p,T=this.viewportTransform.slice(0);p=n(p,s(this.viewportTransform)),T[0]=m,T[3]=m;var x=n(p,T);return T[4]+=C.x-x.x,T[5]+=C.y-x.y,this.setViewportTransform(T)},setZoom:function(p){return this.zoomToPoint(new y.Point(0,0),p),this},absolutePan:function(p){var m=this.viewportTransform.slice(0);return m[4]=-p.x,m[5]=-p.y,this.setViewportTransform(m)},relativePan:function(p){return this.absolutePan(new y.Point(-p.x-this.viewportTransform[4],-p.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(p){this.stateful&&p.setupState(),p._set("canvas",this),p.setCoords(),this.fire("object:added",{target:p}),p.fire("added")},_onObjectRemoved:function(p){this.fire("object:removed",{target:p}),p.fire("removed"),delete p.canvas},clearContext:function(p){return p.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var p=this.contextContainer;return this.renderCanvas(p,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=y.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var p={},m=this.width,C=this.height,T=s(this.viewportTransform);return p.tl=n({x:0,y:0},T),p.br=n({x:m,y:C},T),p.tr=new y.Point(p.br.x,p.tl.y),p.bl=new y.Point(p.tl.x,p.br.y),this.vptCoords=p,p},cancelRequestedRender:function(){this.isRendering&&(y.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(p,m){var C=this.viewportTransform,T=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(p),y.util.setImageSmoothing(p,this.imageSmoothingEnabled),this.fire("before:render",{ctx:p}),this._renderBackground(p),p.save(),p.transform(C[0],C[1],C[2],C[3],C[4],C[5]),this._renderObjects(p,m),p.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(p),T&&(T.canvas=this,T.shouldCache(),T._transformDone=!0,T.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(p)),this._renderOverlay(p),this.controlsAboveOverlay&&this.interactive&&this.drawControls(p),this.fire("after:render",{ctx:p})},drawClipPathOnCanvas:function(p){var m=this.viewportTransform,C=this.clipPath;p.save(),p.transform(m[0],m[1],m[2],m[3],m[4],m[5]),p.globalCompositeOperation="destination-in",C.transform(p),p.scale(1/C.zoomX,1/C.zoomY),p.drawImage(C._cacheCanvas,-C.cacheTranslationX,-C.cacheTranslationY),p.restore()},_renderObjects:function(p,m){var C,T;for(C=0,T=m.length;C<T;++C)m[C]&&m[C].render(p)},_renderBackgroundOrOverlay:function(p,m){var C=this[m+"Color"],T=this[m+"Image"],x=this.viewportTransform,I=this[m+"Vpt"];if(C||T){if(C){p.save(),p.beginPath(),p.moveTo(0,0),p.lineTo(this.width,0),p.lineTo(this.width,this.height),p.lineTo(0,this.height),p.closePath(),p.fillStyle=C.toLive?C.toLive(p,this):C,I&&p.transform(x[0],x[1],x[2],x[3],x[4],x[5]),p.transform(1,0,0,1,C.offsetX||0,C.offsetY||0);var D=C.gradientTransform||C.patternTransform;D&&p.transform(D[0],D[1],D[2],D[3],D[4],D[5]),p.fill(),p.restore()}T&&(p.save(),I&&p.transform(x[0],x[1],x[2],x[3],x[4],x[5]),T.render(p),p.restore())}},_renderBackground:function(p){this._renderBackgroundOrOverlay(p,"background")},_renderOverlay:function(p){this._renderBackgroundOrOverlay(p,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new y.Point(this.width/2,this.height/2)},centerObjectH:function(p){return this._centerObject(p,new y.Point(this.getCenterPoint().x,p.getCenterPoint().y))},centerObjectV:function(p){return this._centerObject(p,new y.Point(p.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(p){var m=this.getCenterPoint();return this._centerObject(p,m)},viewportCenterObject:function(p){var m=this.getVpCenter();return this._centerObject(p,m)},viewportCenterObjectH:function(p){var m=this.getVpCenter();return this._centerObject(p,new y.Point(m.x,p.getCenterPoint().y)),this},viewportCenterObjectV:function(p){var m=this.getVpCenter();return this._centerObject(p,new y.Point(p.getCenterPoint().x,m.y))},getVpCenter:function(){var p=this.getCenterPoint(),m=s(this.viewportTransform);return n(p,m)},_centerObject:function(p,m){return p.setPositionByOrigin(m,"center","center"),p.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(p){return this.toDatalessObject(p)},toObject:function(p){return this._toObjectMethod("toObject",p)},toDatalessObject:function(p){return this._toObjectMethod("toDatalessObject",p)},_toObjectMethod:function(p,m){var C=this.clipPath,T={version:y.version,objects:this._toObjects(p,m)};return C&&!C.excludeFromExport&&(T.clipPath=this._toObject(this.clipPath,p,m)),a(T,this.__serializeBgOverlay(p,m)),y.util.populateWithProperties(this,T,m),T},_toObjects:function(p,m){return this._objects.filter(function(C){return!C.excludeFromExport}).map(function(C){return this._toObject(C,p,m)},this)},_toObject:function(p,m,C){var T;this.includeDefaultValues||(T=p.includeDefaultValues,p.includeDefaultValues=!1);var x=p[m](C);return this.includeDefaultValues||(p.includeDefaultValues=T),x},__serializeBgOverlay:function(p,m){var C={},T=this.backgroundImage,x=this.overlayImage,I=this.backgroundColor,D=this.overlayColor;return I&&I.toObject?I.excludeFromExport||(C.background=I.toObject(m)):I&&(C.background=I),D&&D.toObject?D.excludeFromExport||(C.overlay=D.toObject(m)):D&&(C.overlay=D),T&&!T.excludeFromExport&&(C.backgroundImage=this._toObject(T,p,m)),x&&!x.excludeFromExport&&(C.overlayImage=this._toObject(x,p,m)),C},svgViewportTransformation:!0,toSVG:function(p,m){p||(p={}),p.reviver=m;var C=[];return this._setSVGPreamble(C,p),this._setSVGHeader(C,p),this.clipPath&&C.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(C,"background"),this._setSVGBgOverlayImage(C,"backgroundImage",m),this._setSVGObjects(C,m),this.clipPath&&C.push(`</g>
`),this._setSVGBgOverlayColor(C,"overlay"),this._setSVGBgOverlayImage(C,"overlayImage",m),C.push("</svg>"),C.join("")},_setSVGPreamble:function(p,m){m.suppressPreamble||p.push('<?xml version="1.0" encoding="',m.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(p,m){var C,T=m.width||this.width,x=m.height||this.height,I='viewBox="0 0 '+this.width+" "+this.height+'" ',D=y.Object.NUM_FRACTION_DIGITS;m.viewBox?I='viewBox="'+m.viewBox.x+" "+m.viewBox.y+" "+m.viewBox.width+" "+m.viewBox.height+'" ':this.svgViewportTransformation&&(C=this.viewportTransform,I='viewBox="'+d(-C[4]/C[0],D)+" "+d(-C[5]/C[3],D)+" "+d(this.width/C[0],D)+" "+d(this.height/C[3],D)+'" '),p.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',T,'" ','height="',x,'" ',I,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",y.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(m),`</defs>
`)},createSVGClipPathMarkup:function(p){var m=this.clipPath;return m?(m.clipPathId="CLIPPATH_"+y.Object.__uid++,'<clipPath id="'+m.clipPathId+`" >
`+this.clipPath.toClipPathSVG(p.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var p=this;return["background","overlay"].map(function(m){var C=p[m+"Color"];if(C&&C.toLive){var T=p[m+"Vpt"],x=p.viewportTransform,I={width:p.width/(T?x[0]:1),height:p.height/(T?x[3]:1)};return C.toSVG(I,{additionalTransform:T?y.util.matrixToSVG(x):""})}}).join("")},createSVGFontFacesMarkup:function(){var p,m,C,T,x,I,D,L,V="",H={},$=y.fontPaths,X=[];for(this._objects.forEach(function R(M){X.push(M),M._objects&&M._objects.forEach(R)}),D=0,L=X.length;D<L;D++)if(m=(p=X[D]).fontFamily,p.type.indexOf("text")!==-1&&!H[m]&&$[m]&&(H[m]=!0,p.styles))for(x in C=p.styles)for(I in T=C[x])!H[m=T[I].fontFamily]&&$[m]&&(H[m]=!0);for(var O in H)V+=[`		@font-face {
`,"			font-family: '",O,`';
`,"			src: url('",$[O],`');
`,`		}
`].join("");return V&&(V=['	<style type="text/css">',`<![CDATA[
`,V,"]]>",`</style>
`].join("")),V},_setSVGObjects:function(p,m){var C,T,x,I=this._objects;for(T=0,x=I.length;T<x;T++)(C=I[T]).excludeFromExport||this._setSVGObject(p,C,m)},_setSVGObject:function(p,m,C){p.push(m.toSVG(C))},_setSVGBgOverlayImage:function(p,m,C){this[m]&&!this[m].excludeFromExport&&this[m].toSVG&&p.push(this[m].toSVG(C))},_setSVGBgOverlayColor:function(p,m){var C=this[m+"Color"],T=this.viewportTransform,x=this.width,I=this.height;if(C)if(C.toLive){var D=C.repeat,L=y.util.invertTransform(T),V=this[m+"Vpt"]?y.util.matrixToSVG(L):"";p.push('<rect transform="'+V+" translate(",x/2,",",I/2,')"',' x="',C.offsetX-x/2,'" y="',C.offsetY-I/2,'" ','width="',D==="repeat-y"||D==="no-repeat"?C.source.width:x,'" height="',D==="repeat-x"||D==="no-repeat"?C.source.height:I,'" fill="url(#SVGID_'+C.id+')"',`></rect>
`)}else p.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',C,'"',`></rect>
`)},sendToBack:function(p){if(!p)return this;var m,C,T,x=this._activeObject;if(p===x&&p.type==="activeSelection")for(m=(T=x._objects).length;m--;)C=T[m],l(this._objects,C),this._objects.unshift(C);else l(this._objects,p),this._objects.unshift(p);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(p){if(!p)return this;var m,C,T,x=this._activeObject;if(p===x&&p.type==="activeSelection")for(T=x._objects,m=0;m<T.length;m++)C=T[m],l(this._objects,C),this._objects.push(C);else l(this._objects,p),this._objects.push(p);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(p,m){if(!p)return this;var C,T,x,I,D,L=this._activeObject,V=0;if(p===L&&p.type==="activeSelection")for(D=L._objects,C=0;C<D.length;C++)T=D[C],(x=this._objects.indexOf(T))>0+V&&(I=x-1,l(this._objects,T),this._objects.splice(I,0,T)),V++;else(x=this._objects.indexOf(p))!==0&&(I=this._findNewLowerIndex(p,x,m),l(this._objects,p),this._objects.splice(I,0,p));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(p,m,C){var T,x;if(C){for(T=m,x=m-1;x>=0;--x)if(p.intersectsWithObject(this._objects[x])||p.isContainedWithinObject(this._objects[x])||this._objects[x].isContainedWithinObject(p)){T=x;break}}else T=m-1;return T},bringForward:function(p,m){if(!p)return this;var C,T,x,I,D,L=this._activeObject,V=0;if(p===L&&p.type==="activeSelection")for(C=(D=L._objects).length;C--;)T=D[C],(x=this._objects.indexOf(T))<this._objects.length-1-V&&(I=x+1,l(this._objects,T),this._objects.splice(I,0,T)),V++;else(x=this._objects.indexOf(p))!==this._objects.length-1&&(I=this._findNewUpperIndex(p,x,m),l(this._objects,p),this._objects.splice(I,0,p));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(p,m,C){var T,x,I;if(C){for(T=m,x=m+1,I=this._objects.length;x<I;++x)if(p.intersectsWithObject(this._objects[x])||p.isContainedWithinObject(this._objects[x])||this._objects[x].isContainedWithinObject(p)){T=x;break}}else T=m+1;return T},moveTo:function(p,m){return l(this._objects,p),this._objects.splice(m,0,p),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(y.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(p){p.dispose&&p.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),y.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),y.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),a(y.StaticCanvas.prototype,y.Observable),a(y.StaticCanvas.prototype,y.Collection),a(y.StaticCanvas.prototype,y.DataURLExporter),a(y.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(p){var m=_();if(!m||!m.getContext)return null;var C=m.getContext("2d");return C&&p==="setLineDash"?C.setLineDash!==void 0:null}}),y.StaticCanvas.prototype.toJSON=y.StaticCanvas.prototype.toObject,y.isLikelyNode&&(y.StaticCanvas.prototype.createPNGStream=function(){var p=h(this.lowerCanvasEl);return p&&p.createPNGStream()},y.StaticCanvas.prototype.createJPEGStream=function(p){var m=h(this.lowerCanvasEl);return m&&m.createJPEGStream(p)})}}(),y.BaseBrush=y.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(a){a.strokeStyle=this.color,a.lineWidth=this.width,a.lineCap=this.strokeLineCap,a.miterLimit=this.strokeMiterLimit,a.lineJoin=this.strokeLineJoin,a.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(a){var o=this.canvas.viewportTransform;a.save(),a.transform(o[0],o[1],o[2],o[3],o[4],o[5])},_setShadow:function(){if(this.shadow){var a=this.canvas,o=this.shadow,l=a.contextTop,d=a.getZoom();a&&a._isRetinaScaling()&&(d*=y.devicePixelRatio),l.shadowColor=o.color,l.shadowBlur=o.blur*d,l.shadowOffsetX=o.offsetX*d,l.shadowOffsetY=o.offsetY*d}},needsFullRender:function(){return new y.Color(this.color).getAlpha()<1||!!this.shadow},_resetShadow:function(){var a=this.canvas.contextTop;a.shadowColor="",a.shadowBlur=a.shadowOffsetX=a.shadowOffsetY=0},_isOutSideCanvas:function(a){return a.x<0||a.x>this.canvas.getWidth()||a.y<0||a.y>this.canvas.getHeight()}}),y.PencilBrush=y.util.createClass(y.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(a){this.canvas=a,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(a,o,l){var d=o.midPointFrom(l);return a.quadraticCurveTo(o.x,o.y,d.x,d.y),d},onMouseDown:function(a,o){this.canvas._isMainEvent(o.e)&&(this.drawStraightLine=o.e[this.straightLineKey],this._prepareForDrawing(a),this._captureDrawingPath(a),this._render())},onMouseMove:function(a,o){if(this.canvas._isMainEvent(o.e)&&(this.drawStraightLine=o.e[this.straightLineKey],(this.limitedToCanvasSize!==!0||!this._isOutSideCanvas(a))&&this._captureDrawingPath(a)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var l=this._points,d=l.length,n=this.canvas.contextTop;this._saveAndTransform(n),this.oldEnd&&(n.beginPath(),n.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(n,l[d-2],l[d-1],!0),n.stroke(),n.restore()}},onMouseUp:function(a){return!this.canvas._isMainEvent(a.e)||(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1)},_prepareForDrawing:function(a){var o=new y.Point(a.x,a.y);this._reset(),this._addPoint(o),this.canvas.contextTop.moveTo(o.x,o.y)},_addPoint:function(a){return!(this._points.length>1&&a.eq(this._points[this._points.length-1])||(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(a),0))},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(a){var o=new y.Point(a.x,a.y);return this._addPoint(o)},_render:function(a){var o,l,d=this._points[0],n=this._points[1];if(a=a||this.canvas.contextTop,this._saveAndTransform(a),a.beginPath(),this._points.length===2&&d.x===n.x&&d.y===n.y){var s=this.width/1e3;d=new y.Point(d.x,d.y),n=new y.Point(n.x,n.y),d.x-=s,n.x+=s}for(a.moveTo(d.x,d.y),o=1,l=this._points.length;o<l;o++)this._drawSegment(a,d,n),d=this._points[o],n=this._points[o+1];a.lineTo(d.x,d.y),a.stroke(),a.restore()},convertPointsToSVGPath:function(a){var o=this.width/1e3;return y.util.getSmoothPathFromPoints(a,o)},_isEmptySVGPath:function(a){return y.util.joinPath(a)==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(a){var o=new y.Path(a,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,o.shadow=new y.Shadow(this.shadow)),o},decimatePoints:function(a,o){if(a.length<=2)return a;var l,d=this.canvas.getZoom(),n=Math.pow(o/d,2),s=a.length-1,h=a[0],_=[h];for(l=1;l<s-1;l++)Math.pow(h.x-a[l].x,2)+Math.pow(h.y-a[l].y,2)>=n&&(h=a[l],_.push(h));return _.push(a[s]),_},_finalizeAndAddPath:function(){this.canvas.contextTop.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var a=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(a))this.canvas.requestRenderAll();else{var o=this.createPath(a);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:o}),this.canvas.add(o),this.canvas.requestRenderAll(),o.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:o})}}}),y.CircleBrush=y.util.createClass(y.BaseBrush,{width:10,initialize:function(a){this.canvas=a,this.points=[]},drawDot:function(a){var o=this.addPoint(a),l=this.canvas.contextTop;this._saveAndTransform(l),this.dot(l,o),l.restore()},dot:function(a,o){a.fillStyle=o.fill,a.beginPath(),a.arc(o.x,o.y,o.radius,0,2*Math.PI,!1),a.closePath(),a.fill()},onMouseDown:function(a){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(a)},_render:function(){var a,o,l=this.canvas.contextTop,d=this.points;for(this._saveAndTransform(l),a=0,o=d.length;a<o;a++)this.dot(l,d[a]);l.restore()},onMouseMove:function(a){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(a)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(a),this._render()):this.drawDot(a))},onMouseUp:function(){var a,o,l=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;var d=[];for(a=0,o=this.points.length;a<o;a++){var n=this.points[a],s=new y.Circle({radius:n.radius,left:n.x,top:n.y,originX:"center",originY:"center",fill:n.fill});this.shadow&&(s.shadow=new y.Shadow(this.shadow)),d.push(s)}var h=new y.Group(d);h.canvas=this.canvas,this.canvas.fire("before:path:created",{path:h}),this.canvas.add(h),this.canvas.fire("path:created",{path:h}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=l,this.canvas.requestRenderAll()},addPoint:function(a){var o=new y.Point(a.x,a.y),l=y.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,d=new y.Color(this.color).setAlpha(y.util.getRandomInt(0,100)/100).toRgba();return o.radius=l,o.fill=d,this.points.push(o),o}}),y.SprayBrush=y.util.createClass(y.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(a){this.canvas=a,this.sprayChunks=[]},onMouseDown:function(a){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(a),this.render(this.sprayChunkPoints)},onMouseMove:function(a){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(a)||(this.addSprayChunk(a),this.render(this.sprayChunkPoints))},onMouseUp:function(){var a=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var o=[],l=0,d=this.sprayChunks.length;l<d;l++)for(var n=this.sprayChunks[l],s=0,h=n.length;s<h;s++){var _=new y.Rect({width:n[s].width,height:n[s].width,left:n[s].x+1,top:n[s].y+1,originX:"center",originY:"center",fill:this.color});o.push(_)}this.optimizeOverlapping&&(o=this._getOptimizedRects(o));var f=new y.Group(o);this.shadow&&f.set("shadow",new y.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:f}),this.canvas.add(f),this.canvas.fire("path:created",{path:f}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=a,this.canvas.requestRenderAll()},_getOptimizedRects:function(a){var o,l,d,n={};for(l=0,d=a.length;l<d;l++)n[o=a[l].left+""+a[l].top]||(n[o]=a[l]);var s=[];for(o in n)s.push(n[o]);return s},render:function(a){var o,l,d=this.canvas.contextTop;for(d.fillStyle=this.color,this._saveAndTransform(d),o=0,l=a.length;o<l;o++){var n=a[o];n.opacity!==void 0&&(d.globalAlpha=n.opacity),d.fillRect(n.x,n.y,n.width,n.width)}d.restore()},_render:function(){var a,o,l=this.canvas.contextTop;for(l.fillStyle=this.color,this._saveAndTransform(l),a=0,o=this.sprayChunks.length;a<o;a++)this.render(this.sprayChunks[a]);l.restore()},addSprayChunk:function(a){this.sprayChunkPoints=[];var o,l,d,n,s=this.width/2;for(n=0;n<this.density;n++){o=y.util.getRandomInt(a.x-s,a.x+s),l=y.util.getRandomInt(a.y-s,a.y+s),d=this.dotWidthVariance?y.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):this.dotWidth;var h=new y.Point(o,l);h.width=d,this.randomOpacity&&(h.opacity=y.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(h)}this.sprayChunks.push(this.sprayChunkPoints)}}),y.PatternBrush=y.util.createClass(y.PencilBrush,{getPatternSrc:function(){var a=y.util.createCanvasElement(),o=a.getContext("2d");return a.width=a.height=25,o.fillStyle=this.color,o.beginPath(),o.arc(10,10,10,0,2*Math.PI,!1),o.closePath(),o.fill(),a},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(a){return a.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(a){this.callSuper("_setBrushStyles",a),a.strokeStyle=this.getPattern(a)},createPath:function(a){var o=this.callSuper("createPath",a),l=o._getLeftTopCoords().scalarAdd(o.strokeWidth/2);return o.stroke=new y.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-l.x,offsetY:-l.y}),o}}),function(){var a=y.util.getPointer,o=y.util.degreesToRadians,l=y.util.isTouchEvent;for(var d in y.Canvas=y.util.createClass(y.StaticCanvas,{initialize:function(n,s){s||(s={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(n,s),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=y.PencilBrush&&new y.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var n,s,h,_=this.getActiveObjects();if(_.length>0&&!this.preserveObjectStacking){s=[],h=[];for(var f=0,p=this._objects.length;f<p;f++)n=this._objects[f],_.indexOf(n)===-1?s.push(n):h.push(n);_.length>1&&(this._activeObject._objects=h),s.push.apply(s,h)}else s=this._objects;return s},renderAll:function(){!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var n=this.contextContainer;return this.renderCanvas(n,this._chooseObjectsToRender()),this},renderTopLayer:function(n){n.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(n),this.contextTopDirty=!0),n.restore()},renderTop:function(){var n=this.contextTop;return this.clearContext(n),this.renderTopLayer(n),this.fire("after:render"),this},_normalizePointer:function(n,s){var h=n.calcTransformMatrix(),_=y.util.invertTransform(h),f=this.restorePointerVpt(s);return y.util.transformPoint(f,_)},isTargetTransparent:function(n,s,h){if(n.shouldCache()&&n._cacheCanvas&&n!==this._activeObject){var _=this._normalizePointer(n,{x:s,y:h}),f=Math.max(n.cacheTranslationX+_.x*n.zoomX,0),p=Math.max(n.cacheTranslationY+_.y*n.zoomY,0);return y.util.isTransparent(n._cacheContext,Math.round(f),Math.round(p),this.targetFindTolerance)}var m=this.contextCache,C=n.selectionBackgroundColor,T=this.viewportTransform;return n.selectionBackgroundColor="",this.clearContext(m),m.save(),m.transform(T[0],T[1],T[2],T[3],T[4],T[5]),n.render(m),m.restore(),n.selectionBackgroundColor=C,y.util.isTransparent(m,s,h,this.targetFindTolerance)},_isSelectionKeyPressed:function(n){return Array.isArray(this.selectionKey)?!!this.selectionKey.find(function(s){return n[s]===!0}):n[this.selectionKey]},_shouldClearSelection:function(n,s){var h=this.getActiveObjects(),_=this._activeObject;return!s||s&&_&&h.length>1&&h.indexOf(s)===-1&&_!==s&&!this._isSelectionKeyPressed(n)||s&&!s.evented||s&&!s.selectable&&_&&_!==s},_shouldCenterTransform:function(n,s,h){var _;if(n)return s==="scale"||s==="scaleX"||s==="scaleY"||s==="resizing"?_=this.centeredScaling||n.centeredScaling:s==="rotate"&&(_=this.centeredRotation||n.centeredRotation),_?!h:h},_getOriginFromCorner:function(n,s){var h={x:n.originX,y:n.originY};return s==="ml"||s==="tl"||s==="bl"?h.x="right":s!=="mr"&&s!=="tr"&&s!=="br"||(h.x="left"),s==="tl"||s==="mt"||s==="tr"?h.y="bottom":s!=="bl"&&s!=="mb"&&s!=="br"||(h.y="top"),h},_getActionFromCorner:function(n,s,h,_){if(!s||!n)return"drag";var f=_.controls[s];return f.getActionName(h,f,_)},_setupCurrentTransform:function(n,s,h){if(s){var _=this.getPointer(n),f=s.__corner,p=s.controls[f],m=h&&f?p.getActionHandler(n,s,p):y.controlsUtils.dragHandler,C=this._getActionFromCorner(h,f,n,s),T=this._getOriginFromCorner(s,f),x=n[this.centeredKey],I={target:s,action:C,actionHandler:m,corner:f,scaleX:s.scaleX,scaleY:s.scaleY,skewX:s.skewX,skewY:s.skewY,offsetX:_.x-s.left,offsetY:_.y-s.top,originX:T.x,originY:T.y,ex:_.x,ey:_.y,lastX:_.x,lastY:_.y,theta:o(s.angle),width:s.width*s.scaleX,shiftKey:n.shiftKey,altKey:x,original:y.util.saveObjectTransform(s)};this._shouldCenterTransform(s,C,x)&&(I.originX="center",I.originY="center"),I.original.originX=T.x,I.original.originY=T.y,this._currentTransform=I,this._beforeTransform(n)}},setCursor:function(n){this.upperCanvasEl.style.cursor=n},_drawSelection:function(n){var s=this._groupSelector,h=new y.Point(s.ex,s.ey),_=y.util.transformPoint(h,this.viewportTransform),f=new y.Point(s.ex+s.left,s.ey+s.top),p=y.util.transformPoint(f,this.viewportTransform),m=Math.min(_.x,p.x),C=Math.min(_.y,p.y),T=Math.max(_.x,p.x),x=Math.max(_.y,p.y),I=this.selectionLineWidth/2;this.selectionColor&&(n.fillStyle=this.selectionColor,n.fillRect(m,C,T-m,x-C)),this.selectionLineWidth&&this.selectionBorderColor&&(n.lineWidth=this.selectionLineWidth,n.strokeStyle=this.selectionBorderColor,m+=I,C+=I,T-=I,x-=I,y.Object.prototype._setLineDash.call(this,n,this.selectionDashArray),n.strokeRect(m,C,T-m,x-C))},findTarget:function(n,s){if(!this.skipTargetFind){var h,_,f=this.getPointer(n,!0),p=this._activeObject,m=this.getActiveObjects(),C=l(n),T=m.length>1&&!s||m.length===1;if(this.targets=[],T&&p._findTargetCorner(f,C)||m.length>1&&!s&&p===this._searchPossibleTargets([p],f))return p;if(m.length===1&&p===this._searchPossibleTargets([p],f)){if(!this.preserveObjectStacking)return p;h=p,_=this.targets,this.targets=[]}var x=this._searchPossibleTargets(this._objects,f);return n[this.altSelectionKey]&&x&&h&&x!==h&&(x=h,this.targets=_),x}},_checkTarget:function(n,s,h){if(s&&s.visible&&s.evented&&s.containsPoint(n)&&(!this.perPixelTargetFind&&!s.perPixelTargetFind||s.isEditing||!this.isTargetTransparent(s,h.x,h.y)))return!0},_searchPossibleTargets:function(n,s){for(var h,_,f=n.length;f--;){var p=n[f],m=p.group?this._normalizePointer(p.group,s):s;if(this._checkTarget(m,p,s)){(h=n[f]).subTargetCheck&&h instanceof y.Group&&(_=this._searchPossibleTargets(h._objects,s))&&this.targets.push(_);break}}return h},restorePointerVpt:function(n){return y.util.transformPoint(n,y.util.invertTransform(this.viewportTransform))},getPointer:function(n,s){if(this._absolutePointer&&!s)return this._absolutePointer;if(this._pointer&&s)return this._pointer;var h,_=a(n),f=this.upperCanvasEl,p=f.getBoundingClientRect(),m=p.width||0,C=p.height||0;m&&C||("top"in p&&"bottom"in p&&(C=Math.abs(p.top-p.bottom)),"right"in p&&"left"in p&&(m=Math.abs(p.right-p.left))),this.calcOffset(),_.x=_.x-this._offset.left,_.y=_.y-this._offset.top,s||(_=this.restorePointerVpt(_));var T=this.getRetinaScaling();return T!==1&&(_.x/=T,_.y/=T),h=m===0||C===0?{width:1,height:1}:{width:f.width/m,height:f.height/C},{x:_.x*h.width,y:_.y*h.height}},_createUpperCanvas:function(){var n=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),s=this.lowerCanvasEl,h=this.upperCanvasEl;h?h.className="":(h=this._createCanvasElement(),this.upperCanvasEl=h),y.util.addClass(h,"upper-canvas "+n),this.wrapperEl.appendChild(h),this._copyCanvasStyle(s,h),this._applyCanvasStyle(h),this.contextTop=h.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=y.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),y.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),y.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(n){var s=this.width||n.width,h=this.height||n.height;y.util.setStyle(n,{position:"absolute",width:s+"px",height:h+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),n.width=s,n.height=h,y.util.makeElementUnselectable(n)},_copyCanvasStyle:function(n,s){s.style.cssText=n.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var n=this._activeObject;return n?n.type==="activeSelection"&&n._objects?n._objects.slice(0):[n]:[]},_onObjectRemoved:function(n){n===this._activeObject&&(this.fire("before:selection:cleared",{target:n}),this._discardActiveObject(),this.fire("selection:cleared",{target:n}),n.fire("deselected")),n===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",n)},_fireSelectionEvents:function(n,s){var h=!1,_=this.getActiveObjects(),f=[],p=[];n.forEach(function(m){_.indexOf(m)===-1&&(h=!0,m.fire("deselected",{e:s,target:m}),p.push(m))}),_.forEach(function(m){n.indexOf(m)===-1&&(h=!0,m.fire("selected",{e:s,target:m}),f.push(m))}),n.length>0&&_.length>0?h&&this.fire("selection:updated",{e:s,selected:f,deselected:p}):_.length>0?this.fire("selection:created",{e:s,selected:f}):n.length>0&&this.fire("selection:cleared",{e:s,deselected:p})},setActiveObject:function(n,s){var h=this.getActiveObjects();return this._setActiveObject(n,s),this._fireSelectionEvents(h,s),this},_setActiveObject:function(n,s){return this._activeObject!==n&&!!this._discardActiveObject(s,n)&&!n.onSelect({e:s})&&(this._activeObject=n,!0)},_discardActiveObject:function(n,s){var h=this._activeObject;if(h){if(h.onDeselect({e:n,object:s}))return!1;this._activeObject=null}return!0},discardActiveObject:function(n){var s=this.getActiveObjects(),h=this.getActiveObject();return s.length&&this.fire("before:selection:cleared",{target:h,e:n}),this._discardActiveObject(n),this._fireSelectionEvents(s,n),this},dispose:function(){var n=this.wrapperEl;return this.removeListeners(),n.removeChild(this.upperCanvasEl),n.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(s){y.util.cleanUpJsdomNode(this[s]),this[s]=void 0}.bind(this)),n.parentNode&&n.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,y.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(n){var s=this._activeObject;s&&s._renderControls(n)},_toObject:function(n,s,h){var _=this._realizeGroupTransformOnObject(n),f=this.callSuper("_toObject",n,s,h);return this._unwindGroupTransformOnObject(n,_),f},_realizeGroupTransformOnObject:function(n){if(n.group&&n.group.type==="activeSelection"&&this._activeObject===n.group){var s={};return["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"].forEach(function(h){s[h]=n[h]}),y.util.addTransformToObject(n,this._activeObject.calcOwnMatrix()),s}return null},_unwindGroupTransformOnObject:function(n,s){s&&n.set(s)},_setSVGObject:function(n,s,h){var _=this._realizeGroupTransformOnObject(s);this.callSuper("_setSVGObject",n,s,h),this._unwindGroupTransformOnObject(s,_)},setViewportTransform:function(n){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),y.StaticCanvas.prototype.setViewportTransform.call(this,n)}}),y.StaticCanvas)d!=="prototype"&&(y.Canvas[d]=y.StaticCanvas[d])}(),function(){var a=y.util.addListener,o=y.util.removeListener,l={passive:!1};function d(n,s){return n.button&&n.button===s-1}y.util.object.extend(y.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(a,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(n,s){var h=this.upperCanvasEl,_=this._getEventPrefix();n(y.window,"resize",this._onResize),n(h,_+"down",this._onMouseDown),n(h,_+"move",this._onMouseMove,l),n(h,_+"out",this._onMouseOut),n(h,_+"enter",this._onMouseEnter),n(h,"wheel",this._onMouseWheel),n(h,"contextmenu",this._onContextMenu),n(h,"dblclick",this._onDoubleClick),n(h,"dragover",this._onDragOver),n(h,"dragenter",this._onDragEnter),n(h,"dragleave",this._onDragLeave),n(h,"drop",this._onDrop),this.enablePointerEvents||n(h,"touchstart",this._onTouchStart,l),typeof eventjs<"u"&&s in eventjs&&(eventjs[s](h,"gesture",this._onGesture),eventjs[s](h,"drag",this._onDrag),eventjs[s](h,"orientation",this._onOrientationChange),eventjs[s](h,"shake",this._onShake),eventjs[s](h,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(o,"remove");var n=this._getEventPrefix();o(y.document,n+"up",this._onMouseUp),o(y.document,"touchend",this._onTouchEnd,l),o(y.document,n+"move",this._onMouseMove,l),o(y.document,"touchmove",this._onMouseMove,l)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(n,s){this.__onTransformGesture&&this.__onTransformGesture(n,s)},_onDrag:function(n,s){this.__onDrag&&this.__onDrag(n,s)},_onMouseWheel:function(n){this.__onMouseWheel(n)},_onMouseOut:function(n){var s=this._hoveredTarget;this.fire("mouse:out",{target:s,e:n}),this._hoveredTarget=null,s&&s.fire("mouseout",{e:n});var h=this;this._hoveredTargets.forEach(function(_){h.fire("mouse:out",{target:s,e:n}),_&&s.fire("mouseout",{e:n})}),this._hoveredTargets=[],this._iTextInstances&&this._iTextInstances.forEach(function(_){_.isEditing&&_.hiddenTextarea.focus()})},_onMouseEnter:function(n){this._currentTransform||this.findTarget(n)||(this.fire("mouse:over",{target:null,e:n}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(n,s){this.__onOrientationChange&&this.__onOrientationChange(n,s)},_onShake:function(n,s){this.__onShake&&this.__onShake(n,s)},_onLongPress:function(n,s){this.__onLongPress&&this.__onLongPress(n,s)},_onDragOver:function(n){n.preventDefault();var s=this._simpleEventHandler("dragover",n);this._fireEnterLeaveEvents(s,n)},_onDrop:function(n){return this._simpleEventHandler("drop:before",n),this._simpleEventHandler("drop",n)},_onContextMenu:function(n){return this.stopContextMenu&&(n.stopPropagation(),n.preventDefault()),!1},_onDoubleClick:function(n){this._cacheTransformEventData(n),this._handleEvent(n,"dblclick"),this._resetTransformEventData(n)},getPointerId:function(n){var s=n.changedTouches;return s?s[0]&&s[0].identifier:this.enablePointerEvents?n.pointerId:-1},_isMainEvent:function(n){return n.isPrimary===!0||n.isPrimary!==!1&&(n.type==="touchend"&&n.touches.length===0||!n.changedTouches||n.changedTouches[0].identifier===this.mainTouchId)},_onTouchStart:function(n){n.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(n)),this.__onMouseDown(n),this._resetTransformEventData();var s=this.upperCanvasEl,h=this._getEventPrefix();a(y.document,"touchend",this._onTouchEnd,l),a(y.document,"touchmove",this._onMouseMove,l),o(s,h+"down",this._onMouseDown)},_onMouseDown:function(n){this.__onMouseDown(n),this._resetTransformEventData();var s=this.upperCanvasEl,h=this._getEventPrefix();o(s,h+"move",this._onMouseMove,l),a(y.document,h+"up",this._onMouseUp),a(y.document,h+"move",this._onMouseMove,l)},_onTouchEnd:function(n){if(!(n.touches.length>0)){this.__onMouseUp(n),this._resetTransformEventData(),this.mainTouchId=null;var s=this._getEventPrefix();o(y.document,"touchend",this._onTouchEnd,l),o(y.document,"touchmove",this._onMouseMove,l);var h=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){a(h.upperCanvasEl,s+"down",h._onMouseDown),h._willAddMouseDown=0},400)}},_onMouseUp:function(n){this.__onMouseUp(n),this._resetTransformEventData();var s=this.upperCanvasEl,h=this._getEventPrefix();this._isMainEvent(n)&&(o(y.document,h+"up",this._onMouseUp),o(y.document,h+"move",this._onMouseMove,l),a(s,h+"move",this._onMouseMove,l))},_onMouseMove:function(n){!this.allowTouchScrolling&&n.preventDefault&&n.preventDefault(),this.__onMouseMove(n)},_onResize:function(){this.calcOffset()},_shouldRender:function(n){var s=this._activeObject;return!!(!!s!=!!n||s&&n&&s!==n)||(s&&s.isEditing,!1)},__onMouseUp:function(n){var s,h=this._currentTransform,_=this._groupSelector,f=!1,p=!_||_.left===0&&_.top===0;if(this._cacheTransformEventData(n),s=this._target,this._handleEvent(n,"up:before"),d(n,3))this.fireRightClick&&this._handleEvent(n,"up",3,p);else{if(d(n,2))return this.fireMiddleClick&&this._handleEvent(n,"up",2,p),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)this._onMouseUpInDrawingMode(n);else if(this._isMainEvent(n)){if(h&&(this._finalizeCurrentTransform(n),f=h.actionPerformed),!p){var m=s===this._activeObject;this._maybeGroupObjects(n),f||(f=this._shouldRender(s)||!m&&s===this._activeObject)}var C,T;if(s){if(C=s._findTargetCorner(this.getPointer(n,!0),y.util.isTouchEvent(n)),s.selectable&&s!==this._activeObject&&s.activeOn==="up")this.setActiveObject(s,n),f=!0;else{var x=s.controls[C],I=x&&x.getMouseUpHandler(n,s,x);I&&I(n,h,(T=this.getPointer(n)).x,T.y)}s.isMoving=!1}if(h&&(h.target!==s||h.corner!==C)){var D=h.target&&h.target.controls[h.corner],L=D&&D.getMouseUpHandler(n,s,x);T=T||this.getPointer(n),L&&L(n,h,T.x,T.y)}this._setCursorFromEvent(n,s),this._handleEvent(n,"up",1,p),this._groupSelector=null,this._currentTransform=null,s&&(s.__corner=0),f?this.requestRenderAll():p||this.renderTop()}}},_simpleEventHandler:function(n,s){var h=this.findTarget(s),_=this.targets,f={e:s,target:h,subTargets:_};if(this.fire(n,f),h&&h.fire(n,f),!_)return h;for(var p=0;p<_.length;p++)_[p].fire(n,f);return h},_handleEvent:function(n,s,h,_){var f=this._target,p=this.targets||[],m={e:n,target:f,subTargets:p,button:h||1,isClick:_||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};s==="up"&&(m.currentTarget=this.findTarget(n),m.currentSubTargets=this.targets),this.fire("mouse:"+s,m),f&&f.fire("mouse"+s,m);for(var C=0;C<p.length;C++)p[C].fire("mouse"+s,m)},_finalizeCurrentTransform:function(n){var s=this._currentTransform,h=s.target,_={e:n,target:h,transform:s,action:s.action};h._scaling&&(h._scaling=!1),h.setCoords(),(s.actionPerformed||this.stateful&&h.hasStateChanged())&&this._fire("modified",_)},_onMouseDownInDrawingMode:function(n){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(n).requestRenderAll();var s=this.getPointer(n);this.freeDrawingBrush.onMouseDown(s,{e:n,pointer:s}),this._handleEvent(n,"down")},_onMouseMoveInDrawingMode:function(n){if(this._isCurrentlyDrawing){var s=this.getPointer(n);this.freeDrawingBrush.onMouseMove(s,{e:n,pointer:s})}this.setCursor(this.freeDrawingCursor),this._handleEvent(n,"move")},_onMouseUpInDrawingMode:function(n){var s=this.getPointer(n);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:n,pointer:s}),this._handleEvent(n,"up")},__onMouseDown:function(n){this._cacheTransformEventData(n),this._handleEvent(n,"down:before");var s=this._target;if(d(n,3))this.fireRightClick&&this._handleEvent(n,"down",3);else if(d(n,2))this.fireMiddleClick&&this._handleEvent(n,"down",2);else if(this.isDrawingMode)this._onMouseDownInDrawingMode(n);else if(this._isMainEvent(n)&&!this._currentTransform){var h=this._pointer;this._previousPointer=h;var _=this._shouldRender(s),f=this._shouldGroup(n,s);if(this._shouldClearSelection(n,s)?this.discardActiveObject(n):f&&(this._handleGrouping(n,s),s=this._activeObject),!this.selection||s&&(s.selectable||s.isEditing||s===this._activeObject)||(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),s){var p=s===this._activeObject;s.selectable&&s.activeOn==="down"&&this.setActiveObject(s,n);var m=s._findTargetCorner(this.getPointer(n,!0),y.util.isTouchEvent(n));if(s.__corner=m,s===this._activeObject&&(m||!f)){this._setupCurrentTransform(n,s,p);var C=s.controls[m],T=(h=this.getPointer(n),C&&C.getMouseDownHandler(n,s,C));T&&T(n,this._currentTransform,h.x,h.y)}}this._handleEvent(n,"down"),(_||f)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(n){this._resetTransformEventData(),this._pointer=this.getPointer(n,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(n)||null},_beforeTransform:function(n){var s=this._currentTransform;this.stateful&&s.target.saveState(),this.fire("before:transform",{e:n,transform:s})},__onMouseMove:function(n){var s,h;if(this._handleEvent(n,"move:before"),this._cacheTransformEventData(n),this.isDrawingMode)this._onMouseMoveInDrawingMode(n);else if(this._isMainEvent(n)){var _=this._groupSelector;_?(h=this._absolutePointer,_.left=h.x-_.ex,_.top=h.y-_.ey,this.renderTop()):this._currentTransform?this._transformObject(n):(s=this.findTarget(n)||null,this._setCursorFromEvent(n,s),this._fireOverOutEvents(s,n)),this._handleEvent(n,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(n,s){var h=this._hoveredTarget,_=this._hoveredTargets,f=this.targets,p=Math.max(_.length,f.length);this.fireSyntheticInOutEvents(n,s,{oldTarget:h,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var m=0;m<p;m++)this.fireSyntheticInOutEvents(f[m],s,{oldTarget:_[m],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=n,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(n,s){var h=this._draggedoverTarget,_=this._hoveredTargets,f=this.targets,p=Math.max(_.length,f.length);this.fireSyntheticInOutEvents(n,s,{oldTarget:h,evtOut:"dragleave",evtIn:"dragenter"});for(var m=0;m<p;m++)this.fireSyntheticInOutEvents(f[m],s,{oldTarget:_[m],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=n},fireSyntheticInOutEvents:function(n,s,h){var _,f,p,m=h.oldTarget,C=m!==n,T=h.canvasEvtIn,x=h.canvasEvtOut;C&&(_={e:s,target:n,previousTarget:m},f={e:s,target:m,nextTarget:n}),p=n&&C,m&&C&&(x&&this.fire(x,f),m.fire(h.evtOut,f)),p&&(T&&this.fire(T,_),n.fire(h.evtIn,_))},__onMouseWheel:function(n){this._cacheTransformEventData(n),this._handleEvent(n,"wheel"),this._resetTransformEventData()},_transformObject:function(n){var s=this.getPointer(n),h=this._currentTransform;h.reset=!1,h.shiftKey=n.shiftKey,h.altKey=n[this.centeredKey],this._performTransformAction(n,h,s),h.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(n,s,h){var _=h.x,f=h.y,p=s.action,m=!1,C=s.actionHandler;C&&(m=C(n,s,_,f)),p==="drag"&&m&&(s.target.isMoving=!0,this.setCursor(s.target.moveCursor||this.moveCursor)),s.actionPerformed=s.actionPerformed||m},_fire:y.controlsUtils.fireEvent,_setCursorFromEvent:function(n,s){if(!s)return this.setCursor(this.defaultCursor),!1;var h=s.hoverCursor||this.hoverCursor,_=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,f=(!_||!_.contains(s))&&s._findTargetCorner(this.getPointer(n,!0));f?this.setCursor(this.getCornerCursor(f,s,n)):(s.subTargetCheck&&this.targets.concat().reverse().map(function(p){h=p.hoverCursor||h}),this.setCursor(h))},getCornerCursor:function(n,s,h){var _=s.controls[n];return _.cursorStyleHandler(h,_,s)}})}(),ee=Math.min,K=Math.max,y.util.object.extend(y.Canvas.prototype,{_shouldGroup:function(a,o){var l=this._activeObject;return l&&this._isSelectionKeyPressed(a)&&o&&o.selectable&&this.selection&&(l!==o||l.type==="activeSelection")&&!o.onSelect({e:a})},_handleGrouping:function(a,o){var l=this._activeObject;l.__corner||(o!==l||(o=this.findTarget(a,!0))&&o.selectable)&&(l&&l.type==="activeSelection"?this._updateActiveSelection(o,a):this._createActiveSelection(o,a))},_updateActiveSelection:function(a,o){var l=this._activeObject,d=l._objects.slice(0);l.contains(a)?(l.removeWithUpdate(a),this._hoveredTarget=a,this._hoveredTargets=this.targets.concat(),l.size()===1&&this._setActiveObject(l.item(0),o)):(l.addWithUpdate(a),this._hoveredTarget=l,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(d,o)},_createActiveSelection:function(a,o){var l=this.getActiveObjects(),d=this._createGroup(a);this._hoveredTarget=d,this._setActiveObject(d,o),this._fireSelectionEvents(l,o)},_createGroup:function(a){var o=this._objects,l=o.indexOf(this._activeObject)<o.indexOf(a)?[this._activeObject,a]:[a,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new y.ActiveSelection(l,{canvas:this})},_groupSelectedObjects:function(a){var o,l=this._collectObjects(a);l.length===1?this.setActiveObject(l[0],a):l.length>1&&(o=new y.ActiveSelection(l.reverse(),{canvas:this}),this.setActiveObject(o,a))},_collectObjects:function(a){for(var o,l=[],d=this._groupSelector.ex,n=this._groupSelector.ey,s=d+this._groupSelector.left,h=n+this._groupSelector.top,_=new y.Point(ee(d,s),ee(n,h)),f=new y.Point(K(d,s),K(n,h)),p=!this.selectionFullyContained,m=d===s&&n===h,C=this._objects.length;C--&&!((o=this._objects[C])&&o.selectable&&o.visible&&(p&&o.intersectsWithRect(_,f,!0)||o.isContainedWithinRect(_,f,!0)||p&&o.containsPoint(_,null,!0)||p&&o.containsPoint(f,null,!0))&&(l.push(o),m)););return l.length>1&&(l=l.filter(function(T){return!T.onSelect({e:a})})),l},_maybeGroupObjects:function(a){this.selection&&this._groupSelector&&this._groupSelectedObjects(a),this.setCursor(this.defaultCursor),this._groupSelector=null}}),y.util.object.extend(y.StaticCanvas.prototype,{toDataURL:function(a){a||(a={});var o=a.format||"png",l=a.quality||1,d=(a.multiplier||1)*(a.enableRetinaScaling?this.getRetinaScaling():1),n=this.toCanvasElement(d,a);return y.util.toDataURL(n,o,l)},toCanvasElement:function(a,o){a=a||1;var l=((o=o||{}).width||this.width)*a,d=(o.height||this.height)*a,n=this.getZoom(),s=this.width,h=this.height,_=n*a,f=this.viewportTransform,p=(f[4]-(o.left||0))*a,m=(f[5]-(o.top||0))*a,C=this.interactive,T=[_,0,0,_,p,m],x=this.enableRetinaScaling,I=y.util.createCanvasElement(),D=this.contextTop;return I.width=l,I.height=d,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=T,this.width=l,this.height=d,this.calcViewportBoundaries(),this.renderCanvas(I.getContext("2d"),this._objects),this.viewportTransform=f,this.width=s,this.height=h,this.calcViewportBoundaries(),this.interactive=C,this.enableRetinaScaling=x,this.contextTop=D,I}}),y.util.object.extend(y.StaticCanvas.prototype,{loadFromJSON:function(a,o,l){if(a){var d=typeof a=="string"?JSON.parse(a):y.util.object.clone(a),n=this,s=d.clipPath,h=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete d.clipPath,this._enlivenObjects(d.objects,function(_){n.clear(),n._setBgOverlay(d,function(){s?n._enlivenObjects([s],function(f){n.clipPath=f[0],n.__setupCanvas.call(n,d,_,h,o)}):n.__setupCanvas.call(n,d,_,h,o)})},l),this}},__setupCanvas:function(a,o,l,d){var n=this;o.forEach(function(s,h){n.insertAt(s,h)}),this.renderOnAddRemove=l,delete a.objects,delete a.backgroundImage,delete a.overlayImage,delete a.background,delete a.overlay,this._setOptions(a),this.renderAll(),d&&d()},_setBgOverlay:function(a,o){var l={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(a.backgroundImage||a.overlayImage||a.background||a.overlay){var d=function(){l.backgroundImage&&l.overlayImage&&l.backgroundColor&&l.overlayColor&&o&&o()};this.__setBgOverlay("backgroundImage",a.backgroundImage,l,d),this.__setBgOverlay("overlayImage",a.overlayImage,l,d),this.__setBgOverlay("backgroundColor",a.background,l,d),this.__setBgOverlay("overlayColor",a.overlay,l,d)}else o&&o()},__setBgOverlay:function(a,o,l,d){var n=this;if(!o)return l[a]=!0,void(d&&d());a==="backgroundImage"||a==="overlayImage"?y.util.enlivenObjects([o],function(s){n[a]=s[0],l[a]=!0,d&&d()}):this["set"+y.util.string.capitalize(a,!0)](o,function(){l[a]=!0,d&&d()})},_enlivenObjects:function(a,o,l){a&&a.length!==0?y.util.enlivenObjects(a,function(d){o&&o(d)},null,l):o&&o([])},_toDataURL:function(a,o){this.clone(function(l){o(l.toDataURL(a))})},_toDataURLWithMultiplier:function(a,o,l){this.clone(function(d){l(d.toDataURLWithMultiplier(a,o))})},clone:function(a,o){var l=JSON.stringify(this.toJSON(o));this.cloneWithoutData(function(d){d.loadFromJSON(l,function(){a&&a(d)})})},cloneWithoutData:function(a){var o=y.util.createCanvasElement();o.width=this.width,o.height=this.height;var l=new y.Canvas(o);this.backgroundImage?(l.setBackgroundImage(this.backgroundImage.src,function(){l.renderAll(),a&&a(l)}),l.backgroundImageOpacity=this.backgroundImageOpacity,l.backgroundImageStretch=this.backgroundImageStretch):a&&a(l)}}),function(a){var o=a.fabric||(a.fabric={}),l=o.util.object.extend,d=o.util.object.clone,n=o.util.toFixed,s=o.util.string.capitalize,h=o.util.degreesToRadians,_=!o.isLikelyNode;o.Object||(o.Object=o.util.createClass(o.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:_,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(f){f&&this.setOptions(f)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=o.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(f){var p=o.perfLimitSizeTotal,m=f.width,C=f.height,T=o.maxCacheSideLimit,x=o.minCacheSideLimit;if(m<=T&&C<=T&&m*C<=p)return m<x&&(f.width=x),C<x&&(f.height=x),f;var I=m/C,D=o.util.limitDimsByArea(I,p),L=o.util.capValue,V=L(x,D.x,T),H=L(x,D.y,T);return m>V&&(f.zoomX/=m/V,f.width=V,f.capped=!0),C>H&&(f.zoomY/=C/H,f.height=H,f.capped=!0),f},_getCacheCanvasDimensions:function(){var f=this.getTotalObjectScaling(),p=this._getTransformedDimensions(0,0),m=p.x*f.scaleX/this.scaleX,C=p.y*f.scaleY/this.scaleY;return{width:m+2,height:C+2,zoomX:f.scaleX,zoomY:f.scaleY,x:m,y:C}},_updateCacheCanvas:function(){var f=this.canvas;if(this.noScaleCache&&f&&f._currentTransform){var p=f._currentTransform.target,m=f._currentTransform.action;if(this===p&&m.slice&&m.slice(0,5)==="scale")return!1}var C,T,x=this._cacheCanvas,I=this._limitCacheSize(this._getCacheCanvasDimensions()),D=o.minCacheSideLimit,L=I.width,V=I.height,H=I.zoomX,$=I.zoomY,X=L!==this.cacheWidth||V!==this.cacheHeight,O=this.zoomX!==H||this.zoomY!==$,R=X||O,M=0,F=0,j=!1;if(X){var G=this._cacheCanvas.width,k=this._cacheCanvas.height,P=L>G||V>k;j=P||(L<.9*G||V<.9*k)&&G>D&&k>D,P&&!I.capped&&(L>D||V>D)&&(M=.1*L,F=.1*V)}return this instanceof o.Text&&this.path&&(R=!0,j=!0,M+=this.getHeightOfLine(0)*this.zoomX,F+=this.getHeightOfLine(0)*this.zoomY),!!R&&(j?(x.width=Math.ceil(L+M),x.height=Math.ceil(V+F)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,x.width,x.height)),C=I.x/2,T=I.y/2,this.cacheTranslationX=Math.round(x.width/2-C)+C,this.cacheTranslationY=Math.round(x.height/2-T)+T,this.cacheWidth=L,this.cacheHeight=V,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(H,$),this.zoomX=H,this.zoomY=$,!0)},setOptions:function(f){this._setOptions(f),this._initGradient(f.fill,"fill"),this._initGradient(f.stroke,"stroke"),this._initPattern(f.fill,"fill"),this._initPattern(f.stroke,"stroke")},transform:function(f){var p=this.group&&!this.group._transformDone||this.group&&this.canvas&&f===this.canvas.contextTop,m=this.calcTransformMatrix(!p);f.transform(m[0],m[1],m[2],m[3],m[4],m[5])},toObject:function(f){var p=o.Object.NUM_FRACTION_DIGITS,m={type:this.type,version:o.version,originX:this.originX,originY:this.originY,left:n(this.left,p),top:n(this.top,p),width:n(this.width,p),height:n(this.height,p),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:n(this.strokeWidth,p),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:n(this.strokeMiterLimit,p),scaleX:n(this.scaleX,p),scaleY:n(this.scaleY,p),angle:n(this.angle,p),flipX:this.flipX,flipY:this.flipY,opacity:n(this.opacity,p),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:n(this.skewX,p),skewY:n(this.skewY,p)};return this.clipPath&&!this.clipPath.excludeFromExport&&(m.clipPath=this.clipPath.toObject(f),m.clipPath.inverted=this.clipPath.inverted,m.clipPath.absolutePositioned=this.clipPath.absolutePositioned),o.util.populateWithProperties(this,m,f),this.includeDefaultValues||(m=this._removeDefaultValues(m)),m},toDatalessObject:function(f){return this.toObject(f)},_removeDefaultValues:function(f){var p=o.util.getKlass(f.type).prototype;return p.stateProperties.forEach(function(m){m!=="left"&&m!=="top"&&(f[m]===p[m]&&delete f[m],Array.isArray(f[m])&&Array.isArray(p[m])&&f[m].length===0&&p[m].length===0&&delete f[m])}),f},toString:function(){return"#<fabric."+s(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var f=o.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(f.scaleX),scaleY:Math.abs(f.scaleY)}},getTotalObjectScaling:function(){var f=this.getObjectScaling(),p=f.scaleX,m=f.scaleY;if(this.canvas){var C=this.canvas.getZoom(),T=this.canvas.getRetinaScaling();p*=C*T,m*=C*T}return{scaleX:p,scaleY:m}},getObjectOpacity:function(){var f=this.opacity;return this.group&&(f*=this.group.getObjectOpacity()),f},_set:function(f,p){var m=f==="scaleX"||f==="scaleY",C=this[f]!==p,T=!1;return m&&(p=this._constrainScale(p)),f==="scaleX"&&p<0?(this.flipX=!this.flipX,p*=-1):f==="scaleY"&&p<0?(this.flipY=!this.flipY,p*=-1):f!=="shadow"||!p||p instanceof o.Shadow?f==="dirty"&&this.group&&this.group.set("dirty",p):p=new o.Shadow(p),this[f]=p,C&&(T=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(f)>-1?(this.dirty=!0,T&&this.group.set("dirty",!0)):T&&this.stateProperties.indexOf(f)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:o.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(f){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(f.save(),this._setupCompositeOperation(f),this.drawSelectionBackground(f),this.transform(f),this._setOpacity(f),this._setShadow(f,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(f)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(f),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),f.restore())},renderCache:function(f){f=f||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,f.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!(this.paintFirst!=="stroke"||!this.hasFill()||!this.hasStroke()||typeof this.shadow!="object")||!!this.clipPath},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(f,p){if(f.save(),p.inverted?f.globalCompositeOperation="destination-out":f.globalCompositeOperation="destination-in",p.absolutePositioned){var m=o.util.invertTransform(this.calcTransformMatrix());f.transform(m[0],m[1],m[2],m[3],m[4],m[5])}p.transform(f),f.scale(1/p.zoomX,1/p.zoomY),f.drawImage(p._cacheCanvas,-p.cacheTranslationX,-p.cacheTranslationY),f.restore()},drawObject:function(f,p){var m=this.fill,C=this.stroke;p?(this.fill="black",this.stroke="",this._setClippingProperties(f)):this._renderBackground(f),this._render(f),this._drawClipPath(f,this.clipPath),this.fill=m,this.stroke=C},_drawClipPath:function(f,p){p&&(p.canvas=this.canvas,p.shouldCache(),p._transformDone=!0,p.renderCache({forClipping:!0}),this.drawClipPathOnCache(f,p))},drawCacheOnCanvas:function(f){f.scale(1/this.zoomX,1/this.zoomY),f.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(f){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!f&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!f){var p=this.cacheWidth/this.zoomX,m=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-p/2,-m/2,p,m)}return!0}return!1},_renderBackground:function(f){if(this.backgroundColor){var p=this._getNonTransformedDimensions();f.fillStyle=this.backgroundColor,f.fillRect(-p.x/2,-p.y/2,p.x,p.y),this._removeShadow(f)}},_setOpacity:function(f){this.group&&!this.group._transformDone?f.globalAlpha=this.getObjectOpacity():f.globalAlpha*=this.opacity},_setStrokeStyles:function(f,p){var m=p.stroke;m&&(f.lineWidth=p.strokeWidth,f.lineCap=p.strokeLineCap,f.lineDashOffset=p.strokeDashOffset,f.lineJoin=p.strokeLineJoin,f.miterLimit=p.strokeMiterLimit,m.toLive?m.gradientUnits==="percentage"||m.gradientTransform||m.patternTransform?this._applyPatternForTransformedGradient(f,m):(f.strokeStyle=m.toLive(f,this),this._applyPatternGradientTransform(f,m)):f.strokeStyle=p.stroke)},_setFillStyles:function(f,p){var m=p.fill;m&&(m.toLive?(f.fillStyle=m.toLive(f,this),this._applyPatternGradientTransform(f,p.fill)):f.fillStyle=m)},_setClippingProperties:function(f){f.globalAlpha=1,f.strokeStyle="transparent",f.fillStyle="#000000"},_setLineDash:function(f,p){p&&p.length!==0&&(1&p.length&&p.push.apply(p,p),f.setLineDash(p))},_renderControls:function(f,p){var m,C,T,x=this.getViewportTransform(),I=this.calcTransformMatrix();C=(p=p||{}).hasBorders!==void 0?p.hasBorders:this.hasBorders,T=p.hasControls!==void 0?p.hasControls:this.hasControls,I=o.util.multiplyTransformMatrices(x,I),m=o.util.qrDecompose(I),f.save(),f.translate(m.translateX,m.translateY),f.lineWidth=1*this.borderScaleFactor,this.group||(f.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(m.angle-=180),f.rotate(h(this.group?m.angle:this.angle)),p.forActiveSelection||this.group?C&&this.drawBordersInGroup(f,m,p):C&&this.drawBorders(f,p),T&&this.drawControls(f,p),f.restore()},_setShadow:function(f){if(this.shadow){var p,m=this.shadow,C=this.canvas,T=C&&C.viewportTransform[0]||1,x=C&&C.viewportTransform[3]||1;p=m.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),C&&C._isRetinaScaling()&&(T*=o.devicePixelRatio,x*=o.devicePixelRatio),f.shadowColor=m.color,f.shadowBlur=m.blur*o.browserShadowBlurConstant*(T+x)*(p.scaleX+p.scaleY)/4,f.shadowOffsetX=m.offsetX*T*p.scaleX,f.shadowOffsetY=m.offsetY*x*p.scaleY}},_removeShadow:function(f){this.shadow&&(f.shadowColor="",f.shadowBlur=f.shadowOffsetX=f.shadowOffsetY=0)},_applyPatternGradientTransform:function(f,p){if(!p||!p.toLive)return{offsetX:0,offsetY:0};var m=p.gradientTransform||p.patternTransform,C=-this.width/2+p.offsetX||0,T=-this.height/2+p.offsetY||0;return p.gradientUnits==="percentage"?f.transform(this.width,0,0,this.height,C,T):f.transform(1,0,0,1,C,T),m&&f.transform(m[0],m[1],m[2],m[3],m[4],m[5]),{offsetX:C,offsetY:T}},_renderPaintInOrder:function(f){this.paintFirst==="stroke"?(this._renderStroke(f),this._renderFill(f)):(this._renderFill(f),this._renderStroke(f))},_render:function(){},_renderFill:function(f){this.fill&&(f.save(),this._setFillStyles(f,this),this.fillRule==="evenodd"?f.fill("evenodd"):f.fill(),f.restore())},_renderStroke:function(f){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(f),f.save(),this.strokeUniform&&this.group){var p=this.getObjectScaling();f.scale(1/p.scaleX,1/p.scaleY)}else this.strokeUniform&&f.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(f,this.strokeDashArray),this._setStrokeStyles(f,this),f.stroke(),f.restore()}},_applyPatternForTransformedGradient:function(f,p){var m,C=this._limitCacheSize(this._getCacheCanvasDimensions()),T=o.util.createCanvasElement(),x=this.canvas.getRetinaScaling(),I=C.x/this.scaleX/x,D=C.y/this.scaleY/x;T.width=I,T.height=D,(m=T.getContext("2d")).beginPath(),m.moveTo(0,0),m.lineTo(I,0),m.lineTo(I,D),m.lineTo(0,D),m.closePath(),m.translate(I/2,D/2),m.scale(C.zoomX/this.scaleX/x,C.zoomY/this.scaleY/x),this._applyPatternGradientTransform(m,p),m.fillStyle=p.toLive(f),m.fill(),f.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),f.scale(x*this.scaleX/C.zoomX,x*this.scaleY/C.zoomY),f.strokeStyle=m.createPattern(T,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var f=o.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",f.scaleX),this.set("scaleY",f.scaleY),this.angle=f.angle,this.skewX=f.skewX,this.skewY=0}},_removeTransformMatrix:function(f){var p=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),p=o.util.transformPoint(p,this.transformMatrix)),this.transformMatrix=null,f&&(this.scaleX*=f.scaleX,this.scaleY*=f.scaleY,this.cropX=f.cropX,this.cropY=f.cropY,p.x+=f.offsetLeft,p.y+=f.offsetTop,this.width=f.width,this.height=f.height),this.setPositionByOrigin(p,"center","center")},clone:function(f,p){var m=this.toObject(p);this.constructor.fromObject?this.constructor.fromObject(m,f):o.Object._fromObject("Object",m,f)},cloneAsImage:function(f,p){var m=this.toCanvasElement(p);return f&&f(new o.Image(m)),this},toCanvasElement:function(f){f||(f={});var p=o.util,m=p.saveObjectTransform(this),C=this.group,T=this.shadow,x=Math.abs,I=(f.multiplier||1)*(f.enableRetinaScaling?o.devicePixelRatio:1);delete this.group,f.withoutTransform&&p.resetObjectTransform(this),f.withoutShadow&&(this.shadow=null);var D,L,V,H,$=o.util.createCanvasElement(),X=this.getBoundingRect(!0,!0),O=this.shadow,R={x:0,y:0};O&&(L=O.blur,D=O.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),R.x=2*Math.round(x(O.offsetX)+L)*x(D.scaleX),R.y=2*Math.round(x(O.offsetY)+L)*x(D.scaleY)),V=X.width+R.x,H=X.height+R.y,$.width=Math.ceil(V),$.height=Math.ceil(H);var M=new o.StaticCanvas($,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});f.format==="jpeg"&&(M.backgroundColor="#fff"),this.setPositionByOrigin(new o.Point(M.width/2,M.height/2),"center","center");var F=this.canvas;M.add(this);var j=M.toCanvasElement(I||1,f);return this.shadow=T,this.set("canvas",F),C&&(this.group=C),this.set(m).setCoords(),M._objects=[],M.dispose(),M=null,j},toDataURL:function(f){return f||(f={}),o.util.toDataURL(this.toCanvasElement(f),f.format||"png",f.quality||1)},isType:function(f){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===f},complexity:function(){return 1},toJSON:function(f){return this.toObject(f)},rotate:function(f){var p=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return p&&this._setOriginToCenter(),this.set("angle",f),p&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(f,p){p=p||this.canvas.getPointer(f);var m=new o.Point(p.x,p.y),C=this._getLeftTopCoords();return this.angle&&(m=o.util.rotatePoint(m,C,h(-this.angle))),{x:m.x-C.x,y:m.y-C.y}},_setupCompositeOperation:function(f){this.globalCompositeOperation&&(f.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){o.runningAnimations&&o.runningAnimations.cancelByTarget(this)}}),o.util.createAccessors&&o.util.createAccessors(o.Object),l(o.Object.prototype,o.Observable),o.Object.NUM_FRACTION_DIGITS=2,o.Object.ENLIVEN_PROPS=["clipPath"],o.Object._fromObject=function(f,p,m,C){var T=o[f];p=d(p,!0),o.util.enlivenPatterns([p.fill,p.stroke],function(x){x[0]!==void 0&&(p.fill=x[0]),x[1]!==void 0&&(p.stroke=x[1]),o.util.enlivenObjectEnlivables(p,p,function(){var I=C?new T(p[C],p):new T(p);m&&m(I)})})},o.Object.__uid=0)}(t),oe=y.util.degreesToRadians,pe={left:-.5,center:0,right:.5},ye={top:-.5,center:0,bottom:.5},y.util.object.extend(y.Object.prototype,{translateToGivenOrigin:function(a,o,l,d,n){var s,h,_,f=a.x,p=a.y;return typeof o=="string"?o=pe[o]:o-=.5,typeof d=="string"?d=pe[d]:d-=.5,typeof l=="string"?l=ye[l]:l-=.5,typeof n=="string"?n=ye[n]:n-=.5,h=n-l,((s=d-o)||h)&&(_=this._getTransformedDimensions(),f=a.x+s*_.x,p=a.y+h*_.y),new y.Point(f,p)},translateToCenterPoint:function(a,o,l){var d=this.translateToGivenOrigin(a,o,l,"center","center");return this.angle?y.util.rotatePoint(d,a,oe(this.angle)):d},translateToOriginPoint:function(a,o,l){var d=this.translateToGivenOrigin(a,"center","center",o,l);return this.angle?y.util.rotatePoint(d,a,oe(this.angle)):d},getCenterPoint:function(){var a=new y.Point(this.left,this.top);return this.translateToCenterPoint(a,this.originX,this.originY)},getPointByOrigin:function(a,o){var l=this.getCenterPoint();return this.translateToOriginPoint(l,a,o)},toLocalPoint:function(a,o,l){var d,n,s=this.getCenterPoint();return d=o!==void 0&&l!==void 0?this.translateToGivenOrigin(s,"center","center",o,l):new y.Point(this.left,this.top),n=new y.Point(a.x,a.y),this.angle&&(n=y.util.rotatePoint(n,s,-oe(this.angle))),n.subtractEquals(d)},setPositionByOrigin:function(a,o,l){var d=this.translateToCenterPoint(a,o,l),n=this.translateToOriginPoint(d,this.originX,this.originY);this.set("left",n.x),this.set("top",n.y)},adjustPosition:function(a){var o,l,d=oe(this.angle),n=this.getScaledWidth(),s=y.util.cos(d)*n,h=y.util.sin(d)*n;o=typeof this.originX=="string"?pe[this.originX]:this.originX-.5,l=typeof a=="string"?pe[a]:a-.5,this.left+=s*(l-o),this.top+=h*(l-o),this.setCoords(),this.originX=a},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var a=this.getCenterPoint();this.originX="center",this.originY="center",this.left=a.x,this.top=a.y},_resetOrigin:function(){var a=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=a.x,this.top=a.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}}),function(){var a=y.util,o=a.degreesToRadians,l=a.multiplyTransformMatrices,d=a.transformPoint;a.object.extend(y.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(n,s){return s?n?this.calcACoords():this.calcLineCoords():(this.aCoords&&this.lineCoords||this.setCoords(!0),n?this.aCoords:this.lineCoords)},getCoords:function(n,s){return h=this._getCoords(n,s),[new y.Point(h.tl.x,h.tl.y),new y.Point(h.tr.x,h.tr.y),new y.Point(h.br.x,h.br.y),new y.Point(h.bl.x,h.bl.y)];var h},intersectsWithRect:function(n,s,h,_){var f=this.getCoords(h,_);return y.Intersection.intersectPolygonRectangle(f,n,s).status==="Intersection"},intersectsWithObject:function(n,s,h){return y.Intersection.intersectPolygonPolygon(this.getCoords(s,h),n.getCoords(s,h)).status==="Intersection"||n.isContainedWithinObject(this,s,h)||this.isContainedWithinObject(n,s,h)},isContainedWithinObject:function(n,s,h){for(var _=this.getCoords(s,h),f=s?n.aCoords:n.lineCoords,p=0,m=n._getImageLines(f);p<4;p++)if(!n.containsPoint(_[p],m))return!1;return!0},isContainedWithinRect:function(n,s,h,_){var f=this.getBoundingRect(h,_);return f.left>=n.x&&f.left+f.width<=s.x&&f.top>=n.y&&f.top+f.height<=s.y},containsPoint:function(n,s,h,_){var f=this._getCoords(h,_),p=(s=s||this._getImageLines(f),this._findCrossPoints(n,s));return p!==0&&p%2==1},isOnScreen:function(n){if(!this.canvas)return!1;var s=this.canvas.vptCoords.tl,h=this.canvas.vptCoords.br;return!!this.getCoords(!0,n).some(function(_){return _.x<=h.x&&_.x>=s.x&&_.y<=h.y&&_.y>=s.y})||!!this.intersectsWithRect(s,h,!0,n)||this._containsCenterOfCanvas(s,h,n)},_containsCenterOfCanvas:function(n,s,h){var _={x:(n.x+s.x)/2,y:(n.y+s.y)/2};return!!this.containsPoint(_,null,!0,h)},isPartiallyOnScreen:function(n){if(!this.canvas)return!1;var s=this.canvas.vptCoords.tl,h=this.canvas.vptCoords.br;return!!this.intersectsWithRect(s,h,!0,n)||this.getCoords(!0,n).every(function(_){return(_.x>=h.x||_.x<=s.x)&&(_.y>=h.y||_.y<=s.y)})&&this._containsCenterOfCanvas(s,h,n)},_getImageLines:function(n){return{topline:{o:n.tl,d:n.tr},rightline:{o:n.tr,d:n.br},bottomline:{o:n.br,d:n.bl},leftline:{o:n.bl,d:n.tl}}},_findCrossPoints:function(n,s){var h,_,f,p=0;for(var m in s)if(!((f=s[m]).o.y<n.y&&f.d.y<n.y||f.o.y>=n.y&&f.d.y>=n.y||(f.o.x===f.d.x&&f.o.x>=n.x?_=f.o.x:(h=(f.d.y-f.o.y)/(f.d.x-f.o.x),_=-(n.y-0*n.x-(f.o.y-h*f.o.x))/(0-h)),_>=n.x&&(p+=1),p!==2)))break;return p},getBoundingRect:function(n,s){var h=this.getCoords(n,s);return a.makeBoundingBoxFromPoints(h)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(n){return Math.abs(n)<this.minScaleLimit?n<0?-this.minScaleLimit:this.minScaleLimit:n===0?1e-4:n},scale:function(n){return this._set("scaleX",n),this._set("scaleY",n),this.setCoords()},scaleToWidth:function(n,s){var h=this.getBoundingRect(s).width/this.getScaledWidth();return this.scale(n/this.width/h)},scaleToHeight:function(n,s){var h=this.getBoundingRect(s).height/this.getScaledHeight();return this.scale(n/this.height/h)},calcLineCoords:function(){var n=this.getViewportTransform(),s=this.padding,h=o(this.angle),_=a.cos(h)*s,f=a.sin(h)*s,p=_+f,m=_-f,C=this.calcACoords(),T={tl:d(C.tl,n),tr:d(C.tr,n),bl:d(C.bl,n),br:d(C.br,n)};return s&&(T.tl.x-=m,T.tl.y-=p,T.tr.x+=p,T.tr.y-=m,T.bl.x-=p,T.bl.y+=m,T.br.x+=m,T.br.y+=p),T},calcOCoords:function(){var n=this._calcRotateMatrix(),s=this._calcTranslateMatrix(),h=this.getViewportTransform(),_=l(h,s),f=l(_,n),p=(f=l(f,[1/h[0],0,0,1/h[3],0,0]),this._calculateCurrentDimensions()),m={};return this.forEachControl(function(C,T,x){m[T]=C.positionHandler(p,f,x)}),m},calcACoords:function(){var n=this._calcRotateMatrix(),s=this._calcTranslateMatrix(),h=l(s,n),_=this._getTransformedDimensions(),f=_.x/2,p=_.y/2;return{tl:d({x:-f,y:-p},h),tr:d({x:f,y:-p},h),bl:d({x:-f,y:p},h),br:d({x:f,y:p},h)}},setCoords:function(n){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),n||(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords()),this},_calcRotateMatrix:function(){return a.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var n=this.getCenterPoint();return[1,0,0,1,n.x,n.y]},transformMatrixKey:function(n){var s="_",h="";return!n&&this.group&&(h=this.group.transformMatrixKey(n)+s),h+this.top+s+this.left+s+this.scaleX+s+this.scaleY+s+this.skewX+s+this.skewY+s+this.angle+s+this.originX+s+this.originY+s+this.width+s+this.height+s+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(n){var s=this.calcOwnMatrix();if(n||!this.group)return s;var h=this.transformMatrixKey(n),_=this.matrixCache||(this.matrixCache={});return _.key===h?_.value:(this.group&&(s=l(this.group.calcTransformMatrix(!1),s)),_.key=h,_.value=s,s)},calcOwnMatrix:function(){var n=this.transformMatrixKey(!0),s=this.ownMatrixCache||(this.ownMatrixCache={});if(s.key===n)return s.value;var h=this._calcTranslateMatrix(),_={angle:this.angle,translateX:h[4],translateY:h[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return s.key=n,s.value=a.composeMatrix(_),s.value},_getNonTransformedDimensions:function(){var n=this.strokeWidth;return{x:this.width+n,y:this.height+n}},_getTransformedDimensions:function(n,s){n===void 0&&(n=this.skewX),s===void 0&&(s=this.skewY);var h,_,f,p=n===0&&s===0;if(this.strokeUniform?(_=this.width,f=this.height):(_=(h=this._getNonTransformedDimensions()).x,f=h.y),p)return this._finalizeDimensions(_*this.scaleX,f*this.scaleY);var m=a.sizeAfterTransform(_,f,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:n,skewY:s});return this._finalizeDimensions(m.x,m.y)},_finalizeDimensions:function(n,s){return this.strokeUniform?{x:n+this.strokeWidth,y:s+this.strokeWidth}:{x:n,y:s}},_calculateCurrentDimensions:function(){var n=this.getViewportTransform(),s=this._getTransformedDimensions();return d(s,n,!0).scalarAdd(2*this.padding)}})}(),y.util.object.extend(y.Object.prototype,{sendToBack:function(){return this.group?y.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?y.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(a){return this.group?y.StaticCanvas.prototype.sendBackwards.call(this.group,this,a):this.canvas&&this.canvas.sendBackwards(this,a),this},bringForward:function(a){return this.group?y.StaticCanvas.prototype.bringForward.call(this.group,this,a):this.canvas&&this.canvas.bringForward(this,a),this},moveTo:function(a){return this.group&&this.group.type!=="activeSelection"?y.StaticCanvas.prototype.moveTo.call(this.group,this,a):this.canvas&&this.canvas.moveTo(this,a),this}}),function(){function a(l,d){if(d){if(d.toLive)return l+": url(#SVGID_"+d.id+"); ";var n=new y.Color(d),s=l+": "+n.toRgb()+"; ",h=n.getAlpha();return h!==1&&(s+=l+"-opacity: "+h.toString()+"; "),s}return l+": none; "}var o=y.util.toFixed;y.util.object.extend(y.Object.prototype,{getSvgStyles:function(l){var d=this.fillRule?this.fillRule:"nonzero",n=this.strokeWidth?this.strokeWidth:"0",s=this.strokeDashArray?this.strokeDashArray.join(" "):"none",h=this.strokeDashOffset?this.strokeDashOffset:"0",_=this.strokeLineCap?this.strokeLineCap:"butt",f=this.strokeLineJoin?this.strokeLineJoin:"miter",p=this.strokeMiterLimit?this.strokeMiterLimit:"4",m=this.opacity!==void 0?this.opacity:"1",C=this.visible?"":" visibility: hidden;",T=l?"":this.getSvgFilter(),x=a("fill",this.fill);return[a("stroke",this.stroke),"stroke-width: ",n,"; ","stroke-dasharray: ",s,"; ","stroke-linecap: ",_,"; ","stroke-dashoffset: ",h,"; ","stroke-linejoin: ",f,"; ","stroke-miterlimit: ",p,"; ",x,"fill-rule: ",d,"; ","opacity: ",m,";",T,C].join("")},getSvgSpanStyles:function(l,d){var n="; ",s=l.fontFamily?"font-family: "+(l.fontFamily.indexOf("'")===-1&&l.fontFamily.indexOf('"')===-1?"'"+l.fontFamily+"'":l.fontFamily)+n:"",h=l.strokeWidth?"stroke-width: "+l.strokeWidth+n:"",_=l.fontSize?"font-size: "+l.fontSize+"px"+n:"",f=l.fontStyle?"font-style: "+l.fontStyle+n:"",p=l.fontWeight?"font-weight: "+l.fontWeight+n:"",m=l.fill?a("fill",l.fill):"",C=l.stroke?a("stroke",l.stroke):"",T=this.getSvgTextDecoration(l);return T&&(T="text-decoration: "+T+n),[C,h,s,_,f,p,T,m,l.deltaY?"baseline-shift: "+-l.deltaY+"; ":"",d?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(l){return["overline","underline","line-through"].filter(function(d){return l[d.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(l,d){var n=l?this.calcTransformMatrix():this.calcOwnMatrix();return'transform="'+y.util.matrixToSVG(n)+(d||"")+'" '},_setSVGBg:function(l){if(this.backgroundColor){var d=y.Object.NUM_FRACTION_DIGITS;l.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',o(-this.width/2,d),'" y="',o(-this.height/2,d),'" width="',o(this.width,d),'" height="',o(this.height,d),`"></rect>
`)}},toSVG:function(l){return this._createBaseSVGMarkup(this._toSVG(l),{reviver:l})},toClipPathSVG:function(l){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(l),{reviver:l})},_createBaseClipPathSVGMarkup:function(l,d){var n=(d=d||{}).reviver,s=d.additionalTransform||"",h=[this.getSvgTransform(!0,s),this.getSvgCommons()].join(""),_=l.indexOf("COMMON_PARTS");return l[_]=h,n?n(l.join("")):l.join("")},_createBaseSVGMarkup:function(l,d){var n,s,h=(d=d||{}).noStyle,_=d.reviver,f=h?"":'style="'+this.getSvgStyles()+'" ',p=d.withShadow?'style="'+this.getSvgFilter()+'" ':"",m=this.clipPath,C=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",T=m&&m.absolutePositioned,x=this.stroke,I=this.fill,D=this.shadow,L=[],V=l.indexOf("COMMON_PARTS"),H=d.additionalTransform;return m&&(m.clipPathId="CLIPPATH_"+y.Object.__uid++,s='<clipPath id="'+m.clipPathId+`" >
`+m.toClipPathSVG(_)+`</clipPath>
`),T&&L.push("<g ",p,this.getSvgCommons(),` >
`),L.push("<g ",this.getSvgTransform(!1),T?"":p+this.getSvgCommons(),` >
`),n=[f,C,h?"":this.addPaintOrder()," ",H?'transform="'+H+'" ':""].join(""),l[V]=n,I&&I.toLive&&L.push(I.toSVG(this)),x&&x.toLive&&L.push(x.toSVG(this)),D&&L.push(D.toSVG(this)),m&&L.push(s),L.push(l.join("")),L.push(`</g>
`),T&&L.push(`</g>
`),_?_(L.join("")):L.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var a=y.util.object.extend,o="stateProperties";function l(n,s,h){var _={};h.forEach(function(f){_[f]=n[f]}),a(n[s],_,!0)}function d(n,s,h){if(n===s)return!0;if(Array.isArray(n)){if(!Array.isArray(s)||n.length!==s.length)return!1;for(var _=0,f=n.length;_<f;_++)if(!d(n[_],s[_]))return!1;return!0}if(n&&typeof n=="object"){var p,m=Object.keys(n);if(!s||typeof s!="object"||!h&&m.length!==Object.keys(s).length)return!1;for(_=0,f=m.length;_<f;_++)if((p=m[_])!=="canvas"&&p!=="group"&&!d(n[p],s[p]))return!1;return!0}}y.util.object.extend(y.Object.prototype,{hasStateChanged:function(n){var s="_"+(n=n||o);return Object.keys(this[s]).length<this[n].length||!d(this[s],this,!0)},saveState:function(n){var s=n&&n.propertySet||o,h="_"+s;return this[h]?(l(this,h,this[s]),n&&n.stateProperties&&l(this,h,n.stateProperties),this):this.setupState(n)},setupState:function(n){var s=(n=n||{}).propertySet||o;return n.propertySet=s,this["_"+s]={},this.saveState(n),this}})}(),function(){var a=y.util.degreesToRadians;y.util.object.extend(y.Object.prototype,{_findTargetCorner:function(o,l){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var d,n,s,h=o.x,_=o.y,f=Object.keys(this.oCoords),p=f.length-1;for(this.__corner=0;p>=0;p--)if(s=f[p],this.isControlVisible(s)&&(n=this._getImageLines(l?this.oCoords[s].touchCorner:this.oCoords[s].corner),(d=this._findCrossPoints({x:h,y:_},n))!==0&&d%2==1))return this.__corner=s,s;return!1},forEachControl:function(o){for(var l in this.controls)o(this.controls[l],l,this)},_setCornerCoords:function(){var o=this.oCoords;for(var l in o){var d=this.controls[l];o[l].corner=d.calcCornerCoords(this.angle,this.cornerSize,o[l].x,o[l].y,!1),o[l].touchCorner=d.calcCornerCoords(this.angle,this.touchCornerSize,o[l].x,o[l].y,!0)}},drawSelectionBackground:function(o){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;o.save();var l=this.getCenterPoint(),d=this._calculateCurrentDimensions(),n=this.canvas.viewportTransform;return o.translate(l.x,l.y),o.scale(1/n[0],1/n[3]),o.rotate(a(this.angle)),o.fillStyle=this.selectionBackgroundColor,o.fillRect(-d.x/2,-d.y/2,d.x,d.y),o.restore(),this},drawBorders:function(o,l){l=l||{};var d=this._calculateCurrentDimensions(),n=this.borderScaleFactor,s=d.x+n,h=d.y+n,_=l.hasControls!==void 0?l.hasControls:this.hasControls,f=!1;return o.save(),o.strokeStyle=l.borderColor||this.borderColor,this._setLineDash(o,l.borderDashArray||this.borderDashArray),o.strokeRect(-s/2,-h/2,s,h),_&&(o.beginPath(),this.forEachControl(function(p,m,C){p.withConnection&&p.getVisibility(C,m)&&(f=!0,o.moveTo(p.x*s,p.y*h),o.lineTo(p.x*s+p.offsetX,p.y*h+p.offsetY))}),f&&o.stroke()),o.restore(),this},drawBordersInGroup:function(o,l,d){d=d||{};var n=y.util.sizeAfterTransform(this.width,this.height,l),s=this.strokeWidth,h=this.strokeUniform,_=this.borderScaleFactor,f=n.x+s*(h?this.canvas.getZoom():l.scaleX)+_,p=n.y+s*(h?this.canvas.getZoom():l.scaleY)+_;return o.save(),this._setLineDash(o,d.borderDashArray||this.borderDashArray),o.strokeStyle=d.borderColor||this.borderColor,o.strokeRect(-f/2,-p/2,f,p),o.restore(),this},drawControls:function(o,l){l=l||{},o.save();var d,n,s=this.canvas.getRetinaScaling();return o.setTransform(s,0,0,s,0,0),o.strokeStyle=o.fillStyle=l.cornerColor||this.cornerColor,this.transparentCorners||(o.strokeStyle=l.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(o,l.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(d=this.group.calcTransformMatrix()),this.forEachControl(function(h,_,f){n=f.oCoords[_],h.getVisibility(f,_)&&(d&&(n=y.util.transformPoint(n,d)),h.render(o,n.x,n.y,l,f))}),o.restore(),this},isControlVisible:function(o){return this.controls[o]&&this.controls[o].getVisibility(this,o)},setControlVisible:function(o,l){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[o]=l,this},setControlsVisibility:function(o){for(var l in o||(o={}),o)this.setControlVisible(l,o[l]);return this},onDeselect:function(){},onSelect:function(){}})}(),y.util.object.extend(y.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(a,o){var l=function(){},d=(o=o||{}).onComplete||l,n=o.onChange||l,s=this;return y.util.animate({target:this,startValue:a.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(h){a.set("left",h),s.requestRenderAll(),n()},onComplete:function(){a.setCoords(),d()}})},fxCenterObjectV:function(a,o){var l=function(){},d=(o=o||{}).onComplete||l,n=o.onChange||l,s=this;return y.util.animate({target:this,startValue:a.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(h){a.set("top",h),s.requestRenderAll(),n()},onComplete:function(){a.setCoords(),d()}})},fxRemove:function(a,o){var l=function(){},d=(o=o||{}).onComplete||l,n=o.onChange||l,s=this;return y.util.animate({target:this,startValue:a.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(h){a.set("opacity",h),s.requestRenderAll(),n()},onComplete:function(){s.remove(a),d()}})}}),y.util.object.extend(y.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var a,o,l=[],d=[];for(a in arguments[0])l.push(a);for(var n=0,s=l.length;n<s;n++)a=l[n],o=n!==s-1,d.push(this._animate(a,arguments[0][a],arguments[1],o));return d}return this._animate.apply(this,arguments)},_animate:function(a,o,l,d){var n,s=this;o=o.toString(),l=l?y.util.object.clone(l):{},~a.indexOf(".")&&(n=a.split("."));var h=s.colorProperties.indexOf(a)>-1||n&&s.colorProperties.indexOf(n[1])>-1,_=n?this.get(n[0])[n[1]]:this.get(a);"from"in l||(l.from=_),h||(o=~o.indexOf("=")?_+parseFloat(o.replace("=","")):parseFloat(o));var f={target:this,startValue:l.from,endValue:o,byValue:l.by,easing:l.easing,duration:l.duration,abort:l.abort&&function(p,m,C){return l.abort.call(s,p,m,C)},onChange:function(p,m,C){n?s[n[0]][n[1]]=p:s.set(a,p),d||l.onChange&&l.onChange(p,m,C)},onComplete:function(p,m,C){d||(s.setCoords(),l.onComplete&&l.onComplete(p,m,C))}};return h?y.util.animateColor(f.startValue,f.endValue,f.duration,f):y.util.animate(f)}}),function(a){var o=a.fabric||(a.fabric={}),l=o.util.object.extend,d=o.util.object.clone,n={x1:1,x2:1,y1:1,y2:1};function s(h,_){var f=h.origin,p=h.axis1,m=h.axis2,C=h.dimension,T=_.nearest,x=_.center,I=_.farthest;return function(){switch(this.get(f)){case T:return Math.min(this.get(p),this.get(m));case x:return Math.min(this.get(p),this.get(m))+.5*this.get(C);case I:return Math.max(this.get(p),this.get(m))}}}o.Line?o.warn("fabric.Line is already defined"):(o.Line=o.util.createClass(o.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:o.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(h,_){h||(h=[0,0,0,0]),this.callSuper("initialize",_),this.set("x1",h[0]),this.set("y1",h[1]),this.set("x2",h[2]),this.set("y2",h[3]),this._setWidthHeight(_)},_setWidthHeight:function(h){h||(h={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in h?h.left:this._getLeftToOriginX(),this.top="top"in h?h.top:this._getTopToOriginY()},_set:function(h,_){return this.callSuper("_set",h,_),n[h]!==void 0&&this._setWidthHeight(),this},_getLeftToOriginX:s({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:s({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(h){h.beginPath();var _=this.calcLinePoints();h.moveTo(_.x1,_.y1),h.lineTo(_.x2,_.y2),h.lineWidth=this.strokeWidth;var f=h.strokeStyle;h.strokeStyle=this.stroke||h.fillStyle,this.stroke&&this._renderStroke(h),h.strokeStyle=f},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(h){return l(this.callSuper("toObject",h),this.calcLinePoints())},_getNonTransformedDimensions:function(){var h=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(h.y-=this.strokeWidth),this.height===0&&(h.x-=this.strokeWidth)),h},calcLinePoints:function(){var h=this.x1<=this.x2?-1:1,_=this.y1<=this.y2?-1:1,f=h*this.width*.5,p=_*this.height*.5;return{x1:f,x2:h*this.width*-.5,y1:p,y2:_*this.height*-.5}},_toSVG:function(){var h=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',h.x1,'" y1="',h.y1,'" x2="',h.x2,'" y2="',h.y2,`" />
`]}}),o.Line.ATTRIBUTE_NAMES=o.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),o.Line.fromElement=function(h,_,f){f=f||{};var p=o.parseAttributes(h,o.Line.ATTRIBUTE_NAMES),m=[p.x1||0,p.y1||0,p.x2||0,p.y2||0];_(new o.Line(m,l(p,f)))},o.Line.fromObject=function(h,_){var f=d(h,!0);f.points=[h.x1,h.y1,h.x2,h.y2],o.Object._fromObject("Line",f,function(p){delete p.points,_&&_(p)},"points")})}(t),function(a){var o=a.fabric||(a.fabric={}),l=o.util.degreesToRadians;o.Circle?o.warn("fabric.Circle is already defined."):(o.Circle=o.util.createClass(o.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:o.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(d,n){return this.callSuper("_set",d,n),d==="radius"&&this.setRadius(n),this},toObject:function(d){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(d))},_toSVG:function(){var d,n=(this.endAngle-this.startAngle)%360;if(n===0)d=["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',this.radius,`" />
`];else{var s=l(this.startAngle),h=l(this.endAngle),_=this.radius;d=['<path d="M '+o.util.cos(s)*_+" "+o.util.sin(s)*_," A "+_+" "+_," 0 ",+(n>180?"1":"0")+" 1"," "+o.util.cos(h)*_+" "+o.util.sin(h)*_,'" ',"COMMON_PARTS",` />
`]}return d},_render:function(d){d.beginPath(),d.arc(0,0,this.radius,l(this.startAngle),l(this.endAngle),!1),this._renderPaintInOrder(d)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(d){return this.radius=d,this.set("width",2*d).set("height",2*d)}}),o.Circle.ATTRIBUTE_NAMES=o.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),o.Circle.fromElement=function(d,n){var s,h=o.parseAttributes(d,o.Circle.ATTRIBUTE_NAMES);if(!("radius"in(s=h)&&s.radius>=0))throw new Error("value of `r` attribute is required and can not be negative");h.left=(h.left||0)-h.radius,h.top=(h.top||0)-h.radius,n(new o.Circle(h))},o.Circle.fromObject=function(d,n){o.Object._fromObject("Circle",d,n)})}(t),function(a){var o=a.fabric||(a.fabric={});o.Triangle?o.warn("fabric.Triangle is already defined"):(o.Triangle=o.util.createClass(o.Object,{type:"triangle",width:100,height:100,_render:function(l){var d=this.width/2,n=this.height/2;l.beginPath(),l.moveTo(-d,n),l.lineTo(0,-n),l.lineTo(d,n),l.closePath(),this._renderPaintInOrder(l)},_toSVG:function(){var l=this.width/2,d=this.height/2;return["<polygon ","COMMON_PARTS",'points="',[-l+" "+d,"0 "+-d,l+" "+d].join(","),'" />']}}),o.Triangle.fromObject=function(l,d){return o.Object._fromObject("Triangle",l,d)})}(t),function(a){var o=a.fabric||(a.fabric={}),l=2*Math.PI;o.Ellipse?o.warn("fabric.Ellipse is already defined."):(o.Ellipse=o.util.createClass(o.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:o.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(d){this.callSuper("initialize",d),this.set("rx",d&&d.rx||0),this.set("ry",d&&d.ry||0)},_set:function(d,n){switch(this.callSuper("_set",d,n),d){case"rx":this.rx=n,this.set("width",2*n);break;case"ry":this.ry=n,this.set("height",2*n)}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(d){return this.callSuper("toObject",["rx","ry"].concat(d))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(d){d.beginPath(),d.save(),d.transform(1,0,0,this.ry/this.rx,0,0),d.arc(0,0,this.rx,0,l,!1),d.restore(),this._renderPaintInOrder(d)}}),o.Ellipse.ATTRIBUTE_NAMES=o.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),o.Ellipse.fromElement=function(d,n){var s=o.parseAttributes(d,o.Ellipse.ATTRIBUTE_NAMES);s.left=(s.left||0)-s.rx,s.top=(s.top||0)-s.ry,n(new o.Ellipse(s))},o.Ellipse.fromObject=function(d,n){o.Object._fromObject("Ellipse",d,n)})}(t),function(a){var o=a.fabric||(a.fabric={}),l=o.util.object.extend;o.Rect?o.warn("fabric.Rect is already defined"):(o.Rect=o.util.createClass(o.Object,{stateProperties:o.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:o.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(d){this.callSuper("initialize",d),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(d){var n=this.rx?Math.min(this.rx,this.width/2):0,s=this.ry?Math.min(this.ry,this.height/2):0,h=this.width,_=this.height,f=-this.width/2,p=-this.height/2,m=n!==0||s!==0,C=.4477152502;d.beginPath(),d.moveTo(f+n,p),d.lineTo(f+h-n,p),m&&d.bezierCurveTo(f+h-C*n,p,f+h,p+C*s,f+h,p+s),d.lineTo(f+h,p+_-s),m&&d.bezierCurveTo(f+h,p+_-C*s,f+h-C*n,p+_,f+h-n,p+_),d.lineTo(f+n,p+_),m&&d.bezierCurveTo(f+C*n,p+_,f,p+_-C*s,f,p+_-s),d.lineTo(f,p+s),m&&d.bezierCurveTo(f,p+C*s,f+C*n,p,f+n,p),d.closePath(),this._renderPaintInOrder(d)},toObject:function(d){return this.callSuper("toObject",["rx","ry"].concat(d))},_toSVG:function(){return["<rect ","COMMON_PARTS",'x="',-this.width/2,'" y="',-this.height/2,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),o.Rect.ATTRIBUTE_NAMES=o.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),o.Rect.fromElement=function(d,n,s){if(!d)return n(null);s=s||{};var h=o.parseAttributes(d,o.Rect.ATTRIBUTE_NAMES);h.left=h.left||0,h.top=h.top||0,h.height=h.height||0,h.width=h.width||0;var _=new o.Rect(l(s?o.util.object.clone(s):{},h));_.visible=_.visible&&_.width>0&&_.height>0,n(_)},o.Rect.fromObject=function(d,n){return o.Object._fromObject("Rect",d,n)})}(t),function(a){var o=a.fabric||(a.fabric={}),l=o.util.object.extend,d=o.util.array.min,n=o.util.array.max,s=o.util.toFixed,h=o.util.projectStrokeOnPoints;o.Polyline?o.warn("fabric.Polyline is already defined"):(o.Polyline=o.util.createClass(o.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:o.Object.prototype.cacheProperties.concat("points"),initialize:function(_,f){f=f||{},this.points=_||[],this.callSuper("initialize",f),this._setPositionDimensions(f)},_projectStrokeOnPoints:function(){return h(this.points,this,!0)},_setPositionDimensions:function(_){var f,p=this._calcDimensions(_),m=this.exactBoundingBox?this.strokeWidth:0;this.width=p.width-m,this.height=p.height-m,_.fromSVG||(f=this.translateToGivenOrigin({x:p.left-this.strokeWidth/2+m/2,y:p.top-this.strokeWidth/2+m/2},"left","top",this.originX,this.originY)),_.left===void 0&&(this.left=_.fromSVG?p.left:f.x),_.top===void 0&&(this.top=_.fromSVG?p.top:f.y),this.pathOffset={x:p.left+this.width/2+m/2,y:p.top+this.height/2+m/2}},_calcDimensions:function(){var _=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,f=d(_,"x")||0,p=d(_,"y")||0;return{left:f,top:p,width:(n(_,"x")||0)-f,height:(n(_,"y")||0)-p}},toObject:function(_){return l(this.callSuper("toObject",_),{points:this.points.concat()})},_toSVG:function(){for(var _=[],f=this.pathOffset.x,p=this.pathOffset.y,m=o.Object.NUM_FRACTION_DIGITS,C=0,T=this.points.length;C<T;C++)_.push(s(this.points[C].x-f,m),",",s(this.points[C].y-p,m)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',_.join(""),`" />
`]},commonRender:function(_){var f,p=this.points.length,m=this.pathOffset.x,C=this.pathOffset.y;if(!p||isNaN(this.points[p-1].y))return!1;_.beginPath(),_.moveTo(this.points[0].x-m,this.points[0].y-C);for(var T=0;T<p;T++)f=this.points[T],_.lineTo(f.x-m,f.y-C);return!0},_render:function(_){this.commonRender(_)&&this._renderPaintInOrder(_)},complexity:function(){return this.get("points").length}}),o.Polyline.ATTRIBUTE_NAMES=o.SHARED_ATTRIBUTES.concat(),o.Polyline.fromElementGenerator=function(_){return function(f,p,m){if(!f)return p(null);m||(m={});var C=o.parsePointsAttribute(f.getAttribute("points")),T=o.parseAttributes(f,o[_].ATTRIBUTE_NAMES);T.fromSVG=!0,p(new o[_](C,l(T,m)))}},o.Polyline.fromElement=o.Polyline.fromElementGenerator("Polyline"),o.Polyline.fromObject=function(_,f){return o.Object._fromObject("Polyline",_,f,"points")})}(t),function(a){var o=a.fabric||(a.fabric={}),l=o.util.projectStrokeOnPoints;o.Polygon?o.warn("fabric.Polygon is already defined"):(o.Polygon=o.util.createClass(o.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return l(this.points,this)},_render:function(d){this.commonRender(d)&&(d.closePath(),this._renderPaintInOrder(d))}}),o.Polygon.ATTRIBUTE_NAMES=o.SHARED_ATTRIBUTES.concat(),o.Polygon.fromElement=o.Polyline.fromElementGenerator("Polygon"),o.Polygon.fromObject=function(d,n){o.Object._fromObject("Polygon",d,n,"points")})}(t),function(a){var o=a.fabric||(a.fabric={}),l=o.util.array.min,d=o.util.array.max,n=o.util.object.extend,s=o.util.object.clone,h=o.util.toFixed;o.Path?o.warn("fabric.Path is already defined"):(o.Path=o.util.createClass(o.Object,{type:"path",path:null,cacheProperties:o.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:o.Object.prototype.stateProperties.concat("path"),initialize:function(_,f){delete(f=s(f||{})).path,this.callSuper("initialize",f),this._setPath(_||[],f)},_setPath:function(_,f){this.path=o.util.makePathSimpler(Array.isArray(_)?_:o.util.parsePath(_)),o.Polyline.prototype._setPositionDimensions.call(this,f||{})},_renderPathCommands:function(_){var f,p=0,m=0,C=0,T=0,x=0,I=0,D=-this.pathOffset.x,L=-this.pathOffset.y;_.beginPath();for(var V=0,H=this.path.length;V<H;++V)switch((f=this.path[V])[0]){case"L":C=f[1],T=f[2],_.lineTo(C+D,T+L);break;case"M":p=C=f[1],m=T=f[2],_.moveTo(C+D,T+L);break;case"C":C=f[5],T=f[6],x=f[3],I=f[4],_.bezierCurveTo(f[1]+D,f[2]+L,x+D,I+L,C+D,T+L);break;case"Q":_.quadraticCurveTo(f[1]+D,f[2]+L,f[3]+D,f[4]+L),C=f[3],T=f[4],x=f[1],I=f[2];break;case"z":case"Z":C=p,T=m,_.closePath()}},_render:function(_){this._renderPathCommands(_),this._renderPaintInOrder(_)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(_){return n(this.callSuper("toObject",_),{path:this.path.map(function(f){return f.slice()})})},toDatalessObject:function(_){var f=this.toObject(["sourcePath"].concat(_));return f.sourcePath&&delete f.path,f},_toSVG:function(){return["<path ","COMMON_PARTS",'d="',o.util.joinPath(this.path),'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var _=o.Object.NUM_FRACTION_DIGITS;return" translate("+h(-this.pathOffset.x,_)+", "+h(-this.pathOffset.y,_)+")"},toClipPathSVG:function(_){var f=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:_,additionalTransform:f})},toSVG:function(_){var f=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:_,additionalTransform:f})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var _,f,p=[],m=[],C=0,T=0,x=0,I=0,D=0,L=this.path.length;D<L;++D){switch((_=this.path[D])[0]){case"L":x=_[1],I=_[2],f=[];break;case"M":C=x=_[1],T=I=_[2],f=[];break;case"C":f=o.util.getBoundsOfCurve(x,I,_[1],_[2],_[3],_[4],_[5],_[6]),x=_[5],I=_[6];break;case"Q":f=o.util.getBoundsOfCurve(x,I,_[1],_[2],_[1],_[2],_[3],_[4]),x=_[3],I=_[4];break;case"z":case"Z":x=C,I=T}f.forEach(function($){p.push($.x),m.push($.y)}),p.push(x),m.push(I)}var V=l(p)||0,H=l(m)||0;return{left:V,top:H,width:(d(p)||0)-V,height:(d(m)||0)-H}}}),o.Path.fromObject=function(_,f){if(typeof _.sourcePath=="string"){var p=_.sourcePath;o.loadSVGFromURL(p,function(m){var C=m[0];C.setOptions(_),f&&f(C)})}else o.Object._fromObject("Path",_,f,"path")},o.Path.ATTRIBUTE_NAMES=o.SHARED_ATTRIBUTES.concat(["d"]),o.Path.fromElement=function(_,f,p){var m=o.parseAttributes(_,o.Path.ATTRIBUTE_NAMES);m.fromSVG=!0,f(new o.Path(m.d,n(m,p)))})}(t),function(a){var o=a.fabric||(a.fabric={}),l=o.util.array.min,d=o.util.array.max;o.Group||(o.Group=o.util.createClass(o.Object,o.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(n,s,h){s=s||{},this._objects=[],h&&this.callSuper("initialize",s),this._objects=n||[];for(var _=this._objects.length;_--;)this._objects[_].group=this;if(h)this._updateObjectsACoords();else{var f=s&&s.centerPoint;s.originX!==void 0&&(this.originX=s.originX),s.originY!==void 0&&(this.originY=s.originY),f||this._calcBounds(),this._updateObjectsCoords(f),delete s.centerPoint,this.callSuper("initialize",s)}this.setCoords()},_updateObjectsACoords:function(){for(var n=this._objects.length;n--;)this._objects[n].setCoords(!0)},_updateObjectsCoords:function(n){n=n||this.getCenterPoint();for(var s=this._objects.length;s--;)this._updateObjectCoords(this._objects[s],n)},_updateObjectCoords:function(n,s){var h=n.left,_=n.top;n.set({left:h-s.x,top:_-s.y}),n.group=this,n.setCoords(!0)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(n){var s=!!this.group;return this._restoreObjectsState(),o.util.resetObjectTransform(this),n&&(s&&o.util.removeTransformFromObject(n,this.group.calcTransformMatrix()),this._objects.push(n),n.group=this,n._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,s?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(n){return this._restoreObjectsState(),o.util.resetObjectTransform(this),this.remove(n),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(n){this.dirty=!0,n.group=this,n._set("canvas",this.canvas)},_onObjectRemoved:function(n){this.dirty=!0,delete n.group},_set:function(n,s){var h=this._objects.length;if(this.useSetOnGroup)for(;h--;)this._objects[h].setOnGroup(n,s);if(n==="canvas")for(;h--;)this._objects[h]._set(n,s);o.Object.prototype._set.call(this,n,s)},toObject:function(n){var s=this.includeDefaultValues,h=this._objects.filter(function(f){return!f.excludeFromExport}).map(function(f){var p=f.includeDefaultValues;f.includeDefaultValues=s;var m=f.toObject(n);return f.includeDefaultValues=p,m}),_=o.Object.prototype.toObject.call(this,n);return _.objects=h,_},toDatalessObject:function(n){var s,h=this.sourcePath;if(h)s=h;else{var _=this.includeDefaultValues;s=this._objects.map(function(p){var m=p.includeDefaultValues;p.includeDefaultValues=_;var C=p.toDatalessObject(n);return p.includeDefaultValues=m,C})}var f=o.Object.prototype.toDatalessObject.call(this,n);return f.objects=s,f},render:function(n){this._transformDone=!0,this.callSuper("render",n),this._transformDone=!1},shouldCache:function(){var n=o.Object.prototype.shouldCache.call(this);if(n){for(var s=0,h=this._objects.length;s<h;s++)if(this._objects[s].willDrawShadow())return this.ownCaching=!1,!1}return n},willDrawShadow:function(){if(o.Object.prototype.willDrawShadow.call(this))return!0;for(var n=0,s=this._objects.length;n<s;n++)if(this._objects[n].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(n){for(var s=0,h=this._objects.length;s<h;s++)this._objects[s].render(n);this._drawClipPath(n,this.clipPath)},isCacheDirty:function(n){if(this.callSuper("isCacheDirty",n))return!0;if(!this.statefullCache)return!1;for(var s=0,h=this._objects.length;s<h;s++)if(this._objects[s].isCacheDirty(!0)){if(this._cacheCanvas){var _=this.cacheWidth/this.zoomX,f=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-_/2,-f/2,_,f)}return!0}return!1},_restoreObjectsState:function(){var n=this.calcOwnMatrix();return this._objects.forEach(function(s){o.util.addTransformToObject(s,n),delete s.group,s.setCoords()}),this},destroy:function(){return this._objects.forEach(function(n){n.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(n){n.dispose&&n.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var n=this._objects,s=this.canvas;this._objects=[];var h=this.toObject();delete h.objects;var _=new o.ActiveSelection([]);return _.set(h),_.type="activeSelection",s.remove(this),n.forEach(function(f){f.group=_,f.dirty=!0,s.add(f)}),_.canvas=s,_._objects=n,s._activeObject=_,_.setCoords(),_}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){return this.forEachObject(function(n){n.setCoords(!0)}),this},_calcBounds:function(n){for(var s,h,_,f,p=[],m=[],C=["tr","br","bl","tl"],T=0,x=this._objects.length,I=C.length;T<x;++T){for(_=(s=this._objects[T]).calcACoords(),f=0;f<I;f++)h=C[f],p.push(_[h].x),m.push(_[h].y);s.aCoords=_}this._getBounds(p,m,n)},_getBounds:function(n,s,h){var _=new o.Point(l(n),l(s)),f=new o.Point(d(n),d(s)),p=_.y||0,m=_.x||0,C=f.x-_.x||0,T=f.y-_.y||0;this.width=C,this.height=T,h||this.setPositionByOrigin({x:m,y:p},"left","top")},_toSVG:function(n){for(var s=["<g ","COMMON_PARTS",` >
`],h=0,_=this._objects.length;h<_;h++)s.push("		",this._objects[h].toSVG(n));return s.push(`</g>
`),s},getSvgStyles:function(){var n=this.opacity!==void 0&&this.opacity!==1?"opacity: "+this.opacity+";":"",s=this.visible?"":" visibility: hidden;";return[n,this.getSvgFilter(),s].join("")},toClipPathSVG:function(n){for(var s=[],h=0,_=this._objects.length;h<_;h++)s.push("	",this._objects[h].toClipPathSVG(n));return this._createBaseClipPathSVGMarkup(s,{reviver:n})}}),o.Group.fromObject=function(n,s){var h=n.objects,_=o.util.object.clone(n,!0);delete _.objects,typeof h!="string"?o.util.enlivenObjects(h,function(f){var p=o.util.object.clone(n,!0);delete p.objects,o.util.enlivenObjectEnlivables(n,p,function(){s&&s(new o.Group(f,p,!0))})}):o.loadSVGFromURL(h,function(f){var p=o.util.groupSVGElements(f,n,h);p.set(_),s&&s(p)})})}(t),function(a){var o=a.fabric||(a.fabric={});o.ActiveSelection||(o.ActiveSelection=o.util.createClass(o.Group,{type:"activeSelection",initialize:function(l,d){d=d||{},this._objects=l||[];for(var n=this._objects.length;n--;)this._objects[n].group=this;d.originX&&(this.originX=d.originX),d.originY&&(this.originY=d.originY),this._calcBounds(),this._updateObjectsCoords(),o.Object.prototype.initialize.call(this,d),this.setCoords()},toGroup:function(){var l=this._objects.concat();this._objects=[];var d=o.Object.prototype.toObject.call(this),n=new o.Group([]);if(delete d.type,n.set(d),l.forEach(function(h){h.canvas.remove(h),h.group=n}),n._objects=l,!this.canvas)return n;var s=this.canvas;return s.add(n),s._activeObject=n,n.setCoords(),n},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(l,d,n){l.save(),l.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",l,d),(n=n||{}).hasControls===void 0&&(n.hasControls=!1),n.forActiveSelection=!0;for(var s=0,h=this._objects.length;s<h;s++)this._objects[s]._renderControls(l,n);l.restore()}}),o.ActiveSelection.fromObject=function(l,d){o.util.enlivenObjects(l.objects,function(n){delete l.objects,d&&d(new o.ActiveSelection(n,l,!0))})})}(t),function(a){var o=y.util.object.extend;a.fabric||(a.fabric={}),a.fabric.Image?y.warn("fabric.Image is already defined."):(y.Image=y.util.createClass(y.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:y.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:y.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(l,d){d||(d={}),this.filters=[],this.cacheKey="texture"+y.Object.__uid++,this.callSuper("initialize",d),this._initElement(l,d)},getElement:function(){return this._element||{}},setElement:function(l,d){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=l,this._originalElement=l,this._initConfig(d),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(l){var d=y.filterBackend;d&&d.evictCachesForKey&&d.evictCachesForKey(l)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(l){y.util.cleanUpJsdomNode(this[l]),this[l]=void 0}.bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var l=this.getElement();return{width:l.naturalWidth||l.width,height:l.naturalHeight||l.height}},_stroke:function(l){if(this.stroke&&this.strokeWidth!==0){var d=this.width/2,n=this.height/2;l.beginPath(),l.moveTo(-d,-n),l.lineTo(d,-n),l.lineTo(d,n),l.lineTo(-d,n),l.lineTo(-d,-n),l.closePath()}},toObject:function(l){var d=[];this.filters.forEach(function(s){s&&d.push(s.toObject())});var n=o(this.callSuper("toObject",["cropX","cropY"].concat(l)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:d});return this.resizeFilter&&(n.resizeFilter=this.resizeFilter.toObject()),n},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var l,d=[],n=[],s=this._element,h=-this.width/2,_=-this.height/2,f="",p="";if(!s)return[];if(this.hasCrop()){var m=y.Object.__uid++;d.push('<clipPath id="imageCrop_'+m+`">
`,'	<rect x="'+h+'" y="'+_+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),f=' clip-path="url(#imageCrop_'+m+')" '}if(this.imageSmoothing||(p='" image-rendering="optimizeSpeed'),n.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',h-this.cropX,'" y="',_-this.cropY,'" width="',s.width||s.naturalWidth,'" height="',s.height||s.height,p,'"',f,`></image>
`),this.stroke||this.strokeDashArray){var C=this.fill;this.fill=null,l=["	<rect ",'x="',h,'" y="',_,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=C}return this.paintFirst!=="fill"?d.concat(l,n):d.concat(n,l)},getSrc:function(l){var d=l?this._element:this._originalElement;return d?d.toDataURL?d.toDataURL():this.srcFromAttribute?d.getAttribute("src"):d.src:this.src||""},setSrc:function(l,d,n){return y.util.loadImage(l,function(s,h){this.setElement(s,n),this._setWidthHeight(),d&&d(this,h)},this,n&&n.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var l=this.resizeFilter,d=this.minimumScaleTrigger,n=this.getTotalObjectScaling(),s=n.scaleX,h=n.scaleY,_=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!l||s>d&&h>d)return this._element=_,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=s,void(this._lastScaleY=h);y.filterBackend||(y.filterBackend=y.initFilterBackend());var f=y.util.createCanvasElement(),p=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,m=_.width,C=_.height;f.width=m,f.height=C,this._element=f,this._lastScaleX=l.scaleX=s,this._lastScaleY=l.scaleY=h,y.filterBackend.applyFilters([l],_,m,C,this._element,p),this._filterScalingX=f.width/this._originalElement.width,this._filterScalingY=f.height/this._originalElement.height},applyFilters:function(l){if(l=(l=l||this.filters||[]).filter(function(_){return _&&!_.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),l.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var d=this._originalElement,n=d.naturalWidth||d.width,s=d.naturalHeight||d.height;if(this._element===this._originalElement){var h=y.util.createCanvasElement();h.width=n,h.height=s,this._element=h,this._filteredEl=h}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,n,s),this._lastScaleX=1,this._lastScaleY=1;return y.filterBackend||(y.filterBackend=y.initFilterBackend()),y.filterBackend.applyFilters(l,this._originalElement,n,s,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(l){y.util.setImageSmoothing(l,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(l),this._renderPaintInOrder(l)},drawCacheOnCanvas:function(l){y.util.setImageSmoothing(l,this.imageSmoothing),y.Object.prototype.drawCacheOnCanvas.call(this,l)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(l){var d=this._element;if(d){var n=this._filterScalingX,s=this._filterScalingY,h=this.width,_=this.height,f=Math.min,p=Math.max,m=p(this.cropX,0),C=p(this.cropY,0),T=d.naturalWidth||d.width,x=d.naturalHeight||d.height,I=m*n,D=C*s,L=f(h*n,T-I),V=f(_*s,x-D),H=-h/2,$=-_/2,X=f(h,T/n-m),O=f(_,x/s-C);d&&l.drawImage(d,I,D,L,V,H,$,X,O)}},_needsResize:function(){var l=this.getTotalObjectScaling();return l.scaleX!==this._lastScaleX||l.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(l,d){this.setElement(y.util.getById(l),d),y.util.addClass(this.getElement(),y.Image.CSS_CANVAS)},_initConfig:function(l){l||(l={}),this.setOptions(l),this._setWidthHeight(l)},_initFilters:function(l,d){l&&l.length?y.util.enlivenObjects(l,function(n){d&&d(n)},"fabric.Image.filters"):d&&d()},_setWidthHeight:function(l){l||(l={});var d=this.getElement();this.width=l.width||d.naturalWidth||d.width||0,this.height=l.height||d.naturalHeight||d.height||0},parsePreserveAspectRatioAttribute:function(){var l,d=y.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),n=this._element.width,s=this._element.height,h=1,_=1,f=0,p=0,m=0,C=0,T=this.width,x=this.height,I={width:T,height:x};return!d||d.alignX==="none"&&d.alignY==="none"?(h=T/n,_=x/s):(d.meetOrSlice==="meet"&&(l=(T-n*(h=_=y.util.findScaleToFit(this._element,I)))/2,d.alignX==="Min"&&(f=-l),d.alignX==="Max"&&(f=l),l=(x-s*_)/2,d.alignY==="Min"&&(p=-l),d.alignY==="Max"&&(p=l)),d.meetOrSlice==="slice"&&(l=n-T/(h=_=y.util.findScaleToCover(this._element,I)),d.alignX==="Mid"&&(m=l/2),d.alignX==="Max"&&(m=l),l=s-x/_,d.alignY==="Mid"&&(C=l/2),d.alignY==="Max"&&(C=l),n=T/h,s=x/_)),{width:n,height:s,scaleX:h,scaleY:_,offsetLeft:f,offsetTop:p,cropX:m,cropY:C}}}),y.Image.CSS_CANVAS="canvas-img",y.Image.prototype.getSvgSrc=y.Image.prototype.getSrc,y.Image.fromObject=function(l,d){var n=y.util.object.clone(l);y.util.loadImage(n.src,function(s,h){h?d&&d(null,!0):y.Image.prototype._initFilters.call(n,n.filters,function(_){n.filters=_||[],y.Image.prototype._initFilters.call(n,[n.resizeFilter],function(f){n.resizeFilter=f[0],y.util.enlivenObjectEnlivables(n,n,function(){var p=new y.Image(s,n);d(p,!1)})})})},null,n.crossOrigin)},y.Image.fromURL=function(l,d,n){y.util.loadImage(l,function(s,h){d&&d(new y.Image(s,n),h)},null,n&&n.crossOrigin)},y.Image.ATTRIBUTE_NAMES=y.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),y.Image.fromElement=function(l,d,n){var s=y.parseAttributes(l,y.Image.ATTRIBUTE_NAMES);y.Image.fromURL(s["xlink:href"],d,o(n?y.util.object.clone(n):{},s))})}(t),y.util.object.extend(y.Object.prototype,{_getAngleValueForStraighten:function(){var a=this.angle%360;return a>0?90*Math.round((a-1)/90):90*Math.round(a/90)},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(a){var o=function(){},l=(a=a||{}).onComplete||o,d=a.onChange||o,n=this;return y.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(s){n.rotate(s),d()},onComplete:function(){n.setCoords(),l()}})}}),y.util.object.extend(y.StaticCanvas.prototype,{straightenObject:function(a){return a.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(a){return a.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){function a(l,d){var n="precision "+d+` float;
void main(){}`,s=l.createShader(l.FRAGMENT_SHADER);return l.shaderSource(s,n),l.compileShader(s),!!l.getShaderParameter(s,l.COMPILE_STATUS)}function o(l){l&&l.tileSize&&(this.tileSize=l.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}y.isWebglSupported=function(l){if(y.isLikelyNode)return!1;l=l||y.WebglFilterBackend.prototype.tileSize;var d=document.createElement("canvas"),n=d.getContext("webgl")||d.getContext("experimental-webgl"),s=!1;if(n){y.maxTextureSize=n.getParameter(n.MAX_TEXTURE_SIZE),s=y.maxTextureSize>=l;for(var h=["highp","mediump","lowp"],_=0;_<3;_++)if(a(n,h[_])){y.webGlPrecision=h[_];break}}return this.isSupported=s,s},y.WebglFilterBackend=o,o.prototype={tileSize:2048,resources:{},setupGLContext:function(l,d){this.dispose(),this.createWebGLCanvas(l,d),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(l,d)},chooseFastestCopyGLTo2DMethod:function(l,d){var n,s=window.performance!==void 0;try{new ImageData(1,1),n=!0}catch{n=!1}var h=typeof ArrayBuffer<"u",_=typeof Uint8ClampedArray<"u";if(s&&n&&h&&_){var f=y.util.createCanvasElement(),p=new ArrayBuffer(l*d*4);if(y.forceGLPutImageData)return this.imageBuffer=p,void(this.copyGLTo2D=he);var m,C,T={imageBuffer:p,destinationWidth:l,destinationHeight:d,targetCanvas:f};f.width=l,f.height=d,m=window.performance.now(),te.call(T,this.gl,T),C=window.performance.now()-m,m=window.performance.now(),he.call(T,this.gl,T),C>window.performance.now()-m?(this.imageBuffer=p,this.copyGLTo2D=he):this.copyGLTo2D=te}},createWebGLCanvas:function(l,d){var n=y.util.createCanvasElement();n.width=l,n.height=d;var s={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},h=n.getContext("webgl",s);h||(h=n.getContext("experimental-webgl",s)),h&&(h.clearColor(0,0,0,0),this.canvas=n,this.gl=h)},applyFilters:function(l,d,n,s,h,_){var f,p=this.gl;_&&(f=this.getCachedTexture(_,d));var m={originalWidth:d.width||d.originalWidth,originalHeight:d.height||d.originalHeight,sourceWidth:n,sourceHeight:s,destinationWidth:n,destinationHeight:s,context:p,sourceTexture:this.createTexture(p,n,s,!f&&d),targetTexture:this.createTexture(p,n,s),originalTexture:f||this.createTexture(p,n,s,!f&&d),passes:l.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:h},C=p.createFramebuffer();return p.bindFramebuffer(p.FRAMEBUFFER,C),l.forEach(function(T){T&&T.applyTo(m)}),function(T){var x=T.targetCanvas,I=x.width,D=x.height,L=T.destinationWidth,V=T.destinationHeight;I===L&&D===V||(x.width=L,x.height=V)}(m),this.copyGLTo2D(p,m),p.bindTexture(p.TEXTURE_2D,null),p.deleteTexture(m.sourceTexture),p.deleteTexture(m.targetTexture),p.deleteFramebuffer(C),h.getContext("2d").setTransform(1,0,0,1,0,0),m},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(l,d,n,s){var h=l.createTexture();return l.bindTexture(l.TEXTURE_2D,h),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.NEAREST),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE),s?l.texImage2D(l.TEXTURE_2D,0,l.RGBA,l.RGBA,l.UNSIGNED_BYTE,s):l.texImage2D(l.TEXTURE_2D,0,l.RGBA,d,n,0,l.RGBA,l.UNSIGNED_BYTE,null),h},getCachedTexture:function(l,d){if(this.textureCache[l])return this.textureCache[l];var n=this.createTexture(this.gl,d.width,d.height,d);return this.textureCache[l]=n,n},evictCachesForKey:function(l){this.textureCache[l]&&(this.gl.deleteTexture(this.textureCache[l]),delete this.textureCache[l])},copyGLTo2D:te,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var l=this.gl,d={renderer:"",vendor:""};if(!l)return d;var n=l.getExtension("WEBGL_debug_renderer_info");if(n){var s=l.getParameter(n.UNMASKED_RENDERER_WEBGL),h=l.getParameter(n.UNMASKED_VENDOR_WEBGL);s&&(d.renderer=s.toLowerCase()),h&&(d.vendor=h.toLowerCase())}return this.gpuInfo=d,d}}}(),function(){var a=function(){};function o(){}y.Canvas2dFilterBackend=o,o.prototype={evictCachesForKey:a,dispose:a,clearWebGLCaches:a,resources:{},applyFilters:function(l,d,n,s,h){var _=h.getContext("2d");_.drawImage(d,0,0,n,s);var f={sourceWidth:n,sourceHeight:s,imageData:_.getImageData(0,0,n,s),originalEl:d,originalImageData:_.getImageData(0,0,n,s),canvasEl:h,ctx:_,filterBackend:this};return l.forEach(function(p){p.applyTo(f)}),f.imageData.width===n&&f.imageData.height===s||(h.width=f.imageData.width,h.height=f.imageData.height),_.putImageData(f.imageData,0,0),f}}}(),y.Image=y.Image||{},y.Image.filters=y.Image.filters||{},y.Image.filters.BaseFilter=y.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(a){a&&this.setOptions(a)},setOptions:function(a){for(var o in a)this[o]=a[o]},createProgram:function(a,o,l){o=o||this.fragmentSource,l=l||this.vertexSource,y.webGlPrecision!=="highp"&&(o=o.replace(/precision highp float/g,"precision "+y.webGlPrecision+" float"));var d=a.createShader(a.VERTEX_SHADER);if(a.shaderSource(d,l),a.compileShader(d),!a.getShaderParameter(d,a.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+a.getShaderInfoLog(d));var n=a.createShader(a.FRAGMENT_SHADER);if(a.shaderSource(n,o),a.compileShader(n),!a.getShaderParameter(n,a.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+a.getShaderInfoLog(n));var s=a.createProgram();if(a.attachShader(s,d),a.attachShader(s,n),a.linkProgram(s),!a.getProgramParameter(s,a.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+a.getProgramInfoLog(s));var h=this.getAttributeLocations(a,s),_=this.getUniformLocations(a,s)||{};return _.uStepW=a.getUniformLocation(s,"uStepW"),_.uStepH=a.getUniformLocation(s,"uStepH"),{program:s,attributeLocations:h,uniformLocations:_}},getAttributeLocations:function(a,o){return{aPosition:a.getAttribLocation(o,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(a,o,l){var d=o.aPosition,n=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,n),a.enableVertexAttribArray(d),a.vertexAttribPointer(d,2,a.FLOAT,!1,0,0),a.bufferData(a.ARRAY_BUFFER,l,a.STATIC_DRAW)},_setupFrameBuffer:function(a){var o,l,d=a.context;a.passes>1?(o=a.destinationWidth,l=a.destinationHeight,a.sourceWidth===o&&a.sourceHeight===l||(d.deleteTexture(a.targetTexture),a.targetTexture=a.filterBackend.createTexture(d,o,l)),d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,a.targetTexture,0)):(d.bindFramebuffer(d.FRAMEBUFFER,null),d.finish())},_swapTextures:function(a){a.passes--,a.pass++;var o=a.targetTexture;a.targetTexture=a.sourceTexture,a.sourceTexture=o},isNeutralState:function(){var a=this.mainParameter,o=y.Image.filters[this.type].prototype;if(a){if(Array.isArray(o[a])){for(var l=o[a].length;l--;)if(this[a][l]!==o[a][l])return!1;return!0}return o[a]===this[a]}return!1},applyTo:function(a){a.webgl?(this._setupFrameBuffer(a),this.applyToWebGL(a),this._swapTextures(a)):this.applyTo2d(a)},retrieveShader:function(a){return a.programCache.hasOwnProperty(this.type)||(a.programCache[this.type]=this.createProgram(a.context)),a.programCache[this.type]},applyToWebGL:function(a){var o=a.context,l=this.retrieveShader(a);a.pass===0&&a.originalTexture?o.bindTexture(o.TEXTURE_2D,a.originalTexture):o.bindTexture(o.TEXTURE_2D,a.sourceTexture),o.useProgram(l.program),this.sendAttributeData(o,l.attributeLocations,a.aPosition),o.uniform1f(l.uniformLocations.uStepW,1/a.sourceWidth),o.uniform1f(l.uniformLocations.uStepH,1/a.sourceHeight),this.sendUniformData(o,l.uniformLocations),o.viewport(0,0,a.destinationWidth,a.destinationHeight),o.drawArrays(o.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(a,o,l){a.activeTexture(l),a.bindTexture(a.TEXTURE_2D,o),a.activeTexture(a.TEXTURE0)},unbindAdditionalTexture:function(a,o){a.activeTexture(o),a.bindTexture(a.TEXTURE_2D,null),a.activeTexture(a.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(a){this[this.mainParameter]=a},sendUniformData:function(){},createHelpLayer:function(a){if(!a.helpLayer){var o=document.createElement("canvas");o.width=a.sourceWidth,o.height=a.sourceHeight,a.helpLayer=o}},toObject:function(){var a={type:this.type},o=this.mainParameter;return o&&(a[o]=this[o]),a},toJSON:function(){return this.toObject()}}),y.Image.filters.BaseFilter.fromObject=function(a,o){var l=new y.Image.filters[a.type](a);return o&&o(l),l},function(a){var o=a.fabric||(a.fabric={}),l=o.Image.filters,d=o.util.createClass;l.ColorMatrix=d(l.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(n){this.callSuper("initialize",n),this.matrix=this.matrix.slice(0)},applyTo2d:function(n){var s,h,_,f,p,m=n.imageData.data,C=m.length,T=this.matrix,x=this.colorsOnly;for(p=0;p<C;p+=4)s=m[p],h=m[p+1],_=m[p+2],x?(m[p]=s*T[0]+h*T[1]+_*T[2]+255*T[4],m[p+1]=s*T[5]+h*T[6]+_*T[7]+255*T[9],m[p+2]=s*T[10]+h*T[11]+_*T[12]+255*T[14]):(f=m[p+3],m[p]=s*T[0]+h*T[1]+_*T[2]+f*T[3]+255*T[4],m[p+1]=s*T[5]+h*T[6]+_*T[7]+f*T[8]+255*T[9],m[p+2]=s*T[10]+h*T[11]+_*T[12]+f*T[13]+255*T[14],m[p+3]=s*T[15]+h*T[16]+_*T[17]+f*T[18]+255*T[19])},getUniformLocations:function(n,s){return{uColorMatrix:n.getUniformLocation(s,"uColorMatrix"),uConstants:n.getUniformLocation(s,"uConstants")}},sendUniformData:function(n,s){var h=this.matrix,_=[h[0],h[1],h[2],h[3],h[5],h[6],h[7],h[8],h[10],h[11],h[12],h[13],h[15],h[16],h[17],h[18]],f=[h[4],h[9],h[14],h[19]];n.uniformMatrix4fv(s.uColorMatrix,!1,_),n.uniform4fv(s.uConstants,f)}}),o.Image.filters.ColorMatrix.fromObject=o.Image.filters.BaseFilter.fromObject}(t),function(a){var o=a.fabric||(a.fabric={}),l=o.Image.filters,d=o.util.createClass;l.Brightness=d(l.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(n){if(this.brightness!==0){var s,h=n.imageData.data,_=h.length,f=Math.round(255*this.brightness);for(s=0;s<_;s+=4)h[s]=h[s]+f,h[s+1]=h[s+1]+f,h[s+2]=h[s+2]+f}},getUniformLocations:function(n,s){return{uBrightness:n.getUniformLocation(s,"uBrightness")}},sendUniformData:function(n,s){n.uniform1f(s.uBrightness,this.brightness)}}),o.Image.filters.Brightness.fromObject=o.Image.filters.BaseFilter.fromObject}(t),function(a){var o=a.fabric||(a.fabric={}),l=o.util.object.extend,d=o.Image.filters,n=o.util.createClass;d.Convolute=n(d.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(s){var h=Math.sqrt(this.matrix.length),_=this.type+"_"+h+"_"+(this.opaque?1:0),f=this.fragmentSource[_];return s.programCache.hasOwnProperty(_)||(s.programCache[_]=this.createProgram(s.context,f)),s.programCache[_]},applyTo2d:function(s){var h,_,f,p,m,C,T,x,I,D,L,V,H,$=s.imageData,X=$.data,O=this.matrix,R=Math.round(Math.sqrt(O.length)),M=Math.floor(R/2),F=$.width,j=$.height,G=s.ctx.createImageData(F,j),k=G.data,P=this.opaque?1:0;for(L=0;L<j;L++)for(D=0;D<F;D++){for(m=4*(L*F+D),h=0,_=0,f=0,p=0,H=0;H<R;H++)for(V=0;V<R;V++)C=D+V-M,(T=L+H-M)<0||T>=j||C<0||C>=F||(x=4*(T*F+C),I=O[H*R+V],h+=X[x]*I,_+=X[x+1]*I,f+=X[x+2]*I,P||(p+=X[x+3]*I));k[m]=h,k[m+1]=_,k[m+2]=f,k[m+3]=P?X[m+3]:p}s.imageData=G},getUniformLocations:function(s,h){return{uMatrix:s.getUniformLocation(h,"uMatrix"),uOpaque:s.getUniformLocation(h,"uOpaque"),uHalfSize:s.getUniformLocation(h,"uHalfSize"),uSize:s.getUniformLocation(h,"uSize")}},sendUniformData:function(s,h){s.uniform1fv(h.uMatrix,this.matrix)},toObject:function(){return l(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),o.Image.filters.Convolute.fromObject=o.Image.filters.BaseFilter.fromObject}(t),function(a){var o=a.fabric||(a.fabric={}),l=o.Image.filters,d=o.util.createClass;l.Grayscale=d(l.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(n){var s,h,_=n.imageData.data,f=_.length,p=this.mode;for(s=0;s<f;s+=4)p==="average"?h=(_[s]+_[s+1]+_[s+2])/3:p==="lightness"?h=(Math.min(_[s],_[s+1],_[s+2])+Math.max(_[s],_[s+1],_[s+2]))/2:p==="luminosity"&&(h=.21*_[s]+.72*_[s+1]+.07*_[s+2]),_[s]=h,_[s+1]=h,_[s+2]=h},retrieveShader:function(n){var s=this.type+"_"+this.mode;if(!n.programCache.hasOwnProperty(s)){var h=this.fragmentSource[this.mode];n.programCache[s]=this.createProgram(n.context,h)}return n.programCache[s]},getUniformLocations:function(n,s){return{uMode:n.getUniformLocation(s,"uMode")}},sendUniformData:function(n,s){n.uniform1i(s.uMode,1)},isNeutralState:function(){return!1}}),o.Image.filters.Grayscale.fromObject=o.Image.filters.BaseFilter.fromObject}(t),function(a){var o=a.fabric||(a.fabric={}),l=o.Image.filters,d=o.util.createClass;l.Invert=d(l.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(n){var s,h=n.imageData.data,_=h.length;for(s=0;s<_;s+=4)h[s]=255-h[s],h[s+1]=255-h[s+1],h[s+2]=255-h[s+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(n,s){return{uInvert:n.getUniformLocation(s,"uInvert")}},sendUniformData:function(n,s){n.uniform1i(s.uInvert,this.invert)}}),o.Image.filters.Invert.fromObject=o.Image.filters.BaseFilter.fromObject}(t),function(a){var o=a.fabric||(a.fabric={}),l=o.util.object.extend,d=o.Image.filters,n=o.util.createClass;d.Noise=n(d.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(s){if(this.noise!==0){var h,_,f=s.imageData.data,p=f.length,m=this.noise;for(h=0,p=f.length;h<p;h+=4)_=(.5-Math.random())*m,f[h]+=_,f[h+1]+=_,f[h+2]+=_}},getUniformLocations:function(s,h){return{uNoise:s.getUniformLocation(h,"uNoise"),uSeed:s.getUniformLocation(h,"uSeed")}},sendUniformData:function(s,h){s.uniform1f(h.uNoise,this.noise/255),s.uniform1f(h.uSeed,Math.random())},toObject:function(){return l(this.callSuper("toObject"),{noise:this.noise})}}),o.Image.filters.Noise.fromObject=o.Image.filters.BaseFilter.fromObject}(t),function(a){var o=a.fabric||(a.fabric={}),l=o.Image.filters,d=o.util.createClass;l.Pixelate=d(l.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(n){var s,h,_,f,p,m,C,T,x,I,D,L=n.imageData,V=L.data,H=L.height,$=L.width;for(h=0;h<H;h+=this.blocksize)for(_=0;_<$;_+=this.blocksize)for(f=V[s=4*h*$+4*_],p=V[s+1],m=V[s+2],C=V[s+3],I=Math.min(h+this.blocksize,H),D=Math.min(_+this.blocksize,$),T=h;T<I;T++)for(x=_;x<D;x++)V[s=4*T*$+4*x]=f,V[s+1]=p,V[s+2]=m,V[s+3]=C},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(n,s){return{uBlocksize:n.getUniformLocation(s,"uBlocksize"),uStepW:n.getUniformLocation(s,"uStepW"),uStepH:n.getUniformLocation(s,"uStepH")}},sendUniformData:function(n,s){n.uniform1f(s.uBlocksize,this.blocksize)}}),o.Image.filters.Pixelate.fromObject=o.Image.filters.BaseFilter.fromObject}(t),function(a){var o=a.fabric||(a.fabric={}),l=o.util.object.extend,d=o.Image.filters,n=o.util.createClass;d.RemoveColor=n(d.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(s){var h,_,f,p,m=s.imageData.data,C=255*this.distance,T=new o.Color(this.color).getSource(),x=[T[0]-C,T[1]-C,T[2]-C],I=[T[0]+C,T[1]+C,T[2]+C];for(h=0;h<m.length;h+=4)_=m[h],f=m[h+1],p=m[h+2],_>x[0]&&f>x[1]&&p>x[2]&&_<I[0]&&f<I[1]&&p<I[2]&&(m[h+3]=0)},getUniformLocations:function(s,h){return{uLow:s.getUniformLocation(h,"uLow"),uHigh:s.getUniformLocation(h,"uHigh")}},sendUniformData:function(s,h){var _=new o.Color(this.color).getSource(),f=parseFloat(this.distance),p=[0+_[0]/255-f,0+_[1]/255-f,0+_[2]/255-f,1],m=[_[0]/255+f,_[1]/255+f,_[2]/255+f,1];s.uniform4fv(h.uLow,p),s.uniform4fv(h.uHigh,m)},toObject:function(){return l(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),o.Image.filters.RemoveColor.fromObject=o.Image.filters.BaseFilter.fromObject}(t),function(a){var o=a.fabric||(a.fabric={}),l=o.Image.filters,d=o.util.createClass,n={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var s in n)l[s]=d(l.ColorMatrix,{type:s,matrix:n[s],mainParameter:!1,colorsOnly:!0}),o.Image.filters[s].fromObject=o.Image.filters.BaseFilter.fromObject}(t),function(a){var o=a.fabric,l=o.Image.filters,d=o.util.createClass;l.BlendColor=d(l.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(n){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[n]+`}
}`},retrieveShader:function(n){var s,h=this.type+"_"+this.mode;return n.programCache.hasOwnProperty(h)||(s=this.buildSource(this.mode),n.programCache[h]=this.createProgram(n.context,s)),n.programCache[h]},applyTo2d:function(n){var s,h,_,f,p,m,C,T=n.imageData.data,x=T.length,I=1-this.alpha;s=(C=new o.Color(this.color).getSource())[0]*this.alpha,h=C[1]*this.alpha,_=C[2]*this.alpha;for(var D=0;D<x;D+=4)switch(f=T[D],p=T[D+1],m=T[D+2],this.mode){case"multiply":T[D]=f*s/255,T[D+1]=p*h/255,T[D+2]=m*_/255;break;case"screen":T[D]=255-(255-f)*(255-s)/255,T[D+1]=255-(255-p)*(255-h)/255,T[D+2]=255-(255-m)*(255-_)/255;break;case"add":T[D]=f+s,T[D+1]=p+h,T[D+2]=m+_;break;case"diff":case"difference":T[D]=Math.abs(f-s),T[D+1]=Math.abs(p-h),T[D+2]=Math.abs(m-_);break;case"subtract":T[D]=f-s,T[D+1]=p-h,T[D+2]=m-_;break;case"darken":T[D]=Math.min(f,s),T[D+1]=Math.min(p,h),T[D+2]=Math.min(m,_);break;case"lighten":T[D]=Math.max(f,s),T[D+1]=Math.max(p,h),T[D+2]=Math.max(m,_);break;case"overlay":T[D]=s<128?2*f*s/255:255-2*(255-f)*(255-s)/255,T[D+1]=h<128?2*p*h/255:255-2*(255-p)*(255-h)/255,T[D+2]=_<128?2*m*_/255:255-2*(255-m)*(255-_)/255;break;case"exclusion":T[D]=s+f-2*s*f/255,T[D+1]=h+p-2*h*p/255,T[D+2]=_+m-2*_*m/255;break;case"tint":T[D]=s+f*I,T[D+1]=h+p*I,T[D+2]=_+m*I}},getUniformLocations:function(n,s){return{uColor:n.getUniformLocation(s,"uColor")}},sendUniformData:function(n,s){var h=new o.Color(this.color).getSource();h[0]=this.alpha*h[0]/255,h[1]=this.alpha*h[1]/255,h[2]=this.alpha*h[2]/255,h[3]=this.alpha,n.uniform4fv(s.uColor,h)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),o.Image.filters.BlendColor.fromObject=o.Image.filters.BaseFilter.fromObject}(t),function(a){var o=a.fabric,l=o.Image.filters,d=o.util.createClass;l.BlendImage=d(l.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(n){var s=this.type+"_"+this.mode,h=this.fragmentSource[this.mode];return n.programCache.hasOwnProperty(s)||(n.programCache[s]=this.createProgram(n.context,h)),n.programCache[s]},applyToWebGL:function(n){var s=n.context,h=this.createTexture(n.filterBackend,this.image);this.bindAdditionalTexture(s,h,s.TEXTURE1),this.callSuper("applyToWebGL",n),this.unbindAdditionalTexture(s,s.TEXTURE1)},createTexture:function(n,s){return n.getCachedTexture(s.cacheKey,s._element)},calculateMatrix:function(){var n=this.image,s=n._element.width,h=n._element.height;return[1/n.scaleX,0,0,0,1/n.scaleY,0,-n.left/s,-n.top/h,1]},applyTo2d:function(n){var s,h,_,f,p,m,C,T,x,I,D,L=n.imageData,V=n.filterBackend.resources,H=L.data,$=H.length,X=L.width,O=L.height,R=this.image;V.blendImage||(V.blendImage=o.util.createCanvasElement()),I=(x=V.blendImage).getContext("2d"),x.width!==X||x.height!==O?(x.width=X,x.height=O):I.clearRect(0,0,X,O),I.setTransform(R.scaleX,0,0,R.scaleY,R.left,R.top),I.drawImage(R._element,0,0,X,O),D=I.getImageData(0,0,X,O).data;for(var M=0;M<$;M+=4)switch(p=H[M],m=H[M+1],C=H[M+2],T=H[M+3],s=D[M],h=D[M+1],_=D[M+2],f=D[M+3],this.mode){case"multiply":H[M]=p*s/255,H[M+1]=m*h/255,H[M+2]=C*_/255,H[M+3]=T*f/255;break;case"mask":H[M+3]=f}},getUniformLocations:function(n,s){return{uTransformMatrix:n.getUniformLocation(s,"uTransformMatrix"),uImage:n.getUniformLocation(s,"uImage")}},sendUniformData:function(n,s){var h=this.calculateMatrix();n.uniform1i(s.uImage,1),n.uniformMatrix3fv(s.uTransformMatrix,!1,h)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),o.Image.filters.BlendImage.fromObject=function(n,s){o.Image.fromObject(n.image,function(h){var _=o.util.object.clone(n);_.image=h,s(new o.Image.filters.BlendImage(_))})}}(t),function(a){var o=a.fabric||(a.fabric={}),l=Math.pow,d=Math.floor,n=Math.sqrt,s=Math.abs,h=Math.round,_=Math.sin,f=Math.ceil,p=o.Image.filters,m=o.util.createClass;p.Resize=m(p.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(C,T){return{uDelta:C.getUniformLocation(T,"uDelta"),uTaps:C.getUniformLocation(T,"uTaps")}},sendUniformData:function(C,T){C.uniform2fv(T.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),C.uniform1fv(T.uTaps,this.taps)},retrieveShader:function(C){var T=this.getFilterWindow(),x=this.type+"_"+T;if(!C.programCache.hasOwnProperty(x)){var I=this.generateShader(T);C.programCache[x]=this.createProgram(C.context,I)}return C.programCache[x]},getFilterWindow:function(){var C=this.tempScale;return Math.ceil(this.lanczosLobes/C)},getTaps:function(){for(var C=this.lanczosCreate(this.lanczosLobes),T=this.tempScale,x=this.getFilterWindow(),I=new Array(x),D=1;D<=x;D++)I[D-1]=C(D*T);return I},generateShader:function(C){for(var T=new Array(C),x=this.fragmentSourceTOP,I=1;I<=C;I++)T[I-1]=I+".0 * uDelta";return x+="uniform float uTaps["+C+`];
`,x+=`void main() {
`,x+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,x+=`  float sum = 1.0;
`,T.forEach(function(D,L){x+="  color += texture2D(uTexture, vTexCoord + "+D+") * uTaps["+L+`];
`,x+="  color += texture2D(uTexture, vTexCoord - "+D+") * uTaps["+L+`];
`,x+="  sum += 2.0 * uTaps["+L+`];
`}),x+=`  gl_FragColor = color / sum;
`,x+="}"},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(C){C.webgl?(C.passes++,this.width=C.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=C.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),C.destinationWidth=this.dW,this._setupFrameBuffer(C),this.applyToWebGL(C),this._swapTextures(C),C.sourceWidth=C.destinationWidth,this.height=C.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),C.destinationHeight=this.dH,this._setupFrameBuffer(C),this.applyToWebGL(C),this._swapTextures(C),C.sourceHeight=C.destinationHeight):this.applyTo2d(C)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(C){return function(T){if(T>=C||T<=-C)return 0;if(T<11920929e-14&&T>-11920929e-14)return 1;var x=(T*=Math.PI)/C;return _(T)/T*_(x)/x}},applyTo2d:function(C){var T=C.imageData,x=this.scaleX,I=this.scaleY;this.rcpScaleX=1/x,this.rcpScaleY=1/I;var D,L=T.width,V=T.height,H=h(L*x),$=h(V*I);this.resizeType==="sliceHack"?D=this.sliceByTwo(C,L,V,H,$):this.resizeType==="hermite"?D=this.hermiteFastResize(C,L,V,H,$):this.resizeType==="bilinear"?D=this.bilinearFiltering(C,L,V,H,$):this.resizeType==="lanczos"&&(D=this.lanczosResize(C,L,V,H,$)),C.imageData=D},sliceByTwo:function(C,T,x,I,D){var L,V,H=C.imageData,$=.5,X=!1,O=!1,R=T*$,M=x*$,F=o.filterBackend.resources,j=0,G=0,k=T,P=0;for(F.sliceByTwo||(F.sliceByTwo=document.createElement("canvas")),((L=F.sliceByTwo).width<1.5*T||L.height<x)&&(L.width=1.5*T,L.height=x),(V=L.getContext("2d")).clearRect(0,0,1.5*T,x),V.putImageData(H,0,0),I=d(I),D=d(D);!X||!O;)T=R,x=M,I<d(R*$)?R=d(R*$):(R=I,X=!0),D<d(M*$)?M=d(M*$):(M=D,O=!0),V.drawImage(L,j,G,T,x,k,P,R,M),j=k,G=P,P+=M;return V.getImageData(j,G,I,D)},lanczosResize:function(C,T,x,I,D){var L=C.imageData.data,V=C.ctx.createImageData(I,D),H=V.data,$=this.lanczosCreate(this.lanczosLobes),X=this.rcpScaleX,O=this.rcpScaleY,R=2/this.rcpScaleX,M=2/this.rcpScaleY,F=f(X*this.lanczosLobes/2),j=f(O*this.lanczosLobes/2),G={},k={},P={};return function N(U){var Y,Q,ie,re,ne,ae,se,ue,me,ge,Ce;for(k.x=(U+.5)*X,P.x=d(k.x),Y=0;Y<D;Y++){for(k.y=(Y+.5)*O,P.y=d(k.y),ne=0,ae=0,se=0,ue=0,me=0,Q=P.x-F;Q<=P.x+F;Q++)if(!(Q<0||Q>=T)){ge=d(1e3*s(Q-k.x)),G[ge]||(G[ge]={});for(var Te=P.y-j;Te<=P.y+j;Te++)Te<0||Te>=x||(Ce=d(1e3*s(Te-k.y)),G[ge][Ce]||(G[ge][Ce]=$(n(l(ge*R,2)+l(Ce*M,2))/1e3)),(ie=G[ge][Ce])>0&&(ne+=ie,ae+=ie*L[re=4*(Te*T+Q)],se+=ie*L[re+1],ue+=ie*L[re+2],me+=ie*L[re+3]))}H[re=4*(Y*I+U)]=ae/ne,H[re+1]=se/ne,H[re+2]=ue/ne,H[re+3]=me/ne}return++U<I?N(U):V}(0)},bilinearFiltering:function(C,T,x,I,D){var L,V,H,$,X,O,R,M,F,j=0,G=this.rcpScaleX,k=this.rcpScaleY,P=4*(T-1),N=C.imageData.data,U=C.ctx.createImageData(I,D),Y=U.data;for(H=0;H<D;H++)for($=0;$<I;$++)for(X=G*$-(L=d(G*$)),O=k*H-(V=d(k*H)),F=4*(V*T+L),R=0;R<4;R++)M=N[F+R]*(1-X)*(1-O)+N[F+4+R]*X*(1-O)+N[F+P+R]*O*(1-X)+N[F+P+4+R]*X*O,Y[j++]=M;return U},hermiteFastResize:function(C,T,x,I,D){for(var L=this.rcpScaleX,V=this.rcpScaleY,H=f(L/2),$=f(V/2),X=C.imageData.data,O=C.ctx.createImageData(I,D),R=O.data,M=0;M<D;M++)for(var F=0;F<I;F++){for(var j=4*(F+M*I),G=0,k=0,P=0,N=0,U=0,Y=0,Q=0,ie=(M+.5)*V,re=d(M*V);re<(M+1)*V;re++)for(var ne=s(ie-(re+.5))/$,ae=(F+.5)*L,se=ne*ne,ue=d(F*L);ue<(F+1)*L;ue++){var me=s(ae-(ue+.5))/H,ge=n(se+me*me);ge>1&&ge<-1||(G=2*ge*ge*ge-3*ge*ge+1)>0&&(Q+=G*X[3+(me=4*(ue+re*T))],P+=G,X[me+3]<255&&(G=G*X[me+3]/250),N+=G*X[me],U+=G*X[me+1],Y+=G*X[me+2],k+=G)}R[j]=N/k,R[j+1]=U/k,R[j+2]=Y/k,R[j+3]=Q/P}return O},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),o.Image.filters.Resize.fromObject=o.Image.filters.BaseFilter.fromObject}(t),function(a){var o=a.fabric||(a.fabric={}),l=o.Image.filters,d=o.util.createClass;l.Contrast=d(l.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(n){if(this.contrast!==0){var s,h=n.imageData.data,_=h.length,f=Math.floor(255*this.contrast),p=259*(f+255)/(255*(259-f));for(s=0;s<_;s+=4)h[s]=p*(h[s]-128)+128,h[s+1]=p*(h[s+1]-128)+128,h[s+2]=p*(h[s+2]-128)+128}},getUniformLocations:function(n,s){return{uContrast:n.getUniformLocation(s,"uContrast")}},sendUniformData:function(n,s){n.uniform1f(s.uContrast,this.contrast)}}),o.Image.filters.Contrast.fromObject=o.Image.filters.BaseFilter.fromObject}(t),function(a){var o=a.fabric||(a.fabric={}),l=o.Image.filters,d=o.util.createClass;l.Saturation=d(l.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(n){if(this.saturation!==0){var s,h,_=n.imageData.data,f=_.length,p=-this.saturation;for(s=0;s<f;s+=4)h=Math.max(_[s],_[s+1],_[s+2]),_[s]+=h!==_[s]?(h-_[s])*p:0,_[s+1]+=h!==_[s+1]?(h-_[s+1])*p:0,_[s+2]+=h!==_[s+2]?(h-_[s+2])*p:0}},getUniformLocations:function(n,s){return{uSaturation:n.getUniformLocation(s,"uSaturation")}},sendUniformData:function(n,s){n.uniform1f(s.uSaturation,-this.saturation)}}),o.Image.filters.Saturation.fromObject=o.Image.filters.BaseFilter.fromObject}(t),function(a){var o=a.fabric||(a.fabric={}),l=o.Image.filters,d=o.util.createClass;l.Vibrance=d(l.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(n){if(this.vibrance!==0){var s,h,_,f,p=n.imageData.data,m=p.length,C=-this.vibrance;for(s=0;s<m;s+=4)h=Math.max(p[s],p[s+1],p[s+2]),_=(p[s]+p[s+1]+p[s+2])/3,f=2*Math.abs(h-_)/255*C,p[s]+=h!==p[s]?(h-p[s])*f:0,p[s+1]+=h!==p[s+1]?(h-p[s+1])*f:0,p[s+2]+=h!==p[s+2]?(h-p[s+2])*f:0}},getUniformLocations:function(n,s){return{uVibrance:n.getUniformLocation(s,"uVibrance")}},sendUniformData:function(n,s){n.uniform1f(s.uVibrance,-this.vibrance)}}),o.Image.filters.Vibrance.fromObject=o.Image.filters.BaseFilter.fromObject}(t),function(a){var o=a.fabric||(a.fabric={}),l=o.Image.filters,d=o.util.createClass;l.Blur=d(l.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(n){n.webgl?(this.aspectRatio=n.sourceWidth/n.sourceHeight,n.passes++,this._setupFrameBuffer(n),this.horizontal=!0,this.applyToWebGL(n),this._swapTextures(n),this._setupFrameBuffer(n),this.horizontal=!1,this.applyToWebGL(n),this._swapTextures(n)):this.applyTo2d(n)},applyTo2d:function(n){n.imageData=this.simpleBlur(n)},simpleBlur:function(n){var s,h,_=n.filterBackend.resources,f=n.imageData.width,p=n.imageData.height;_.blurLayer1||(_.blurLayer1=o.util.createCanvasElement(),_.blurLayer2=o.util.createCanvasElement()),s=_.blurLayer1,h=_.blurLayer2,s.width===f&&s.height===p||(h.width=s.width=f,h.height=s.height=p);var m,C,T,x,I=s.getContext("2d"),D=h.getContext("2d"),L=.06*this.blur*.5;for(I.putImageData(n.imageData,0,0),D.clearRect(0,0,f,p),x=-15;x<=15;x++)T=L*(C=x/15)*f+(m=(Math.random()-.5)/4),D.globalAlpha=1-Math.abs(C),D.drawImage(s,T,m),I.drawImage(h,0,0),D.globalAlpha=1,D.clearRect(0,0,h.width,h.height);for(x=-15;x<=15;x++)T=L*(C=x/15)*p+(m=(Math.random()-.5)/4),D.globalAlpha=1-Math.abs(C),D.drawImage(s,m,T),I.drawImage(h,0,0),D.globalAlpha=1,D.clearRect(0,0,h.width,h.height);n.ctx.drawImage(s,0,0);var V=n.ctx.getImageData(0,0,s.width,s.height);return I.globalAlpha=1,I.clearRect(0,0,s.width,s.height),V},getUniformLocations:function(n,s){return{delta:n.getUniformLocation(s,"uDelta")}},sendUniformData:function(n,s){var h=this.chooseRightDelta();n.uniform2fv(s.delta,h)},chooseRightDelta:function(){var n,s=1,h=[0,0];return this.horizontal?this.aspectRatio>1&&(s=1/this.aspectRatio):this.aspectRatio<1&&(s=this.aspectRatio),n=s*this.blur*.12,this.horizontal?h[0]=n:h[1]=n,h}}),l.Blur.fromObject=o.Image.filters.BaseFilter.fromObject}(t),function(a){var o=a.fabric||(a.fabric={}),l=o.Image.filters,d=o.util.createClass;l.Gamma=d(l.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(n){this.gamma=[1,1,1],l.BaseFilter.prototype.initialize.call(this,n)},applyTo2d:function(n){var s,h=n.imageData.data,_=this.gamma,f=h.length,p=1/_[0],m=1/_[1],C=1/_[2];for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),s=0,f=256;s<f;s++)this.rVals[s]=255*Math.pow(s/255,p),this.gVals[s]=255*Math.pow(s/255,m),this.bVals[s]=255*Math.pow(s/255,C);for(s=0,f=h.length;s<f;s+=4)h[s]=this.rVals[h[s]],h[s+1]=this.gVals[h[s+1]],h[s+2]=this.bVals[h[s+2]]},getUniformLocations:function(n,s){return{uGamma:n.getUniformLocation(s,"uGamma")}},sendUniformData:function(n,s){n.uniform3fv(s.uGamma,this.gamma)}}),o.Image.filters.Gamma.fromObject=o.Image.filters.BaseFilter.fromObject}(t),function(a){var o=a.fabric||(a.fabric={}),l=o.Image.filters,d=o.util.createClass;l.Composed=d(l.BaseFilter,{type:"Composed",subFilters:[],initialize:function(n){this.callSuper("initialize",n),this.subFilters=this.subFilters.slice(0)},applyTo:function(n){n.passes+=this.subFilters.length-1,this.subFilters.forEach(function(s){s.applyTo(n)})},toObject:function(){return o.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(n){return n.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(n){return!n.isNeutralState()})}}),o.Image.filters.Composed.fromObject=function(n,s){var h=(n.subFilters||[]).map(function(f){return new o.Image.filters[f.type](f)}),_=new o.Image.filters.Composed({subFilters:h});return s&&s(_),_}}(t),function(a){var o=a.fabric||(a.fabric={}),l=o.Image.filters,d=o.util.createClass;l.HueRotation=d(l.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var n=this.rotation*Math.PI,s=o.util.cos(n),h=o.util.sin(n),_=1/3,f=Math.sqrt(_)*h,p=1-s;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=s+p/3,this.matrix[1]=_*p-f,this.matrix[2]=_*p+f,this.matrix[5]=_*p+f,this.matrix[6]=s+_*p,this.matrix[7]=_*p-f,this.matrix[10]=_*p-f,this.matrix[11]=_*p+f,this.matrix[12]=s+_*p},isNeutralState:function(n){return this.calculateMatrix(),l.BaseFilter.prototype.isNeutralState.call(this,n)},applyTo:function(n){this.calculateMatrix(),l.BaseFilter.prototype.applyTo.call(this,n)}}),o.Image.filters.HueRotation.fromObject=o.Image.filters.BaseFilter.fromObject}(t),function(a){var o=a.fabric||(a.fabric={}),l=o.util.object.clone;if(o.Text)o.warn("fabric.Text is already defined");else{var d="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");o.Text=o.util.createClass(o.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:o.Object.prototype.stateProperties.concat(d),cacheProperties:o.Object.prototype.cacheProperties.concat(d),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(n,s){this.styles=s&&s.styles||{},this.text=n,this.__skipDimension=!0,this.callSuper("initialize",s),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var n=this.path;n&&(n.segmentsInfo=o.util.getPathSegmentsInfo(n.path))},getMeasuringContext:function(){return o._measuringContext||(o._measuringContext=this.canvas&&this.canvas.contextCache||o.util.createCanvasElement().getContext("2d")),o._measuringContext},_splitText:function(){var n=this._splitTextIntoLines(this.text);return this.textLines=n.lines,this._textLines=n.graphemeLines,this._unwrappedTextLines=n._unwrappedLines,this._text=n.graphemeText,n},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var n,s,h,_,f,p,m,C=0,T=this._textLines.length;C<T;C++)if((this.textAlign==="justify"||C!==T-1&&!this.isEndOfWrapping(C))&&(_=0,f=this._textLines[C],(s=this.getLineWidth(C))<this.width&&(m=this.textLines[C].match(this._reSpacesAndTabs)))){h=m.length,n=(this.width-s)/h;for(var x=0,I=f.length;x<=I;x++)p=this.__charBounds[C][x],this._reSpaceAndTab.test(f[x])?(p.width+=n,p.kernedWidth+=n,p.left+=_,_+=n):p.left+=_}},isEndOfWrapping:function(n){return n===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var n=this.callSuper("_getCacheCanvasDimensions"),s=this.fontSize;return n.width+=s*n.zoomX,n.height+=s*n.zoomY,n},_render:function(n){var s=this.path;s&&!s.isNotVisible()&&s._render(n),this._setTextStyles(n),this._renderTextLinesBackground(n),this._renderTextDecoration(n,"underline"),this._renderText(n),this._renderTextDecoration(n,"overline"),this._renderTextDecoration(n,"linethrough")},_renderText:function(n){this.paintFirst==="stroke"?(this._renderTextStroke(n),this._renderTextFill(n)):(this._renderTextFill(n),this._renderTextStroke(n))},_setTextStyles:function(n,s,h){if(n.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":n.textBaseline="middle";break;case"ascender":n.textBaseline="top";break;case"descender":n.textBaseline="bottom"}n.font=this._getFontDeclaration(s,h)},calcTextWidth:function(){for(var n=this.getLineWidth(0),s=1,h=this._textLines.length;s<h;s++){var _=this.getLineWidth(s);_>n&&(n=_)}return n},_renderTextLine:function(n,s,h,_,f,p){this._renderChars(n,s,h,_,f,p)},_renderTextLinesBackground:function(n){if(this.textBackgroundColor||this.styleHas("textBackgroundColor")){for(var s,h,_,f,p,m,C,T=n.fillStyle,x=this._getLeftOffset(),I=this._getTopOffset(),D=0,L=0,V=this.path,H=0,$=this._textLines.length;H<$;H++)if(s=this.getHeightOfLine(H),this.textBackgroundColor||this.styleHas("textBackgroundColor",H)){_=this._textLines[H],h=this._getLineLeftOffset(H),L=0,D=0,f=this.getValueOfPropertyAt(H,0,"textBackgroundColor");for(var X=0,O=_.length;X<O;X++)p=this.__charBounds[H][X],m=this.getValueOfPropertyAt(H,X,"textBackgroundColor"),V?(n.save(),n.translate(p.renderLeft,p.renderTop),n.rotate(p.angle),n.fillStyle=m,m&&n.fillRect(-p.width/2,-s/this.lineHeight*(1-this._fontSizeFraction),p.width,s/this.lineHeight),n.restore()):m!==f?(C=x+h+D,this.direction==="rtl"&&(C=this.width-C-L),n.fillStyle=f,f&&n.fillRect(C,I,L,s/this.lineHeight),D=p.left,L=p.width,f=m):L+=p.kernedWidth;m&&!V&&(C=x+h+D,this.direction==="rtl"&&(C=this.width-C-L),n.fillStyle=m,n.fillRect(C,I,L,s/this.lineHeight)),I+=s}else I+=s;n.fillStyle=T,this._removeShadow(n)}},getFontCache:function(n){var s=n.fontFamily.toLowerCase();o.charWidthsCache[s]||(o.charWidthsCache[s]={});var h=o.charWidthsCache[s],_=n.fontStyle.toLowerCase()+"_"+(n.fontWeight+"").toLowerCase();return h[_]||(h[_]={}),h[_]},_measureChar:function(n,s,h,_){var f,p,m,C,T=this.getFontCache(s),x=h+n,I=this._getFontDeclaration(s)===this._getFontDeclaration(_),D=s.fontSize/this.CACHE_FONT_SIZE;if(h&&T[h]!==void 0&&(m=T[h]),T[n]!==void 0&&(C=f=T[n]),I&&T[x]!==void 0&&(C=(p=T[x])-m),f===void 0||m===void 0||p===void 0){var L=this.getMeasuringContext();this._setTextStyles(L,s,!0)}return f===void 0&&(C=f=L.measureText(n).width,T[n]=f),m===void 0&&I&&h&&(m=L.measureText(h).width,T[h]=m),I&&p===void 0&&(p=L.measureText(x).width,T[x]=p,C=p-m),{width:f*D,kernedWidth:C*D}},getHeightOfChar:function(n,s){return this.getValueOfPropertyAt(n,s,"fontSize")},measureLine:function(n){var s=this._measureLine(n);return this.charSpacing!==0&&(s.width-=this._getWidthOfCharSpacing()),s.width<0&&(s.width=0),s},_measureLine:function(n){var s,h,_,f,p,m,C=0,T=this._textLines[n],x=new Array(T.length),I=0,D=this.path,L=this.pathSide==="right";for(this.__charBounds[n]=x,s=0;s<T.length;s++)h=T[s],f=this._getGraphemeBox(h,n,s,_),x[s]=f,C+=f.kernedWidth,_=h;if(x[s]={left:f?f.left+f.width:0,width:0,kernedWidth:0,height:this.fontSize},D){switch(m=D.segmentsInfo[D.segmentsInfo.length-1].length,(p=o.util.getPointOnPath(D.path,0,D.segmentsInfo)).x+=D.pathOffset.x,p.y+=D.pathOffset.y,this.textAlign){case"left":I=L?m-C:0;break;case"center":I=(m-C)/2;break;case"right":I=L?0:m-C}for(I+=this.pathStartOffset*(L?-1:1),s=L?T.length-1:0;L?s>=0:s<T.length;L?s--:s++)f=x[s],I>m?I%=m:I<0&&(I+=m),this._setGraphemeOnPath(I,f,p),I+=f.kernedWidth}return{width:C,numOfSpaces:0}},_setGraphemeOnPath:function(n,s,h){var _=n+s.kernedWidth/2,f=this.path,p=o.util.getPointOnPath(f.path,_,f.segmentsInfo);s.renderLeft=p.x-h.x,s.renderTop=p.y-h.y,s.angle=p.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(n,s,h,_,f){var p,m=this.getCompleteStyleDeclaration(s,h),C=_?this.getCompleteStyleDeclaration(s,h-1):{},T=this._measureChar(n,m,_,C),x=T.kernedWidth,I=T.width;this.charSpacing!==0&&(I+=p=this._getWidthOfCharSpacing(),x+=p);var D={width:I,left:0,height:m.fontSize,kernedWidth:x,deltaY:m.deltaY};if(h>0&&!f){var L=this.__charBounds[s][h-1];D.left=L.left+L.width+T.kernedWidth-T.width}return D},getHeightOfLine:function(n){if(this.__lineHeights[n])return this.__lineHeights[n];for(var s=this._textLines[n],h=this.getHeightOfChar(n,0),_=1,f=s.length;_<f;_++)h=Math.max(this.getHeightOfChar(n,_),h);return this.__lineHeights[n]=h*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var n,s=0,h=0,_=this._textLines.length;h<_;h++)n=this.getHeightOfLine(h),s+=h===_-1?n/this.lineHeight:n;return s},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(n,s){n.save();for(var h=0,_=this._getLeftOffset(),f=this._getTopOffset(),p=0,m=this._textLines.length;p<m;p++){var C=this.getHeightOfLine(p),T=C/this.lineHeight,x=this._getLineLeftOffset(p);this._renderTextLine(s,n,this._textLines[p],_+x,f+h+T,p),h+=C}n.restore()},_renderTextFill:function(n){(this.fill||this.styleHas("fill"))&&this._renderTextCommon(n,"fillText")},_renderTextStroke:function(n){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(n),n.save(),this._setLineDash(n,this.strokeDashArray),n.beginPath(),this._renderTextCommon(n,"strokeText"),n.closePath(),n.restore())},_renderChars:function(n,s,h,_,f,p){var m,C,T,x,I,D=this.getHeightOfLine(p),L=this.textAlign.indexOf("justify")!==-1,V="",H=0,$=this.path,X=!L&&this.charSpacing===0&&this.isEmptyStyles(p)&&!$,O=this.direction==="ltr",R=this.direction==="ltr"?1:-1,M=s.canvas.getAttribute("dir");if(s.save(),M!==this.direction&&(s.canvas.setAttribute("dir",O?"ltr":"rtl"),s.direction=O?"ltr":"rtl",s.textAlign=O?"left":"right"),f-=D*this._fontSizeFraction/this.lineHeight,X)return this._renderChar(n,s,p,0,h.join(""),_,f,D),void s.restore();for(var F=0,j=h.length-1;F<=j;F++)x=F===j||this.charSpacing||$,V+=h[F],T=this.__charBounds[p][F],H===0?(_+=R*(T.kernedWidth-T.width),H+=T.width):H+=T.kernedWidth,L&&!x&&this._reSpaceAndTab.test(h[F])&&(x=!0),x||(m=m||this.getCompleteStyleDeclaration(p,F),C=this.getCompleteStyleDeclaration(p,F+1),x=this._hasStyleChanged(m,C)),x&&($?(s.save(),s.translate(T.renderLeft,T.renderTop),s.rotate(T.angle),this._renderChar(n,s,p,F,V,-H/2,0,D),s.restore()):(I=_,this._renderChar(n,s,p,F,V,I,f,D)),V="",m=C,_+=R*H,H=0);s.restore()},_applyPatternGradientTransformText:function(n){var s,h=o.util.createCanvasElement(),_=this.width+this.strokeWidth,f=this.height+this.strokeWidth;return h.width=_,h.height=f,(s=h.getContext("2d")).beginPath(),s.moveTo(0,0),s.lineTo(_,0),s.lineTo(_,f),s.lineTo(0,f),s.closePath(),s.translate(_/2,f/2),s.fillStyle=n.toLive(s),this._applyPatternGradientTransform(s,n),s.fill(),s.createPattern(h,"no-repeat")},handleFiller:function(n,s,h){var _,f;return h.toLive?h.gradientUnits==="percentage"||h.gradientTransform||h.patternTransform?(_=-this.width/2,f=-this.height/2,n.translate(_,f),n[s]=this._applyPatternGradientTransformText(h),{offsetX:_,offsetY:f}):(n[s]=h.toLive(n,this),this._applyPatternGradientTransform(n,h)):(n[s]=h,{offsetX:0,offsetY:0})},_setStrokeStyles:function(n,s){return n.lineWidth=s.strokeWidth,n.lineCap=this.strokeLineCap,n.lineDashOffset=this.strokeDashOffset,n.lineJoin=this.strokeLineJoin,n.miterLimit=this.strokeMiterLimit,this.handleFiller(n,"strokeStyle",s.stroke)},_setFillStyles:function(n,s){return this.handleFiller(n,"fillStyle",s.fill)},_renderChar:function(n,s,h,_,f,p,m){var C,T,x=this._getStyleDeclaration(h,_),I=this.getCompleteStyleDeclaration(h,_),D=n==="fillText"&&I.fill,L=n==="strokeText"&&I.stroke&&I.strokeWidth;(L||D)&&(s.save(),D&&(C=this._setFillStyles(s,I)),L&&(T=this._setStrokeStyles(s,I)),s.font=this._getFontDeclaration(I),x&&x.textBackgroundColor&&this._removeShadow(s),x&&x.deltaY&&(m+=x.deltaY),D&&s.fillText(f,p-C.offsetX,m-C.offsetY),L&&s.strokeText(f,p-T.offsetX,m-T.offsetY),s.restore())},setSuperscript:function(n,s){return this._setScript(n,s,this.superscript)},setSubscript:function(n,s){return this._setScript(n,s,this.subscript)},_setScript:function(n,s,h){var _=this.get2DCursorLocation(n,!0),f=this.getValueOfPropertyAt(_.lineIndex,_.charIndex,"fontSize"),p=this.getValueOfPropertyAt(_.lineIndex,_.charIndex,"deltaY"),m={fontSize:f*h.size,deltaY:p+f*h.baseline};return this.setSelectionStyles(m,n,s),this},_hasStyleChanged:function(n,s){return n.fill!==s.fill||n.stroke!==s.stroke||n.strokeWidth!==s.strokeWidth||n.fontSize!==s.fontSize||n.fontFamily!==s.fontFamily||n.fontWeight!==s.fontWeight||n.fontStyle!==s.fontStyle||n.deltaY!==s.deltaY},_hasStyleChangedForSvg:function(n,s){return this._hasStyleChanged(n,s)||n.overline!==s.overline||n.underline!==s.underline||n.linethrough!==s.linethrough},_getLineLeftOffset:function(n){var s=this.getLineWidth(n),h=this.width-s,_=this.textAlign,f=this.direction,p=0,m=this.isEndOfWrapping(n);return _==="justify"||_==="justify-center"&&!m||_==="justify-right"&&!m||_==="justify-left"&&!m?0:(_==="center"&&(p=h/2),_==="right"&&(p=h),_==="justify-center"&&(p=h/2),_==="justify-right"&&(p=h),f==="rtl"&&(p-=h),p)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var n=this._forceClearCache;return n||(n=this.hasStateChanged("_dimensionAffectingProps")),n&&(this.dirty=!0,this._forceClearCache=!1),n},getLineWidth:function(n){if(this.__lineWidths[n]!==void 0)return this.__lineWidths[n];var s=this.measureLine(n).width;return this.__lineWidths[n]=s,s},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(n,s,h){var _=this._getStyleDeclaration(n,s);return _&&_[h]!==void 0?_[h]:this[h]},_renderTextDecoration:function(n,s){if(this[s]||this.styleHas(s)){for(var h,_,f,p,m,C,T,x,I,D,L,V,H,$,X,O,R=this._getLeftOffset(),M=this._getTopOffset(),F=this.path,j=this._getWidthOfCharSpacing(),G=this.offsets[s],k=0,P=this._textLines.length;k<P;k++)if(h=this.getHeightOfLine(k),this[s]||this.styleHas(s,k)){T=this._textLines[k],$=h/this.lineHeight,p=this._getLineLeftOffset(k),D=0,L=0,x=this.getValueOfPropertyAt(k,0,s),O=this.getValueOfPropertyAt(k,0,"fill"),I=M+$*(1-this._fontSizeFraction),_=this.getHeightOfChar(k,0),m=this.getValueOfPropertyAt(k,0,"deltaY");for(var N=0,U=T.length;N<U;N++)if(V=this.__charBounds[k][N],H=this.getValueOfPropertyAt(k,N,s),X=this.getValueOfPropertyAt(k,N,"fill"),f=this.getHeightOfChar(k,N),C=this.getValueOfPropertyAt(k,N,"deltaY"),F&&H&&X)n.save(),n.fillStyle=O,n.translate(V.renderLeft,V.renderTop),n.rotate(V.angle),n.fillRect(-V.kernedWidth/2,G*f+C,V.kernedWidth,this.fontSize/15),n.restore();else if((H!==x||X!==O||f!==_||C!==m)&&L>0){var Y=R+p+D;this.direction==="rtl"&&(Y=this.width-Y-L),x&&O&&(n.fillStyle=O,n.fillRect(Y,I+G*_+m,L,this.fontSize/15)),D=V.left,L=V.width,x=H,O=X,_=f,m=C}else L+=V.kernedWidth;Y=R+p+D,this.direction==="rtl"&&(Y=this.width-Y-L),n.fillStyle=X,H&&X&&n.fillRect(Y,I+G*_+m,L-j,this.fontSize/15),M+=h}else M+=h;this._removeShadow(n)}},_getFontDeclaration:function(n,s){var h=n||this,_=this.fontFamily,f=o.Text.genericFonts.indexOf(_.toLowerCase())>-1,p=_===void 0||_.indexOf("'")>-1||_.indexOf(",")>-1||_.indexOf('"')>-1||f?h.fontFamily:'"'+h.fontFamily+'"';return[o.isLikelyNode?h.fontWeight:h.fontStyle,o.isLikelyNode?h.fontStyle:h.fontWeight,s?this.CACHE_FONT_SIZE+"px":h.fontSize+"px",p].join(" ")},render:function(n){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",n)))},_splitTextIntoLines:function(n){for(var s=n.split(this._reNewline),h=new Array(s.length),_=[`
`],f=[],p=0;p<s.length;p++)h[p]=o.util.string.graphemeSplit(s[p]),f=f.concat(h[p],_);return f.pop(),{_unwrappedLines:h,lines:s,graphemeText:f,graphemeLines:h}},toObject:function(n){var s=d.concat(n),h=this.callSuper("toObject",s);return h.styles=l(this.styles,!0),h.path&&(h.path=this.path.toObject()),h},set:function(n,s){this.callSuper("set",n,s);var h=!1,_=!1;if(typeof n=="object")for(var f in n)f==="path"&&this.setPathInfo(),h=h||this._dimensionAffectingProps.indexOf(f)!==-1,_=_||f==="path";else h=this._dimensionAffectingProps.indexOf(n)!==-1,_=n==="path";return _&&this.setPathInfo(),h&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),o.Text.ATTRIBUTE_NAMES=o.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),o.Text.DEFAULT_SVG_FONT_SIZE=16,o.Text.fromElement=function(n,s,h){if(!n)return s(null);var _=o.parseAttributes(n,o.Text.ATTRIBUTE_NAMES),f=_.textAnchor||"left";if((h=o.util.object.extend(h?l(h):{},_)).top=h.top||0,h.left=h.left||0,_.textDecoration){var p=_.textDecoration;p.indexOf("underline")!==-1&&(h.underline=!0),p.indexOf("overline")!==-1&&(h.overline=!0),p.indexOf("line-through")!==-1&&(h.linethrough=!0),delete h.textDecoration}"dx"in _&&(h.left+=_.dx),"dy"in _&&(h.top+=_.dy),"fontSize"in h||(h.fontSize=o.Text.DEFAULT_SVG_FONT_SIZE);var m="";"textContent"in n?m=n.textContent:"firstChild"in n&&n.firstChild!==null&&"data"in n.firstChild&&n.firstChild.data!==null&&(m=n.firstChild.data),m=m.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var C=h.strokeWidth;h.strokeWidth=0;var T=new o.Text(m,h),x=T.getScaledHeight()/T.height,I=((T.height+T.strokeWidth)*T.lineHeight-T.height)*x,D=T.getScaledHeight()+I,L=0;f==="center"&&(L=T.getScaledWidth()/2),f==="right"&&(L=T.getScaledWidth()),T.set({left:T.left-L,top:T.top-(D-T.fontSize*(.07+T._fontSizeFraction))/T.lineHeight,strokeWidth:C!==void 0?C:1}),s(T)},o.Text.fromObject=function(n,s){var h=l(n),_=n.path;return delete h.path,o.Object._fromObject("Text",h,function(f){_?o.Object._fromObject("Path",_,function(p){f.set("path",p),s(f)},"path"):s(f)},"text")},o.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],o.util.createAccessors&&o.util.createAccessors(o.Text)}}(t),y.util.object.extend(y.Text.prototype,{isEmptyStyles:function(a){if(!this.styles||a!==void 0&&!this.styles[a])return!0;var o=a===void 0?this.styles:{line:this.styles[a]};for(var l in o)for(var d in o[l])for(var n in o[l][d])return!1;return!0},styleHas:function(a,o){if(!this.styles||!a||a===""||o!==void 0&&!this.styles[o])return!1;var l=o===void 0?this.styles:{0:this.styles[o]};for(var d in l)for(var n in l[d])if(l[d][n][a]!==void 0)return!0;return!1},cleanStyle:function(a){if(!this.styles||!a||a==="")return!1;var o,l,d=this.styles,n=0,s=!0,h=0;for(var _ in d){for(var f in o=0,d[_]){var p;n++,(p=d[_][f]).hasOwnProperty(a)?(l?p[a]!==l&&(s=!1):l=p[a],p[a]===this[a]&&delete p[a]):s=!1,Object.keys(p).length!==0?o++:delete d[_][f]}o===0&&delete d[_]}for(var m=0;m<this._textLines.length;m++)h+=this._textLines[m].length;s&&n===h&&(this[a]=l,this.removeStyle(a))},removeStyle:function(a){if(this.styles&&a&&a!==""){var o,l,d,n=this.styles;for(l in n){for(d in o=n[l])delete o[d][a],Object.keys(o[d]).length===0&&delete o[d];Object.keys(o).length===0&&delete n[l]}}},_extendStyles:function(a,o){var l=this.get2DCursorLocation(a);this._getLineStyle(l.lineIndex)||this._setLineStyle(l.lineIndex),this._getStyleDeclaration(l.lineIndex,l.charIndex)||this._setStyleDeclaration(l.lineIndex,l.charIndex,{}),y.util.object.extend(this._getStyleDeclaration(l.lineIndex,l.charIndex),o)},get2DCursorLocation:function(a,o){a===void 0&&(a=this.selectionStart);for(var l=o?this._unwrappedTextLines:this._textLines,d=l.length,n=0;n<d;n++){if(a<=l[n].length)return{lineIndex:n,charIndex:a};a-=l[n].length+this.missingNewlineOffset(n)}return{lineIndex:n-1,charIndex:l[n-1].length<a?l[n-1].length:a}},getSelectionStyles:function(a,o,l){a===void 0&&(a=this.selectionStart||0),o===void 0&&(o=this.selectionEnd||a);for(var d=[],n=a;n<o;n++)d.push(this.getStyleAtPosition(n,l));return d},getStyleAtPosition:function(a,o){var l=this.get2DCursorLocation(a);return(o?this.getCompleteStyleDeclaration(l.lineIndex,l.charIndex):this._getStyleDeclaration(l.lineIndex,l.charIndex))||{}},setSelectionStyles:function(a,o,l){o===void 0&&(o=this.selectionStart||0),l===void 0&&(l=this.selectionEnd||o);for(var d=o;d<l;d++)this._extendStyles(d,a);return this._forceClearCache=!0,this},_getStyleDeclaration:function(a,o){var l=this.styles&&this.styles[a];return l?l[o]:null},getCompleteStyleDeclaration:function(a,o){for(var l,d=this._getStyleDeclaration(a,o)||{},n={},s=0;s<this._styleProperties.length;s++)n[l=this._styleProperties[s]]=d[l]===void 0?this[l]:d[l];return n},_setStyleDeclaration:function(a,o,l){this.styles[a][o]=l},_deleteStyleDeclaration:function(a,o){delete this.styles[a][o]},_getLineStyle:function(a){return!!this.styles[a]},_setLineStyle:function(a){this.styles[a]={}},_deleteLineStyle:function(a){delete this.styles[a]}}),function(){function a(o){o.textDecoration&&(o.textDecoration.indexOf("underline")>-1&&(o.underline=!0),o.textDecoration.indexOf("line-through")>-1&&(o.linethrough=!0),o.textDecoration.indexOf("overline")>-1&&(o.overline=!0),delete o.textDecoration)}y.IText=y.util.createClass(y.Text,y.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(o,l){this.callSuper("initialize",o,l),this.initBehavior()},setSelectionStart:function(o){o=Math.max(o,0),this._updateAndFire("selectionStart",o)},setSelectionEnd:function(o){o=Math.min(o,this.text.length),this._updateAndFire("selectionEnd",o)},_updateAndFire:function(o,l){this[o]!==l&&(this._fireSelectionChanged(),this[o]=l),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(o){this.clearContextTop(),this.callSuper("render",o),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(o){this.callSuper("_render",o)},clearContextTop:function(o){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var l=this.canvas.contextTop,d=this.canvas.viewportTransform;l.save(),l.transform(d[0],d[1],d[2],d[3],d[4],d[5]),this.transform(l),this._clearTextArea(l),o||l.restore()}},renderCursorOrSelection:function(){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var o=this._getCursorBoundaries(),l=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(o,l):this.renderSelection(o,l),l.restore()}},_clearTextArea:function(o){var l=this.width+4,d=this.height+4;o.clearRect(-l/2,-d/2,l,d)},_getCursorBoundaries:function(o){o===void 0&&(o=this.selectionStart);var l=this._getLeftOffset(),d=this._getTopOffset(),n=this._getCursorBoundariesOffsets(o);return{left:l,top:d,leftOffset:n.left,topOffset:n.top}},_getCursorBoundariesOffsets:function(o){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var l,d,n,s,h=0,_=0,f=this.get2DCursorLocation(o);n=f.charIndex,d=f.lineIndex;for(var p=0;p<d;p++)h+=this.getHeightOfLine(p);l=this._getLineLeftOffset(d);var m=this.__charBounds[d][n];return m&&(_=m.left),this.charSpacing!==0&&n===this._textLines[d].length&&(_-=this._getWidthOfCharSpacing()),s={top:h,left:l+(_>0?_:0)},this.direction==="rtl"&&(s.left*=-1),this.cursorOffsetCache=s,this.cursorOffsetCache},renderCursor:function(o,l){var d=this.get2DCursorLocation(),n=d.lineIndex,s=d.charIndex>0?d.charIndex-1:0,h=this.getValueOfPropertyAt(n,s,"fontSize"),_=this.scaleX*this.canvas.getZoom(),f=this.cursorWidth/_,p=o.topOffset,m=this.getValueOfPropertyAt(n,s,"deltaY");p+=(1-this._fontSizeFraction)*this.getHeightOfLine(n)/this.lineHeight-h*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(o,l),l.fillStyle=this.cursorColor||this.getValueOfPropertyAt(n,s,"fill"),l.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,l.fillRect(o.left+o.leftOffset-f/2,p+o.top+m,f,h)},renderSelection:function(o,l){for(var d=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,n=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,s=this.textAlign.indexOf("justify")!==-1,h=this.get2DCursorLocation(d),_=this.get2DCursorLocation(n),f=h.lineIndex,p=_.lineIndex,m=h.charIndex<0?0:h.charIndex,C=_.charIndex<0?0:_.charIndex,T=f;T<=p;T++){var x,I=this._getLineLeftOffset(T)||0,D=this.getHeightOfLine(T),L=0,V=0;if(T===f&&(L=this.__charBounds[f][m].left),T>=f&&T<p)V=s&&!this.isEndOfWrapping(T)?this.width:this.getLineWidth(T)||5;else if(T===p)if(C===0)V=this.__charBounds[p][C].left;else{var H=this._getWidthOfCharSpacing();V=this.__charBounds[p][C-1].left+this.__charBounds[p][C-1].width-H}x=D,(this.lineHeight<1||T===p&&this.lineHeight>1)&&(D/=this.lineHeight);var $=o.left+I+L,X=V-L,O=D,R=0;this.inCompositionMode?(l.fillStyle=this.compositionColor||"black",O=1,R=D):l.fillStyle=this.selectionColor,this.direction==="rtl"&&($=this.width-$-X),l.fillRect($,o.top+o.topOffset+R,X,O),o.topOffset+=x}},getCurrentCharFontSize:function(){var o=this._getCurrentCharIndex();return this.getValueOfPropertyAt(o.l,o.c,"fontSize")},getCurrentCharColor:function(){var o=this._getCurrentCharIndex();return this.getValueOfPropertyAt(o.l,o.c,"fill")},_getCurrentCharIndex:function(){var o=this.get2DCursorLocation(this.selectionStart,!0),l=o.charIndex>0?o.charIndex-1:0;return{l:o.lineIndex,c:l}}}),y.IText.fromObject=function(o,l){if(a(o),o.styles)for(var d in o.styles)for(var n in o.styles[d])a(o.styles[d][n]);y.Object._fromObject("IText",o,l,"text")}}(),_e=y.util.object.clone,y.util.object.extend(y.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var a=this;this.on("added",function(){var o=a.canvas;o&&(o._hasITextHandlers||(o._hasITextHandlers=!0,a._initCanvasHandlers(o)),o._iTextInstances=o._iTextInstances||[],o._iTextInstances.push(a))})},initRemovedHandler:function(){var a=this;this.on("removed",function(){var o=a.canvas;o&&(o._iTextInstances=o._iTextInstances||[],y.util.removeFromArray(o._iTextInstances,a),o._iTextInstances.length===0&&(o._hasITextHandlers=!1,a._removeCanvasHandlers(o)))})},_initCanvasHandlers:function(a){a._mouseUpITextHandler=function(){a._iTextInstances&&a._iTextInstances.forEach(function(o){o.__isMousedown=!1})},a.on("mouse:up",a._mouseUpITextHandler)},_removeCanvasHandlers:function(a){a.off("mouse:up",a._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(a,o,l,d){var n;return n={isAborted:!1,abort:function(){this.isAborted=!0}},a.animate("_currentCursorOpacity",o,{duration:l,onComplete:function(){n.isAborted||a[d]()},onChange:function(){a.canvas&&a.selectionStart===a.selectionEnd&&a.renderCursorOrSelection()},abort:function(){return n.isAborted}}),n},_onTickComplete:function(){var a=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){a._currentTickCompleteState=a._animateCursor(a,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(a){var o=this,l=a?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){o._tick()},l)},abortCursorAnimation:function(){var a=this._currentTickState||this._currentTickCompleteState,o=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,a&&o&&o.clearContext(o.contextTop||o.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(a){var o=0,l=a-1;if(this._reSpace.test(this._text[l]))for(;this._reSpace.test(this._text[l]);)o++,l--;for(;/\S/.test(this._text[l])&&l>-1;)o++,l--;return a-o},findWordBoundaryRight:function(a){var o=0,l=a;if(this._reSpace.test(this._text[l]))for(;this._reSpace.test(this._text[l]);)o++,l++;for(;/\S/.test(this._text[l])&&l<this._text.length;)o++,l++;return a+o},findLineBoundaryLeft:function(a){for(var o=0,l=a-1;!/\n/.test(this._text[l])&&l>-1;)o++,l--;return a-o},findLineBoundaryRight:function(a){for(var o=0,l=a;!/\n/.test(this._text[l])&&l<this._text.length;)o++,l++;return a+o},searchWordBoundary:function(a,o){for(var l=this._text,d=this._reSpace.test(l[a])?a-1:a,n=l[d],s=y.reNonWord;!s.test(n)&&d>0&&d<l.length;)n=l[d+=o];return s.test(n)&&(d+=o===1?0:1),d},selectWord:function(a){a=a||this.selectionStart;var o=this.searchWordBoundary(a,-1),l=this.searchWordBoundary(a,1);this.selectionStart=o,this.selectionEnd=l,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(a){a=a||this.selectionStart;var o=this.findLineBoundaryLeft(a),l=this.findLineBoundaryRight(a);return this.selectionStart=o,this.selectionEnd=l,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(a){if(!this.isEditing&&this.editable)return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(a),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(a){a._iTextInstances&&a._iTextInstances.forEach(function(o){o.selected=!1,o.isEditing&&o.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(a){if(this.__isMousedown&&this.isEditing){var o=this.getSelectionStartFromPointer(a.e),l=this.selectionStart,d=this.selectionEnd;(o===this.__selectionStartOnMouseDown&&l!==d||l!==o&&d!==o)&&(o>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=o):(this.selectionStart=o,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===l&&this.selectionEnd===d||(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(a,o,l){var d=l.slice(0,a),n=y.util.string.graphemeSplit(d).length;if(a===o)return{selectionStart:n,selectionEnd:n};var s=l.slice(a,o);return{selectionStart:n,selectionEnd:n+y.util.string.graphemeSplit(s).length}},fromGraphemeToStringSelection:function(a,o,l){var d=l.slice(0,a).join("").length;return a===o?{selectionStart:d,selectionEnd:d}:{selectionStart:d,selectionEnd:d+l.slice(a,o).join("").length}},_updateTextarea:function(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){var a=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=a.selectionStart,this.hiddenTextarea.selectionEnd=a.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var a=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=a.selectionEnd,this.inCompositionMode||(this.selectionStart=a.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var a=this._calcTextareaPosition();this.hiddenTextarea.style.left=a.left,this.hiddenTextarea.style.top=a.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var a=this.inCompositionMode?this.compositionStart:this.selectionStart,o=this._getCursorBoundaries(a),l=this.get2DCursorLocation(a),d=l.lineIndex,n=l.charIndex,s=this.getValueOfPropertyAt(d,n,"fontSize")*this.lineHeight,h=o.leftOffset,_=this.calcTransformMatrix(),f={x:o.left+h,y:o.top+o.topOffset+s},p=this.canvas.getRetinaScaling(),m=this.canvas.upperCanvasEl,C=m.width/p,T=m.height/p,x=C-s,I=T-s,D=m.clientWidth/C,L=m.clientHeight/T;return f=y.util.transformPoint(f,_),(f=y.util.transformPoint(f,this.canvas.viewportTransform)).x*=D,f.y*=L,f.x<0&&(f.x=0),f.x>x&&(f.x=x),f.y<0&&(f.y=0),f.y>I&&(f.y=I),f.x+=this.canvas._offset.left,f.y+=this.canvas._offset.top,{left:f.x+"px",top:f.y+"px",fontSize:s+"px",charHeight:s}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var a=this._textBeforeEdit!==this.text,o=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,o&&(o.blur&&o.blur(),o.parentNode&&o.parentNode.removeChild(o)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),a&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),a&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var a in this.styles)this._textLines[a]||delete this.styles[a]},removeStyleFromTo:function(a,o){var l,d,n=this.get2DCursorLocation(a,!0),s=this.get2DCursorLocation(o,!0),h=n.lineIndex,_=n.charIndex,f=s.lineIndex,p=s.charIndex;if(h!==f){if(this.styles[h])for(l=_;l<this._unwrappedTextLines[h].length;l++)delete this.styles[h][l];if(this.styles[f])for(l=p;l<this._unwrappedTextLines[f].length;l++)(d=this.styles[f][l])&&(this.styles[h]||(this.styles[h]={}),this.styles[h][_+l-p]=d);for(l=h+1;l<=f;l++)delete this.styles[l];this.shiftLineStyles(f,h-f)}else if(this.styles[h]){d=this.styles[h];var m,C,T=p-_;for(l=_;l<p;l++)delete d[l];for(C in this.styles[h])(m=parseInt(C,10))>=p&&(d[m-T]=d[C],delete d[C])}},shiftLineStyles:function(a,o){var l=_e(this.styles);for(var d in this.styles){var n=parseInt(d,10);n>a&&(this.styles[n+o]=l[n],l[n-o]||delete this.styles[n])}},restartCursorIfNeeded:function(){this._currentTickState&&!this._currentTickState.isAborted&&this._currentTickCompleteState&&!this._currentTickCompleteState.isAborted||this.initDelayedCursor()},insertNewlineStyleObject:function(a,o,l,d){var n,s={},h=!1,_=this._unwrappedTextLines[a].length===o;for(var f in l||(l=1),this.shiftLineStyles(a,l),this.styles[a]&&(n=this.styles[a][o===0?o:o-1]),this.styles[a]){var p=parseInt(f,10);p>=o&&(h=!0,s[p-o]=this.styles[a][f],_&&o===0||delete this.styles[a][f])}var m=!1;for(h&&!_&&(this.styles[a+l]=s,m=!0),m&&l--;l>0;)d&&d[l-1]?this.styles[a+l]={0:_e(d[l-1])}:n?this.styles[a+l]={0:_e(n)}:delete this.styles[a+l],l--;this._forceClearCache=!0},insertCharStyleObject:function(a,o,l,d){this.styles||(this.styles={});var n=this.styles[a],s=n?_e(n):{};for(var h in l||(l=1),s){var _=parseInt(h,10);_>=o&&(n[_+l]=s[_],s[_-l]||delete n[_])}if(this._forceClearCache=!0,d)for(;l--;)Object.keys(d[l]).length&&(this.styles[a]||(this.styles[a]={}),this.styles[a][o+l]=_e(d[l]));else if(n)for(var f=n[o?o-1:1];f&&l--;)this.styles[a][o+l]=_e(f)},insertNewStyleBlock:function(a,o,l){for(var d=this.get2DCursorLocation(o,!0),n=[0],s=0,h=0;h<a.length;h++)a[h]===`
`?n[++s]=0:n[s]++;for(n[0]>0&&(this.insertCharStyleObject(d.lineIndex,d.charIndex,n[0],l),l=l&&l.slice(n[0]+1)),s&&this.insertNewlineStyleObject(d.lineIndex,d.charIndex+n[0],s),h=1;h<s;h++)n[h]>0?this.insertCharStyleObject(d.lineIndex+h,0,n[h],l):l&&this.styles[d.lineIndex+h]&&l[0]&&(this.styles[d.lineIndex+h][0]=l[0]),l=l&&l.slice(n[h]+1);n[h]>0&&this.insertCharStyleObject(d.lineIndex+h,0,n[h],l)},setSelectionStartEndWithShift:function(a,o,l){l<=a?(o===a?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=a),this.selectionStart=l):l>a&&l<o?this._selectionDirection==="right"?this.selectionEnd=l:this.selectionStart=l:(o===a?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=o),this.selectionEnd=l)},setSelectionInBoundaries:function(){var a=this.text.length;this.selectionStart>a?this.selectionStart=a:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>a?this.selectionEnd=a:this.selectionEnd<0&&(this.selectionEnd=0)}}),y.util.object.extend(y.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(a){if(this.canvas){this.__newClickTime=+new Date;var o=a.pointer;this.isTripleClick(o)&&(this.fire("tripleclick",a),this._stopEvent(a.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=o,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(a){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===a.x&&this.__lastPointer.y===a.y},_stopEvent:function(a){a.preventDefault&&a.preventDefault(),a.stopPropagation&&a.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(a){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(a.e))},tripleClickHandler:function(a){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(a.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(a){!this.canvas||!this.editable||a.e.button&&a.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(a.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(a){!this.canvas||!this.editable||a.e.button&&a.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(a){if(this.__isMousedown=!1,!(!this.editable||this.group||a.transform&&a.transform.actionPerformed||a.e.button&&a.e.button!==1)){if(this.canvas){var o=this.canvas._activeObject;if(o&&o!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(a.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(a){var o=this.getSelectionStartFromPointer(a),l=this.selectionStart,d=this.selectionEnd;a.shiftKey?this.setSelectionStartEndWithShift(l,d,o):(this.selectionStart=o,this.selectionEnd=o),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(a){for(var o,l=this.getLocalPointer(a),d=0,n=0,s=0,h=0,_=0,f=0,p=this._textLines.length;f<p&&s<=l.y;f++)s+=this.getHeightOfLine(f)*this.scaleY,_=f,f>0&&(h+=this._textLines[f-1].length+this.missingNewlineOffset(f-1));n=this._getLineLeftOffset(_)*this.scaleX,o=this._textLines[_],this.direction==="rtl"&&(l.x=this.width*this.scaleX-l.x+n);for(var m=0,C=o.length;m<C&&(d=n,(n+=this.__charBounds[_][m].kernedWidth*this.scaleX)<=l.x);m++)h++;return this._getNewSelectionStartFromOffset(l,d,n,h,C)},_getNewSelectionStartFromOffset:function(a,o,l,d,n){var s=a.x-o,h=l-a.x,_=d+(h>s||h<0?0:1);return this.flipX&&(_=n-_),_>this._text.length&&(_=this._text.length),_}}),y.util.object.extend(y.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=y.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var a=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+a.top+"; left: "+a.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding\uFF70top: "+a.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):y.document.body.appendChild(this.hiddenTextarea),y.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),y.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),y.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),y.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),y.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),y.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),y.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),y.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),y.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(y.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(a){if(this.isEditing){var o=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(a.keyCode in o)this[o[a.keyCode]](a);else{if(!(a.keyCode in this.ctrlKeysMapDown)||!a.ctrlKey&&!a.metaKey)return;this[this.ctrlKeysMapDown[a.keyCode]](a)}a.stopImmediatePropagation(),a.preventDefault(),a.keyCode>=33&&a.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(a){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:a.keyCode in this.ctrlKeysMapUp&&(a.ctrlKey||a.metaKey)&&(this[this.ctrlKeysMapUp[a.keyCode]](a),a.stopImmediatePropagation(),a.preventDefault(),this.canvas&&this.canvas.requestRenderAll())},onInput:function(a){var o=this.fromPaste;if(this.fromPaste=!1,a&&a.stopPropagation(),this.isEditing){var l,d,n,s,h,_=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,f=this._text.length,p=_.length,m=p-f,C=this.selectionStart,T=this.selectionEnd,x=C!==T;if(this.hiddenTextarea.value==="")return this.styles={},this.updateFromTextArea(),this.fire("changed"),void(this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll()));var I=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),D=C>I.selectionStart;x?(l=this._text.slice(C,T),m+=T-C):p<f&&(l=D?this._text.slice(T+m,T):this._text.slice(C,C-m)),d=_.slice(I.selectionEnd-m,I.selectionEnd),l&&l.length&&(d.length&&(n=this.getSelectionStyles(C,C+1,!1),n=d.map(function(){return n[0]})),x?(s=C,h=T):D?(s=T-l.length,h=T):(s=T,h=T+l.length),this.removeStyleFromTo(s,h)),d.length&&(o&&d.join("")===y.copiedText&&!y.disableStyleCopyPaste&&(n=y.copiedTextStyle),this.insertNewStyleBlock(d,C,n)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(a){this.compositionStart=a.target.selectionStart,this.compositionEnd=a.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(y.copiedText=this.getSelectedText(),y.disableStyleCopyPaste?y.copiedTextStyle=null:y.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(a){return a&&a.clipboardData||y.window.clipboardData},_getWidthBeforeCursor:function(a,o){var l,d=this._getLineLeftOffset(a);return o>0&&(d+=(l=this.__charBounds[a][o-1]).left+l.width),d},getDownCursorOffset:function(a,o){var l=this._getSelectionForOffset(a,o),d=this.get2DCursorLocation(l),n=d.lineIndex;if(n===this._textLines.length-1||a.metaKey||a.keyCode===34)return this._text.length-l;var s=d.charIndex,h=this._getWidthBeforeCursor(n,s),_=this._getIndexOnLine(n+1,h);return this._textLines[n].slice(s).length+_+1+this.missingNewlineOffset(n)},_getSelectionForOffset:function(a,o){return a.shiftKey&&this.selectionStart!==this.selectionEnd&&o?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(a,o){var l=this._getSelectionForOffset(a,o),d=this.get2DCursorLocation(l),n=d.lineIndex;if(n===0||a.metaKey||a.keyCode===33)return-l;var s=d.charIndex,h=this._getWidthBeforeCursor(n,s),_=this._getIndexOnLine(n-1,h),f=this._textLines[n].slice(0,s),p=this.missingNewlineOffset(n-1);return-this._textLines[n-1].length+_-f.length+(1-p)},_getIndexOnLine:function(a,o){for(var l,d,n=this._textLines[a],s=this._getLineLeftOffset(a),h=0,_=0,f=n.length;_<f;_++)if((s+=l=this.__charBounds[a][_].width)>o){d=!0;var p=s-l,m=s,C=Math.abs(p-o);h=Math.abs(m-o)<C?_:_-1;break}return d||(h=n.length-1),h},moveCursorDown:function(a){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",a)},moveCursorUp:function(a){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",a)},_moveCursorUpOrDown:function(a,o){var l=this["get"+a+"CursorOffset"](o,this._selectionDirection==="right");o.shiftKey?this.moveCursorWithShift(l):this.moveCursorWithoutShift(l),l!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(a){var o=this._selectionDirection==="left"?this.selectionStart+a:this.selectionEnd+a;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,o),a!==0},moveCursorWithoutShift:function(a){return a<0?(this.selectionStart+=a,this.selectionEnd=this.selectionStart):(this.selectionEnd+=a,this.selectionStart=this.selectionEnd),a!==0},moveCursorLeft:function(a){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",a)},_move:function(a,o,l){var d;if(a.altKey)d=this["findWordBoundary"+l](this[o]);else{if(!a.metaKey&&a.keyCode!==35&&a.keyCode!==36)return this[o]+=l==="Left"?-1:1,!0;d=this["findLineBoundary"+l](this[o])}if(typeof d!==void 0&&this[o]!==d)return this[o]=d,!0},_moveLeft:function(a,o){return this._move(a,o,"Left")},_moveRight:function(a,o){return this._move(a,o,"Right")},moveCursorLeftWithoutShift:function(a){var o=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(o=this._moveLeft(a,"selectionStart")),this.selectionEnd=this.selectionStart,o},moveCursorLeftWithShift:function(a){return this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd?this._moveLeft(a,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection="left",this._moveLeft(a,"selectionStart")):void 0},moveCursorRight:function(a){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",a)},_moveCursorLeftOrRight:function(a,o){var l="moveCursor"+a+"With";this._currentCursorOpacity=1,o.shiftKey?l+="Shift":l+="outShift",this[l](o)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(a){return this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd?this._moveRight(a,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection="right",this._moveRight(a,"selectionEnd")):void 0},moveCursorRightWithoutShift:function(a){var o=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(o=this._moveRight(a,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,o},removeChars:function(a,o){o===void 0&&(o=a+1),this.removeStyleFromTo(a,o),this._text.splice(a,o-a),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(a,o,l,d){d===void 0&&(d=l),d>l&&this.removeStyleFromTo(l,d);var n=y.util.string.graphemeSplit(a);this.insertNewStyleBlock(n,l,o),this._text=[].concat(this._text.slice(0,l),n,this._text.slice(d)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var a=y.util.toFixed,o=/  +/g;y.util.object.extend(y.Text.prototype,{_toSVG:function(){var l=this._getSVGLeftTopOffsets(),d=this._getSVGTextAndBg(l.textTop,l.textLeft);return this._wrapSVGTextAndBg(d)},toSVG:function(l){return this._createBaseSVGMarkup(this._toSVG(),{reviver:l,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(l){var d=this.getSvgTextDecoration(this);return[l.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",d?'text-decoration="'+d+'" ':"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",l.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(l,d){var n,s=[],h=[],_=l;this._setSVGBg(h);for(var f=0,p=this._textLines.length;f<p;f++)n=this._getLineLeftOffset(f),(this.textBackgroundColor||this.styleHas("textBackgroundColor",f))&&this._setSVGTextLineBg(h,f,d+n,_),this._setSVGTextLineText(s,f,d+n,_),_+=this.getHeightOfLine(f);return{textSpans:s,textBgRects:h}},_createTextCharSpan:function(l,d,n,s){var h=l!==l.trim()||l.match(o),_=this.getSvgSpanStyles(d,h),f=_?'style="'+_+'"':"",p=d.deltaY,m="",C=y.Object.NUM_FRACTION_DIGITS;return p&&(m=' dy="'+a(p,C)+'" '),['<tspan x="',a(n,C),'" y="',a(s,C),'" ',m,f,">",y.util.string.escapeXml(l),"</tspan>"].join("")},_setSVGTextLineText:function(l,d,n,s){var h,_,f,p,m,C=this.getHeightOfLine(d),T=this.textAlign.indexOf("justify")!==-1,x="",I=0,D=this._textLines[d];s+=C*(1-this._fontSizeFraction)/this.lineHeight;for(var L=0,V=D.length-1;L<=V;L++)m=L===V||this.charSpacing,x+=D[L],f=this.__charBounds[d][L],I===0?(n+=f.kernedWidth-f.width,I+=f.width):I+=f.kernedWidth,T&&!m&&this._reSpaceAndTab.test(D[L])&&(m=!0),m||(h=h||this.getCompleteStyleDeclaration(d,L),_=this.getCompleteStyleDeclaration(d,L+1),m=this._hasStyleChangedForSvg(h,_)),m&&(p=this._getStyleDeclaration(d,L)||{},l.push(this._createTextCharSpan(x,p,n,s)),x="",h=_,n+=I,I=0)},_pushTextBgRect:function(l,d,n,s,h,_){var f=y.Object.NUM_FRACTION_DIGITS;l.push("		<rect ",this._getFillAttributes(d),' x="',a(n,f),'" y="',a(s,f),'" width="',a(h,f),'" height="',a(_,f),`"></rect>
`)},_setSVGTextLineBg:function(l,d,n,s){for(var h,_,f=this._textLines[d],p=this.getHeightOfLine(d)/this.lineHeight,m=0,C=0,T=this.getValueOfPropertyAt(d,0,"textBackgroundColor"),x=0,I=f.length;x<I;x++)h=this.__charBounds[d][x],(_=this.getValueOfPropertyAt(d,x,"textBackgroundColor"))!==T?(T&&this._pushTextBgRect(l,T,n+C,s,m,p),C=h.left,m=h.width,T=_):m+=h.kernedWidth;_&&this._pushTextBgRect(l,_,n+C,s,m,p)},_getFillAttributes:function(l){var d=l&&typeof l=="string"?new y.Color(l):"";return d&&d.getSource()&&d.getAlpha()!==1?'opacity="'+d.getAlpha()+'" fill="'+d.setAlpha(1).toRgb()+'"':'fill="'+l+'"'},_getSVGLineTopOffset:function(l){for(var d,n=0,s=0;s<l;s++)n+=this.getHeightOfLine(s);return d=this.getHeightOfLine(s),{lineTop:n,offset:(this._fontSizeMult-this._fontSizeFraction)*d/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(l){return y.Object.prototype.getSvgStyles.call(this,l)+" white-space: pre;"}})}(),function(a){var o=a.fabric||(a.fabric={});o.Textbox=o.util.createClass(o.IText,o.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:o.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(l){for(var d=0,n=0,s=0,h={},_=0;_<l.graphemeLines.length;_++)l.graphemeText[s]===`
`&&_>0?(n=0,s++,d++):!this.splitByGrapheme&&this._reSpaceAndTab.test(l.graphemeText[s])&&_>0&&(n++,s++),h[_]={line:d,offset:n},s+=l.graphemeLines[_].length,n+=l.graphemeLines[_].length;return h},styleHas:function(l,d){if(this._styleMap&&!this.isWrapping){var n=this._styleMap[d];n&&(d=n.line)}return o.Text.prototype.styleHas.call(this,l,d)},isEmptyStyles:function(l){if(!this.styles)return!0;var d,n,s=0,h=!1,_=this._styleMap[l],f=this._styleMap[l+1];for(var p in _&&(l=_.line,s=_.offset),f&&(h=f.line===l,d=f.offset),n=l===void 0?this.styles:{line:this.styles[l]})for(var m in n[p])if(m>=s&&(!h||m<d))for(var C in n[p][m])return!1;return!0},_getStyleDeclaration:function(l,d){if(this._styleMap&&!this.isWrapping){var n=this._styleMap[l];if(!n)return null;l=n.line,d=n.offset+d}return this.callSuper("_getStyleDeclaration",l,d)},_setStyleDeclaration:function(l,d,n){var s=this._styleMap[l];l=s.line,d=s.offset+d,this.styles[l][d]=n},_deleteStyleDeclaration:function(l,d){var n=this._styleMap[l];l=n.line,d=n.offset+d,delete this.styles[l][d]},_getLineStyle:function(l){var d=this._styleMap[l];return!!this.styles[d.line]},_setLineStyle:function(l){var d=this._styleMap[l];this.styles[d.line]={}},_wrapText:function(l,d){var n,s=[];for(this.isWrapping=!0,n=0;n<l.length;n++)s=s.concat(this._wrapLine(l[n],n,d));return this.isWrapping=!1,s},_measureWord:function(l,d,n){var s,h=0;n=n||0;for(var _=0,f=l.length;_<f;_++)h+=this._getGraphemeBox(l[_],d,_+n,s,!0).kernedWidth,s=l[_];return h},_wrapLine:function(l,d,n,s){var h=0,_=this.splitByGrapheme,f=[],p=[],m=_?o.util.string.graphemeSplit(l):l.split(this._wordJoiners),C="",T=0,x=_?"":" ",I=0,D=0,L=0,V=!0,H=this._getWidthOfCharSpacing();s=s||0,m.length===0&&m.push([]),n-=s;for(var $=0;$<m.length;$++)C=_?m[$]:o.util.string.graphemeSplit(m[$]),I=this._measureWord(C,d,T),T+=C.length,(h+=D+I-H)>n&&!V?(f.push(p),p=[],h=I,V=!0):h+=H,V||_||p.push(x),p=p.concat(C),D=_?0:this._measureWord([x],d,T),T++,V=!1,I>L&&(L=I);return $&&f.push(p),L+s>this.dynamicMinWidth&&(this.dynamicMinWidth=L-H+s),f},isEndOfWrapping:function(l){return!this._styleMap[l+1]||this._styleMap[l+1].line!==this._styleMap[l].line},missingNewlineOffset:function(l){return this.splitByGrapheme?this.isEndOfWrapping(l)?1:0:1},_splitTextIntoLines:function(l){for(var d=o.Text.prototype._splitTextIntoLines.call(this,l),n=this._wrapText(d.lines,this.width),s=new Array(n.length),h=0;h<n.length;h++)s[h]=n[h].join("");return d.lines=s,d.graphemeLines=n,d},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var l={};for(var d in this._styleMap)this._textLines[d]&&(l[this._styleMap[d].line]=1);for(var d in this.styles)l[d]||delete this.styles[d]},toObject:function(l){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(l))}}),o.Textbox.fromObject=function(l,d){return o.Object._fromObject("Textbox",l,d,"text")}}(t),function(){var a=y.controlsUtils,o=a.scaleSkewCursorStyleHandler,l=a.scaleCursorStyleHandler,d=a.scalingEqually,n=a.scalingYOrSkewingX,s=a.scalingXOrSkewingY,h=a.scaleOrSkewActionName,_=y.Object.prototype.controls;if(_.ml=new y.Control({x:-.5,y:0,cursorStyleHandler:o,actionHandler:s,getActionName:h}),_.mr=new y.Control({x:.5,y:0,cursorStyleHandler:o,actionHandler:s,getActionName:h}),_.mb=new y.Control({x:0,y:.5,cursorStyleHandler:o,actionHandler:n,getActionName:h}),_.mt=new y.Control({x:0,y:-.5,cursorStyleHandler:o,actionHandler:n,getActionName:h}),_.tl=new y.Control({x:-.5,y:-.5,cursorStyleHandler:l,actionHandler:d}),_.tr=new y.Control({x:.5,y:-.5,cursorStyleHandler:l,actionHandler:d}),_.bl=new y.Control({x:-.5,y:.5,cursorStyleHandler:l,actionHandler:d}),_.br=new y.Control({x:.5,y:.5,cursorStyleHandler:l,actionHandler:d}),_.mtr=new y.Control({x:0,y:-.5,actionHandler:a.rotationWithSnapping,cursorStyleHandler:a.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),y.Textbox){var f=y.Textbox.prototype.controls={};f.mtr=_.mtr,f.tr=_.tr,f.br=_.br,f.tl=_.tl,f.bl=_.bl,f.mt=_.mt,f.mb=_.mb,f.mr=new y.Control({x:.5,y:0,actionHandler:a.changeWidth,cursorStyleHandler:o,actionName:"resizing"}),f.ml=new y.Control({x:-.5,y:0,actionHandler:a.changeWidth,cursorStyleHandler:o,actionName:"resizing"})}}()},192:()=>{},898:()=>{},245:()=>{}},Ho={};function ui(e){var t=Ho[e];if(t!==void 0)return t.exports;var i=Ho[e]={exports:{}};return Uf[e](i,i.exports,ui),i.exports}ui.d=(e,t)=>{for(var i in t)ui.o(t,i)&&!ui.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})},ui.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var pc={};(()=>{let e;ui.d(pc,{R:()=>e}),e=typeof document<"u"&&typeof window<"u"?ui(653).fabric:{version:"5.2.1"}})();var Ie=pc.R;/*!
 * Dynamsoft JavaScript Library
 * @product Dynamsoft Camera Enhancer JS Edition
 * @website https://www.dynamsoft.com
 * @copyright Copyright 2022, Dynamsoft Corporation
 * @author Dynamsoft
 * @version 3.0.1 (js 20220803)
 * @fileoverview Dynamsoft JavaScript Library for Camera Enhancer
 * More info on DCE JS: https://www.dynamsoft.com/camera-enhancer/docs/programming/javascript/?ver=latest
 */function Ee(e,t,i,r){return new(i||(i=Promise))(function(c,u){function g(S){try{b(r.next(S))}catch(w){u(w)}}function v(S){try{b(r.throw(S))}catch(w){u(w)}}function b(S){var w;S.done?c(S.value):(w=S.value,w instanceof i?w:new i(function(E){E(w)})).then(g,v)}b((r=r.apply(e,t||[])).next())})}const Ir=typeof self>"u";let Di,tt,Bn,fr,Ne;if(typeof navigator<"u"&&(Di=navigator,tt=Di.userAgent,Bn=Di.platform,fr=Di.mediaDevices),!Ir){const e={init:function(){this.browser=this.searchString(this.dataBrowser)||"unknownBrowser",this.version=this.searchVersion(tt)||this.searchVersion(Di.appVersion)||0,this.OS=this.searchString(this.dataOS)||"unknownOS",this.OS=="Linux"&&tt.indexOf("Windows NT")!=-1&&(this.OS="HarmonyOS")},searchString:function(t){for(let i=0;i<t.length;i++){let r=t[i].string,c=t[i].prop;if(this.versionSearchString=t[i].versionSearch||t[i].identity,r){if(r.indexOf(t[i].subString)!=-1)return t[i].identity}else if(c)return t[i].identity}},searchVersion:function(t){let i=t.indexOf(this.versionSearchString);if(i!=-1)return parseFloat(t.substring(i+this.versionSearchString.length+1))},dataBrowser:[{string:tt,subString:"Edge",identity:"Edge"},{string:tt,subString:"OPR",identity:"OPR"},{string:tt,subString:"Chrome",identity:"Chrome"},{string:Di.vendor,subString:"Apple",identity:"Safari",versionSearch:"Version"},{string:tt,subString:"Firefox",identity:"Firefox"},{string:tt,subString:"MSIE",identity:"Explorer",versionSearch:"MSIE"}],dataOS:[{string:tt,subString:"HarmonyOS",identity:"HarmonyOS"},{string:tt,subString:"Android",identity:"Android"},{string:tt,subString:"iPhone",identity:"iPhone"},{string:Bn,subString:"Win",identity:"Windows"},{string:Bn,subString:"Mac",identity:"Mac"},{string:Bn,subString:"Linux",identity:"Linux"}]};e.init(),Ne={browser:e.browser,version:e.version,OS:e.OS}}Ir&&(Ne={browser:"ssr",version:0,OS:"ssr"});const Gf=typeof WebAssembly<"u"&&tt&&!(/Safari/.test(tt)&&!/Chrome/.test(tt)&&/\(.+\s11_2_([2-6]).*\)/.test(tt)),Wf=!(typeof Worker>"u"),_c=!(!fr||!fr.getUserMedia),Hf=async()=>{let e=!1;if(_c)try{(await fr.getUserMedia({video:!0})).getTracks().forEach(t=>{t.stop()}),e=!0}catch{}return e};Ne.browser==="Chrome"&&Ne.version>66||Ne.browser==="Safari"&&Ne.version>13||Ne.browser==="OPR"&&Ne.version>43||Ne.browser==="Edge"&&Ne.version;const Yf=(()=>{if(!Ir&&document.currentScript){let e=document.currentScript.src,t=e.indexOf("?");if(t!=-1)e=e.substring(0,t);else{let i=e.indexOf("#");i!=-1&&(e=e.substring(0,i))}return e.substring(0,e.lastIndexOf("/")+1)}return"./"})();class ze{constructor(t,i){this._zIndex=null,this._drawingLayer=null,this._drawingLayerId=null,this._mapStyle=new Map,this.mapEvents=new Map([["select",[]],["deselect",[]]]),this.isDrawingItem=!0,this._setFabricObject(t),this._mediaType=t.type,this.styleSelector="default",this.styleId=i;for(let r of ze.arrStyleSelectors)this._mapStyle.set(r,null)}get mediaType(){return this._mediaType}get drawingLayerId(){return this._drawingLayerId}_setFabricObject(t){this._fabricObject=t;const i=this.mapEvents;this._fabricObject.onSelect=()=>{this.styleSelector="selected";const r=this.mapEvents.get("select");for(let c of r)c&&c.apply(this)},this._fabricObject.onDeselect=()=>{this.styleSelector="default";const r=i.get("deselect");for(let c of r)c&&c.apply(this)},t.getDrawingItem=()=>this}_getFabricObject(){return this._fabricObject}on(t,i,r){const c=this.mapEvents.get(t);c.includes(i)||c.push(i)}off(t,i){const r=this.mapEvents.get(t),c=r.indexOf(i);c!==-1&&r.splice(c,1)}_setEditable(t){const i=this._fabricObject;t?(i.selectable=!0,i.evented=!0,i.hasControls=!0):(i.selectable=!1,i.evented=!1,i.hasControls=!1)}_extendSet(t,i){return!1}_extendGet(t){}set(t,i){this._extendSet(t,i)||(t==="x"?this._fabricObject.set("left",i):t==="y"?this._fabricObject.set("top",i):this._fabricObject.set(t,i)),["vertices","left","top","width","height","scaleX","scaleY","skewX","skewY","padding","angle","strokeWidth"].includes(t)&&this._fabricObject.setCoords()}get(t){let i=this._extendGet(t);return i===void 0&&(i=t==="x"?this._fabricObject.get("left"):t==="y"?this._fabricObject.get("top"):this._fabricObject.get(t)),i}}function Yo(e,t,i){let r=i.points[this.pointIndex].x-i.pathOffset.x,c=i.points[this.pointIndex].y-i.pathOffset.y;return Ie.util.transformPoint({x:r,y:c},Ie.util.multiplyTransformMatrices(i.canvas.viewportTransform,i.calcTransformMatrix()))}function mc(e){let t=new Ie.Point(e.strokeUniform?1/e.scaleX:1,e.strokeUniform?1/e.scaleY:1).multiply(e.strokeWidth);return new Ie.Point(e.width+t.x,e.height+t.y)}function Xo(e,t,i,r){let c=t.target,u=c.controls[c.__corner],g=c.toLocalPoint(new Ie.Point(i,r),"center","center"),v=mc(c),b=c._getTransformedDimensions(0,0),S={x:g.x*v.x/b.x+c.pathOffset.x,y:g.y*v.y/b.y+c.pathOffset.y};return c.points[u.pointIndex]=S,!0}function $o(e,t){return function(i,r,c,u){let g=r.target,v=Ie.util.transformPoint({x:g.points[e].x-g.pathOffset.x,y:g.points[e].y-g.pathOffset.y},g.calcTransformMatrix()),b=t(i,r,c,u);g._setPositionDimensions({});let S=mc(g),w=(g.points[e].x-g.pathOffset.x)/S.x,E=(g.points[e].y-g.pathOffset.y)/S.y;return g.setPositionByOrigin(v,w+.5,E+.5),b}}ze.arrMediaTypes=["rect","arc","polygon","image","text","line","path"],ze.arrStyleSelectors=["default","selected"],typeof document<"u"&&typeof window<"u"&&(Ie.StaticCanvas.prototype.dispose=function(){return this.isRendering&&(Ie.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(e){e.dispose&&e.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),Ie.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},Ie.Object.prototype.transparentCorners=!1,Ie.Object.prototype.cornerSize=20,Ie.Object.prototype.touchCornerSize=100,Ie.Object.prototype.cornerColor="rgb(254,142,20)",Ie.Object.prototype.cornerStyle="circle",Ie.Object.prototype.strokeUniform=!0,Ie.Object.prototype.hasBorders=!1,Ie.ActiveSelection.prototype.onDeselect=function(){return this.getObjects().forEach(e=>{setTimeout(e.onDeselect,0)}),this.destroy(),!1},Ie.Canvas.prototype.containerClass="",Ie.Canvas.prototype.getPointer=function(e,t){if(this._absolutePointer&&!t)return this._absolutePointer;if(this._pointer&&t)return this._pointer;var i,r=this.upperCanvasEl,c=Ie.util.getPointer(e,r),u=r.getBoundingClientRect(),g=u.width||0,v=u.height||0;g&&v||("top"in u&&"bottom"in u&&(v=Math.abs(u.top-u.bottom)),"right"in u&&"left"in u&&(g=Math.abs(u.right-u.left))),this.calcOffset(),c.x=c.x-this._offset.left,c.y=c.y-this._offset.top,t||(c=this.restorePointerVpt(c));var b=this.getRetinaScaling();if(b!==1&&(c.x/=b,c.y/=b),g!==0&&v!==0){var S=window.getComputedStyle(r).objectFit,w=r.width,E=r.height,A=g,B=v;i={width:w/A,height:E/B};var z,q,J=w/E,Z=A/B;return S==="contain"?J>Z?(z=A,q=A/J,{x:c.x*i.width,y:(c.y-(B-q)/2)*i.width}):(z=B*J,q=B,{x:(c.x-(A-z)/2)*i.height,y:c.y*i.height}):S==="cover"?J>Z?{x:(w-i.height*A)/2+c.x*i.height,y:c.y*i.height}:{x:c.x*i.width,y:(E-i.width*B)/2+c.y*i.width}:{x:c.x*i.width,y:c.y*i.height}}return i={width:1,height:1},{x:c.x*i.width,y:c.y*i.height}});class Xf{constructor(t,i,r,c){let u,g;switch(this.mapMediaType_Style=new Map,this.mode="viewer",this.onSelectionChange=null,this._arrDrwaingItem=[],this._arrFabricObject=[],this._visible=!0,t.hasOwnProperty("getFabricCanvas")?this.fabricCanvas=t.getFabricCanvas():(this.fabricCanvas=new Ie.Canvas(t,c),this.fabricCanvas.setDimensions({width:"100%",height:"100%"},{cssOnly:!0}),this.fabricCanvas.lowerCanvasEl.className="",this.fabricCanvas.upperCanvasEl.className="",this.fabricCanvas.on("selection:created",function(v){const b=v.selected,S=[];for(let w of b){const E=w.getDrawingItem()._drawingLayer;E&&!S.includes(E)&&S.push(E)}for(let w of S){const E=[];for(let A of b){const B=A.getDrawingItem();B._drawingLayer===w&&E.push(B)}setTimeout(()=>{w.onSelectionChange&&w.onSelectionChange(E,[])},0)}}),this.fabricCanvas.on("before:selection:cleared",function(v){const b=this.getActiveObjects(),S=[];for(let w of b){const E=w.getDrawingItem()._drawingLayer;E&&!S.includes(E)&&S.push(E)}for(let w of S){const E=[];for(let A of b){const B=A.getDrawingItem();B._drawingLayer===w&&E.push(B)}setTimeout(()=>{const A=[];for(let B of E)w.hasDrawingItem(B)&&A.push(B);A.length>0&&w.onSelectionChange&&w.onSelectionChange([],A)},0)}}),this.fabricCanvas.on("selection:updated",function(v){const b=v.selected,S=v.deselected,w=[];for(let E of b){const A=E.getDrawingItem()._drawingLayer;A&&!w.includes(A)&&w.push(A)}for(let E of S){const A=E.getDrawingItem()._drawingLayer;A&&!w.includes(A)&&w.push(A)}for(let E of w){const A=[],B=[];for(let z of b){const q=z.getDrawingItem();q._drawingLayer===E&&A.push(q)}for(let z of S){const q=z.getDrawingItem();q._drawingLayer===E&&B.push(q)}setTimeout(()=>{E.onSelectionChange&&E.onSelectionChange(A,B)},0)}}),this.fabricCanvas.wrapperEl.style.position="absolute",t.getFabricCanvas=()=>this.fabricCanvas),this.id=i,this._mapDrawingStyles=r,i){case 1:u=r.get(1),g=r.get(5);break;case 2:u=r.get(2),g=r.get(6);break;case 3:u=r.get(3),g=r.get(7);break;default:u=r.get(4),g=r.get(8)}for(let v of ze.arrMediaTypes)this.mapMediaType_Style.set(v,{default:u,selected:g})}getId(){return this.id}_getDrawingStyle(t,i){if(typeof t!="number")throw new Error("Invalid style id.");const r=this._mapDrawingStyles.get(t);return r?i?JSON.parse(JSON.stringify(r)):r:null}setVisible(t){if(t){for(let i of this._arrFabricObject)i.visible=!0;this._visible=!0}else{for(let i of this._arrFabricObject)i.visible=!1;this._visible=!1}this.fabricCanvas.renderAll()}isVisible(){return this._visible}_getItemCurrentStyleId(t){return t.styleId?t.styleId:this.mapMediaType_Style.get(t._mediaType)[t.styleSelector].styleId}_getItemCurrentStyle(t){return t.styleId?this._getDrawingStyle(t.styleId):t._mapStyle.get(t.styleSelector)||null}_changeMediaTypeCurStyleInStyleSelector(t,i,r,c){let u;switch(t){case"rect":u=this.fabricCanvas.getObjects("rect");break;case"arc":u=this.fabricCanvas.getObjects("circle");break;case"polygon":u=this.fabricCanvas.getObjects("polygon");break;case"image":u=this.fabricCanvas.getObjects("image");break;case"text":u=this.fabricCanvas.getObjects("text");break;case"line":u=this.fabricCanvas.getObjects("line");break;case"path":u=this.fabricCanvas.getObjects("path")}for(let g of u){if(!this._arrFabricObject.includes(g))continue;const v=g.getDrawingItem();v.styleSelector===i&&this._changeItemStyle(v,r,!0)}c||this.fabricCanvas.renderAll()}_changeItemStyle(t,i,r){if(!t||!i)return;const c=t._getFabricObject();typeof t.styleId=="number"&&(i=this._getDrawingStyle(t.styleId)),c.strokeWidth=i.lineWidth,i.paintMode==="fill"?(c.fill=i.fillStyle,c.stroke=i.fillStyle):i.paintMode==="stroke"?(c.fill="transparent",c.stroke=i.strokeStyle):i.paintMode==="strokeAndFill"&&(c.fill=i.fillStyle,c.stroke=i.strokeStyle),c.fontFamily&&(c.fontFamily=i.fontFamily),c.fontSize&&(c.fontSize=i.fontSize),c.group||(c.dirty=!0),r||this.fabricCanvas.renderAll()}_updateGroupItem(t,i,r){if(!t||!i)return;const c=t.getChildItems();if(r==="add"){if(c.includes(i))return;const u=i._getFabricObject();if(this.fabricCanvas.getObjects().includes(u)){if(!this._arrFabricObject.includes(u))throw new Error("Existed in other drawing layers.");i._zIndex=null}else{let g;if(i.styleId)g=this._getDrawingStyle(i.styleId);else{g=this.mapMediaType_Style.get(i._mediaType)[t.styleSelector];const v=()=>{this._changeItemStyle(i,this.mapMediaType_Style.get(i._mediaType).selected,!0)},b=()=>{this._changeItemStyle(i,this.mapMediaType_Style.get(i._mediaType).default,!0)};i.on("select",v),i.on("deselect",b),i._funcChangeStyleToSelected=v,i._funcChangeStyleToDefault=b}i._drawingLayer=this,i._drawingLayerId=this.id,this._changeItemStyle(i,g,!0)}t._fabricObject.addWithUpdate(i._getFabricObject())}else{if(r!=="remove"||!c.includes(i))return;i._zIndex=null,i._drawingLayer=null,i._drawingLayerId=null,i.off("select",i._funcChangeStyleToSelected),i.off("deselect",i._funcChangeStyleToDefault),i._funcChangeStyleToSelected=null,i._funcChangeStyleToDefault=null,t._fabricObject.removeWithUpdate(i._getFabricObject())}this.fabricCanvas.renderAll()}_addDrawingItem(t,i){let r=t._getFabricObject();const c=this.fabricCanvas.getObjects();let u,g;if(c.includes(r)){if(this._arrFabricObject.includes(r))return;throw new Error("Existed in other drawing layers.")}if(t._mediaType==="group"){u=t.getChildItems();for(let S of u)if(S._drawingLayer&&S._drawingLayer!==this)throw new Error("The childItems of DT_Group have existed in other drawing layers.")}if(i&&typeof i=="object"&&!Array.isArray(i))for(let S in i)r.set(S,i[S]);if(u){for(let S of u){if(S.styleId)g=this._getDrawingStyle(S.styleId);else{const w=this.mapMediaType_Style.get(S._mediaType);for(let B of ze.arrStyleSelectors)S._mapStyle.set(B,w[B]);g=w.default;const E=()=>{this._changeItemStyle(S,this.mapMediaType_Style.get(S._mediaType).selected,!0)},A=()=>{this._changeItemStyle(S,this.mapMediaType_Style.get(S._mediaType).default,!0)};S.on("select",E),S.on("deselect",A),S._funcChangeStyleToSelected=E,S._funcChangeStyleToDefault=A}S._drawingLayer=this,S._drawingLayerId=this.id,this._changeItemStyle(S,g,!0)}r.dirty=!0,this.fabricCanvas.renderAll()}else{if(t.styleId)g=this._getDrawingStyle(t.styleId);else{const S=this.mapMediaType_Style.get(t._mediaType);for(let A of ze.arrStyleSelectors)t._mapStyle.set(A,S[A]);g=S.default;const w=()=>{this._changeItemStyle(t,this.mapMediaType_Style.get(t._mediaType).selected)},E=()=>{this._changeItemStyle(t,this.mapMediaType_Style.get(t._mediaType).default)};t.on("select",w),t.on("deselect",E),t._funcChangeStyleToSelected=w,t._funcChangeStyleToDefault=E}this._changeItemStyle(t,g)}t._zIndex=this.id,t._drawingLayer=this,t._drawingLayerId=this.id;const v=this._arrFabricObject.length;let b=c.length;if(v)b=c.indexOf(this._arrFabricObject[v-1])+1;else for(let S=0;S<c.length;S++)if(t._zIndex<c[S].getDrawingItem()._zIndex){b=S;break}this._arrDrwaingItem.push(t),this._arrFabricObject.push(r),this._visible?r.visible=!0:r.visible=!1,this.fabricCanvas.insertAt(r,b,!1)}addDrawingItem(t){if(!t||!t.isDrawingItem)throw TypeError("Illegal drawing item.");if(this.mode==="viewer")t._setEditable(!1);else{if(this.mode!=="editor")throw new Error("Illegal 'mode'.");t._setEditable(!0)}this._addDrawingItem(t)}addDrawingItems(t){for(let i of t)this.addDrawingItem(i)}removeDrawingItem(t){if(!t||!t.isDrawingItem)throw TypeError("Illegal drawing item.");if(!this.hasDrawingItem(t))return;if(t._zIndex=null,t._drawingLayer=null,t._drawingLayerId=null,t._mediaType==="group"){const r=t.getChildItems();for(let c of r)c._zIndex=null,c._drawingLayer=null,c._drawingLayerId=null,c.off("select",c._funcChangeStyleToSelected),c.off("deselect",c._funcChangeStyleToDefault),c._funcChangeStyleToSelected=null,c._funcChangeStyleToDefault=null,c._mapStyle.clear()}else t.off("select",t._funcChangeStyleToSelected),t.off("deselect",t._funcChangeStyleToDefault),t._funcChangeStyleToSelected=null,t._funcChangeStyleToDefault=null,t._mapStyle.clear();t.styleSelector==="selected"&&(this.fabricCanvas._activeObject=null,t.styleSelector="default");const i=t._getFabricObject();this.fabricCanvas.remove(i),this._arrDrwaingItem.splice(this._arrDrwaingItem.indexOf(t),1),this._arrFabricObject.splice(this._arrFabricObject.indexOf(i),1)}removeDrawingItems(t){for(let i of t)this.removeDrawingItem(i)}setDrawingItems(t){this.clearDrawingItems(),this.addDrawingItems(t)}getDrawingItems(){return this._arrDrwaingItem}getSelectedDrawingItems(){const t=this.fabricCanvas.getActiveObjects(),i=[];for(let r of t)this._arrFabricObject.includes(r)&&i.push(r.getDrawingItem());return i}hasDrawingItem(t){if(!t||!t.isDrawingItem)throw TypeError("Illegal drawing item.");return this._arrDrwaingItem.includes(t)}clearDrawingItems(){this.removeDrawingItems(Array.from(this._arrDrwaingItem))}setDrawingStyle(t,i,r){let c,u;if(i=i?i.toLocaleLowerCase():"all",r=r?r.toLocaleLowerCase():"all",c=typeof t=="number"?this._getDrawingStyle(t):t,i==="all"){const g=this.mapMediaType_Style.keys();for(let v of g)if(u=this.mapMediaType_Style.get(v),r==="all")for(let b of ze.arrStyleSelectors){this._changeMediaTypeCurStyleInStyleSelector(v,b,c,!0),u[b]=c;for(let S of this._arrDrwaingItem)typeof S.styleId!="number"&&S._mapStyle.set(b,c)}else{this._changeMediaTypeCurStyleInStyleSelector(v,r,c,!0),u[r]=c;for(let b of this._arrDrwaingItem)typeof b.styleId!="number"&&b._mapStyle.set(r,c)}this.fabricCanvas.renderAll()}else if(u=this.mapMediaType_Style.get(i),r==="all")for(let g of ze.arrStyleSelectors){this._changeMediaTypeCurStyleInStyleSelector(i,g,c,!0),u[g]=c;for(let v of this._arrDrwaingItem)typeof v.styleId!="number"&&v._mediaType===i&&v._mapStyle.set(g,c)}else{this._changeMediaTypeCurStyleInStyleSelector(i,r,c,!0),u[r]=c;for(let g of this._arrDrwaingItem)typeof g.styleId!="number"&&g._mediaType===i&&g._mapStyle.set(r,c)}}setMode(t){if((t=t.toLocaleLowerCase())==="viewer"){for(let i of this._arrDrwaingItem)i._setEditable(!1);this.fabricCanvas.discardActiveObject(),this.fabricCanvas.renderAll(),this.mode="viewer"}else{if(t!=="editor")throw new RangeError("Invalid value.");for(let i of this._arrDrwaingItem)i._setEditable(!0);this.mode="editor"}this._manager._switchPointerEvent()}getMode(){return this.mode}_setDimensions(t,i){this.fabricCanvas.setDimensions(t,i)}_setObjectFit(t){if(t=t.toLowerCase(),!["contain","cover"].includes(t))throw new Error(`Unsupported value '${t}'.`);this.fabricCanvas.lowerCanvasEl.style.objectFit=t,this.fabricCanvas.upperCanvasEl.style.objectFit=t}_getObjectFit(){return this.fabricCanvas.lowerCanvasEl.style.objectFit}renderAll(){for(let t of this._arrDrwaingItem){const i=this._getItemCurrentStyle(t);this._changeItemStyle(t,i,!0)}this.fabricCanvas.renderAll()}dispose(){this.clearDrawingItems(),this._manager._arrDrawingLayer.length===1&&(this.fabricCanvas.wrapperEl.style.pointerEvents="none",this.fabricCanvas.dispose(),this._arrDrwaingItem.length=0,this._arrFabricObject.length=0)}}class $f{constructor(){this._arrDrawingLayer=[],this._mapDrawingStyles=new Map([[1,{id:1,lineWidth:2,fillStyle:"rgba(73, 173, 245, 0.3)",strokeStyle:"rgba(73, 173, 245, 1)",paintMode:"stroke",fontFamily:"sans-serif",fontSize:10}],[2,{id:2,lineWidth:2,fillStyle:"rgba(73, 245, 73, 0.3)",strokeStyle:"rgba(73, 245, 73, 0.9)",paintMode:"strokeAndFill",fontFamily:"sans-serif",fontSize:10}],[3,{id:3,lineWidth:2,fillStyle:"rgba(254, 180, 32, 0.3)",strokeStyle:"rgba(254, 180, 32, 0.9)",paintMode:"strokeAndFill",fontFamily:"sans-serif",fontSize:10}],[4,{id:4,lineWidth:2,fillStyle:"rgba(245, 236, 73, 0.3)",strokeStyle:"rgba(245, 236, 73, 1)",paintMode:"stroke",fontFamily:"sans-serif",fontSize:10}],[5,{id:5,lineWidth:2,fillStyle:"rgba(73, 173, 245, 0.3)",strokeStyle:"rgba(73, 173, 245, 1)",paintMode:"strokeAndFill",fontFamily:"sans-serif",fontSize:10}],[6,{id:6,lineWidth:2,fillStyle:"rgba(73, 245, 73, 0.3)",strokeStyle:"rgba(73, 245, 73, 0.9)",paintMode:"strokeAndFill",fontFamily:"sans-serif",fontSize:10}],[7,{id:7,lineWidth:2,fillStyle:"rgba(254, 180, 32, 0.3)",strokeStyle:"rgba(254, 180, 32, 1)",paintMode:"strokeAndFill",fontFamily:"sans-serif",fontSize:10}],[8,{id:8,lineWidth:2,fillStyle:"rgba(245, 236, 73, 0.3)",strokeStyle:"rgba(245, 236, 73, 1)",paintMode:"strokeAndFill",fontFamily:"sans-serif",fontSize:10}]]),this._defaultStyleTemplate={lineWidth:2,fillStyle:"rgba(245, 236, 73, 0.3)",strokeStyle:"rgba(245, 236, 73, 1)",paintMode:"stroke",fontFamily:"sans-serif",fontSize:10}}createDrawingStyle(t){let i;if(t.hasOwnProperty("id")){if(this._mapDrawingStyles.has(t.id))throw new Error("Existing drawing style id.");i=t.id}else{let c=100;for(;this._mapDrawingStyles.has(c);)c++;i=c}const r=JSON.parse(JSON.stringify(t));r.id=i;for(let c in this._defaultStyleTemplate)r.hasOwnProperty(c)||(r[c]=this._defaultStyleTemplate[c]);return this._mapDrawingStyles.set(i,r),r.id}_getDrawingStyle(t,i){if(typeof t!="number")throw new Error("Invalid style id.");const r=this._mapDrawingStyles.get(t);return r?i?JSON.parse(JSON.stringify(r)):r:null}getDrawingStyle(t){return this._getDrawingStyle(t,!0)}getDrawingStyles(){return JSON.parse(JSON.stringify(Array.from(this._mapDrawingStyles.values())))}_updateDrawingStyle(t,i){const r=this._mapDrawingStyles.get(t);if(r)for(let c in i)r.hasOwnProperty(c)&&(r[c]=i[c])}updateDrawingStyle(t,i){this._updateDrawingStyle(t,i);for(let r of this._arrDrawingLayer)r.renderAll()}createDrawingLayer(t,i){const r=u=>{for(let g of this._arrDrawingLayer)if(g.getId()===u)return!0;return!1};if(i===void 0){for(let u=100;;u++)if(!r(u)){i=u;break}}else if(r(i))throw new Error("Existed drawing layer id.");const c=new Xf(t,i,this._mapDrawingStyles,{enableRetinaScaling:!1});return c._manager=this,this._arrDrawingLayer.push(c),this._switchPointerEvent(),c}deleteDrwaingLayer(t){const i=this.getDrawingLayer(t);if(!i)return;const r=this._arrDrawingLayer;i.dispose(),r.splice(r.indexOf(i),1),this._switchPointerEvent()}clearDrawingLayers(){for(let t of this._arrDrawingLayer)t.dispose();this._arrDrawingLayer.length=0}getDrawingLayer(t){for(let i of this._arrDrawingLayer)if(i.getId()===t)return i;return null}getDrawingLayers(){return Array.from(this._arrDrawingLayer)}getSelectedDrawingItems(){if(!this._arrDrawingLayer.length)return;const t=this._arrDrawingLayer[0].fabricCanvas.getActiveObjects(),i=[];for(let r of t)i.push(r.getDrawingItem());return i}setDimensions(t,i){this._arrDrawingLayer.length&&this._arrDrawingLayer[0]._setDimensions(t,i)}setObjectFit(t){for(let i of this._arrDrawingLayer)i&&i._setObjectFit(t)}getObjectFit(){return this._arrDrawingLayer.length?this._arrDrawingLayer[0]._getObjectFit():null}setVisible(t){this._arrDrawingLayer.length&&(this._arrDrawingLayer[0].fabricCanvas.wrapperEl.style.display=t?"block":"none")}_switchPointerEvent(){if(!this._arrDrawingLayer.length)return;let t=!1;for(let i of this._arrDrawingLayer)i.getMode()==="editor"&&(t=!0);this._arrDrawingLayer[0].fabricCanvas.wrapperEl.style.pointerEvents=t?"":"none"}}class zf{constructor(t){this._controlTarget=null,this._arrUsers=[],this._mapAction_UserArgs=new Map,this._mapProperty_UserValue=new Map,this._mapAction_Callbacks=new Map,this._controlTarget=t}setControlTarget(t){this._controlTarget=t}getControlTarget(){return this._controlTarget}register(t){this._arrUsers.includes(t)||this._arrUsers.push(t)}logout(t){const i=this._arrUsers.indexOf(t);i!==-1&&(this.clearUserDisiredAction({user:t}),this.clearUserDisiredValue({user:t}),this._arrUsers.splice(i,1))}getRegisteredUsers(){return this._arrUsers}ifUserExisted(t){return this._arrUsers.includes(t)}setDisiredValue(t,i,r,c){if(!this._arrUsers.includes(t))throw new Error("Unregistered user.");c&&(this._controlTarget[i]=r),this._mapProperty_UserValue.get(i)?this._mapProperty_UserValue.get(i).set(t,r):this._mapProperty_UserValue.set(i,new Map([[t,r]]))}clearUserDisiredValue(t){if(t&&(t.user||t.property)){if(t.property&&t.user){const i=this._mapProperty_UserValue.get(t.property);if(!i)return;i.delete(t.user)}else if(t.property)this._mapProperty_UserValue.delete(t.property);else if(t.user)for(let i of this._mapProperty_UserValue.values())i.delete(t.user)}else this._mapProperty_UserValue=new Map}getValue(t){if(!this._controlTarget)throw new Error("Control target is not set.");return this._controlTarget[t]}getPropertyDisiredValue(t){if(this._mapProperty_UserValue.get(t)){const i=[],r=this._mapProperty_UserValue.get(t);for(let c of r.values())i.push(c);return i}return null}setDisiredAction(t,i,r,c){if(!this._arrUsers.includes(t))throw new Error("Unregistered user.");return r||(r=[]),c?this._controlTarget[i](...r):(this._mapAction_UserArgs.get(i)?this._mapAction_UserArgs.get(i).set(t,r):this._mapAction_UserArgs.set(i,new Map([[t,r]])),this._render(i))}clearUserDisiredAction(t){if(t&&(t.user||t.actionName)){if(t.actionName&&t.user){const i=this._mapAction_UserArgs.get(t.actionName);if(!i)return;i.delete(t.user)}else if(t.actionName)this._mapAction_UserArgs.delete(t.actionName);else if(t.user)for(let i of this._mapAction_UserArgs.values())i.delete(t.user);this.render()}else this._mapAction_UserArgs=new Map}addCallback(t,i){const r=this._mapAction_Callbacks.get(t);r?r.push(i):this._mapAction_Callbacks.set(t,[i])}removeCallback(t,i){const r=this._mapAction_Callbacks.get(t);if(!r)return;const c=r.indexOf(i);c!==-1&&r.splice(c,1)}clearCallback(t){t?this._mapAction_Callbacks.delete(t):this._mapAction_Callbacks.clear()}_fireCallback(t){const i=this._mapAction_Callbacks.get(t);if(i)for(let r of i){if(!r)return;setTimeout(r.bind(this._controlTarget),0)}}_render(t){const i=this._mapAction_UserArgs.get(t);if(!i)throw new Error("Unrecorded action.");if(i.size===this._arrUsers.length){let r=[];for(let c of i.values())c.length>0&&(r=c);if(this._controlTarget[t]){const c=this._controlTarget[t](...r);return this._mapAction_UserArgs.delete(t),this._fireCallback(t),c}}}render(t){if(t)return this._render(t);for(let i of this._mapAction_UserArgs.keys())this._render(i)}}class fe{constructor(){this._maxCvsSideLength=void 0,this._defaultMaxCvsSideLength=null,this._predefinedResolutions=[{width:160,height:120},{width:320,height:240},{width:480,height:360},{width:640,height:480},{width:800,height:600},{width:960,height:720},{width:1280,height:720},{width:1920,height:1080},{width:2560,height:1440},{width:3840,height:2160}],this._mapCameraResolutions=new Map,this._bWebGLSupported=!0,this.extraBindings=[],this._singleFrameMode=!(navigator&&navigator.mediaDevices&&navigator.mediaDevices.getUserMedia),this._cvsSingleFrameMode=null,this._cvsOriginalImage=null,this._imgWidth=0,this._imgHeight=0,this._singleFrameModeIpt=null,this._clickIptSingleFrameMode=()=>{if(this.singleFrameMode){if(!this._singleFrameModeIpt){const t=document.createElement("input");this._singleFrameModeIpt=t,t.setAttribute("type","file"),t.setAttribute("accept",".jpg,.jpeg,.icon,.gif,.svg,.webp,.png,.bmp"),t.setAttribute("capture",""),t.addEventListener("change",()=>Ee(this,void 0,void 0,function*(){const i=t.files[0];t.value="";const r=yield(S=>Ee(this,void 0,void 0,function*(){let w=null,E=null;if(typeof createImageBitmap<"u")try{if(w=yield createImageBitmap(S),w)return w}catch{}var A;return w||(E=yield(A=S,new Promise((B,z)=>{let q=URL.createObjectURL(A),J=new Image;J.dbrObjUrl=q,J.src=q,J.onload=()=>{B(J)},J.onerror=Z=>{z(new Error("Can't convert blob to image : "+(Z instanceof Event?Z.type:Z)))}}))),E}))(i),c=r instanceof HTMLImageElement?r.naturalWidth:r.width,u=r instanceof HTMLImageElement?r.naturalHeight:r.height;this._imgWidth=c,this._imgHeight=u;const g=S=>{const w=Date.now();if(c===0||u===0)return null;const E=this._scanRegion,A=this.getFrameSize(c,u,E,this.maxCvsSideLength);if(!A)return null;let B,z;B=c!==A.sWidth||u!==A.sHeight,z=A.sWidth!==A.dWidth||A.sHeight!==A.dHeight;const q=(()=>!(!this._bWebGLSupported||z))(),J={data:null,region:E?JSON.parse(JSON.stringify(E)):null,sx:A.sx,sy:A.sy,width:A.dWidth,height:A.dHeight,colorMode:null,timeSpent:null,timeStamp:null,isCropped:B,toCanvas:this._toCanvas,_sWidth:A.sWidth,_sHeight:A.sHeight,_bUseWebGL:null};let Z;try{Z=this._getImageData(S,c,u,A,null,{targetColorMode:this.frameColorMode,bUseWebGL:q})}catch(K){if(K.name!=="WebGLError")throw K;Z=this._getImageData(S,c,u,A,null,{targetColorMode:this.frameColorMode,bUseWebGL:!1})}if(!Z)return null;const ee=Date.now();return fe._onLog&&fe._onLog("DCE: _getVideoFrame(region?) END: "+ee),J.data=Z.data,J.colorMode=Z.colorMode,J._bUseWebGL=Z._bUseWebGL,J.timeSpent=ee-w,J.timeStamp=ee,J};(S=>{let w=this._cvsSingleFrameMode;if(!w){if(w=document.createElement("canvas"),w.style.pointerEvents="none",!this._video)throw new Error("'video' is null.");this._video.after(w),w.style.position="absolute",w.style.width="100%",w.style.height="100%",w.style.left="0",w.style.top="0",w.style.objectFit="contain",this._cvsSingleFrameMode=w}w.width==c&&w.height==u||(w.width=c,w.height=u);const E=w.getContext("2d");E.clearRect(0,0,w.width,w.height),E.drawImage(S,0,0)})(r),this._updateScanRegionCanvas(),this._updateScanAreaDiv(),this._updateViewDecorator();for(let S of this._arrScanRegionOverlays)S&&this._updateScanRegionOverlay(S);let v;this._updateDrawingLayersSize();try{v=g(r)}catch(S){throw S}const b=this.mapCameraEvents.get("singleFrameAcquired");for(let S of b)if(S)try{const w={data:new Uint8Array(v.data),region:JSON.parse(JSON.stringify(v.region)),sx:v.sx,sy:v.sy,width:v.width,height:v.height,colorMode:v.colorMode,timeSpent:v.timeSpent,timeStamp:v.timeStamp,isCropped:v.isCropped,toCanvas:v.toCanvas,_sWidth:v._sWidth,_sHeight:v._sHeight,_bUseWebGL:v._bUseWebGL};yield S.apply(this,[w])}catch(w){console.error(w)}})),t.style.position="fixed",t.style.left="-1px",t.style.top="-1px",t.style.width="1px",t.style.height="1px",t.style.backgroundColor="transparent",t.style.color="transparent",document.body.appendChild(t)}this._singleFrameModeIpt.click()}},this.styleEls=[],this._frameColorMode=void 0,this._defaultFrameColorMode="RGBA",this.currentFSColorMode="rgba",this.ifReuseArrayBufferView=!1,this.maxVideoCvsLength=3,this._reusedCvs=null,this._reusedWebGLCvs=null,this._reusedWebGLCtx=null,this._reusedDataContainer=null,this._webGLTexture=null,this._webGLProgramInfo=null,this._webGLBuffers=null,this._recordedStates={},this._toCanvas=function(){const t=document.createElement("canvas");let i;if(t.width=this.width,t.height=this.height,this.colorMode==="grey"){i=new Uint8ClampedArray(this.width*this.height*4);for(let c=0;c<i.length;c+=4)i[c]=this.data[c/4],i[c+1]=this.data[c/4],i[c+2]=this.data[c/4],i[c+3]=255}else i=new Uint8ClampedArray(this.data);const r=new ImageData(i,this.width,this.height);return t.getContext("2d").putImageData(r,0,0),t},this._onCameraSelChange=()=>Ee(this,void 0,void 0,function*(){yield this.selectCamera(this._selCam.value),this._bOpen||this.stop()}),this._onResolutionSelChange=()=>Ee(this,void 0,void 0,function*(){let t,i;if(this._selRsl&&this._selRsl.selectedIndex!=-1){let r=this._selRsl.options[this._selRsl.selectedIndex];t=r.getAttribute("data-width"),i=r.getAttribute("data-height")}yield this.setResolution(t,i),this._bOpen||this.stop()}),this._onCloseBtnClick=()=>{this.close(!0)},this._bOpen=!1,this.isCameraEnhancer=!0,this.isDisposed=!1,this.videoSrc=null,this.videoSettings={video:{width:{ideal:1280},height:{ideal:720},facingMode:{ideal:"environment"}}},this.iPlayRound=0,this.promisePlay=null,this._ifSaveLastUsedCamera=!1,this.ifSkipCameraInspection=!1,this._allCameras=[],this._currentCamera=null,this._videoTrack=null,this._lastDeviceId=void 0,this._vc_bPlayingVideoBeforeHide=!1,this._ev_documentHideEvent=()=>{document.visibilityState==="visible"?this._vc_bPlayingVideoBeforeHide&&(Ne.browser=="Firefox"?this.play():this._video.play(),this._vc_bPlayingVideoBeforeHide=!1):this._video&&!this._video.paused&&(this._vc_bPlayingVideoBeforeHide=!0,this._video.pause())},this._divVideoContainer=null,this._video=null,this.videoFit="contain",this._cvsScanRegion=null,this._divScanArea=null,this._divScanLight=null,this._bgLoading=null,this._selCam=null,this._bgCamera=null,this._selRsl=null,this._optGotRsl=null,this._btnClose=null,this._selMinLtr=null,this._optGotMinLtr=null,this.regionMaskFillStyle="rgba(0,0,0,0.5)",this.regionMaskStrokeStyle="rgb(254,142,20)",this.regionMaskLineWidth=2,this._bShowScanRegionMask=!0,this._bShowScanRegionLaser=void 0,this._defaultBShowScanRegionLaser=!1,this._scanRegion=null,this._arrScanRegionOverlays=[],this._layerBaseCvs=null,this._cvsViewDecorator=null,this._decoratorType=[],this._decoratorArea=null,this._viewDecoratorInfo={rectangle:{lineWidth:4,strokeStyle:"rgb(254,142,20)",fillStyle:"transparent",maskFillStyle:"transparent"},focus:{lineWidth:4,strokeStyle:"rgb(254,142,20)",fillStyle:"transparent",maskFillStyle:"transparent"},crossline:{lineWidth:2,strokeStyle:"rgb(254,142,20)"},crosshair:{lineWidth:4,strokeStyle:"rgb(254,142,20)"}},this._croppingRegions=void 0,this._defaultCroppingRegions=[null],this.bIncreaseRegionIndexAuto=!0,this._croppingRegionIndex=0,this._loopInterval=void 0,this._defaultLoopInterval=0,this._maxNumberOfFramesInBuffer=void 0,this._defaultMaxNumberOfFramesInBuffer=1,this._frameQueue=[],this._bFetchingLoopStarted=!1,this._refreshInterval=void 0,this._defaultRefreshInterval=-1,this._updateLayersTimeout=100,this._updateLayers=()=>{this._resizeTimeoutId&&clearTimeout(this._resizeTimeoutId),this._resizeTimeoutId=setTimeout(()=>{if(!this.isDisposed){this._updateScanRegionCanvas(),this._updateScanAreaDiv(),this._updateViewDecorator();for(let t of this._arrScanRegionOverlays)t&&this._updateScanRegionOverlay(t);this._updateDrawingLayersSize()}},this._updateLayersTimeout)},this.mapCameraEvents=new Map([["cameraOpen",[]],["cameraClose",[]],["cameraChange",[]],["resolutionChange",[]],["played",[]],["singleFrameAcquired",[]],["frameAddedToBuffer",[]]]),this._controler=null}static getVersion(){return this._version}static detectEnvironment(){return Ee(this,void 0,void 0,function*(){return yield(async()=>({wasm:Gf,worker:Wf,getUserMedia:_c,camera:await Hf(),browser:Ne.browser,version:Ne.version,OS:Ne.OS}))()})}static set engineResourcePath(t){if(this._hasEngineResourceLoaded)throw new Error("`engineResourcePath` is not allowed to change after `createInstance` is called.");fe._engineResourcePath=(i=>{if(i==null&&(i="./"),!Ir){let r=document.createElement("a");r.href=i,i=r.href}return i.endsWith("/")||(i+="/"),i})(t)}static get engineResourcePath(){return this._engineResourcePath}static isStorageAvailable(t){let i;try{i=window[t];const r="__storage_test__";return i.setItem(r,r),i.removeItem(r),!0}catch(r){return r instanceof DOMException&&(r.code===22||r.code===1014||r.name==="QuotaExceededError"||r.name==="NS_ERROR_DOM_QUOTA_REACHED")&&i&&i.length!==0}}static isDCEFrame(t){return!(!t||typeof t!="object"||Array.isArray(t))&&"data"in t&&"region"in t&&"sx"in t&&"sy"in t&&"width"in t&&"height"in t&&"colorMode"in t&&"timeSpent"in t&&"timeStamp"in t&&"isCropped"in t&&"toCanvas"in t&&"_sWidth"in t&&"_sHeight"in t&&"_bUseWebGL"in t}set maxCvsSideLength(t){if(t<=0)throw new Error("Invalid value.");this._maxCvsSideLength=t}get maxCvsSideLength(){if(this._maxCvsSideLength!==void 0)return this._maxCvsSideLength;if(this._controler){const t=this._controler.getPropertyDisiredValue("maxCvsSideLength");if(t&&t.length===1)return t[0]}return this._defaultMaxCvsSideLength}static set defaultUIElementURL(t){fe._defaultUIElementURL=t}static get defaultUIElementURL(){var t;return(t=fe._defaultUIElementURL)===null||t===void 0?void 0:t.replace("@engineResourcePath/",fe.engineResourcePath)}getUIElement(){return this.UIElement}setUIElement(t){return Ee(this,void 0,void 0,function*(){if(this._bOpen)throw new Error("It is not allowed to change the UIElement when the camera is open.");if(typeof t=="string"||t instanceof String){if(!t.trim().startsWith("<")){let r=yield fetch(t);if(!r.ok)throw Error("setUIElement(elementOrUrl): Network Error: "+r.statusText);t=yield r.text()}if(!t.trim().startsWith("<"))throw Error("setUIElement(elementOrUrl): Can't get valid HTMLElement.");let i=document.createElement("div");i.innerHTML=t;for(let r=0;r<i.childElementCount;++r){let c=i.children[r];c instanceof HTMLStyleElement&&(this.styleEls.push(c),document.head.append(c))}(t=i.childElementCount==1?i.children[0]:i).remove()}this.UIElement=t,this._uiOriginalState={display:t&&t.style.display,inDom:document.body.contains(t)}})}appendAndShowUI(){this.UIElement&&(this.UIElement.parentNode||(this.UIElement.style.position="fixed",this.UIElement.style.left="0",this.UIElement.style.top="0",document.body.append(this.UIElement)),this.UIElement.style.display=="none"&&(this.UIElement.style.display=""))}hideUI(){this.UIElement&&(this.UIElement.style.display="none")}get singleFrameMode(){return this._singleFrameMode}set singleFrameMode(t){if(this._bOpen)throw new Error("It is not allowed to change `singleFrameMode` when the camera is open.");this._singleFrameMode=t}set frameColorMode(t){this._frameColorMode=t}get frameColorMode(){if(this._frameColorMode!==void 0)return this._frameColorMode;if(this._controler){const t=this._controler.getPropertyDisiredValue("frameColorMode");if(t&&t.length===1)return t[0]}return this._defaultFrameColorMode}set bOpen(t){if(this._bOpen=t,t){this._updateScanRegionCanvas(),this._updateScanAreaDiv(),this._updateViewDecorator();for(let i of this._arrScanRegionOverlays)i&&this._updateScanRegionOverlay(i);this._updateDrawingLayersSize(),this.ifShowScanRegionMask?this.showScanRegionMask():this.hideScanRegionMask(),this.ifShowScanRegionLaser?this.showScanRegionLaser():this.hideScanRegionLaser(),this.showViewDecorator(),this.showScanRegionOverlays(),this._drawingLayersManager.setVisible(!0)}}set ifSaveLastUsedCamera(t){t?fe.isStorageAvailable("localStorage")?this._ifSaveLastUsedCamera=!0:(this._ifSaveLastUsedCamera=!1,console.warn("Local storage is unavailable")):this._ifSaveLastUsedCamera=!1}get ifSaveLastUsedCamera(){return this._ifSaveLastUsedCamera}get video(){return this._video}setVideoFit(t){if(t=t.toLowerCase(),!["contain","cover"].includes(t))throw new Error(`Unsupported value '${t}'.`);if(this.videoFit=t,this._video&&(this._video.style.objectFit=t,!this.singleFrameMode)){this._updateScanRegionCanvas(),this._updateScanAreaDiv(),this._updateViewDecorator();for(let i of this._arrScanRegionOverlays)i&&this._updateScanRegionOverlay(i);this._drawingLayersManager.setObjectFit(t)}}getVideoFit(){return this.videoFit}set ifShowScanRegionMask(t){this._bShowScanRegionMask=t,t?this.showScanRegionMask():this.hideScanRegionMask()}get ifShowScanRegionMask(){return this._bShowScanRegionMask}showScanRegionMask(){this._cvsScanRegion&&(this._cvsScanRegion.style.display=="none"&&(this._cvsScanRegion.style.display=""),this._recordedStates.maskShow=!0)}hideScanRegionMask(){this._cvsScanRegion&&(this._cvsScanRegion.style.display="none",this._recordedStates.maskShow=!1)}set ifShowScanRegionLaser(t){this._bShowScanRegionLaser=t,t?this.showScanRegionLaser():this.hideScanRegionLaser()}get ifShowScanRegionLaser(){if(this._bShowScanRegionLaser!==void 0)return this._bShowScanRegionLaser;if(this._controler){const t=this._controler.getPropertyDisiredValue("ifShowScanRegionLaser");if(t&&t.length){let i=0;for(let r of t)r||i++;return i!==this._controler.getRegisteredUsers().length}}return this._defaultBShowScanRegionLaser}showScanRegionLaser(){this._divScanLight&&(this._divScanLight.style.display=="none"&&(this._divScanLight.style.display="block"),this._recordedStates.laserShow=!0)}hideScanRegionLaser(){this._divScanLight&&(this._divScanLight.style.display="none",this._recordedStates.laserShow=!1)}_checkValidRegion(t){return!(t!==null&&(!t||!(t.hasOwnProperty("regionLeft")&&t.hasOwnProperty("regionTop")&&t.hasOwnProperty("regionRight")&&t.hasOwnProperty("regionBottom")&&t.hasOwnProperty("regionMeasuredByPercentage"))||t.regionLeft<0||t.regionTop<0||t.regionRight<0||t.regionBottom<0||t.regionMeasuredByPercentage&&(t.regionLeft>100||t.regionTop>100||t.regionRight>100||t.regionBottom>100)))}set scanRegion(t){if(!this._checkValidRegion(t))throw new Error("Invalid region.");this._scanRegion=JSON.parse(JSON.stringify(t)),this._updateScanRegionCanvas(),this._updateScanAreaDiv();for(let i of this._arrScanRegionOverlays)i&&this._updateScanRegionOverlay(i)}setScanRegion(t){this.scanRegion=t}getScanRegion(){return JSON.parse(JSON.stringify(this._scanRegion))}_calculateCvsSize(){if(!this._bOpen)return null;let t,i,r;if(this.singleFrameMode)t=this._imgWidth,i=this._imgHeight,r="contain";else{if(!this._video)return null;t=this._video.videoWidth,i=this._video.videoHeight,r=this.getVideoFit()}return{width:t,height:i,objectFit:r}}addScanRegionOverlayCanvas(){this._assertOpen();const t=document.createElement("canvas");if(this._updateScanRegionOverlay(t),!this._scanRegionOverlayContainer){const i=document.createElement("div");if(this._scanRegionOverlayContainer=i,i.style.position="absolute",i.style.left="0",i.style.top="0",i.style.width="100%",i.style.height="100%",i.style.overflow="hidden",i.style.pointerEvents="none",this._layerBaseCvs)this._layerBaseCvs.parentElement.after(i);else if(this._cvsScanRegion)this._cvsScanRegion.before(i);else if(this._cvsSingleFrameMode)this._cvsSingleFrameMode.after(i);else{if(!this._video)throw new Error("'video' is null.");this._video.after(i)}this._recordedStates.overlayShow=!0}return this._scanRegionOverlayContainer.append(t),this._arrScanRegionOverlays.push(t),t}removeScanRegionOverlayCanvas(t){const i=this._arrScanRegionOverlays.indexOf(t);i!==-1&&(t.remove(),this._arrScanRegionOverlays.splice(i,1))}_updateScanRegionOverlay(t){if(!t)return;const i=this._calculateCvsSize();if(!i)return;const{width:r,height:c,objectFit:u}=i;if(r<=0||c<=0)return t.width=0,void(t.height=0);const g=this._getRegionInPixels(r,c,this._scanRegion),v=this.getFrameSize(r,c,this._scanRegion,this.maxCvsSideLength),b=v.dWidth,S=v.dHeight;t.width==b&&t.height==S||(t.width=b,t.height=S);const w=window.getComputedStyle(this._video),E=parseFloat(w.width),A=parseFloat(w.height),B=E/A,z=r/c;let q,J,Z,ee,K=1;u==="contain"?(B<z?(K=E/r,q=0,J=(A-c*K)/2):(K=A/c,q=(E-r*K)/2,J=0),q+=g.regionLeft*K,J+=g.regionTop*K,Z=(g.regionRight-g.regionLeft)*K,ee=(g.regionBottom-g.regionTop)*K):u==="cover"?(z>B?(K=A/c,q=g.regionLeft*K-(r*K-E)/2,J=g.regionTop*K):(K=E/r,q=g.regionLeft*K,J=g.regionTop*K-(c*K-A)/2),Z=(g.regionRight-g.regionLeft)*K,ee=(g.regionBottom-g.regionTop)*K):(q=0,J=0,Z=0,ee=0),t.style.position="absolute",t.style.left=q+"px",t.style.top=J+"px",t.style.width=Z+"px",t.style.height=ee+"px"}showScanRegionOverlays(){this._scanRegionOverlayContainer&&(this._scanRegionOverlayContainer.style.display=="none"&&(this._scanRegionOverlayContainer.style.display=""),this._recordedStates.overlayShow=!0)}hideScanRegionOverlays(){this._scanRegionOverlayContainer&&(this._scanRegionOverlayContainer.style.display="none",this._recordedStates.overlayShow=!1)}setViewDecorator(t,i){if(!t)return void(this._cvsViewDecorator&&(this._cvsViewDecorator.remove(),this._cvsViewDecorator=null));this._assertOpen();let r=[];if(typeof t=="string"?r.push(t):Array.isArray(t)&&(r=JSON.parse(JSON.stringify(t))),!this._cvsViewDecorator){if(this._cvsViewDecorator=document.createElement("canvas"),this._cvsViewDecorator.style.pointerEvents="none",this._cvsScanRegion)this._cvsScanRegion.after(this._cvsViewDecorator);else if(this._scanRegionOverlayContainer)this._scanRegionOverlayContainer.after(this._cvsViewDecorator);else if(this._layerBaseCvs)this._layerBaseCvs.parentElement.after(this._cvsViewDecorator);else if(this._cvsSingleFrameMode)this._cvsSingleFrameMode.after(this._cvsViewDecorator);else{if(!this._video)throw new Error("'video' is null.");this._video.after(this._cvsViewDecorator)}this._recordedStates.decoratorShow=!0}this._decoratorArea=JSON.parse(JSON.stringify(i)),this._decoratorType.length=0;const c=["rectangle","focus"],u=["crossline","crosshair"];let g=!1,v=!1;for(let b of r)b=b.toLowerCase(),c.includes(b)&&!g&&(g=!0,this._decoratorType.push(b)),u.includes(b)&&!v&&(v=!0,!this._decoratorType.includes(b)&&this._decoratorType.push(b));this._updateViewDecorator()}getViewDecorator(){return{type:JSON.parse(JSON.stringify(this._decoratorType)),area:JSON.parse(JSON.stringify(this._decoratorArea)),canvas:this._cvsViewDecorator}}showViewDecorator(){this._cvsViewDecorator&&(this._cvsViewDecorator.style.display=="none"&&(this._cvsViewDecorator.style.display=""),this._recordedStates.decoratorShow=!0)}hideViewDecorator(){this._cvsViewDecorator&&(this._cvsViewDecorator.style.display="none",this._recordedStates.decoratorShow=!1)}setViewDecoratorLineWidth(t,i){if(typeof t!="string")throw new Error("The 'type' should be a string.");if(t=t.toLowerCase(),!this._viewDecoratorInfo.hasOwnProperty(t))throw new Error(`The type of '${t}' doesn't exist.`);if(!this._viewDecoratorInfo[t].hasOwnProperty("lineWidth"))throw new Error(`It is not allowed to change the property 'lineWidth' when the decorator type is '${t}'.`);this._viewDecoratorInfo[t].lineWidth=i,this._updateViewDecorator()}setViewDecoratorStrokeStyle(t,i){if(typeof t!="string")throw new Error("The 'type' should be a string.");if(t=t.toLowerCase(),!this._viewDecoratorInfo.hasOwnProperty(t))throw new Error(`The type of '${t}' doesn't exist.`);if(!this._viewDecoratorInfo[t].hasOwnProperty("strokeStyle"))throw new Error(`It is not allowed to change the property 'strokeStyle' when the decorator type is '${t}'.`);this._viewDecoratorInfo[t].strokeStyle=i,this._updateViewDecorator()}setViewDecoratorFillStyle(t,i){if(typeof t!="string")throw new Error("The 'type' should be a string.");if(t=t.toLowerCase(),!this._viewDecoratorInfo.hasOwnProperty(t))throw new Error(`The type of '${t}' doesn't exist.`);if(!this._viewDecoratorInfo[t].hasOwnProperty("fillStyle"))throw new Error(`It is not allowed to change the property 'fillStyle' when the decorator type is '${t}'.`);this._viewDecoratorInfo[t].fillStyle=i,this._updateViewDecorator()}setViewDecoratorMaskFillStyle(t,i){if(typeof t!="string")throw new Error("The 'type' should be a string.");if(t=t.toLowerCase(),!this._viewDecoratorInfo.hasOwnProperty(t))throw new Error(`The type of '${t}' doesn't exist.`);if(!this._viewDecoratorInfo[t].hasOwnProperty("maskFillStyle"))throw new Error(`It is not allowed to change the property 'maskFillStyle' when the decorator type is '${t}'.`);this._viewDecoratorInfo[t].maskFillStyle=i,this._updateViewDecorator()}_updateViewDecorator(){if(!this._bOpen||!this._cvsViewDecorator||!this._decoratorArea)return;let t;if(this.singleFrameMode)t="contain";else{if(!this._video)return;t=this.getVideoFit()}const i=this._cvsViewDecorator;i.style.position="absolute",i.style.width="100%",i.style.height="100%",i.style.left="0",i.style.top="0",i.style.objectFit=t;const r=this.getVisibleRegion(!0),c=r.regionRight-r.regionLeft,u=r.regionBottom-r.regionTop;if(i.width==c&&i.height==u||(i.width=c,i.height=u),c<=0||u<=0)return;const g=i.getContext("2d");g.clearRect(0,0,i.width,i.height);const v=this._decoratorArea.x/100*c,b=this._decoratorArea.y/100*u,S=this._decoratorArea.width/100*c,w=this._decoratorArea.height/100*u;for(let E of this._decoratorType){if(E==="rectangle"){g.fillStyle=this._viewDecoratorInfo.rectangle.maskFillStyle,g.fillRect(0,0,i.width,i.height),g.clearRect(Math.round(v),Math.round(b),Math.round(S),Math.round(w)),g.fillStyle=this._viewDecoratorInfo.rectangle.fillStyle,g.fillRect(Math.round(v),Math.round(b),Math.round(S),Math.round(w)),g.lineWidth=this._viewDecoratorInfo.rectangle.lineWidth,g.strokeStyle=this._viewDecoratorInfo.rectangle.strokeStyle;const A=g.lineWidth/2;g.strokeRect(Math.round(v-A),Math.round(b-A),Math.round(S+g.lineWidth),Math.round(w+g.lineWidth))}if(E==="focus"){g.fillStyle=this._viewDecoratorInfo.focus.maskFillStyle,g.fillRect(0,0,i.width,i.height),g.clearRect(Math.round(v),Math.round(b),Math.round(S),Math.round(w)),g.fillStyle=this._viewDecoratorInfo.focus.fillStyle,g.fillRect(Math.round(v),Math.round(b),Math.round(S),Math.round(w)),g.lineWidth=this._viewDecoratorInfo.focus.lineWidth,g.strokeStyle=this._viewDecoratorInfo.focus.strokeStyle;const A=g.lineWidth/2,B=[0,.25,.75,1],z=[0,.25,.75,1];g.beginPath();for(let q=0;q<B.length;q++)if(q==0||q==3)for(let J=0;J<z.length;J+=2)g.moveTo(Math.round(v+B[q]*S),Math.round(b+z[J]*w)),g.lineTo(Math.round(v+B[q]*S),Math.round(b+z[J+1]*w));for(let q=0;q<z.length;q++)if(q==0||q==3)for(let J=0;J<B.length;J+=2)g.moveTo(Math.round(v+B[J]*S-A),Math.round(b+z[q]*w)),g.lineTo(Math.round(v+B[J+1]*S+A),Math.round(b+z[q]*w));g.stroke()}if(E==="crossline"&&(g.beginPath(),g.lineWidth=this._viewDecoratorInfo.crossline.lineWidth,g.strokeStyle=this._viewDecoratorInfo.crossline.strokeStyle,g.moveTo(Math.round(v),Math.round(b+w/2)),g.lineTo(Math.round(v+S),Math.round(b+w/2)),g.moveTo(Math.round(v+S/2),Math.round(b)),g.lineTo(Math.round(v+S/2),Math.round(b+w)),g.stroke()),E==="crosshair"){g.beginPath();const A=.05*Math.min(S,w);g.lineWidth=this._viewDecoratorInfo.crosshair.lineWidth,g.strokeStyle=this._viewDecoratorInfo.crosshair.strokeStyle,g.moveTo(Math.round(v+(S-A)/2),Math.round(b+w/2)),g.lineTo(Math.round(v+(S+A)/2),Math.round(b+w/2)),g.moveTo(Math.round(v+S/2),Math.round(b+(w-A)/2)),g.lineTo(Math.round(v+S/2),Math.round(b+(w+A)/2)),g.stroke()}}}getVisibleRegion(t){this._assertOpen();const i=this._calculateCvsSize();if(!i)return null;const{width:r,height:c,objectFit:u}=i;let g=(()=>{const v=parseFloat(window.getComputedStyle(this._video).width),b=parseFloat(window.getComputedStyle(this._video).height);let S,w={regionBottom:c,regionRight:r,regionLeft:0,regionTop:0,regionMeasuredByPercentage:!1};return u==="cover"?v/b<r/c?(S=b/c,w.regionLeft=Math.floor((r-v/S)/2),w.regionRight=Math.ceil(r-w.regionLeft),w.regionTop=0,w.regionBottom=c):(S=v/r,w.regionTop=Math.floor((c-b/S)/2),w.regionBottom=Math.ceil(c-w.regionTop),w.regionLeft=0,w.regionRight=r):u==="none"&&(v<r&&b<c?(w.regionLeft=Math.floor((r-v)/2),w.regionRight=Math.ceil(r-w.regionLeft),w.regionTop=Math.floor((c-b)/2),w.regionBottom=Math.ceil(c-w.regionTop)):v<r?(w.regionLeft=Math.floor((r-v)/2),w.regionRight=Math.ceil(r-w.regionLeft),w.regionTop=0,w.regionBottom=c):b<c&&(w.regionTop=Math.floor((c-b)/2),w.regionBottom=Math.ceil(c-w.regionTop),w.regionLeft=0,w.regionRight=r)),w})();return t?g.regionMeasuredByPercentage=!1:(g.regionBottom=Math.ceil(g.regionBottom/c*100),g.regionRight=Math.ceil(g.regionRight/r*100),g.regionLeft=Math.floor(g.regionLeft/r*100),g.regionTop=Math.floor(g.regionTop/c*100),g.regionMeasuredByPercentage=!0),g}setScanRegionMaskStyle(t){t&&(t.fillStyle&&(this.regionMaskFillStyle=t.fillStyle),t.strokeStyle&&(this.regionMaskStrokeStyle=t.strokeStyle),t.lineWidth&&(this.regionMaskLineWidth=t.lineWidth),this._updateScanRegionCanvas())}_getRegionInPixels(t,i,r){if(!(t<=0||i<=0))return r?r.regionMeasuredByPercentage?{regionLeft:Math.round(r.regionLeft/100*t),regionTop:Math.round(r.regionTop/100*i),regionRight:Math.round(r.regionRight/100*t),regionBottom:Math.round(r.regionBottom/100*i),regionMeasuredByPercentage:!1}:JSON.parse(JSON.stringify(r)):{regionLeft:0,regionTop:0,regionRight:t,regionBottom:i,regionMeasuredByPercentage:!1}}_updateScanRegionCanvas(){if(!this._bOpen)return;const t=this._calculateCvsSize();if(!t)return;const{width:i,height:r,objectFit:c}=t;if(i<=0||r<=0)return void(this._cvsScanRegion&&(this._cvsScanRegion.width=0,this._cvsScanRegion.height=0));const u=this._getRegionInPixels(i,r,this._scanRegion);this._cvsScanRegion||(this._cvsScanRegion=document.createElement("canvas"),this._cvsScanRegion.style.pointerEvents="none",this._scanRegionOverlayContainer?this._scanRegionOverlayContainer.after(this._cvsScanRegion):this._layerBaseCvs?this._layerBaseCvs.parentElement.after(this._cvsScanRegion):this._cvsSingleFrameMode?this._cvsSingleFrameMode.after(this._cvsScanRegion):this._video.after(this._cvsScanRegion),this._recordedStates.maskShow=!0);const g=this._cvsScanRegion;g.style.position="absolute",g.style.width="100%",g.style.height="100%",g.style.left="0",g.style.top="0",g.style.objectFit=c,g.width==i&&g.height==r||(g.width=i,g.height=r);const v=g.getContext("2d");if(v.clearRect(0,0,g.width,g.height),u.regionLeft!=0||u.regionRight!=i||u.regionTop!=0||u.regionBottom!=r){const b=u.regionLeft,S=u.regionTop,w=u.regionRight-u.regionLeft,E=u.regionBottom-u.regionTop;v.fillStyle=this.regionMaskFillStyle,v.fillRect(0,0,g.width,g.height),v.clearRect(Math.round(b),Math.round(S),Math.round(w),Math.round(E)),v.strokeStyle=this.regionMaskStrokeStyle,v.lineWidth=this.regionMaskLineWidth;const A=v.lineWidth/2;v.strokeRect(Math.round(b-A),Math.round(S-A),Math.round(w+v.lineWidth),Math.round(E+v.lineWidth))}}_updateScanAreaDiv(){if(!this._bOpen)return;const t=this._calculateCvsSize();if(!t)return;const{width:i,height:r,objectFit:c}=t;if(!this._divScanArea)return;if(i<=0||r<=0)return this._divScanArea.style.width="0",void(this._divScanArea.style.height="0");const u=this._getRegionInPixels(i,r,this._scanRegion),g=window.getComputedStyle(this._video),v=parseFloat(g.width),b=parseFloat(g.height),S=v/b,w=i/r;let E,A,B,z,q=1;if(c==="contain")S<w?(q=v/i,E=0,A=(b-r*q)/2):(q=b/r,E=(v-i*q)/2,A=0),E+=u.regionLeft*q,A+=u.regionTop*q,B=(u.regionRight-u.regionLeft)*q,z=(u.regionBottom-u.regionTop)*q;else if(c==="cover")if(S<w){q=b/r,E=u.regionLeft*q-(i*q-v)/2,E=Math.max(E,0),E=Math.min(E,parseFloat(g.width)),A=u.regionTop*q;let J=u.regionRight*q-(i*q-v)/2;J=Math.max(J,0),J=Math.min(J,parseFloat(g.width)),B=J-E,z=(u.regionBottom-u.regionTop)*q}else{q=v/i,E=u.regionLeft*q,A=u.regionTop*q-(r*q-b)/2,A=Math.max(A,0),A=Math.min(A,parseFloat(g.height));let J=u.regionBottom*q-(r*q-b)/2;J=Math.max(J,0),J=Math.min(J,parseFloat(g.height)),B=(u.regionRight-u.regionLeft)*q,z=J-A}else E=0,A=0,B=0,z=0;this._divScanArea.style.left=E+"px",this._divScanArea.style.top=A+"px",this._divScanArea.style.width=B+"px",this._divScanArea.style.height=z+"px"}set croppingRegions(t){this._croppingRegions=t,this._bFetchingLoopStarted&&(this.bIncreaseRegionIndexAuto&&(this._croppingRegionIndex=0),this._fetchingLoop(!1))}get croppingRegions(){if(this._croppingRegions!==void 0)return this._croppingRegions;if(this._controler){const t=this._controler.getPropertyDisiredValue("croppingRegions");if(t&&t.length===1)return t[0]}return this._defaultCroppingRegions}set croppingRegionIndex(t){t<0?(this.bIncreaseRegionIndexAuto=!0,this._croppingRegionIndex=0):(this.bIncreaseRegionIndexAuto=!1,this._croppingRegionIndex=t)}get croppingRegionIndex(){return this._croppingRegionIndex}set loopInterval(t){if(t<0)throw new Error("'Invalid value.");this._loopInterval=t,this._bFetchingLoopStarted&&this._fetchingLoop(!1)}get loopInterval(){if(this._loopInterval!==void 0)return this._loopInterval;if(this._controler){const t=this._controler.getPropertyDisiredValue("loopInterval");if(t&&t.length===1)return t[0]}return this._defaultLoopInterval}set maxNumberOfFramesInBuffer(t){if(t<=0)throw new Error("Invalid value.");for(this._maxNumberOfFramesInBuffer=t;this._frameQueue&&this._frameQueue.length>this.maxNumberOfFramesInBuffer;)this._frameQueue.shift()}get maxNumberOfFramesInBuffer(){if(this._maxNumberOfFramesInBuffer!==void 0)return this._maxNumberOfFramesInBuffer;if(this._controler){const t=this._controler.getPropertyDisiredValue("maxNumberOfFramesInBuffer");if(t&&t.length===1)return t[0]}return this._defaultMaxNumberOfFramesInBuffer}get numberOfFramesInBuffer(){return this._frameQueue.length}set refreshInterval(t){this._refreshInterval=t}get refreshInterval(){if(this._refreshInterval!==void 0)return this._refreshInterval;if(this._controler){const t=this._controler.getPropertyDisiredValue("refreshInterval");if(t&&t.length===1)return t[0]}return this._defaultRefreshInterval}static createInstance(t){return Ee(this,void 0,void 0,function*(){let i=new fe;(typeof t=="string"||t instanceof String)&&(t=JSON.parse(t));for(let r in t)i[r]=t[r];return this._hasEngineResourceLoaded=!0,fe.onWarning&&(location&&location.protocol==="file:"?setTimeout(()=>{fe.onWarning&&fe.onWarning({id:1,message:"Not using HTTP protocol, the SDK may not work correctly."})},0):location&&location.protocol!=="https:"&&setTimeout(()=>{fe.onWarning&&fe.onWarning({id:2,message:"Not connected via SSL (HTTPS), the SDK may not work correctly."})},0)),i._drawingLayersManager=new $f,i})}play(t,i,r,c){return Ee(this,void 0,void 0,function*(){if(this._video&&this.videoSrc){yield new Promise((A,B)=>{this._video.onloadedmetadata=()=>Ee(this,void 0,void 0,function*(){this._video&&(this._video.onloadedmetadata=null,yield this._video.play(),A())}),typeof this.videoSrc=="string"||this.videoSrc instanceof String?this._video.src=this.videoSrc:this._video.srcObject=this.videoSrc,setTimeout(()=>B(new Error("Failed to play video. Timeout.")),4e3)});const w={width:this._video.videoWidth,height:this._video.videoHeight,deviceId:this._currentCamera&&this._currentCamera.deviceId};this.playCallbackInfo=JSON.parse(JSON.stringify(w));const E=this.mapCameraEvents.get("played");for(let A of E){if(!A)continue;const B=JSON.parse(JSON.stringify(w));setTimeout(()=>A.apply(this,[B]),0)}return this._recordedStates.videoPlaying=!0,w}if(this.singleFrameMode)return c&&c.notTriggerSingleFrameClick||this._clickIptSingleFrameMode(),this.playCallbackInfo={width:0,height:0,deviceId:null},JSON.parse(JSON.stringify(this.playCallbackInfo));if(!this._video)return this.playCallbackInfo=null,null;const u=++this.iPlayRound;let g=null,v=0,b=0;if(this._currentCamera&&(g=this._currentCamera.deviceId),this._video&&(v=this._video.videoWidth,b=this._video.videoHeight),this.promisePlay&&(yield this.promisePlay,u<this.iPlayRound))return this.playCallbackInfo={width:this._video.videoWidth,height:this._video.videoHeight,deviceId:this._currentCamera&&this._currentCamera.deviceId},JSON.parse(JSON.stringify(this.playCallbackInfo));this.promisePlay=(()=>Ee(this,void 0,void 0,function*(){var w;try{let pe=function(he){return Ee(this,void 0,void 0,function*(){for(let a of ee){E(),a&&(yield new Promise(o=>setTimeout(o,a))),E();{const o=he.video.deviceId;oe=o?o.exact||o.ideal||o:null}try{fe._onLog&&fe._onLog("DCE: ask "+JSON.stringify(he)),J=yield navigator.mediaDevices.getUserMedia(he),E();break}catch(o){K=o,fe._onLog&&fe._onLog("DCE: "+o.message||o)}}})};this._video&&this._video.srcObject&&this.stop(),fe._onLog&&fe._onLog("DCE: ======before video========");const E=()=>{if(!this._video)throw J&&J.getTracks().forEach(he=>{he.stop()}),this._videoTrack=null,this._currentCamera=null,new Error("'video' is null.")},A=this.getVideoSettings();let B;typeof A.video=="boolean"&&(A.video={});const z=["rear","back","r\xFCck","arri\xE8re","trasera","tr\xE1s","traseira","posteriore","\u540E\u9762","\u5F8C\u9762","\u80CC\u9762","\u540E\u7F6E","\u5F8C\u7F6E","\u80CC\u7F6E","\u0437\u0430\u0434\u043D\u0435\u0439","\u0627\u0644\u062E\u0644\u0641\u064A\u0629","\uD6C4","arka","achterzijde","\u0E2B\u0E25\u0E31\u0E07","baksidan","bagside","sau","bak","tylny","takakamera","belakang","\u05D0\u05D7\u05D5\u05E8\u05D9\u05EA","\u03C0\u03AF\u03C3\u03C9","spate","h\xE1ts\xF3","zadn\xED","darrere","zadn\xE1","\u0437\u0430\u0434\u043D\u044F","stra\u017Enja","belakang","\u092C\u0948\u0915"],q=()=>{for(let he of this._allCameras){let a=he.label.toLowerCase();if(a&&z.some(o=>a.indexOf(o)!=-1)&&/\b0(\b)?/.test(a)){delete A.video.facingMode,A.video.deviceId={ideal:he.deviceId};break}}A.video.deviceId||["Android","HarmonyOS"].indexOf(Ne.OS)==-1||(delete A.video.facingMode,A.video.deviceId={ideal:this._allCameras[this._allCameras.length-1].deviceId})};if(t)delete A.video.facingMode,A.video.deviceId={exact:t};else if(!A.video.deviceId){if(this._lastDeviceId)delete A.video.facingMode,A.video.deviceId={exact:this._lastDeviceId};else if(this.ifSaveLastUsedCamera&&fe.isStorageAvailable&&window.localStorage.getItem("dce_last_camera_id")){delete A.video.facingMode,A.video.deviceId={exact:window.localStorage.getItem("dce_last_camera_id")};const he=JSON.parse(window.localStorage.getItem("dce_last_apply_width")),a=JSON.parse(window.localStorage.getItem("dce_last_apply_height"));he&&a&&(A.video.width=he,A.video.height=a)}else if(!this.ifSkipCameraInspection){if(A.video.facingMode){if(Ne.OS!=="iPhone"&&Ne.OS!=="Mac"&&(yield this.getAllCameras(!0)),!this._video)return null;let he=A.video.facingMode;he instanceof Array&&he.length&&(he=he[0]),he=he.exact||he.ideal||he,he==="environment"&&(B=!!A.video.facingMode,q())}}}let J;i&&(A.video.width={ideal:i}),r&&(A.video.height={ideal:r}),fe._onLog&&fe._onLog("DCE: ======try getUserMedia========");let Z,ee=[0,500],K=null,oe=null;if(yield pe(A),J||(fe._onLog&&fe._onLog("DCE: ======try getUserMedia again========"),Z=JSON.parse(JSON.stringify(A)),typeof Z.video=="object"&&(Ne.OS=="iPhone"?(i>=1280||r>=1280?Z.video.width=1280:i>=640||r>=640?Z.video.width=640:(i<640||r<640)&&(Z.video.width=320),delete Z.video.height):B&&!A.video.deviceId?(delete Z.video.facingMode,this._allCameras.length&&(Z.video.deviceId={ideal:this._allCameras[this._allCameras.length-1].deviceId})):Z.video=!0),fe._onLog&&fe._onLog("DCE: "+Z),yield pe(Z)),J||(ee=[1e3,2e3],yield pe(A)),J||(yield pe(Z)),!J)throw K;const ye=()=>{const he=J.getVideoTracks();let a,o;if(he.length&&(a=this._videoTrack=he[0]),this._video&&a){const l=a.getSettings();if(l){for(let d of this._allCameras)if(l.deviceId===d.deviceId){d._checked=!0,d.label=a.label,o=d;break}}if(!o&&oe){for(let d of this._allCameras)if(oe==d.deviceId){a.label&&(d._checked=!0,d.label=a.label),o=d;break}}}this._currentCamera=o};if(yield this.getAllCameras(!0),E(),B){ye(),q();let he=A.video.deviceId;he&&(he=he.exact||he.ideal||he);let a=(w=this._currentCamera)===null||w===void 0?void 0:w.deviceId;!he||a&&he==a||(J.getTracks().forEach(o=>{o.stop()}),ee=[0,500,1e3,2e3],yield pe(A))}E(),yield(()=>Ee(this,void 0,void 0,function*(){fe._onLog&&fe._onLog("======play video========"),yield new Promise((he,a)=>{E(),this._video.onloadedmetadata=()=>Ee(this,void 0,void 0,function*(){E(),this._video.onloadedmetadata=null,yield this._video.play(),he()}),this._video.srcObject=J,setTimeout(()=>a(new Error("Failed to play video. Timeout.")),4e3)})}))(),E(),fe._onLog&&fe._onLog("DCE: ======played video========"),this._bgLoading&&(this._bgLoading.style.animationPlayState="paused");const y=this._video.videoWidth+"x"+this._video.videoHeight;this._optGotRsl&&(this._optGotRsl.setAttribute("data-width",this._video.videoWidth),this._optGotRsl.setAttribute("data-height",this._video.videoHeight),this._optGotRsl.innerText=y,this._selRsl&&this._optGotRsl.parentNode==this._selRsl&&(this._selRsl.value="got")),fe._onLog&&fe._onLog("DCE: got "+y),ye(),E(),this._renderSelCameraInfo();const le={width:this._video.videoWidth,height:this._video.videoHeight,deviceId:this._currentCamera&&this._currentCamera.deviceId};le.deviceId&&(this._lastDeviceId=le.deviceId,this.ifSaveLastUsedCamera&&fe.isStorageAvailable&&(window.localStorage.setItem("dce_last_camera_id",this._lastDeviceId),A.video.width&&A.video.height&&(window.localStorage.setItem("dce_last_apply_width",JSON.stringify(A.video.width)),window.localStorage.setItem("dce_last_apply_height",JSON.stringify(A.video.height)))));const te=this.mapCameraEvents.get("played");for(let he of te){if(!he)continue;const a=JSON.parse(JSON.stringify(le));setTimeout(()=>he.apply(this,[a]),0)}if(g&&g!=le.deviceId){const he=this.mapCameraEvents.get("cameraChange");for(let a of he){if(!a)continue;const o=JSON.parse(JSON.stringify(le));setTimeout(()=>a.apply(this,[o]),0)}}if(v&&b&&(v!=le.width||b!=le.height)){this._updateScanRegionCanvas(),this._updateScanAreaDiv(),this._updateViewDecorator();for(let a of this._arrScanRegionOverlays)a&&this._updateScanRegionOverlay(a);this._cvsOriginalImage||this._updateDrawingLayersSize();const he=this.mapCameraEvents.get("resolutionChange");for(let a of he){if(!a)continue;const o=JSON.parse(JSON.stringify(le));setTimeout(()=>a.apply(this,[o]),0)}}return this.promisePlay=null,le}catch(E){throw this.promisePlay=null,this._bgLoading&&(this._bgLoading.style.display="none"),E.name==="NotFoundError"&&(DOMException?E=new DOMException("No camera available, please use a device with an accessible camera.",E.name):(E=new Error("No camera available, please use a device with an accessible camera.")).name="NotFoundError"),E}}))();const S=yield this.promisePlay;return this.playCallbackInfo=JSON.parse(JSON.stringify(S)),this._recordedStates.videoPlaying=!0,S})}resume(){return Ee(this,void 0,void 0,function*(){this._assertOpen(),yield this.play(),this.ifShowScanRegionLaser&&this.showScanRegionLaser()})}pause(){this._assertOpen(),this._video&&(this._video.pause(),this._recordedStates.videoPlaying=!1),this.ifShowScanRegionLaser&&this.hideScanRegionLaser()}_bindUI(){if(!this.UIElement)throw new Error("Need to define `UIElement` before opening.");const t=[this.UIElement];for(let i=0;i<t.length;++i)for(let r of t[i].children)t.push(r);for(let i of t){if(!this._video&&i.classList.contains("dce-video-container")){this._divVideoContainer=i;const r=document.createElement("video");r.style.position="absolute",r.style.left="0",r.style.top="0",r.style.width="100%",r.style.height="100%",r.style.objectFit=this.getVideoFit(),r.setAttribute("playsinline","true"),r.setAttribute("muted","true"),i.prepend(r),this._video=r}else!this._divScanArea&&i.classList.contains("dce-scanarea")?this._divScanArea=i:!this._divScanLight&&i.classList.contains("dce-scanlight")?this._divScanLight=i:!this._bgLoading&&i.classList.contains("dce-bg-loading")?this._bgLoading=i:!this._bgCamera&&i.classList.contains("dce-bg-camera")?this._bgCamera=i:!this._selCam&&i.classList.contains("dce-sel-camera")?this._selCam=i:!this._selRsl&&i.classList.contains("dce-sel-resolution")?(this._selRsl=i,this.videoSrc||this.singleFrameMode||this._selRsl.options.length||(this._selRsl.innerHTML=[this._optGotRsl?"":'<option class="dce-opt-gotResolution" value="got"></option>','<option data-width="3840" data-height="2160">3840x2160</option>','<option data-width="1920" data-height="1080">1920x1080</option>','<option data-width="1280" data-height="720">1280x720</option>'].join(""),this._optGotRsl=this._optGotRsl||this._selRsl.options[0])):!this._optGotRsl&&i.classList.contains("dce-opt-gotResolution")?this._optGotRsl=i:!this._btnClose&&i.classList.contains("dce-btn-close")?this._btnClose=i:!this._selMinLtr&&i.classList.contains("dlr-sel-minletter")?(this._selMinLtr=i,this._selMinLtr.options.length||(this._selMinLtr.innerHTML=[this._optGotMinLtr?"":'<option class="dlr-opt-gotMinLtr" value="got"></option>','<option value="0" selected>any letter</option>','<option value="3">3+ letters</option>','<option value="5">5+ letters</option>','<option value="8">8+ letters</option>','<option value="12">12+ letters</option>','<option value="17">17+ letters</option>','<option value="30">30+ letters</option>','<option value="50">50+ letters</option>','<option value="80">80+ letters</option>','<option value="120">120+ letters</option>'].join(""),this._optGotMinLtr=this._optGotMinLtr||this._selMinLtr.options[0])):!this._optGotMinLtr&&i.classList.contains("dlr-opt-gotMinLtr")&&(this._optGotMinLtr=i);if(this.extraBindings&&this.extraBindings.length)for(let r of this.extraBindings)try{r(i)}catch{}}if(!this._video)throw this._unbindUI(),Error("Can not find the video container element with class 'dce-video-container'");this.singleFrameMode?(this._video&&(this._video.addEventListener("click",this._clickIptSingleFrameMode),this._video.style.cursor="pointer",this._video.setAttribute("title","Take a photo")),this._selCam&&(this._selCam.style.display="none"),this._selRsl&&(this._selRsl.style.display="none"),this._selMinLtr&&(this._selMinLtr.style.display="none"),this._bgCamera&&(this._bgCamera.style.display="block")):(this._selCam&&(this._selCam.style.display="block",this._selCam.addEventListener("change",this._onCameraSelChange)),this._selRsl&&(this._selRsl.style.display="block",this._selRsl.addEventListener("change",this._onResolutionSelChange)),this._selMinLtr&&(this._selMinLtr.style.display="block"),this._bgLoading&&(this._bgLoading.style.display="block")),this._btnClose&&this._btnClose.addEventListener("click",this._onCloseBtnClick),document.addEventListener("visibilitychange",this._ev_documentHideEvent),window.ResizeObserver?(this._resizeObserver||(this._resizeObserver=new ResizeObserver(i=>{for(let r of i)r.target===this._divVideoContainer&&this._updateLayers()})),this._divVideoContainer&&this._resizeObserver.observe(this._divVideoContainer)):window.addEventListener("resize",this._updateLayers)}_unbindUI(){this.singleFrameMode?(this._video&&(this._video.removeEventListener("click",this._clickIptSingleFrameMode),this._video.style.cursor="",this._video.removeAttribute("title")),this._bgCamera&&(this._bgCamera.style.display="none")):this._bgLoading&&(this._bgLoading.style.display="none"),this._selCam&&this._selCam.removeEventListener("change",this._onCameraSelChange),this._selRsl&&this._selRsl.removeEventListener("change",this._onResolutionSelChange),this._btnClose&&this._btnClose.removeEventListener("click",this._onCloseBtnClick),this.hideScanRegionLaser(),this.hideViewDecorator(),this.hideScanRegionOverlays(),this._drawingLayersManager.setVisible(!1),this._hideOriginalImageCvs(),this._video&&(this._video.onloadedmetadata=null,this._video.remove()),this._divVideoContainer=null,this._video=null,this._selCam=null,this._selRsl=null,this._optGotRsl=null,this._btnClose=null,this._selMinLtr=null,this._optGotMinLtr=null,this._divScanArea=null,this._divScanLight=null,this._cvsScanRegion&&(this._cvsScanRegion.remove(),this._cvsScanRegion=null),this._singleFrameModeIpt&&(this._singleFrameModeIpt.remove(),this._singleFrameModeIpt=null),this._cvsSingleFrameMode&&(this._cvsSingleFrameMode.remove(),this._cvsSingleFrameMode=null),document.removeEventListener("visibilitychange",this._ev_documentHideEvent),window.ResizeObserver?this._resizeObserver&&this._resizeObserver.disconnect():window.removeEventListener("resize",this._updateLayers)}_assertOpen(){if(!this._bOpen)throw Error("The camera is not open.")}open(t){return Ee(this,void 0,void 0,function*(){this.UIElement||(yield this.setUIElement(fe.defaultUIElementURL)),this._bindUI(),t&&this.appendAndShowUI();let i=yield this.play();this.bOpen=!0;const r=this.mapCameraEvents.get("cameraOpen");for(let c of r){if(!c)continue;const u=JSON.parse(JSON.stringify(i));setTimeout(()=>c.apply(this,[u]),0)}return i})}close(t){if(!this._video)return;this.stop(),this._hideOriginalImage(!1),this._unbindUI(),t&&this.hideUI(),this.stopFetchingLoop(),this.bOpen=!1;const i=this.mapCameraEvents.get("cameraClose");for(let r of i){if(!r)continue;const c={width:0,height:0,deviceId:null};setTimeout(()=>r.apply(this,[c]),0)}}stop(){this._video&&this._video.srcObject&&(fe._onLog&&fe._onLog("DCE: ======stop video========"),this._video.srcObject.getTracks().forEach(t=>{t.stop()}),this._video.srcObject=null,this._videoTrack=null,this._currentCamera=null),this._video&&this.videoSrc&&(fe._onLog&&fe._onLog("DCE: ======stop existing video========"),this._video.pause(),this._video.currentTime=0),this._bgLoading&&(this._bgLoading.style.animationPlayState=""),this._frameQueue.length=0,this._reusedCvs&&this._reusedCvs.ctx2d&&this._reusedCvs.ctx2d.clearRect(0,0,this._reusedCvs.width,this._reusedCvs.height),this.forceLoseContext()}getAllCameras(t){return Ee(this,void 0,void 0,function*(){let i=yield navigator.mediaDevices.enumerateDevices();if(!t&&i&&i.length&&!i[0].deviceId){let u=yield navigator.mediaDevices.getUserMedia({video:!0});i=yield navigator.mediaDevices.enumerateDevices(),u.getTracks().forEach(g=>{g.stop()}),u=null}const r=[],c=[];if(this._allCameras)for(let u of this._allCameras)u._checked&&c.push(u);for(let u=0;u<i.length;u++){let g,v=i[u];if(v.kind=="videoinput"){for(let b of c)v.deviceId==b.deviceId&&(g=b);g||(g={},g.deviceId=v.deviceId,g.label=v.label?v.label:"camera "+u),r.push(g)}}return this._allCameras=r,fe._onLog&&fe._onLog("DCE: "+JSON.stringify(this._allCameras)),Promise.resolve(r)})}_renderSelCameraInfo(){if(this._selCam&&(this._selCam.innerHTML=""),this._selCam){let t;for(let i of this._allCameras){let r=document.createElement("option");r.value=i.deviceId,r.innerText=i.label,this._selCam.append(r),i.deviceId&&this._currentCamera&&this._currentCamera.deviceId==i.deviceId&&(t=r)}this._selCam.value=t?t.value:""}}getSelectedCamera(){if(!this._bOpen){let t="";const i=this.videoSettings.video.deviceId;i&&(t=i.exact||i.ideal||i);for(let r of this._allCameras)if(r.deviceId===t)return JSON.parse(JSON.stringify(r));return{deviceId:t,label:"",_checked:!1}}return this._currentCamera}selectCamera(t){return Ee(this,void 0,void 0,function*(){let i="";return t&&(i=t.deviceId||t),this.videoSettings.video.deviceId={exact:i},this._bOpen?yield this.play(t.deviceId||t):null})}getResolution(){if(this._bOpen)return[this._video.videoWidth,this._video.videoHeight];{let t=0,i=0;const r=this.videoSettings.video.width,c=this.videoSettings.video.height;return r&&(t=r.exact||r.ideal||r),c&&(i=c.exact||c.ideal||c),[t,i]}}setResolution(t,i){return Ee(this,void 0,void 0,function*(){let r,c;return t instanceof Array?(r=t[0],c=t[1]):(r=t,c=i),this.videoSettings.video.width={ideal:r},this.videoSettings.video.height={ideal:c},this._bOpen?yield this.play(null,r,c):null})}getResolutions(t){return Ee(this,void 0,void 0,function*(){let i="";const r=(u,g)=>{const v=this._mapCameraResolutions.get(u);if(!v||!v.length)return!1;for(let b of v)if(b[0]===g.width&&b[1]===g.height)return!0;return!1},c=(u,g,v)=>Ee(this,void 0,void 0,function*(){const b={video:{deviceId:{exact:u},width:{ideal:g},height:{ideal:v}}};let S=null;try{S=yield navigator.mediaDevices.getUserMedia(b)}catch{return null}if(!S)return null;const w=S.getVideoTracks();let E=null;try{const A=w[0].getSettings();E={width:A.width,height:A.height}}catch{const B=document.createElement("video");B.srcObject=S,E={width:B.videoWidth,height:B.videoHeight},B.srcObject=null}return w.forEach(A=>{A.stop()}),E});if(!this._bOpen){const u=this.videoSettings.video.deviceId;if(!u||(i=u.hasOwnProperty("exact")?this.videoSettings.video.deviceId.exact:u.hasOwnProperty("ideal")?this.videoSettings.video.deviceId.ideal:this.videoSettings.video.deviceId,!i))return null;let g=this._mapCameraResolutions.get(i);if(g&&!t)return this._mapCameraResolutions.get(i);this._mapCameraResolutions.set(i,[]),g=this._mapCameraResolutions.get(i);for(let v of this._predefinedResolutions){const b=yield c(i,v.width,v.height);b&&!r(i,b)&&g.push([b.width,b.height])}return g}if(this._currentCamera){i=this._currentCamera.deviceId;let u=this._mapCameraResolutions.get(i);if(u&&!t)return this._mapCameraResolutions.get(i);this._mapCameraResolutions.set(i,[]),u=this._mapCameraResolutions.get(i);const g=this.getConstraints();for(let v of this._predefinedResolutions){yield this._videoTrack.applyConstraints({width:{ideal:v.width},height:{ideal:v.height}});const b=this._videoTrack.getSettings(),S={width:b.width,height:b.height};r(i,S)||u.push([S.width,S.height])}return yield this._videoTrack.applyConstraints(g),u}return null})}on(t,i){if(!this.mapCameraEvents.has(t))throw new Error(`Event '${t}' is not exists.`);const r=this.mapCameraEvents.get(t);r.includes(i)||r.push(i)}off(t,i){if(!this.mapCameraEvents.has(t))throw new Error(`Event '${t}' is not exists.`);const r=this.mapCameraEvents.get(t),c=r.indexOf(i);c!==-1&&r.splice(c,1)}offAll(t){if(t){if(typeof t=="string"){const i=this.mapCameraEvents.get(t);i&&(i.length=0)}}else for(let i of this.mapCameraEvents.values())i&&(i.length=0)}getVideoSettings(){return JSON.parse(JSON.stringify(this.videoSettings))}updateVideoSettings(t){return this.videoSettings=JSON.parse(JSON.stringify(t)),this._lastDeviceId=null,this._bOpen?this.play():Promise.resolve()}isOpen(){return this._bOpen}getCapabilities(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'getCapabilities()' is unavailable in singleFrameMode.");return this._videoTrack&&this._videoTrack.getCapabilities?this._videoTrack.getCapabilities():{}}getCameraSettings(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'getCameraSettings()' is unavailable in singleFrameMode.");return this._videoTrack?this._videoTrack.getSettings():null}getConstraints(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'getConstraints()' is unavailable in singleFrameMode.");return this._videoTrack?this._videoTrack.getConstraints():null}applyConstraints(t){return Ee(this,void 0,void 0,function*(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'applyConstraints()' is unavailable in singleFrameMode.");if(!this._videoTrack)throw new Error('"_videoTrack" is null.');if(!this._videoTrack.applyConstraints)throw Error("Not supported.");return yield this._videoTrack.applyConstraints(t)})}turnOnTorch(){return Ee(this,void 0,void 0,function*(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'turnOnTorch()' is unavailable in singleFrameMode.");if(this.getCapabilities().torch)return yield this._videoTrack.applyConstraints({advanced:[{torch:!0}]});throw Error("Not supported.")})}turnOffTorch(){return Ee(this,void 0,void 0,function*(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'turnOffTorch()' is unavailable in singleFrameMode.");if(this.getCapabilities().torch)return yield this._videoTrack.applyConstraints({advanced:[{torch:!1}]});throw Error("Not supported.")})}setColorTemperature(t){return Ee(this,void 0,void 0,function*(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'setColorTemperature()' is unavailable in singleFrameMode.");let i=this.getCapabilities().colorTemperature;if(!i)throw Error("Not supported.");return t<i.min?t=i.min:t>i.max&&(t=i.max),yield this._videoTrack.applyConstraints({advanced:[{colorTemperature:t}]})})}setExposureCompensation(t){return Ee(this,void 0,void 0,function*(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'setExposureCompensation()' is unavailable in singleFrameMode.");let i=this.getCapabilities().exposureCompensation;if(!i)throw Error("Not supported.");return t<i.min?t=i.min:t>i.max&&(t=i.max),yield this._videoTrack.applyConstraints({advanced:[{exposureCompensation:t}]})})}setZoom(t){return Ee(this,void 0,void 0,function*(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'setZoom()' is unavailable in singleFrameMode.");let i=this.getCapabilities().zoom;if(!i)throw Error("Not supported.");return t<i.min?t=i.min:t>i.max&&(t=i.max),yield this._videoTrack.applyConstraints({advanced:[{zoom:t}]})})}setFrameRate(t){return Ee(this,void 0,void 0,function*(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'setFrameRate()' is unavailable in singleFrameMode.");let i=this.getCapabilities().frameRate;if(!i)throw Error("Not supported.");return t<i.min?t=i.min:t>i.max&&(t=i.max),yield this._videoTrack.applyConstraints({width:{ideal:Math.max(this._video.videoWidth,this._video.videoHeight)},frameRate:t})})}getFrameRate(){return this.getCameraSettings().frameRate}setFocus(t,i){return Ee(this,void 0,void 0,function*(){if(this._assertOpen(),this.singleFrameMode)throw new Error("'setFocus()' is unavailable in singleFrameMode.");const r=this.getCapabilities().focusMode,c=this.getCapabilities().focusDistance;if(!r||!r.includes(t)||!c)throw Error("Not supported.");return i?(i<c.min?i=c.min:i>c.max&&(i=c.max),yield this._videoTrack.applyConstraints({advanced:[{focusMode:t,focusDistance:i}]})):yield this._videoTrack.applyConstraints({advanced:[{focusMode:t}]})})}getFocus(){const t=this.getCameraSettings().focusMode;return t==="continuous"?{mode:t}:{mode:t,distance:this.getCameraSettings().focusDistance}}getFrameSize(t,i,r,c){if(!t||!i)return null;let u,g,v,b,S=t,w=i;const E={regionLeft:0,regionTop:0,regionRight:S,regionBottom:w,regionMeasuredByPercentage:!1};r?(r.regionMeasuredByPercentage?(E.regionLeft=r.regionLeft*S/100,E.regionTop=r.regionTop*w/100,E.regionRight=r.regionRight*S/100,E.regionBottom=r.regionBottom*w/100):(E.regionLeft=r.regionLeft,E.regionTop=r.regionTop,E.regionRight=r.regionRight,E.regionBottom=r.regionBottom),u=E.regionLeft,g=E.regionTop,S=Math.round(E.regionRight-E.regionLeft),w=Math.round(E.regionBottom-E.regionTop)):(u=0,g=0);const A=Math.max(S,w);if(c&&c>0&&A>c){const B=c/A;S>w?(v=c,b=Math.round(w*B)):(v=Math.round(S*B),b=c)}else v=S,b=w;return v<=0||b<=0?null:{sx:u,sy:g,sWidth:S,sHeight:w,dWidth:v,dHeight:b}}getFrame(){if(this.singleFrameMode)throw Error("'getFrame()' is unavailable in singleFrameMode.");if(this._assertOpen(),this.singleFrameMode)throw new Error("'getFrame()' is unavailable in singleFrameMode.");return this._getVideoFrame(this._scanRegion)}getImage(){const t=this.getFrame();return t.pixelFormat=t.colorMode,Object.assign(Object.assign({},t),{pixelFormat:t.colorMode})}_getVideoFrame(t,i){if(this.isDisposed)throw Error("The 'CameraEnhancer' instance has been disposed.");if(this._assertOpen(),this.singleFrameMode)throw new Error("'_getVideoFrame()' is unavailable in singleFrameMode.");const r=Date.now();fe._onLog&&fe._onLog("DCE: _getVideoFrame() START: "+r);const c=this._video.videoWidth,u=this._video.videoHeight;if(c===0||u===0)return null;const g=this.getFrameSize(c,u,t,this.maxCvsSideLength);if(!g)return null;let v,b;v=c!==g.sWidth||u!==g.sHeight,b=g.sWidth!==g.dWidth||g.sHeight!==g.dHeight;const S=(()=>!(!this._bWebGLSupported||b))(),w={data:null,region:t?JSON.parse(JSON.stringify(t)):null,sx:g.sx,sy:g.sy,width:g.dWidth,height:g.dHeight,colorMode:null,timeSpent:null,timeStamp:null,isCropped:v,toCanvas:this._toCanvas,_sWidth:g.sWidth,_sHeight:g.sHeight,_bUseWebGL:null};let E;try{E=this._getImageData(this._video,c,u,g,i,{targetColorMode:this.frameColorMode,bUseWebGL:S})}catch(B){if(B.name!=="WebGLError")throw B;fe._onLog&&fe._onLog("DCE: get WebGLError, try again in canvas."),E=this._getImageData(this._video,c,u,g,i,{targetColorMode:this.frameColorMode,bUseWebGL:!1})}if(!E)return null;const A=Date.now();return fe._onLog&&fe._onLog("DCE: _getVideoFrame() END: "+A),w.data=E.data,w.colorMode=E.colorMode,w._bUseWebGL=E._bUseWebGL,w.timeSpent=A-r,w.timeStamp=A,w}_getImageData(t,i,r,c,u,g){if(this.isDisposed)throw Error("The 'CameraEnhancer' instance has been disposed.");if(!i||!r)return null;fe._onLog&&fe._onLog("DCE: _getImageData(), START: "+Date.now());const{sx:v,sy:b,sWidth:S,sHeight:w,dWidth:E,dHeight:A}=c;let B;if(B=g&&g.targetColorMode?g.targetColorMode.toLowerCase():"rgba",g&&g.bUseWebGL){fe._onLog&&fe._onLog("DCE:  _getImageData() in WebGL."),this._reusedWebGLCvs||(this._reusedWebGLCvs=document.createElement("canvas"));const z=this._reusedWebGLCvs;z.width==i&&z.height==r||(z.width=i,z.height=r,this._reusedWebGLCtx&&this._reusedWebGLCtx.viewport(0,0,i,r));const q=this._reusedWebGLCtx||z.getContext("webgl",{antialias:!1})||z.getContext("experimental-webgl",{antialias:!1});if(!q){fe._onLog&&fe._onLog("DCE: WebGL unavailable."),this._reusedWebGLCtx=null,this._bWebGLSupported=!1;const K=new Error("WebGL error: unable to initialize WebGL. Your browser or machine may not support it.");throw K.name="WebGLError",K}if(q.enable(q.SCISSOR_TEST),q.scissor(v,b,E,A),!this._reusedWebGLCtx||B!==this.currentFSColorMode){this._reusedWebGLCtx=q;const K=te=>{const he=te.createBuffer();te.bindBuffer(te.ARRAY_BUFFER,he),te.bufferData(te.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,1,1,-1,1]),te.STATIC_DRAW);const a=te.createBuffer();return te.bindBuffer(te.ELEMENT_ARRAY_BUFFER,a),te.bufferData(te.ELEMENT_ARRAY_BUFFER,new Uint16Array([0,1,2,0,2,3]),te.STATIC_DRAW),{position:he,indices:a}},oe=te=>{const he=te.createTexture();return te.bindTexture(te.TEXTURE_2D,he),te.texParameteri(te.TEXTURE_2D,te.TEXTURE_MAG_FILTER,te.LINEAR),te.texParameteri(te.TEXTURE_2D,te.TEXTURE_MIN_FILTER,te.LINEAR),te.texParameteri(te.TEXTURE_2D,te.TEXTURE_WRAP_S,te.CLAMP_TO_EDGE),te.texParameteri(te.TEXTURE_2D,te.TEXTURE_WRAP_T,te.CLAMP_TO_EDGE),he},pe=(te,he,a)=>{const o=ye(te,te.VERTEX_SHADER,he),l=ye(te,te.FRAGMENT_SHADER,a),d=te.createProgram();return te.attachShader(d,o),te.attachShader(d,l),te.linkProgram(d),te.getProgramParameter(d,te.LINK_STATUS)?d:(alert("Unable to initialize the shader program: "+te.getProgramInfoLog(d)),null)},ye=(te,he,a)=>{const o=te.createShader(he);return te.shaderSource(o,a),te.compileShader(o),te.getShaderParameter(o,te.COMPILE_STATUS)?o:(alert("An error occurred compiling the shaders: "+te.getShaderInfoLog(o)),te.deleteShader(o),null)},_e=`
                  attribute mediump vec2 aVertexPosition;
                  varying mediump vec2 vDirection;
          
                  void main( void )
                  {
                      gl_Position = vec4(aVertexPosition, 1.0, 1.0) * 2.0;
                      vDirection = aVertexPosition;
                  }
                `;let y;y=["rgba","rbga","grba","gbra","brga","bgra"].includes(B)?B.slice(0,3):"rgb";const le=pe(q,_e,`
                    precision mediump float;

                    varying mediump vec2 vDirection;
                    uniform sampler2D uSampler;
                    uniform lowp float uColorFactor;
            
                    void main(void)
                    {
                        vec4 sample = texture2D(uSampler, vec2(vDirection.x * 0.5 + 0.5, vDirection.y * 0.5 + 0.5));
                        lowp float grey = 0.21 * sample.r + 0.71 * sample.g + 0.07 * sample.b;
                        gl_FragColor = vec4(sample.${y} * (1.0 - uColorFactor) + (grey * uColorFactor), sample.a);
                    }
                `);this._webGLProgramInfo={program:le,attribLocations:{vertexPosition:q.getAttribLocation(le,"aVertexPosition")},uniformLocations:{uSampler:q.getUniformLocation(le,"uSampler"),uColorFactor:q.getUniformLocation(le,"uColorFactor")}},this._webGLBuffers=K(q),this._webGLTexture=oe(q),this.currentFSColorMode=B}const J=(K,oe,pe)=>{const ye=K.RGBA,_e=K.RGBA,y=K.UNSIGNED_BYTE;K.bindTexture(K.TEXTURE_2D,oe),K.texImage2D(K.TEXTURE_2D,0,ye,_e,y,pe)},Z=(K,oe,pe,ye)=>{K.clearColor(0,0,0,1),K.clearDepth(1),K.enable(K.DEPTH_TEST),K.depthFunc(K.LEQUAL),K.clear(K.COLOR_BUFFER_BIT|K.DEPTH_BUFFER_BIT),K.bindBuffer(K.ELEMENT_ARRAY_BUFFER,pe.indices),K.useProgram(oe.program);{const le=K.FLOAT,te=!1,he=0,a=0;K.bindBuffer(K.ARRAY_BUFFER,pe.position),K.vertexAttribPointer(oe.attribLocations.vertexPosition,2,le,te,he,a),K.enableVertexAttribArray(oe.attribLocations.vertexPosition)}K.activeTexture(K.TEXTURE0),K.bindTexture(K.TEXTURE_2D,ye),K.uniform1i(oe.uniformLocations.uSampler,0),K.uniform1f(oe.uniformLocations.uColorFactor,B==="grey"||B==="grey32"?1:0);const _e=K.UNSIGNED_SHORT;K.drawElements(K.TRIANGLES,6,_e,0)};let ee;if(J(q,this._webGLTexture,t),Z(q,this._webGLProgramInfo,this._webGLBuffers,this._webGLTexture),u){if(u.length<E*A*4)return null;ee=u}else this.ifReuseArrayBufferView||B==="grey"?(this._reusedDataContainer&&this._reusedDataContainer.length===E*A*4||(this._reusedDataContainer=new Uint8Array(E*A*4)),ee=this._reusedDataContainer):ee=new Uint8Array(E*A*4);if(q.readPixels(v,b,E,A,q.RGBA,q.UNSIGNED_BYTE,ee),q.disable(q.SCISSOR_TEST),ee[3]!==255){fe._onLog&&fe._onLog("DCE: WebGL drawing incorrect."),this.forceLoseContext(),this._bWebGLSupported=!1;const K=new Error("WebGL error: incorrect WebGL drawing.");throw K.name="WebGLError",K}if(B==="grey"){let K=fe._onLog?Date.now():0;if(ee=new Uint8Array(new Uint32Array(ee.buffer)),u){if(u.length<ee.length)return null;u.set(ee)}fe._onLog&&fe._onLog("DCE: Extract grey cost: "+(Date.now()-K))}return fe._onLog&&fe._onLog("DCE: _getImageData() in WebGL, END: "+Date.now()),{data:ee,colorMode:B,_bUseWebGL:!0}}{fe._onLog&&fe._onLog("DCE:  _getImageData() in canvas."),this._reusedCvs||(this._reusedCvs=document.createElement("canvas"));const z=this._reusedCvs;z.width===E&&z.height===A||(z.width=E,z.height=A),z.ctx2d||(z.ctx2d=z.getContext("2d"));const q=z.ctx2d;q.drawImage(t,v,b,S,w,0,0,E,A);let J=q.getImageData(0,0,z.width,z.height).data;if(["rbga","grba","gbra","brga","bgra"].includes(B)){const Z=B.indexOf("r"),ee=B.indexOf("g"),K=B.indexOf("b");let oe=0;Z===1||Z===2?oe=Z:ee===2&&(oe=ee);for(let pe=0;pe<J.length;pe+=4){let ye;oe&&(ye=J[pe+oe]),J[pe+Z]=J[pe],J[pe+ee]=oe===1?ye:J[pe+1],J[pe+K]=oe===2?ye:J[pe+2]}}else if(B==="grey"||B==="grey32")for(let Z=0;Z<J.length;Z+=4){const ee=.21*J[Z]+.71*J[Z+1]+.07*J[Z+2];J[Z]=ee,J[Z+1]=ee,J[Z+2]=ee}if(J=B==="grey"?new Uint8Array(new Uint32Array(J.buffer)):new Uint8Array(J.buffer),u){if(u.length<J.length)return null;u.set(J)}return fe._onLog&&fe._onLog("DCE: _getImageData() in canvas, END: "+Date.now()),{data:J,colorMode:B,_bUseWebGL:!1}}}getCurrentRegion(){let t=null;if(this._scanRegion)t=this._scanRegion;else if(this.croppingRegions){if(this._croppingRegionIndex>=this.croppingRegions.length||this._croppingRegionIndex<0)throw new Error("The 'croppingRegionIndex' is out of bounds.");t=this.croppingRegions[this._croppingRegionIndex],this.bIncreaseRegionIndexAuto&&++this._croppingRegionIndex>=this.croppingRegions.length&&(this._croppingRegionIndex=0)}return t}_fetchingLoop(t){if(this.isDisposed)return;if(!this._bOpen||!this.isFetchingLoopStarted())return void this.stopFetchingLoop();const i=()=>{fe._onLog&&fe._onLog("DCE: start fetching a frame: "+Date.now());const c=this.getCurrentRegion();let u=this._getVideoFrame(c);if(!u)return void(fe._onLog&&fe._onLog("DCE: get a invalid frame, abandon it: "+Date.now()));for(;this._frameQueue&&this._frameQueue.length>=this.maxNumberOfFramesInBuffer;)this._frameQueue.shift();this._frameQueue.push(u),fe._onLog&&fe._onLog("DCE: finish fetching a frame: "+Date.now());const g=this.mapCameraEvents.get("frameAddedToBuffer");for(let v of g)v&&setTimeout(v.bind(this),0)},r=()=>{this.isDisposed||(this._frameLoopTimeoutId2&&clearTimeout(this._frameLoopTimeoutId2),this.refreshInterval<=0||(this._frameLoopTimeoutId2=setTimeout(()=>{this.isDisposed||(this._bOpen&&this.isFetchingLoopStarted()?(fe._onLog&&fe._onLog("DCE: second timeout executes: "+Date.now()),i(),r()):this.stopFetchingLoop())},this.refreshInterval)))};t&&(this._frameQueue.length<this.maxNumberOfFramesInBuffer?(i(),this.refreshInterval>0&&r()):this.refreshInterval>0?(i(),r()):this.refreshInterval===0?i():this.refreshInterval),this._frameLoopTimeoutId&&clearTimeout(this._frameLoopTimeoutId),this._frameLoopTimeoutId=setTimeout(()=>{this.isDisposed||this._fetchingLoop(!0)},this.loopInterval)}startFetchingLoop(){if(this.isDisposed)throw Error("The 'CameraEnhancer' instance has been disposed.");if(this._assertOpen(),this.singleFrameMode)throw Error("'startFetchingLoop()' is unavailable in singleFrameMode.");this.isFetchingLoopStarted()||(this._bFetchingLoopStarted=!0,this._recordedStates.fetchingLoopStart=!0,fe._onLog&&fe._onLog("start fetching loop: "+Date.now()),this._fetchingLoop(!0))}isFetchingLoopStarted(){return this._bFetchingLoopStarted}stopFetchingLoop(){this._bFetchingLoopStarted&&(fe._onLog&&fe._onLog("stop fetching loop: "+Date.now()),this._frameLoopTimeoutId&&clearTimeout(this._frameLoopTimeoutId),this._frameQueue.length=0,this._bFetchingLoopStarted=!1,this._recordedStates.fetchingLoopStart=!1)}getFrameFromBuffer(t){return this._frameQueue&&this._frameQueue.length?t?t<this._frameQueue.length?(this._frameLoopTimeoutId2&&clearTimeout(this._frameLoopTimeoutId2),this._frameQueue.splice(t,1)[0]):void 0:(this._frameLoopTimeoutId2&&clearTimeout(this._frameLoopTimeoutId2),this._frameQueue.shift()):null}forceLoseContext(){if(!this._reusedWebGLCtx)return;const t=this._reusedWebGLCtx;t&&!t.isContextLost()&&t.getExtension("WEBGL_lose_context")&&t.getExtension("WEBGL_lose_context").loseContext(),this._webGLTexture=null,this._webGLProgramInfo=null,this._webGLBuffers=null,this._reusedWebGLCtx=null,this._reusedWebGLCvs=null}_createDrawingLayerBaseCvs(){this._assertOpen();const t=this._calculateCvsSize();if(!t)throw new Error("Camera is not open.");const{width:i,height:r,objectFit:c}=t;if(i<=0||r<=0)throw new Error("Invalid dimension of video or image.");const u=document.createElement("canvas");if(u.width==i&&u.height==r||(u.width=i,u.height=r),u.style.objectFit=c,this._scanRegionOverlayContainer)this._scanRegionOverlayContainer.before(u);else if(this._cvsScanRegion)this._cvsScanRegion.before(u);else if(this._cvsSingleFrameMode)this._cvsSingleFrameMode.after(u);else{if(!this._video)throw new Error("'_video' is lost.");this._video.after(u)}return u}_updateDrawingLayersSize(t){let i;if(i=t&&t.width&&t.height&&t.objectFit?{width:t.width,height:t.height,objectFit:t.objectFit}:this._calculateCvsSize(),!i)return;const{width:r,height:c,objectFit:u}=i;this._drawingLayersManager.setDimensions({width:r,height:c},{backstoreOnly:!0}),this._drawingLayersManager.setObjectFit(u)}_createDrawingLayer(t){this._layerBaseCvs||(this._layerBaseCvs=this._createDrawingLayerBaseCvs());const i=this._layerBaseCvs;return this._drawingLayersManager.createDrawingLayer(i,t)}createDrawingLayer(){return this._createDrawingLayer()}getDrawingLayer(t){return this._drawingLayersManager.getDrawingLayer(t)||([1,2,3].includes(t)?this._createDrawingLayer(t):null)}getDrawingLayers(){return this._drawingLayersManager.getDrawingLayers()}getSelectedDrawingItems(){return this._drawingLayersManager.getSelectedDrawingItems()}createDrawingStyle(t){return this._drawingLayersManager.createDrawingStyle(t)}getDrawingStyle(t){return this._drawingLayersManager.getDrawingStyle(t)}getDrawingStyles(){return this._drawingLayersManager.getDrawingStyles()}updateDrawingStyle(t,i){return this._drawingLayersManager.updateDrawingStyle(t,i)}clearDrawingLayers(){this._drawingLayersManager.clearDrawingLayers(),this._layerBaseCvs&&(this._layerBaseCvs.remove(),this._layerBaseCvs=null)}_createControler(){if(this._controler||(this._controler=new zf(this)),this._controler)return this._controler}_destroyControler(){this._controler=null}setOriginalImage(t,i,r){if(!t||!i||!r)throw new Error("Invalid arguments");this._originalImageData={imageData:t,width:i,height:r};let c=this._cvsOriginalImage;c||(c=document.createElement("canvas"),c.style.position="absolute",c.style.width="100%",c.style.height="100%",c.style.left="0",c.style.top="0",c.style.backgroundColor="white",c.style.objectFit="contain",this._cvsOriginalImage=c),c.width===i&&c.height===r||(c.width=i,c.height=r);const u=c.getContext("2d");u.clearRect(0,0,c.width,c.height),t instanceof Uint8Array||t instanceof Uint8ClampedArray?(t instanceof Uint8Array&&(t=new Uint8ClampedArray(t)),u.putImageData(new ImageData(t,i,r),0,0)):t instanceof HTMLCanvasElement&&u.drawImage(t,0,0),document.body.contains(c)&&c.style.display===""&&this._updateDrawingLayersSize({width:i,height:r,objectFit:"contain"})}getOriginalImage(){return this._originalImageData?Object.assign({},this._originalImageData):null}deleteOriginalImage(){return Ee(this,void 0,void 0,function*(){yield this.hideOriginalImage(),this._cvsOriginalImage&&(this._cvsOriginalImage.remove(),this._cvsOriginalImage=null),this._originalImageData=null})}_showOriginalImageCvs(){this._cvsOriginalImage&&this._cvsOriginalImage.style.display=="none"&&(this._cvsOriginalImage.style.display="")}_hideOriginalImageCvs(){this._cvsOriginalImage&&(this._cvsOriginalImage.style.display="none")}showOriginalImage(){if(!this._originalImageData)throw new Error("No original image is set.");const t=this._cvsOriginalImage;if(t.style.display===""&&document.body.contains(t))return;const{width:i,height:r}=this._originalImageData;if(this._updateDrawingLayersSize({width:i,height:r,objectFit:"contain"}),this._bOpen&&(this._video&&!this._video.paused&&this._video.pause(),this._bFetchingLoopStarted&&(this.stopFetchingLoop(),this._recordedStates.fetchingLoopStart=!0),this.ifShowScanRegionMask&&this._cvsScanRegion&&(this._cvsScanRegion.style.display="none"),this.ifShowScanRegionLaser&&this._divScanLight&&(this._divScanLight.style.display="none"),this._cvsViewDecorator&&(this._cvsViewDecorator.style.display="none"),this._scanRegionOverlayContainer&&(this._scanRegionOverlayContainer.style.display="none"),this._selCam&&(this._selCam.parentElement.style.display="none")),!document.body.contains(t))if(this._cvsSingleFrameMode)this._cvsSingleFrameMode.after(t);else{if(!this._video)throw new Error("'video' is null.");this._video.after(t)}this._showOriginalImageCvs()}_hideOriginalImage(t){return Ee(this,void 0,void 0,function*(){this._originalImageData&&this._cvsOriginalImage&&this._cvsOriginalImage.style.display!=="none"&&(this._updateDrawingLayersSize(),this._bOpen&&t&&(this._video&&this._recordedStates.videoPlaying&&(yield this.play(null,null,null,{notTriggerSingleFrameClick:!0})),this._recordedStates.fetchingLoopStart&&!this.singleFrameMode&&this.startFetchingLoop(),this.ifShowScanRegionMask&&this._cvsScanRegion&&this._recordedStates.maskShow&&this.showScanRegionMask(),this.ifShowScanRegionLaser&&this._divScanLight&&this._recordedStates.laserShow&&this.showScanRegionLaser(),this._cvsViewDecorator&&this._recordedStates.decoratorShow&&this.showViewDecorator(),this._scanRegionOverlayContainer&&this._recordedStates.overlayShow&&this.showScanRegionOverlays()),this._selCam&&(this._selCam.parentElement.style.display=""),this._hideOriginalImageCvs())})}hideOriginalImage(){return Ee(this,void 0,void 0,function*(){return this._hideOriginalImage(!0)})}dispose(t){this.UIElement&&(this._uiOriginalState&&this._uiOriginalState.inDom?this.UIElement.style.display=this._uiOriginalState.display:this.UIElement.style.display="none"),this.clearDrawingLayers(),this.close(),this.forceLoseContext(),this.setViewDecorator(null,null),this._scanRegionOverlayContainer&&this._scanRegionOverlayContainer.remove(),this._arrScanRegionOverlays.length=0,t&&this.UIElement&&this.UIElement.remove(),this.__proto__=null;for(let i in this)delete this[i];Object.defineProperty(this,"isCameraEnhancer",{value:!0}),Object.defineProperty(this,"isDisposed",{value:!0})}}fe._jsVersion="3.0.1",fe._jsEditVersion="20220803",fe._version="JS "+fe._jsVersion+"."+fe._jsEditVersion,fe.browserInfo=Ne,fe._hasEngineResourceLoaded=!1,fe._engineResourcePath=Yf,fe._defaultUIElementURL="@engineResourcePath/dce.ui.html";const qf={DT_Arc:class extends ze{constructor(e,t,i,r,c,u){super(new Ie.Circle({left:e,top:t,radius:i,startAngle:r,endAngle:c}),u),this._mediaType="arc"}},DT_Polygon:class extends ze{constructor(e,t){super(new Ie.Polygon(e,{objectCaching:!1}),t);const i=this._fabricObject;let r=i.points.length-1;i.controls=i.points.reduce(function(c,u,g){return c["p"+g]=new Ie.Control({positionHandler:Yo,actionHandler:$o(g>0?g-1:r,Xo),actionName:"modifyPolygon",pointIndex:g}),c},{})}_extendSet(e,t){if(e==="vertices"){const i=this._fabricObject;i.points=t;const r=i.points.length-1;return i.controls=i.points.reduce(function(c,u,g){return c["p"+g]=new Ie.Control({positionHandler:Yo,actionHandler:$o(g>0?g-1:r,Xo),actionName:"modifyPolygon",pointIndex:g}),c},{}),i._setPositionDimensions({}),!0}}_extendGet(e){if(e==="vertices"){const t=[],i=this._fabricObject;if(i.selectable)for(let r in i.oCoords)t.push({x:i.oCoords[r].x,y:i.oCoords[r].y});else for(let r in i.getCoords())t.push({x:i.getCoords()[r].x,y:i.getCoords()[r].y});return t}}},DT_Rect:class extends ze{constructor(e,t,i,r,c){super(new Ie.Rect({left:e,top:t,width:i,height:r}),c)}},DT_Image:class extends ze{constructor(e,t,i,r){super(new Ie.Image(e,{left:t,top:i}),r),this.image=e}_extendSet(e,t){if(e==="image"){if(t instanceof HTMLImageElement)return this._fabricObject.setElement(t),this.image=t,!0;if(t instanceof HTMLCanvasElement){const i=new Image;return i.src=t.toDataURL(),this._fabricObject.setElement(i),this.image=t,!0}throw new Error("Unsupported value.")}}_extendGet(e){if(e==="image")return this.image}},DT_Text:class extends ze{constructor(e,t,i,r){super(new Ie.IText(e,{left:t,top:i}),r),this._mediaType="text"}},DT_Line:class extends ze{constructor(e,t,i){super(new Ie.Line([e.x,e.y,t.x,t.y]),i)}_extendSet(e,t){return e==="startPoint"?(this._fabricObject.set("x1",t.x),this._fabricObject.set("y1",t.y),!0):e==="endPoint"?(this._fabricObject.set("x2",t.x),this._fabricObject.set("y2",t.y),!0):void 0}_extendGet(e){return e==="startPoint"?{x:this._fabricObject.get("x1"),y:this._fabricObject.get("y1")}:e==="endPoint"?{x:this._fabricObject.get("x2"),y:this._fabricObject.get("y2")}:void 0}},DT_Group:class extends ze{constructor(e){super(new Ie.Group(e.map(i=>i._getFabricObject())));const t=this.mapEvents;this._fabricObject.onSelect=()=>{this.styleSelector="selected";const i=this.mapEvents.get("select");for(let c of i)c&&c.apply(this);const r=this._fabricObject._objects;for(let c of r)setTimeout(()=>{c.onSelect&&c.onSelect()},0);setTimeout(()=>{this._fabricObject&&this._fabricObject.canvas&&(this._fabricObject.dirty=!0,this._fabricObject.canvas.renderAll())},0)},this._fabricObject.onDeselect=()=>{this.styleSelector="default";const i=t.get("deselect");for(let c of i)c&&c.apply(this);const r=this._fabricObject._objects;for(let c of r)setTimeout(()=>{c.onDeselect&&c.onDeselect()},0);setTimeout(()=>{this._fabricObject&&this._fabricObject.canvas&&(this._fabricObject.dirty=!0,this._fabricObject.canvas.renderAll())},0)}}getChildItems(){return this._fabricObject._objects.map(e=>e.getDrawingItem())}addChildItem(e){if(!e||!e.isDrawingItem)throw TypeError("Illegal drawing item.");this._drawingLayer?this._drawingLayer._updateGroupItem(this,e,"add"):this._fabricObject.addWithUpdate(e._getFabricObject())}removeChildItem(e){e&&e.isDrawingItem&&(this._drawingLayer?this._drawingLayer._updateGroupItem(this,e,"remove"):this._fabricObject.removeWithUpdate(e._getFabricObject()))}}};class kt extends W{constructor(){super(),this._barcodeFillStyle="rgba(254,180,32,0.3)",this._barcodeStrokeStyle="rgba(254,180,32,0.9)",this._barcodeLineWidth=1,this._barcodeFillStyleBeforeVerification="rgba(248,252,0,0.2)",this._barcodeStrokeStyleBeforeVerification="transparent",this._barcodeLineWidthBeforeVerification=2,this.bFilterRegionInJs=!0,this._onCameraSelChange=()=>{},this._onResolutionSelChange=()=>{},this._onCloseBtnClick=()=>{},this._onPlayed=null}static get version(){return this._version+`(DCE ${fe.getVersion()})`}static _fireHTTPSWarnning(){kt.onWarning&&location&&location.protocol!=="https:"&&setTimeout(()=>{kt.onWarning&&kt.onWarning({id:2,message:"Not connected via SSL (HTTPS), the SDK may not work correctly."})},0)}_fireResolutionWarning(){if(!this.singleFrameMode&&this.onWarning&&this.dce.isOpen()){const t=this.dce.getConstraints();t&&t.width<1280&&t.height<720&&setTimeout(()=>{this.onWarning&&this.onWarning({id:3,message:"Camera resolution too low, please use a higher resolution (720P or better)."})},0)}}getUIElement(){return this.dce.getUIElement()}async setUIElement(t){await this.dce.setUIElement(t)}get singleFrameMode(){return this.dce.singleFrameMode}set singleFrameMode(t){this.dce.singleFrameMode=t,t&&(this.dce.ifShowScanRegionLaser=!1,(async()=>{let i=await this.getScanSettings();i.oneDTrustFrameCount=1,await this.updateScanSettings(i)})())}get onUnduplicatedRead(){return this.onUniqueRead}set onUnduplicatedRead(t){this.onUniqueRead=t}get video(){return this.dce&&this.dce.video}set videoSrc(t){this.dce&&(this.dce.videoSrc=t)}get videoSrc(){return this.dce&&this.dce.videoSrc}_assertOpen(){if(!this.dce.isOpen())throw Error("The scanner is not open.")}set barcodeFillStyle(t){this._barcodeFillStyle=t,this.dce&&this.dce.updateDrawingStyle(3,{fillStyle:t})}get barcodeFillStyle(){return this._barcodeFillStyle}set barcodeStrokeStyle(t){this._barcodeStrokeStyle=t,this.dce&&this.dce.updateDrawingStyle(3,{strokeStyle:t})}get barcodeStrokeStyle(){return this._barcodeStrokeStyle}set barcodeLineWidth(t){this._barcodeLineWidth=t,this.dce&&this.dce.updateDrawingStyle(3,{lineWidth:t})}get barcodeLineWidth(){return this._barcodeLineWidth}set barcodeFillStyleBeforeVerification(t){this._barcodeFillStyleBeforeVerification=t,this._styleIdBeforeVerification&&this.dce.updateDrawingStyle(this._styleIdBeforeVerification,{fillStyle:t})}get barcodeFillStyleBeforeVerification(){return this._barcodeFillStyleBeforeVerification}set barcodeStrokeStyleBeforeVerification(t){this._barcodeStrokeStyleBeforeVerification=t,this._styleIdBeforeVerification&&this.dce.updateDrawingStyle(this._styleIdBeforeVerification,{strokeStyle:t})}get barcodeStrokeStyleBeforeVerification(){return this._barcodeStrokeStyleBeforeVerification}set barcodeLineWidthBeforeVerification(t){this._barcodeLineWidthBeforeVerification=t,this._styleIdBeforeVerification&&this.dce.updateDrawingStyle(this._styleIdBeforeVerification,{lineWidth:t})}get barcodeLineWidthBeforeVerification(){return this._barcodeLineWidthBeforeVerification}set regionMaskFillStyle(t){this.dce.setScanRegionMaskStyle({fillStyle:t})}get regionMaskFillStyle(){return this.dce.regionMaskFillStyle}set regionMaskStrokeStyle(t){this.dce.setScanRegionMaskStyle({strokeStyle:t})}get regionMaskStrokeStyle(){return this.dce.regionMaskStrokeStyle}set regionMaskLineWidth(t){this.dce.setScanRegionMaskStyle({lineWidth:t})}get regionMaskLineWidth(){return this.dce.regionMaskLineWidth}set region(t){this._region=t,this.dce&&(t?t instanceof Array||this.dce.setScanRegion(t):this.dce.setScanRegion(null)),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0}get region(){return this._region}set ifSaveOriginalImageInACanvas(t){this._ifSaveOriginalImageInACanvas=t,this.dce.frameColorMode=t?"rgba":"grey"}get ifSaveOriginalImageInACanvas(){return this._ifSaveOriginalImageInACanvas}async createDCEInstance(){this.dce||(W._onLog&&W._onLog("createDCEInstance()"),fe.defaultUIElementURL=null,this.dce=await fe.createInstance(),this.dce.refreshInterval=200,this.dce.frameColorMode="grey",this.dce.maxCvsSideLength=this.maxCvsSideLength,this._drawingItemNamespace=qf,W.browserInfo.OS!=="iPhone"&&W.browserInfo.OS!=="Android"&&W.browserInfo.OS!=="HarmonyOS"&&this.dce.setResolution(1920,1080),this._styleIdBeforeVerification=this.dce.createDrawingStyle({fillStyle:"rgba(248,252,0,0.2)",strokeStyle:"transparent",paintMode:"strokeAndFill"}),this.barcodeLineWidth=this._barcodeLineWidth,this.dce.on("cameraChange",()=>{this._drawResults(null),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0}),this.dce.on("resolutionChange",()=>{this._drawResults(null),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0}),this.dce.on("cameraClose",()=>{this._drawResults(null),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0,this._bPauseScan=!1}),this.dce.on("singleFrameAcquired",async t=>{if(!t||!t.data)return;let i;this.ifSaveOriginalImageInACanvas&&(this.oriCanvas=null,this.oriCanvasData={width:t.width,height:t.height,colorMode:t.colorMode,data:new Uint8Array(t.data),toCanvas:t.toCanvas});const{data:r,sx:c,sy:u,width:g,height:v,colorMode:b,timeStamp:S,_sWidth:w,_sHeight:E}=t,A={timeStamp:S};if(b==="grey")i=await this._decodeBuffer_Uint8Array(r,g,v,g,Be.IPF_GrayScaled,A);else if(b==="rgba")i=await this._decodeBuffer_Uint8Array(r,g,v,4*g,Be.IPF_ABGR_8888,A);else{if(b!=="bgra")throw new Error(`Color mode '${b}' is not supported.`);i=await this._decodeBuffer_Uint8Array(r,g,v,4*g,Be.IPF_ARGB_8888,A)}if(await this.clearMapDecodeRecord(),W.recalculateResultLocation(i,c,u,w,E,g,v),this._drawResults(i),this.onFrameRead&&this.isOpen()&&!this._bPauseScan){let B=this._cloneDecodeResults(i);this.onFrameRead(B)}if(this.onUniqueRead&&this.isOpen()&&!this._bPauseScan)for(let B of i)this.onUniqueRead(B.barcodeText,this._cloneDecodeResults(B))}))}set maxCvsSideLength(t){this._maxCvsSideLength=t,this.dce.maxCvsSideLength=t}get maxCvsSideLength(){return this._maxCvsSideLength}static async createInstance(t){let i=new kt;i._instanceID=await kt.createInstanceInWorker(!0),await i.createDCEInstance(),typeof t=="string"&&(t=JSON.parse(t));for(let r in t)i[r]=t[r];return await i.dce.setUIElement(kt.defaultUIElementURL),i.singleFrameMode&&console.warn("The `navigator.mediaDevices.getUserMedia` is unavailable. automatically change to `singleFrameMode`."),kt._fireHTTPSWarnning(),i.singleFrameMode||await i.updateRuntimeSettings("single"),i}async decodeCurrentFrame(t){this._assertOpen();let i=null;t&&t.region&&(i=t.region);const r=this.dce._getVideoFrame(i);return this._decode_DCEFrame(r)}async updateRuntimeSettings(t){let i;if(typeof t=="string")if(t=="speed"){let r=await this.getRuntimeSettings();await this.resetRuntimeSettings(),i=await this.getRuntimeSettings(),i.barcodeFormatIds=r.barcodeFormatIds,i.barcodeFormatIds_2=r.barcodeFormatIds_2,r.region&&(i.region=r.region),i.expectedBarcodesCount=0,i.localizationModes=[2,0,0,0,0,0,0,0],i.barcodeZoneMinDistanceToImageBorders=9}else if(t=="balance"){let r=await this.getRuntimeSettings();await this.resetRuntimeSettings(),i=await this.getRuntimeSettings(),i.barcodeFormatIds=r.barcodeFormatIds,i.barcodeFormatIds_2=r.barcodeFormatIds_2,r.region&&(i.region=r.region),i.expectedBarcodesCount=512,i.deblurLevel=3,i.localizationModes=[2,16,0,0,0,0,0,0],i.barcodeZoneMinDistanceToImageBorders=9,i.timeout=1e5}else if(t=="coverage"){let r=await this.getRuntimeSettings();await this.resetRuntimeSettings(),i=await this.getRuntimeSettings(),i.barcodeFormatIds=r.barcodeFormatIds,i.barcodeFormatIds_2=r.barcodeFormatIds_2,r.region&&(i.region=r.region),i.expectedBarcodesCount=512,i.deblurLevel=5,i.scaleDownThreshold=1e5,i.localizationModes=[2,16,4,8,0,0,0,0],i.barcodeZoneMinDistanceToImageBorders=9,i.timeout=1e5}else if(t=="single"){let r=await this.getRuntimeSettings();await this.resetRuntimeSettings(),i=await this.getRuntimeSettings(),i.barcodeFormatIds=r.barcodeFormatIds,i.barcodeFormatIds_2=r.barcodeFormatIds_2,r.region&&(i.region=r.region)}else if(t=="dense"){let r=await this.getRuntimeSettings();await this.resetRuntimeSettings(),this.maxCvsSideLength=4096,i=await this.getRuntimeSettings(),i.barcodeFormatIds=r.barcodeFormatIds,i.barcodeFormatIds_2=r.barcodeFormatIds_2,r.region&&(i.region=r.region),i.expectedBarcodesCount=0,i.deblurLevel=7,i.scaleDownThreshold=1e5,i.localizationModes=[2,8,0,0,0,0,0,0],i.minResultConfidence=0,i.barcodeZoneMinDistanceToImageBorders=9,i.timeout=1e5}else if(t=="distance"){let r=await this.getRuntimeSettings();await this.resetRuntimeSettings(),this.maxCvsSideLength=4096,i=await this.getRuntimeSettings(),i.barcodeFormatIds=r.barcodeFormatIds,i.barcodeFormatIds_2=r.barcodeFormatIds_2,r.region&&(i.region=r.region),i.expectedBarcodesCount=0,i.scaleDownThreshold=1e5,i.localizationModes=[2,8,0,0,0,0,0,0],i.barcodeZoneMinDistanceToImageBorders=9,i.timeout=1e5}else i=JSON.parse(t);else{if(typeof t!="object")throw TypeError("'UpdateRuntimeSettings(settings)': Type of 'settings' should be 'string' or 'PlainObject'.");if(i=JSON.parse(JSON.stringify(t)),i.region instanceof Array){let r=t.region;[r.regionLeft,r.regionTop,r.regionLeft,r.regionBottom,r.regionMeasuredByPercentage].some(c=>c!==void 0)&&(i.region={regionLeft:r.regionLeft||0,regionTop:r.regionTop||0,regionRight:r.regionRight||0,regionBottom:r.regionBottom||0,regionMeasuredByPercentage:r.regionMeasuredByPercentage||0})}}if(!W._bUseFullFeature){if((i.barcodeFormatIds&~(wt.BF_ONED|wt.BF_QR_CODE|wt.BF_PDF417|wt.BF_DATAMATRIX))!=0||i.barcodeFormatIds_2!=0)throw Error("Some of the specified barcode formats are not supported in the compact version. Please try the full-featured version.");if(i.intermediateResultTypes!=0)throw Error("Intermediate results is not supported in the compact version. Please try the full-featured version.")}{let r=i.region;if(this.bFilterRegionInJs?this.userDefinedRegion=JSON.parse(JSON.stringify(r)):this.userDefinedRegion=null,r instanceof Array)if(r.length){for(let c=0;c<r.length;++c){let u=r[c];u&&((u.regionLeft||u.regionTop||u.regionRight||u.regionBottom||u.regionMeasuredByPercentage)&&(u.regionLeft||u.regionTop||u.regionRight!=100||u.regionBottom!=100||!u.regionMeasuredByPercentage)||(r[c]=null))}this.region=r}else this.region=null;else r&&(r.regionLeft||r.regionTop||r.regionRight||r.regionBottom||r.regionMeasuredByPercentage)&&(r.regionLeft||r.regionTop||r.regionRight!=100||r.regionBottom!=100||!r.regionMeasuredByPercentage)?this.region=r:this.region=null;this.bFilterRegionInJs&&(i.region={regionLeft:0,regionTop:0,regionRight:0,regionBottom:0,regionMeasuredByPercentage:0})}await new Promise((r,c)=>{let u=W._nextTaskID++;W._taskCallbackMap.set(u,g=>{if(g.success){try{this._handleRetJsonString(g.updateReturn)}catch(v){c(v)}return r()}{let v=new Error(g.message);return v.stack=g.stack+`
`+v.stack,c(v)}}),W._dbrWorker.postMessage({type:"updateRuntimeSettings",id:u,instanceID:this._instanceID,body:{settings:JSON.stringify(i)}})}),typeof t=="string"&&["speed","balance","coverage","dense","distance"].includes(t)&&(await this.setModeArgument("BinarizationModes",0,"EnableFillBinaryVacancy","1"),await this.setModeArgument("BinarizationModes",0,"BlockSizeX","0"),await this.setModeArgument("BinarizationModes",0,"BlockSizeY","0"))}_bindUI(){if(!this.getUIElement())throw new Error("Need to define `UIElement` before opening.");if(this.dce._bindUI(),!this.dce.video)throw this._unbindUI(),Error("Can not find the video container element with class 'dce-video-container'")}_unbindUI(){this.dce._unbindUI()}set onPlayed(t){this.dce.off("played",this._onPlayed),this._onPlayed=t,this.dce.on("played",this._onPlayed)}get onPlayed(){return this._onPlayed}async getAllCameras(){return this.dce.getAllCameras()}async getCurrentCamera(){return this.dce.getSelectedCamera()}async setCurrentCamera(t){const i=await this.dce.selectCamera(t);return this._fireResolutionWarning(),i}getResolution(){return this.dce.getResolution()}async setResolution(t,i){const r=await this.dce.setResolution(t,i);return this._fireResolutionWarning(),r}getVideoSettings(){return this.dce.getVideoSettings()}updateVideoSettings(t){return this.dce.updateVideoSettings(t)}isOpen(){return this.dce&&this.dce.isOpen()}setVideoFit(t){return this.dce&&this.dce.setVideoFit(t)}set ifShowScanRegionMask(t){this.dce&&(this.dce.ifShowScanRegionMask=t)}get ifShowScanRegionMask(){return this.dce&&this.dce.ifShowScanRegionMask}set ifSaveLastUsedCamera(t){this.dce&&(this.dce.ifSaveLastUsedCamera=t)}get ifSaveLastUsedCamera(){return this.dce&&this.dce.ifSaveLastUsedCamera}set ifSkipCameraInspection(t){this.dce&&(this.dce.ifSkipCameraInspection=t)}get ifSkipCameraInspection(){return this.dce&&this.dce.ifSkipCameraInspection}stop(){this._drawResults(null),this.dce.stop(),this.dce.ifShowScanRegionLaser=!1,this.dce.hideViewDecorator(),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0}pause(){this.dce.pause()}async play(t,i,r){this.dce.ifShowScanRegionLaser=!0;const c=await this.dce.play(t,i,r);return this._fireResolutionWarning(),c}pauseScan(t){this._assertOpen(),t&&t.keepResultsHighlighted||this._drawResults(null),this._bPauseScan=!0,this.dce.ifShowScanRegionLaser=!1,this.dce.stopFetchingLoop()}resumeScan(){this._assertOpen(),this._bPauseScan=!1,this.dce.ifShowScanRegionLaser=!0}getCapabilities(){return this.dce.getCapabilities()}getCameraSettings(){return this.dce.getCameraSettings()}getConstraints(){return this.dce.getConstraints()}async applyConstraints(t){return this.dce.applyConstraints(t)}async turnOnTorch(){return this.dce.turnOnTorch()}async turnOffTorch(){return this.dce.turnOffTorch()}async setColorTemperature(t){return this.dce.setColorTemperature(t)}async setExposureCompensation(t){return this.dce.setExposureCompensation(t)}async setZoom(t){return this.dce.setZoom(t)}async setFrameRate(t){return this.dce.setFrameRate(t)}getFrameRate(){return this.dce.getFrameRate()}async setFocus(t,i){return this.dce.setFocus(t,i)}getFocus(){return this.dce.getFocus()}async _loopReadVideo(){if(this.bDestroyed)return this.dce&&this.dce.stopFetchingLoop(),void this._drawResults(null);if(!this.isOpen())return this._drawResults(null),void await this.clearMapDecodeRecord();if(!this.dce.video||this.dce.video.paused||this._bPauseScan)return W._onLog&&W._onLog("Video or scan is paused. Ask in 1s."),await this.clearMapDecodeRecord(),this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),void(this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},this._intervalDetectVideoPause));W._onLog&&W._onLog("======= once read ======="),W._onLog&&(this._timeStartDecode=Date.now());const t=this._getVideoFrame();if(!t)return W._onLog&&W._onLog("Get invalid frame."),this._drawResults(null),this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),void(this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},0));(async()=>{t._bUseWebGL||t.colorMode!=="grey"||(this.dce.frameColorMode="rgba");let i=[];this.ifSaveOriginalImageInACanvas&&(this.oriCanvas=null,this.oriCanvasData={width:t.width,height:t.height,colorMode:t.colorMode,data:new Uint8Array(t.data),toCanvas:t.toCanvas});const{data:r,sx:c,sy:u,width:g,height:v,colorMode:b,timeStamp:S,_sWidth:w,_sHeight:E}=t,A={timeStamp:S};if(b==="grey")i=await this._decodeBuffer_Uint8Array(r,g,v,g,Be.IPF_GrayScaled,A);else if(b==="rgba")i=await this._decodeBuffer_Uint8Array(r,g,v,4*g,Be.IPF_ABGR_8888,A);else{if(b!=="bgra")throw new Error(`Color mode '${b}' is not supported.`);i=await this._decodeBuffer_Uint8Array(r,g,v,4*g,Be.IPF_ARGB_8888,A)}return W.recalculateResultLocation(i,c,u,w,E,g,v),this._drawResults(i),i})().then(i=>{if(W._onLog&&W._onLog(i),this.captureAndDecodeInParallel){let r=this.array_decodeFrameTimeCost,c=this.array_getFrameTimeCost,u=this._indexCurrentDecodingFrame;const g=()=>{let v=0;if(this.region instanceof Array){let b=0,S=0;b=u+1>=this.region.length?0:u+1,S=b+1>=this.region.length?0:b+1,v=r[b]&&r[b].length&&c[S]&&c[S].length?Math.min(...r[b])-Math.max(...c[S]):0}else if(c&&c.length){let b=Math.min(...r),S=Math.max(...c);b&&S&&(v=b-S)}else v=0;return v>0?v:0};(()=>{if(this.region instanceof Array){for(r[u]&&r[u]instanceof Array||(r[u]=[]);r[u].length>=5;)r[u].shift();r[u].push(this._lastInnerDecodeDuration)}else{for(;r.length>=5;)r.shift();r.push(this._lastInnerDecodeDuration)}})(),this._intervalGetVideoFrame=g()+this.intervalTime,W._onLog&&W._onLog("Next fetching frame loop interval: "+this._intervalGetVideoFrame)}if(this.isOpen()&&this.dce.video&&!this.dce.video.paused&&!this._bPauseScan){if(this.bPlaySoundOnSuccessfulRead&&i.length){let r=!1;this.bPlaySoundOnSuccessfulRead===!0||this.bPlaySoundOnSuccessfulRead==="frame"?r=i.some(c=>c.resultState>=0):this.bPlaySoundOnSuccessfulRead==="unique"&&(r=i.some(c=>c.resultState===0)),r&&(this.beepSound.stop(),this.beepSound.play())}if(navigator.vibrate&&this.bVibrateOnSuccessfulRead&&i.length){let r=!1;if(this.bVibrateOnSuccessfulRead===!0||this.bVibrateOnSuccessfulRead==="frame"?r=i.some(c=>c.resultState>=0):this.bVibrateOnSuccessfulRead==="unique"&&(r=i.some(c=>c.resultState===0)),r)try{navigator.vibrate(this.vibrateDuration)}catch(c){console.warn("Vibration not allowed. User interaction required: "+(c.message||c))}}if(this.onFrameRead){i=i.filter(c=>c.resultState>=0);const r=this._cloneDecodeResults(i);this.onFrameRead(r)}if(this.onUniqueRead){i=i.filter(c=>c.resultState==0);const r=this._cloneDecodeResults(i);for(let c of r)this.onUniqueRead(c.barcodeText,c)}}this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this.intervalTime?this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},this.intervalTime):this._loopReadVideo()}).catch(i=>{this.dce.stopFetchingLoop(),W._onLog&&W._onLog(i.message||i),this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},Math.max(this.intervalTime,1e3)),i.message=="platform error"||console.warn(i.message||i)})}_getVideoFrame(){if(!this.dce)return null;let t;if(this.captureAndDecodeInParallel){W._onLog&&W._onLog("Get frame in parallel.");let i=this.dce.isFetchingLoopStarted();if(this.dce.loopInterval=this._intervalGetVideoFrame,i||this.dce.startFetchingLoop(),!this.dce.numberOfFramesInBuffer)return this.dce.loopInterval=0,null;t=this.dce.getFrameFromBuffer(),(c=>{if(!c)return;let u=c.timeSpent,g=this.array_getFrameTimeCost;for(;g.length>=5;)g.shift();g.push(u)})(t)}else W._onLog&&W._onLog("Get frame in serial."),this.dce.stopFetchingLoop(),t=this.dce.getFrame();return t}async open(){this._bindUI();const t=await this.dce.open();return this._bPauseScan=!1,this.singleFrameMode||(this.dce&&(this.dce.ifShowScanRegionLaser=!0),this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},0)),this._fireResolutionWarning(),this.keepAlive(),t}async openVideo(){this._bindUI(),this.dce.ifShowScanRegionLaser=!1;const t=await this.dce.open();return this._bPauseScan=!0,this.singleFrameMode||(this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},0)),this._fireResolutionWarning(),this.keepAlive(),t}close(){this.dce.close(),this._bPauseScan=!0,this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId)}async show(){this._bindUI();const t=await this.dce.open(!0);return this._bPauseScan=!1,this.singleFrameMode||(this.dce&&(this.dce.ifShowScanRegionLaser=!0),this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},0)),this._fireResolutionWarning(),this.keepAlive(),t}async showVideo(){this._bindUI(),this.dce.ifShowScanRegionLaser=!1;const t=await this.dce.open(!0);return this._bPauseScan=!0,this.singleFrameMode||(this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},0)),this._fireResolutionWarning(),this.keepAlive(),t}hide(){this.dce.close(!0),this._bPauseScan=!0,this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId)}destroyContext(){this.close(),this.dce&&this.dce.dispose(!1),this.bDestroyed||super.destroyContext()}}var zo,qo,Jo,Ko,Qo,Zo,ea,ta,ia,na,ra,sa,oa,aa,la,ca,ha,ua,da,fa,ga,pa,_a,ma,va,ya,ba;(function(e){e[e.BICM_DARK_ON_LIGHT=1]="BICM_DARK_ON_LIGHT",e[e.BICM_LIGHT_ON_DARK=2]="BICM_LIGHT_ON_DARK",e[e.BICM_DARK_ON_DARK=4]="BICM_DARK_ON_DARK",e[e.BICM_LIGHT_ON_LIGHT=8]="BICM_LIGHT_ON_LIGHT",e[e.BICM_DARK_LIGHT_MIXED=16]="BICM_DARK_LIGHT_MIXED",e[e.BICM_DARK_ON_LIGHT_DARK_SURROUNDING=32]="BICM_DARK_ON_LIGHT_DARK_SURROUNDING",e[e.BICM_SKIP=0]="BICM_SKIP",e[e.BICM_REV=2147483648]="BICM_REV"})(zo||(zo={})),function(e){e[e.BCM_AUTO=1]="BCM_AUTO",e[e.BCM_GENERAL=2]="BCM_GENERAL",e[e.BCM_SKIP=0]="BCM_SKIP",e[e.BCM_REV=2147483648]="BCM_REV"}(qo||(qo={})),function(e){e[e.BF2_NULL=0]="BF2_NULL",e[e.BF2_POSTALCODE=32505856]="BF2_POSTALCODE",e[e.BF2_NONSTANDARD_BARCODE=1]="BF2_NONSTANDARD_BARCODE",e[e.BF2_USPSINTELLIGENTMAIL=1048576]="BF2_USPSINTELLIGENTMAIL",e[e.BF2_POSTNET=2097152]="BF2_POSTNET",e[e.BF2_PLANET=4194304]="BF2_PLANET",e[e.BF2_AUSTRALIANPOST=8388608]="BF2_AUSTRALIANPOST",e[e.BF2_RM4SCC=16777216]="BF2_RM4SCC",e[e.BF2_DOTCODE=2]="BF2_DOTCODE",e[e.BF2_PHARMACODE_ONE_TRACK=4]="BF2_PHARMACODE_ONE_TRACK",e[e.BF2_PHARMACODE_TWO_TRACK=8]="BF2_PHARMACODE_TWO_TRACK",e[e.BF2_PHARMACODE=12]="BF2_PHARMACODE"}(Jo||(Jo={})),function(e){e[e.BM_AUTO=1]="BM_AUTO",e[e.BM_LOCAL_BLOCK=2]="BM_LOCAL_BLOCK",e[e.BM_SKIP=0]="BM_SKIP",e[e.BM_THRESHOLD=4]="BM_THRESHOLD",e[e.BM_REV=2147483648]="BM_REV"}(Ko||(Ko={})),function(e){e[e.ECCM_CONTRAST=1]="ECCM_CONTRAST"}(Qo||(Qo={})),function(e){e[e.CFM_GENERAL=1]="CFM_GENERAL"}(Zo||(Zo={})),function(e){e[e.CCM_AUTO=1]="CCM_AUTO",e[e.CCM_GENERAL_HSV=2]="CCM_GENERAL_HSV",e[e.CCM_SKIP=0]="CCM_SKIP",e[e.CCM_REV=2147483648]="CCM_REV"}(ea||(ea={})),function(e){e[e.CICM_GENERAL=1]="CICM_GENERAL",e[e.CICM_SKIP=0]="CICM_SKIP",e[e.CICM_REV=2147483648]="CICM_REV"}(ta||(ta={})),function(e){e[e.CM_IGNORE=1]="CM_IGNORE",e[e.CM_OVERWRITE=2]="CM_OVERWRITE"}(ia||(ia={})),function(e){e[e.DM_SKIP=0]="DM_SKIP",e[e.DM_DIRECT_BINARIZATION=1]="DM_DIRECT_BINARIZATION",e[e.DM_THRESHOLD_BINARIZATION=2]="DM_THRESHOLD_BINARIZATION",e[e.DM_GRAY_EQUALIZATION=4]="DM_GRAY_EQUALIZATION",e[e.DM_SMOOTHING=8]="DM_SMOOTHING",e[e.DM_MORPHING=16]="DM_MORPHING",e[e.DM_DEEP_ANALYSIS=32]="DM_DEEP_ANALYSIS",e[e.DM_SHARPENING=64]="DM_SHARPENING",e[e.DM_BASED_ON_LOC_BIN=128]="DM_BASED_ON_LOC_BIN",e[e.DM_SHARPENING_SMOOTHING=256]="DM_SHARPENING_SMOOTHING"}(na||(na={})),function(e){e[e.DRM_AUTO=1]="DRM_AUTO",e[e.DRM_GENERAL=2]="DRM_GENERAL",e[e.DRM_BROAD_WARP=4]="DRM_BROAD_WARP",e[e.DRM_LOCAL_REFERENCE=8]="DRM_LOCAL_REFERENCE",e[e.DRM_DEWRINKLE=16]="DRM_DEWRINKLE",e[e.DRM_SKIP=0]="DRM_SKIP",e[e.DRM_REV=2147483648]="DRM_REV"}(ra||(ra={})),function(e){e[e.DPMCRM_AUTO=1]="DPMCRM_AUTO",e[e.DPMCRM_GENERAL=2]="DPMCRM_GENERAL",e[e.DPMCRM_SKIP=0]="DPMCRM_SKIP",e[e.DPMCRM_REV=2147483648]="DPMCRM_REV"}(sa||(sa={})),function(e){e[e.GTM_INVERTED=1]="GTM_INVERTED",e[e.GTM_ORIGINAL=2]="GTM_ORIGINAL",e[e.GTM_SKIP=0]="GTM_SKIP",e[e.GTM_REV=2147483648]="GTM_REV"}(oa||(oa={})),function(e){e[e.IPM_AUTO=1]="IPM_AUTO",e[e.IPM_GENERAL=2]="IPM_GENERAL",e[e.IPM_GRAY_EQUALIZE=4]="IPM_GRAY_EQUALIZE",e[e.IPM_GRAY_SMOOTH=8]="IPM_GRAY_SMOOTH",e[e.IPM_SHARPEN_SMOOTH=16]="IPM_SHARPEN_SMOOTH",e[e.IPM_MORPHOLOGY=32]="IPM_MORPHOLOGY",e[e.IPM_SKIP=0]="IPM_SKIP",e[e.IPM_REV=2147483648]="IPM_REV"}(aa||(aa={})),function(e){e[e.IRSM_MEMORY=1]="IRSM_MEMORY",e[e.IRSM_FILESYSTEM=2]="IRSM_FILESYSTEM",e[e.IRSM_BOTH=4]="IRSM_BOTH"}(la||(la={})),function(e){e[e.IRT_NO_RESULT=0]="IRT_NO_RESULT",e[e.IRT_ORIGINAL_IMAGE=1]="IRT_ORIGINAL_IMAGE",e[e.IRT_COLOUR_CLUSTERED_IMAGE=2]="IRT_COLOUR_CLUSTERED_IMAGE",e[e.IRT_COLOUR_CONVERTED_GRAYSCALE_IMAGE=4]="IRT_COLOUR_CONVERTED_GRAYSCALE_IMAGE",e[e.IRT_TRANSFORMED_GRAYSCALE_IMAGE=8]="IRT_TRANSFORMED_GRAYSCALE_IMAGE",e[e.IRT_PREDETECTED_REGION=16]="IRT_PREDETECTED_REGION",e[e.IRT_PREPROCESSED_IMAGE=32]="IRT_PREPROCESSED_IMAGE",e[e.IRT_BINARIZED_IMAGE=64]="IRT_BINARIZED_IMAGE",e[e.IRT_TEXT_ZONE=128]="IRT_TEXT_ZONE",e[e.IRT_CONTOUR=256]="IRT_CONTOUR",e[e.IRT_LINE_SEGMENT=512]="IRT_LINE_SEGMENT",e[e.IRT_FORM=1024]="IRT_FORM",e[e.IRT_SEGMENTATION_BLOCK=2048]="IRT_SEGMENTATION_BLOCK",e[e.IRT_TYPED_BARCODE_ZONE=4096]="IRT_TYPED_BARCODE_ZONE",e[e.IRT_PREDETECTED_QUADRILATERAL=8192]="IRT_PREDETECTED_QUADRILATERAL"}(ca||(ca={})),function(e){e[e.LM_SKIP=0]="LM_SKIP",e[e.LM_AUTO=1]="LM_AUTO",e[e.LM_CONNECTED_BLOCKS=2]="LM_CONNECTED_BLOCKS",e[e.LM_LINES=8]="LM_LINES",e[e.LM_STATISTICS=4]="LM_STATISTICS",e[e.LM_SCAN_DIRECTLY=16]="LM_SCAN_DIRECTLY",e[e.LM_STATISTICS_MARKS=32]="LM_STATISTICS_MARKS",e[e.LM_STATISTICS_POSTAL_CODE=64]="LM_STATISTICS_POSTAL_CODE",e[e.LM_CENTRE=128]="LM_CENTRE",e[e.LM_ONED_FAST_SCAN=256]="LM_ONED_FAST_SCAN",e[e.LM_REV=2147483648]="LM_REV"}(ha||(ha={})),function(e){e[e.PDFRM_RASTER=1]="PDFRM_RASTER",e[e.PDFRM_AUTO=2]="PDFRM_AUTO",e[e.PDFRM_VECTOR=4]="PDFRM_VECTOR",e[e.PDFRM_REV=2147483648]="PDFRM_REV"}(ua||(ua={})),function(e){e[e.QRECL_ERROR_CORRECTION_H=0]="QRECL_ERROR_CORRECTION_H",e[e.QRECL_ERROR_CORRECTION_L=1]="QRECL_ERROR_CORRECTION_L",e[e.QRECL_ERROR_CORRECTION_M=2]="QRECL_ERROR_CORRECTION_M",e[e.QRECL_ERROR_CORRECTION_Q=3]="QRECL_ERROR_CORRECTION_Q"}(da||(da={})),function(e){e[e.RPM_AUTO=1]="RPM_AUTO",e[e.RPM_GENERAL=2]="RPM_GENERAL",e[e.RPM_GENERAL_RGB_CONTRAST=4]="RPM_GENERAL_RGB_CONTRAST",e[e.RPM_GENERAL_GRAY_CONTRAST=8]="RPM_GENERAL_GRAY_CONTRAST",e[e.RPM_GENERAL_HSV_CONTRAST=16]="RPM_GENERAL_HSV_CONTRAST",e[e.RPM_SKIP=0]="RPM_SKIP",e[e.RPM_REV=2147483648]="RPM_REV"}(fa||(fa={})),function(e){e[e.RCT_PIXEL=1]="RCT_PIXEL",e[e.RCT_PERCENTAGE=2]="RCT_PERCENTAGE"}(ga||(ga={})),function(e){e[e.RT_STANDARD_TEXT=0]="RT_STANDARD_TEXT",e[e.RT_RAW_TEXT=1]="RT_RAW_TEXT",e[e.RT_CANDIDATE_TEXT=2]="RT_CANDIDATE_TEXT",e[e.RT_PARTIAL_TEXT=3]="RT_PARTIAL_TEXT"}(pa||(pa={})),function(e){e[e.SUM_AUTO=1]="SUM_AUTO",e[e.SUM_LINEAR_INTERPOLATION=2]="SUM_LINEAR_INTERPOLATION",e[e.SUM_NEAREST_NEIGHBOUR_INTERPOLATION=4]="SUM_NEAREST_NEIGHBOUR_INTERPOLATION",e[e.SUM_SKIP=0]="SUM_SKIP",e[e.SUM_REV=2147483648]="SUM_REV"}(_a||(_a={})),function(e){e[e.TP_REGION_PREDETECTED=1]="TP_REGION_PREDETECTED",e[e.TP_IMAGE_PREPROCESSED=2]="TP_IMAGE_PREPROCESSED",e[e.TP_IMAGE_BINARIZED=4]="TP_IMAGE_BINARIZED",e[e.TP_BARCODE_LOCALIZED=8]="TP_BARCODE_LOCALIZED",e[e.TP_BARCODE_TYPE_DETERMINED=16]="TP_BARCODE_TYPE_DETERMINED",e[e.TP_BARCODE_RECOGNIZED=32]="TP_BARCODE_RECOGNIZED"}(ma||(ma={})),function(e){e[e.TFM_AUTO=1]="TFM_AUTO",e[e.TFM_GENERAL_CONTOUR=2]="TFM_GENERAL_CONTOUR",e[e.TFM_SKIP=0]="TFM_SKIP",e[e.TFM_REV=2147483648]="TFM_REV"}(va||(va={})),function(e){e[e.TROM_CONFIDENCE=1]="TROM_CONFIDENCE",e[e.TROM_POSITION=2]="TROM_POSITION",e[e.TROM_FORMAT=4]="TROM_FORMAT",e[e.TROM_SKIP=0]="TROM_SKIP",e[e.TROM_REV=2147483648]="TROM_REV"}(ya||(ya={})),function(e){e[e.TDM_AUTO=1]="TDM_AUTO",e[e.TDM_GENERAL_WIDTH_CONCENTRATION=2]="TDM_GENERAL_WIDTH_CONCENTRATION",e[e.TDM_SKIP=0]="TDM_SKIP",e[e.TDM_REV=2147483648]="TDM_REV"}(ba||(ba={}));W.license="f0068NQAAABlh/1ZxArnC9aocfPLd9sDNK8pTY4/jFT1KdMh9830owey05B/ZqQUIAHC5uybNv6A7OFEbLLAP4xJAhQbTAuI=";W.engineResourcePath="https://npm.scannerproxy.com/cdn/dynamsoft-javascript-barcode@9.3.1/dist/";/*!
  * vue-router v4.1.6
  * (c) 2022 Eduardo San Martin Morote
  * @license MIT
  */const Ft=typeof window<"u";function Jf(e){return e.__esModule||e[Symbol.toStringTag]==="Module"}const Ae=Object.assign;function Vr(e,t){const i={};for(const r in t){const c=t[r];i[r]=lt(c)?c.map(e):e(c)}return i}const an=()=>{},lt=Array.isArray;function xe(e){const t=Array.from(arguments).slice(1);console.warn.apply(console,["[Vue Router warn]: "+e].concat(t))}const Kf=/\/$/,Qf=e=>e.replace(Kf,"");function Ur(e,t,i="/"){let r,c={},u="",g="";const v=t.indexOf("#");let b=t.indexOf("?");return v<b&&v>=0&&(b=-1),b>-1&&(r=t.slice(0,b),u=t.slice(b+1,v>-1?v:t.length),c=e(u)),v>-1&&(r=r||t.slice(0,v),g=t.slice(v,t.length)),r=tg(r!=null?r:t,i),{fullPath:r+(u&&"?")+u+g,path:r,query:c,hash:g}}function Zf(e,t){const i=t.query?e(t.query):"";return t.path+(i&&"?")+i+(t.hash||"")}function Sa(e,t){return!t||!e.toLowerCase().startsWith(t.toLowerCase())?e:e.slice(t.length)||"/"}function Ca(e,t,i){const r=t.matched.length-1,c=i.matched.length-1;return r>-1&&r===c&&Zt(t.matched[r],i.matched[c])&&vc(t.params,i.params)&&e(t.query)===e(i.query)&&t.hash===i.hash}function Zt(e,t){return(e.aliasOf||e)===(t.aliasOf||t)}function vc(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const i in e)if(!eg(e[i],t[i]))return!1;return!0}function eg(e,t){return lt(e)?wa(e,t):lt(t)?wa(t,e):e===t}function wa(e,t){return lt(t)?e.length===t.length&&e.every((i,r)=>i===t[r]):e.length===1&&e[0]===t}function tg(e,t){if(e.startsWith("/"))return e;if(!t.startsWith("/"))return xe(`Cannot resolve a relative location without an absolute path. Trying to resolve "${e}" from "${t}". It should look like "/${t}".`),e;if(!e)return t;const i=t.split("/"),r=e.split("/");let c=i.length-1,u,g;for(u=0;u<r.length;u++)if(g=r[u],g!==".")if(g==="..")c>1&&c--;else break;return i.slice(0,c).join("/")+"/"+r.slice(u-(u===r.length?1:0)).join("/")}var vn;(function(e){e.pop="pop",e.push="push"})(vn||(vn={}));var ln;(function(e){e.back="back",e.forward="forward",e.unknown=""})(ln||(ln={}));function ig(e){if(!e)if(Ft){const t=document.querySelector("base");e=t&&t.getAttribute("href")||"/",e=e.replace(/^\w+:\/\/[^\/]+/,"")}else e="/";return e[0]!=="/"&&e[0]!=="#"&&(e="/"+e),Qf(e)}const ng=/^[^#]+#/;function rg(e,t){return e.replace(ng,"#")+t}function sg(e,t){const i=document.documentElement.getBoundingClientRect(),r=e.getBoundingClientRect();return{behavior:t.behavior,left:r.left-i.left-(t.left||0),top:r.top-i.top-(t.top||0)}}const Or=()=>({left:window.pageXOffset,top:window.pageYOffset});function og(e){let t;if("el"in e){const i=e.el,r=typeof i=="string"&&i.startsWith("#");if(typeof e.el=="string"&&(!r||!document.getElementById(e.el.slice(1))))try{const u=document.querySelector(e.el);if(r&&u){xe(`The selector "${e.el}" should be passed as "el: document.querySelector('${e.el}')" because it starts with "#".`);return}}catch{xe(`The selector "${e.el}" is invalid. If you are using an id selector, make sure to escape it. You can find more information about escaping characters in selectors at https://mathiasbynens.be/notes/css-escapes or use CSS.escape (https://developer.mozilla.org/en-US/docs/Web/API/CSS/escape).`);return}const c=typeof i=="string"?r?document.getElementById(i.slice(1)):document.querySelector(i):i;if(!c){xe(`Couldn't find element using selector "${e.el}" returned by scrollBehavior.`);return}t=sg(c,e)}else t=e;"scrollBehavior"in document.documentElement.style?window.scrollTo(t):window.scrollTo(t.left!=null?t.left:window.pageXOffset,t.top!=null?t.top:window.pageYOffset)}function Ta(e,t){return(history.state?history.state.position-t:-1)+e}const fs=new Map;function ag(e,t){fs.set(e,t)}function lg(e){const t=fs.get(e);return fs.delete(e),t}let cg=()=>location.protocol+"//"+location.host;function yc(e,t){const{pathname:i,search:r,hash:c}=t,u=e.indexOf("#");if(u>-1){let v=c.includes(e.slice(u))?e.slice(u).length:1,b=c.slice(v);return b[0]!=="/"&&(b="/"+b),Sa(b,"")}return Sa(i,e)+r+c}function hg(e,t,i,r){let c=[],u=[],g=null;const v=({state:A})=>{const B=yc(e,location),z=i.value,q=t.value;let J=0;if(A){if(i.value=B,t.value=A,g&&g===z){g=null;return}J=q?A.position-q.position:0}else r(B);c.forEach(Z=>{Z(i.value,z,{delta:J,type:vn.pop,direction:J?J>0?ln.forward:ln.back:ln.unknown})})};function b(){g=i.value}function S(A){c.push(A);const B=()=>{const z=c.indexOf(A);z>-1&&c.splice(z,1)};return u.push(B),B}function w(){const{history:A}=window;!A.state||A.replaceState(Ae({},A.state,{scroll:Or()}),"")}function E(){for(const A of u)A();u=[],window.removeEventListener("popstate",v),window.removeEventListener("beforeunload",w)}return window.addEventListener("popstate",v),window.addEventListener("beforeunload",w),{pauseListeners:b,listen:S,destroy:E}}function xa(e,t,i,r=!1,c=!1){return{back:e,current:t,forward:i,replaced:r,position:window.history.length,scroll:c?Or():null}}function ug(e){const{history:t,location:i}=window,r={value:yc(e,i)},c={value:t.state};c.value||u(r.value,{back:null,current:r.value,forward:null,position:t.length-1,replaced:!0,scroll:null},!0);function u(b,S,w){const E=e.indexOf("#"),A=E>-1?(i.host&&document.querySelector("base")?e:e.slice(E))+b:cg()+e+b;try{t[w?"replaceState":"pushState"](S,"",A),c.value=S}catch(B){xe("Error with push/replace State",B),i[w?"replace":"assign"](A)}}function g(b,S){const w=Ae({},t.state,xa(c.value.back,b,c.value.forward,!0),S,{position:c.value.position});u(b,w,!0),r.value=b}function v(b,S){const w=Ae({},c.value,t.state,{forward:b,scroll:Or()});t.state||xe(`history.state seems to have been manually replaced without preserving the necessary values. Make sure to preserve existing history state if you are manually calling history.replaceState:

history.replaceState(history.state, '', url)

You can find more information at https://next.router.vuejs.org/guide/migration/#usage-of-history-state.`),u(w.current,w,!0);const E=Ae({},xa(r.value,b,null),{position:w.position+1},S);u(b,E,!1),r.value=b}return{location:r,state:c,push:v,replace:g}}function dg(e){e=ig(e);const t=ug(e),i=hg(e,t.state,t.location,t.replace);function r(u,g=!0){g||i.pauseListeners(),history.go(u)}const c=Ae({location:"",base:e,go:r,createHref:rg.bind(null,e)},t,i);return Object.defineProperty(c,"location",{enumerable:!0,get:()=>t.location.value}),Object.defineProperty(c,"state",{enumerable:!0,get:()=>t.state.value}),c}function fg(e){return e=location.host?e||location.pathname+location.search:"",e.includes("#")||(e+="#"),!e.endsWith("#/")&&!e.endsWith("#")&&xe(`A hash base must end with a "#":
"${e}" should be "${e.replace(/#.*$/,"#")}".`),dg(e)}function gg(e){return typeof e=="string"||e&&typeof e=="object"}function bc(e){return typeof e=="string"||typeof e=="symbol"}const Wt={path:"/",name:void 0,params:{},query:{},hash:"",fullPath:"/",matched:[],meta:{},redirectedFrom:void 0},Sc=Symbol("navigation failure");var Ea;(function(e){e[e.aborted=4]="aborted",e[e.cancelled=8]="cancelled",e[e.duplicated=16]="duplicated"})(Ea||(Ea={}));const pg={[1]({location:e,currentLocation:t}){return`No match for
 ${JSON.stringify(e)}${t?`
while being at
`+JSON.stringify(t):""}`},[2]({from:e,to:t}){return`Redirected from "${e.fullPath}" to "${mg(t)}" via a navigation guard.`},[4]({from:e,to:t}){return`Navigation aborted from "${e.fullPath}" to "${t.fullPath}" via a navigation guard.`},[8]({from:e,to:t}){return`Navigation cancelled from "${e.fullPath}" to "${t.fullPath}" with a new navigation.`},[16]({from:e,to:t}){return`Avoided redundant navigation to current location: "${e.fullPath}".`}};function Wi(e,t){return Ae(new Error(pg[e](t)),{type:e,[Sc]:!0},t)}function Dt(e,t){return e instanceof Error&&Sc in e&&(t==null||!!(e.type&t))}const _g=["params","query","hash"];function mg(e){if(typeof e=="string")return e;if("path"in e)return e.path;const t={};for(const i of _g)i in e&&(t[i]=e[i]);return JSON.stringify(t,null,2)}const Aa="[^/]+?",vg={sensitive:!1,strict:!1,start:!0,end:!0},yg=/[.+*?^${}()[\]/\\]/g;function bg(e,t){const i=Ae({},vg,t),r=[];let c=i.start?"^":"";const u=[];for(const S of e){const w=S.length?[]:[90];i.strict&&!S.length&&(c+="/");for(let E=0;E<S.length;E++){const A=S[E];let B=40+(i.sensitive?.25:0);if(A.type===0)E||(c+="/"),c+=A.value.replace(yg,"\\$&"),B+=40;else if(A.type===1){const{value:z,repeatable:q,optional:J,regexp:Z}=A;u.push({name:z,repeatable:q,optional:J});const ee=Z||Aa;if(ee!==Aa){B+=10;try{new RegExp(`(${ee})`)}catch(oe){throw new Error(`Invalid custom RegExp for param "${z}" (${ee}): `+oe.message)}}let K=q?`((?:${ee})(?:/(?:${ee}))*)`:`(${ee})`;E||(K=J&&S.length<2?`(?:/${K})`:"/"+K),J&&(K+="?"),c+=K,B+=20,J&&(B+=-8),q&&(B+=-20),ee===".*"&&(B+=-50)}w.push(B)}r.push(w)}if(i.strict&&i.end){const S=r.length-1;r[S][r[S].length-1]+=.7000000000000001}i.strict||(c+="/?"),i.end?c+="$":i.strict&&(c+="(?:/|$)");const g=new RegExp(c,i.sensitive?"":"i");function v(S){const w=S.match(g),E={};if(!w)return null;for(let A=1;A<w.length;A++){const B=w[A]||"",z=u[A-1];E[z.name]=B&&z.repeatable?B.split("/"):B}return E}function b(S){let w="",E=!1;for(const A of e){(!E||!w.endsWith("/"))&&(w+="/"),E=!1;for(const B of A)if(B.type===0)w+=B.value;else if(B.type===1){const{value:z,repeatable:q,optional:J}=B,Z=z in S?S[z]:"";if(lt(Z)&&!q)throw new Error(`Provided param "${z}" is an array but it is not repeatable (* or + modifiers)`);const ee=lt(Z)?Z.join("/"):Z;if(!ee)if(J)A.length<2&&(w.endsWith("/")?w=w.slice(0,-1):E=!0);else throw new Error(`Missing required param "${z}"`);w+=ee}}return w||"/"}return{re:g,score:r,keys:u,parse:v,stringify:b}}function Sg(e,t){let i=0;for(;i<e.length&&i<t.length;){const r=t[i]-e[i];if(r)return r;i++}return e.length<t.length?e.length===1&&e[0]===40+40?-1:1:e.length>t.length?t.length===1&&t[0]===40+40?1:-1:0}function Cg(e,t){let i=0;const r=e.score,c=t.score;for(;i<r.length&&i<c.length;){const u=Sg(r[i],c[i]);if(u)return u;i++}if(Math.abs(c.length-r.length)===1){if(Ia(r))return 1;if(Ia(c))return-1}return c.length-r.length}function Ia(e){const t=e[e.length-1];return e.length>0&&t[t.length-1]<0}const wg={type:0,value:""},Tg=/[a-zA-Z0-9_]/;function xg(e){if(!e)return[[]];if(e==="/")return[[wg]];if(!e.startsWith("/"))throw new Error(`Route paths should start with a "/": "${e}" should be "/${e}".`);function t(B){throw new Error(`ERR (${i})/"${S}": ${B}`)}let i=0,r=i;const c=[];let u;function g(){u&&c.push(u),u=[]}let v=0,b,S="",w="";function E(){!S||(i===0?u.push({type:0,value:S}):i===1||i===2||i===3?(u.length>1&&(b==="*"||b==="+")&&t(`A repeatable param (${S}) must be alone in its segment. eg: '/:ids+.`),u.push({type:1,value:S,regexp:w,repeatable:b==="*"||b==="+",optional:b==="*"||b==="?"})):t("Invalid state to consume buffer"),S="")}function A(){S+=b}for(;v<e.length;){if(b=e[v++],b==="\\"&&i!==2){r=i,i=4;continue}switch(i){case 0:b==="/"?(S&&E(),g()):b===":"?(E(),i=1):A();break;case 4:A(),i=r;break;case 1:b==="("?i=2:Tg.test(b)?A():(E(),i=0,b!=="*"&&b!=="?"&&b!=="+"&&v--);break;case 2:b===")"?w[w.length-1]=="\\"?w=w.slice(0,-1)+b:i=3:w+=b;break;case 3:E(),i=0,b!=="*"&&b!=="?"&&b!=="+"&&v--,w="";break;default:t("Unknown state");break}}return i===2&&t(`Unfinished custom RegExp for param "${S}"`),E(),g(),c}function Eg(e,t,i){const r=bg(xg(e.path),i);{const u=new Set;for(const g of r.keys)u.has(g.name)&&xe(`Found duplicated params with name "${g.name}" for path "${e.path}". Only the last one will be available on "$route.params".`),u.add(g.name)}const c=Ae(r,{record:e,parent:t,children:[],alias:[]});return t&&!c.record.aliasOf==!t.record.aliasOf&&t.children.push(c),c}function Ag(e,t){const i=[],r=new Map;t=Da({strict:!1,end:!0,sensitive:!1},t);function c(w){return r.get(w)}function u(w,E,A){const B=!A,z=Ig(w);Mg(z,E),z.aliasOf=A&&A.record;const q=Da(t,w),J=[z];if("alias"in w){const K=typeof w.alias=="string"?[w.alias]:w.alias;for(const oe of K)J.push(Ae({},z,{components:A?A.record.components:z.components,path:oe,aliasOf:A?A.record:z}))}let Z,ee;for(const K of J){const{path:oe}=K;if(E&&oe[0]!=="/"){const pe=E.record.path,ye=pe[pe.length-1]==="/"?"":"/";K.path=E.record.path+(oe&&ye+oe)}if(K.path==="*")throw new Error(`Catch all routes ("*") must now be defined using a param with a custom regexp.
See more at https://next.router.vuejs.org/guide/migration/#removed-star-or-catch-all-routes.`);if(Z=Eg(K,E,q),E&&oe[0]==="/"&&Lg(Z,E),A?(A.alias.push(Z),Dg(A,Z)):(ee=ee||Z,ee!==Z&&ee.alias.push(Z),B&&w.name&&!Ra(Z)&&g(w.name)),z.children){const pe=z.children;for(let ye=0;ye<pe.length;ye++)u(pe[ye],Z,A&&A.children[ye])}A=A||Z,(Z.record.components&&Object.keys(Z.record.components).length||Z.record.name||Z.record.redirect)&&b(Z)}return ee?()=>{g(ee)}:an}function g(w){if(bc(w)){const E=r.get(w);E&&(r.delete(w),i.splice(i.indexOf(E),1),E.children.forEach(g),E.alias.forEach(g))}else{const E=i.indexOf(w);E>-1&&(i.splice(E,1),w.record.name&&r.delete(w.record.name),w.children.forEach(g),w.alias.forEach(g))}}function v(){return i}function b(w){let E=0;for(;E<i.length&&Cg(w,i[E])>=0&&(w.record.path!==i[E].record.path||!Cc(w,i[E]));)E++;i.splice(E,0,w),w.record.name&&!Ra(w)&&r.set(w.record.name,w)}function S(w,E){let A,B={},z,q;if("name"in w&&w.name){if(A=r.get(w.name),!A)throw Wi(1,{location:w});{const ee=Object.keys(w.params||{}).filter(K=>!A.keys.find(oe=>oe.name===K));ee.length&&xe(`Discarded invalid param(s) "${ee.join('", "')}" when navigating. See https://github.com/vuejs/router/blob/main/packages/router/CHANGELOG.md#414-2022-08-22 for more details.`)}q=A.record.name,B=Ae(Oa(E.params,A.keys.filter(ee=>!ee.optional).map(ee=>ee.name)),w.params&&Oa(w.params,A.keys.map(ee=>ee.name))),z=A.stringify(B)}else if("path"in w)z=w.path,z.startsWith("/")||xe(`The Matcher cannot resolve relative paths but received "${z}". Unless you directly called \`matcher.resolve("${z}")\`, this is probably a bug in vue-router. Please open an issue at https://new-issue.vuejs.org/?repo=vuejs/router.`),A=i.find(ee=>ee.re.test(z)),A&&(B=A.parse(z),q=A.record.name);else{if(A=E.name?r.get(E.name):i.find(ee=>ee.re.test(E.path)),!A)throw Wi(1,{location:w,currentLocation:E});q=A.record.name,B=Ae({},E.params,w.params),z=A.stringify(B)}const J=[];let Z=A;for(;Z;)J.unshift(Z.record),Z=Z.parent;return{name:q,path:z,params:B,matched:J,meta:Rg(J)}}return e.forEach(w=>u(w)),{addRoute:u,resolve:S,removeRoute:g,getRoutes:v,getRecordMatcher:c}}function Oa(e,t){const i={};for(const r of t)r in e&&(i[r]=e[r]);return i}function Ig(e){return{path:e.path,redirect:e.redirect,name:e.name,meta:e.meta||{},aliasOf:void 0,beforeEnter:e.beforeEnter,props:Og(e),children:e.children||[],instances:{},leaveGuards:new Set,updateGuards:new Set,enterCallbacks:{},components:"components"in e?e.components||null:e.component&&{default:e.component}}}function Og(e){const t={},i=e.props||!1;if("component"in e)t.default=i;else for(const r in e.components)t[r]=typeof i=="boolean"?i:i[r];return t}function Ra(e){for(;e;){if(e.record.aliasOf)return!0;e=e.parent}return!1}function Rg(e){return e.reduce((t,i)=>Ae(t,i.meta),{})}function Da(e,t){const i={};for(const r in e)i[r]=r in t?t[r]:e[r];return i}function gs(e,t){return e.name===t.name&&e.optional===t.optional&&e.repeatable===t.repeatable}function Dg(e,t){for(const i of e.keys)if(!i.optional&&!t.keys.find(gs.bind(null,i)))return xe(`Alias "${t.record.path}" and the original record: "${e.record.path}" must have the exact same param named "${i.name}"`);for(const i of t.keys)if(!i.optional&&!e.keys.find(gs.bind(null,i)))return xe(`Alias "${t.record.path}" and the original record: "${e.record.path}" must have the exact same param named "${i.name}"`)}function Mg(e,t){t&&t.record.name&&!e.name&&!e.path&&xe(`The route named "${String(t.record.name)}" has a child without a name and an empty path. Using that name won't render the empty path child so you probably want to move the name to the child instead. If this is intentional, add a name to the child route to remove the warning.`)}function Lg(e,t){for(const i of t.keys)if(!e.keys.find(gs.bind(null,i)))return xe(`Absolute path "${e.record.path}" must have the exact same param named "${i.name}" as its parent "${t.record.path}".`)}function Cc(e,t){return t.children.some(i=>i===e||Cc(e,i))}const wc=/#/g,Pg=/&/g,kg=/\//g,Fg=/=/g,Bg=/\?/g,Tc=/\+/g,jg=/%5B/g,Ng=/%5D/g,xc=/%5E/g,Vg=/%60/g,Ec=/%7B/g,Ug=/%7C/g,Ac=/%7D/g,Gg=/%20/g;function $s(e){return encodeURI(""+e).replace(Ug,"|").replace(jg,"[").replace(Ng,"]")}function Wg(e){return $s(e).replace(Ec,"{").replace(Ac,"}").replace(xc,"^")}function ps(e){return $s(e).replace(Tc,"%2B").replace(Gg,"+").replace(wc,"%23").replace(Pg,"%26").replace(Vg,"`").replace(Ec,"{").replace(Ac,"}").replace(xc,"^")}function Hg(e){return ps(e).replace(Fg,"%3D")}function Yg(e){return $s(e).replace(wc,"%23").replace(Bg,"%3F")}function Xg(e){return e==null?"":Yg(e).replace(kg,"%2F")}function yn(e){try{return decodeURIComponent(""+e)}catch{xe(`Error decoding "${e}". Using original value`)}return""+e}function $g(e){const t={};if(e===""||e==="?")return t;const r=(e[0]==="?"?e.slice(1):e).split("&");for(let c=0;c<r.length;++c){const u=r[c].replace(Tc," "),g=u.indexOf("="),v=yn(g<0?u:u.slice(0,g)),b=g<0?null:yn(u.slice(g+1));if(v in t){let S=t[v];lt(S)||(S=t[v]=[S]),S.push(b)}else t[v]=b}return t}function Ma(e){let t="";for(let i in e){const r=e[i];if(i=Hg(i),r==null){r!==void 0&&(t+=(t.length?"&":"")+i);continue}(lt(r)?r.map(u=>u&&ps(u)):[r&&ps(r)]).forEach(u=>{u!==void 0&&(t+=(t.length?"&":"")+i,u!=null&&(t+="="+u))})}return t}function zg(e){const t={};for(const i in e){const r=e[i];r!==void 0&&(t[i]=lt(r)?r.map(c=>c==null?null:""+c):r==null?r:""+r)}return t}const qg=Symbol("router view location matched"),La=Symbol("router view depth"),zs=Symbol("router"),Ic=Symbol("route location"),_s=Symbol("router view location");function Ki(){let e=[];function t(r){return e.push(r),()=>{const c=e.indexOf(r);c>-1&&e.splice(c,1)}}function i(){e=[]}return{add:t,list:()=>e,reset:i}}function $t(e,t,i,r,c){const u=r&&(r.enterCallbacks[c]=r.enterCallbacks[c]||[]);return()=>new Promise((g,v)=>{const b=E=>{E===!1?v(Wi(4,{from:i,to:t})):E instanceof Error?v(E):gg(E)?v(Wi(2,{from:t,to:E})):(u&&r.enterCallbacks[c]===u&&typeof E=="function"&&u.push(E),g())},S=e.call(r&&r.instances[c],t,i,Jg(b,t,i));let w=Promise.resolve(S);if(e.length<3&&(w=w.then(b)),e.length>2){const E=`The "next" callback was never called inside of ${e.name?'"'+e.name+'"':""}:
${e.toString()}
. If you are returning a value instead of calling "next", make sure to remove the "next" parameter from your function.`;if(typeof S=="object"&&"then"in S)w=w.then(A=>b._called?A:(xe(E),Promise.reject(new Error("Invalid navigation guard"))));else if(S!==void 0&&!b._called){xe(E),v(new Error("Invalid navigation guard"));return}}w.catch(E=>v(E))})}function Jg(e,t,i){let r=0;return function(){r++===1&&xe(`The "next" callback was called more than once in one navigation guard when going from "${i.fullPath}" to "${t.fullPath}". It should be called exactly one time in each navigation guard. This will fail in production.`),e._called=!0,r===1&&e.apply(null,arguments)}}function Gr(e,t,i,r){const c=[];for(const u of e){!u.components&&!u.children.length&&xe(`Record with path "${u.path}" is either missing a "component(s)" or "children" property.`);for(const g in u.components){let v=u.components[g];{if(!v||typeof v!="object"&&typeof v!="function")throw xe(`Component "${g}" in record with path "${u.path}" is not a valid component. Received "${String(v)}".`),new Error("Invalid route component");if("then"in v){xe(`Component "${g}" in record with path "${u.path}" is a Promise instead of a function that returns a Promise. Did you write "import('./MyPage.vue')" instead of "() => import('./MyPage.vue')" ? This will break in production if not fixed.`);const b=v;v=()=>b}else v.__asyncLoader&&!v.__warnedDefineAsync&&(v.__warnedDefineAsync=!0,xe(`Component "${g}" in record with path "${u.path}" is defined using "defineAsyncComponent()". Write "() => import('./MyPage.vue')" instead of "defineAsyncComponent(() => import('./MyPage.vue'))".`))}if(!(t!=="beforeRouteEnter"&&!u.instances[g]))if(Kg(v)){const S=(v.__vccOpts||v)[t];S&&c.push($t(S,i,r,u,g))}else{let b=v();"catch"in b||(xe(`Component "${g}" in record with path "${u.path}" is a function that does not return a Promise. If you were passing a functional component, make sure to add a "displayName" to the component. This will break in production if not fixed.`),b=Promise.resolve(b)),c.push(()=>b.then(S=>{if(!S)return Promise.reject(new Error(`Couldn't resolve component "${g}" at "${u.path}"`));const w=Jf(S)?S.default:S;u.components[g]=w;const A=(w.__vccOpts||w)[t];return A&&$t(A,i,r,u,g)()}))}}}return c}function Kg(e){return typeof e=="object"||"displayName"in e||"props"in e||"__vccOpts"in e}function Pa(e){const t=xt(zs),i=xt(Ic),r=rt(()=>t.resolve(Ke(e.to))),c=rt(()=>{const{matched:b}=r.value,{length:S}=b,w=b[S-1],E=i.matched;if(!w||!E.length)return-1;const A=E.findIndex(Zt.bind(null,w));if(A>-1)return A;const B=ka(b[S-2]);return S>1&&ka(w)===B&&E[E.length-1].path!==B?E.findIndex(Zt.bind(null,b[S-2])):A}),u=rt(()=>c.value>-1&&ep(i.params,r.value.params)),g=rt(()=>c.value>-1&&c.value===i.matched.length-1&&vc(i.params,r.value.params));function v(b={}){return Zg(b)?t[Ke(e.replace)?"replace":"push"](Ke(e.to)).catch(an):Promise.resolve()}if(Ft){const b=En();if(b){const S={route:r.value,isActive:u.value,isExactActive:g.value};b.__vrl_devtools=b.__vrl_devtools||[],b.__vrl_devtools.push(S),uu(()=>{S.route=r.value,S.isActive=u.value,S.isExactActive=g.value},{flush:"post"})}}return{route:r,href:rt(()=>r.value.href),isActive:u,isExactActive:g,navigate:v}}const Qg=Nt({name:"RouterLink",compatConfig:{MODE:3},props:{to:{type:[String,Object],required:!0},replace:Boolean,activeClass:String,exactActiveClass:String,custom:Boolean,ariaCurrentValue:{type:String,default:"page"}},useLink:Pa,setup(e,{slots:t}){const i=mt(Pa(e)),{options:r}=xt(zs),c=rt(()=>({[Fa(e.activeClass,r.linkActiveClass,"router-link-active")]:i.isActive,[Fa(e.exactActiveClass,r.linkExactActiveClass,"router-link-exact-active")]:i.isExactActive}));return()=>{const u=t.default&&t.default(i);return e.custom?u:Kl("a",{"aria-current":i.isExactActive?e.ariaCurrentValue:null,href:i.href,onClick:i.navigate,class:c.value},u)}}}),bn=Qg;function Zg(e){if(!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)&&!e.defaultPrevented&&!(e.button!==void 0&&e.button!==0)){if(e.currentTarget&&e.currentTarget.getAttribute){const t=e.currentTarget.getAttribute("target");if(/\b_blank\b/i.test(t))return}return e.preventDefault&&e.preventDefault(),!0}}function ep(e,t){for(const i in t){const r=t[i],c=e[i];if(typeof r=="string"){if(r!==c)return!1}else if(!lt(c)||c.length!==r.length||r.some((u,g)=>u!==c[g]))return!1}return!0}function ka(e){return e?e.aliasOf?e.aliasOf.path:e.path:""}const Fa=(e,t,i)=>e!=null?e:t!=null?t:i,tp=Nt({name:"RouterView",inheritAttrs:!1,props:{name:{type:String,default:"default"},route:Object},compatConfig:{MODE:3},setup(e,{attrs:t,slots:i}){ip();const r=xt(_s),c=rt(()=>e.route||r.value),u=xt(La,0),g=rt(()=>{let S=Ke(u);const{matched:w}=c.value;let E;for(;(E=w[S])&&!E.components;)S++;return S}),v=rt(()=>c.value.matched[g.value]);Wn(La,rt(()=>g.value+1)),Wn(qg,v),Wn(_s,c);const b=Cn();return Et(()=>[b.value,v.value,e.name],([S,w,E],[A,B,z])=>{w&&(w.instances[E]=S,B&&B!==w&&S&&S===A&&(w.leaveGuards.size||(w.leaveGuards=B.leaveGuards),w.updateGuards.size||(w.updateGuards=B.updateGuards))),S&&w&&(!B||!Zt(w,B)||!A)&&(w.enterCallbacks[E]||[]).forEach(q=>q(S))},{flush:"post"}),()=>{const S=c.value,w=e.name,E=v.value,A=E&&E.components[w];if(!A)return Ba(i.default,{Component:A,route:S});const B=E.props[w],z=B?B===!0?S.params:typeof B=="function"?B(S):B:null,J=Kl(A,Ae({},z,t,{onVnodeUnmounted:Z=>{Z.component.isUnmounted&&(E.instances[w]=null)},ref:b}));if(Ft&&J.ref){const Z={depth:g.value,name:E.name,path:E.path,meta:E.meta};(lt(J.ref)?J.ref.map(K=>K.i):[J.ref.i]).forEach(K=>{K.__vrv_devtools=Z})}return Ba(i.default,{Component:J,route:S})||J}}});function Ba(e,t){if(!e)return null;const i=e(t);return i.length===1?i[0]:i}const Oc=tp;function ip(){const e=En(),t=e.parent&&e.parent.type.name;if(t&&(t==="KeepAlive"||t.includes("Transition"))){const i=t==="KeepAlive"?"keep-alive":"transition";xe(`<router-view> can no longer be used directly inside <transition> or <keep-alive>.
Use slot props instead:

<router-view v-slot="{ Component }">
  <${i}>
    <component :is="Component" />
  </${i}>
</router-view>`)}}function Qi(e,t){const i=Ae({},e,{matched:e.matched.map(r=>up(r,["instances","children","aliasOf"]))});return{_custom:{type:null,readOnly:!0,display:e.fullPath,tooltip:t,value:i}}}function jn(e){return{_custom:{display:e}}}let np=0;function rp(e,t,i){if(t.__hasDevtools)return;t.__hasDevtools=!0;const r=np++;Ws({id:"org.vuejs.router"+(r?"."+r:""),label:"Vue Router",packageName:"vue-router",homepage:"https://router.vuejs.org",logo:"https://router.vuejs.org/logo.png",componentStateTypes:["Routing"],app:e},c=>{typeof c.now!="function"&&console.warn("[Vue Router]: You seem to be using an outdated version of Vue Devtools. Are you still using the Beta release instead of the stable one? You can find the links at https://devtools.vuejs.org/guide/installation.html."),c.on.inspectComponent((w,E)=>{w.instanceData&&w.instanceData.state.push({type:"Routing",key:"$route",editable:!1,value:Qi(t.currentRoute.value,"Current Route")})}),c.on.visitComponentTree(({treeNode:w,componentInstance:E})=>{if(E.__vrv_devtools){const A=E.__vrv_devtools;w.tags.push({label:(A.name?`${A.name.toString()}: `:"")+A.path,textColor:0,tooltip:"This component is rendered by &lt;router-view&gt;",backgroundColor:Rc})}lt(E.__vrl_devtools)&&(E.__devtoolsApi=c,E.__vrl_devtools.forEach(A=>{let B=Lc,z="";A.isExactActive?(B=Mc,z="This is exactly active"):A.isActive&&(B=Dc,z="This link is active"),w.tags.push({label:A.route.path,textColor:0,tooltip:z,backgroundColor:B})}))}),Et(t.currentRoute,()=>{b(),c.notifyComponentUpdate(),c.sendInspectorTree(v),c.sendInspectorState(v)});const u="router:navigations:"+r;c.addTimelineLayer({id:u,label:`Router${r?" "+r:""} Navigations`,color:4237508}),t.onError((w,E)=>{c.addTimelineEvent({layerId:u,event:{title:"Error during Navigation",subtitle:E.fullPath,logType:"error",time:c.now(),data:{error:w},groupId:E.meta.__navigationId}})});let g=0;t.beforeEach((w,E)=>{const A={guard:jn("beforeEach"),from:Qi(E,"Current Location during this navigation"),to:Qi(w,"Target location")};Object.defineProperty(w.meta,"__navigationId",{value:g++}),c.addTimelineEvent({layerId:u,event:{time:c.now(),title:"Start of navigation",subtitle:w.fullPath,data:A,groupId:w.meta.__navigationId}})}),t.afterEach((w,E,A)=>{const B={guard:jn("afterEach")};A?(B.failure={_custom:{type:Error,readOnly:!0,display:A?A.message:"",tooltip:"Navigation Failure",value:A}},B.status=jn("\u274C")):B.status=jn("\u2705"),B.from=Qi(E,"Current Location during this navigation"),B.to=Qi(w,"Target location"),c.addTimelineEvent({layerId:u,event:{title:"End of navigation",subtitle:w.fullPath,time:c.now(),data:B,logType:A?"warning":"default",groupId:w.meta.__navigationId}})});const v="router-inspector:"+r;c.addInspector({id:v,label:"Routes"+(r?" "+r:""),icon:"book",treeFilterPlaceholder:"Search routes"});function b(){if(!S)return;const w=S;let E=i.getRoutes().filter(A=>!A.parent);E.forEach(Fc),w.filter&&(E=E.filter(A=>ms(A,w.filter.toLowerCase()))),E.forEach(A=>kc(A,t.currentRoute.value)),w.rootNodes=E.map(Pc)}let S;c.on.getInspectorTree(w=>{S=w,w.app===e&&w.inspectorId===v&&b()}),c.on.getInspectorState(w=>{if(w.app===e&&w.inspectorId===v){const A=i.getRoutes().find(B=>B.record.__vd_id===w.nodeId);A&&(w.state={options:op(A)})}}),c.sendInspectorTree(v),c.sendInspectorState(v)})}function sp(e){return e.optional?e.repeatable?"*":"?":e.repeatable?"+":""}function op(e){const{record:t}=e,i=[{editable:!1,key:"path",value:t.path}];return t.name!=null&&i.push({editable:!1,key:"name",value:t.name}),i.push({editable:!1,key:"regexp",value:e.re}),e.keys.length&&i.push({editable:!1,key:"keys",value:{_custom:{type:null,readOnly:!0,display:e.keys.map(r=>`${r.name}${sp(r)}`).join(" "),tooltip:"Param keys",value:e.keys}}}),t.redirect!=null&&i.push({editable:!1,key:"redirect",value:t.redirect}),e.alias.length&&i.push({editable:!1,key:"aliases",value:e.alias.map(r=>r.record.path)}),Object.keys(e.record.meta).length&&i.push({editable:!1,key:"meta",value:e.record.meta}),i.push({key:"score",editable:!1,value:{_custom:{type:null,readOnly:!0,display:e.score.map(r=>r.join(", ")).join(" | "),tooltip:"Score used to sort routes",value:e.score}}}),i}const Rc=15485081,Dc=2450411,Mc=8702998,ap=2282478,Lc=16486972,lp=6710886;function Pc(e){const t=[],{record:i}=e;i.name!=null&&t.push({label:String(i.name),textColor:0,backgroundColor:ap}),i.aliasOf&&t.push({label:"alias",textColor:0,backgroundColor:Lc}),e.__vd_match&&t.push({label:"matches",textColor:0,backgroundColor:Rc}),e.__vd_exactActive&&t.push({label:"exact",textColor:0,backgroundColor:Mc}),e.__vd_active&&t.push({label:"active",textColor:0,backgroundColor:Dc}),i.redirect&&t.push({label:typeof i.redirect=="string"?`redirect: ${i.redirect}`:"redirects",textColor:16777215,backgroundColor:lp});let r=i.__vd_id;return r==null&&(r=String(cp++),i.__vd_id=r),{id:r,label:i.path,tags:t,children:e.children.map(Pc)}}let cp=0;const hp=/^\/(.*)\/([a-z]*)$/;function kc(e,t){const i=t.matched.length&&Zt(t.matched[t.matched.length-1],e.record);e.__vd_exactActive=e.__vd_active=i,i||(e.__vd_active=t.matched.some(r=>Zt(r,e.record))),e.children.forEach(r=>kc(r,t))}function Fc(e){e.__vd_match=!1,e.children.forEach(Fc)}function ms(e,t){const i=String(e.re).match(hp);if(e.__vd_match=!1,!i||i.length<3)return!1;if(new RegExp(i[1].replace(/\$$/,""),i[2]).test(t))return e.children.forEach(g=>ms(g,t)),e.record.path!=="/"||t==="/"?(e.__vd_match=e.re.test(t),!0):!1;const c=e.record.path.toLowerCase(),u=yn(c);return!t.startsWith("/")&&(u.includes(t)||c.includes(t))||u.startsWith(t)||c.startsWith(t)||e.record.name&&String(e.record.name).includes(t)?!0:e.children.some(g=>ms(g,t))}function up(e,t){const i={};for(const r in e)t.includes(r)||(i[r]=e[r]);return i}function dp(e){const t=Ag(e.routes,e),i=e.parseQuery||$g,r=e.stringifyQuery||Ma,c=e.history;if(!c)throw new Error('Provide the "history" option when calling "createRouter()": https://next.router.vuejs.org/api/#history.');const u=Ki(),g=Ki(),v=Ki(),b=Rh(Wt);let S=Wt;Ft&&e.scrollBehavior&&"scrollRestoration"in history&&(history.scrollRestoration="manual");const w=Vr.bind(null,x=>""+x),E=Vr.bind(null,Xg),A=Vr.bind(null,yn);function B(x,I){let D,L;return bc(x)?(D=t.getRecordMatcher(x),L=I):L=x,t.addRoute(L,D)}function z(x){const I=t.getRecordMatcher(x);I?t.removeRoute(I):xe(`Cannot remove non-existent route "${String(x)}"`)}function q(){return t.getRoutes().map(x=>x.record)}function J(x){return!!t.getRecordMatcher(x)}function Z(x,I){if(I=Ae({},I||b.value),typeof x=="string"){const X=Ur(i,x,I.path),O=t.resolve({path:X.path},I),R=c.createHref(X.fullPath);return R.startsWith("//")?xe(`Location "${x}" resolved to "${R}". A resolved location cannot start with multiple slashes.`):O.matched.length||xe(`No match found for location with path "${x}"`),Ae(X,O,{params:A(O.params),hash:yn(X.hash),redirectedFrom:void 0,href:R})}let D;if("path"in x)"params"in x&&!("name"in x)&&Object.keys(x.params).length&&xe(`Path "${x.path}" was passed with params but they will be ignored. Use a named route alongside params instead.`),D=Ae({},x,{path:Ur(i,x.path,I.path).path});else{const X=Ae({},x.params);for(const O in X)X[O]==null&&delete X[O];D=Ae({},x,{params:E(x.params)}),I.params=E(I.params)}const L=t.resolve(D,I),V=x.hash||"";V&&!V.startsWith("#")&&xe(`A \`hash\` should always start with the character "#". Replace "${V}" with "#${V}".`),L.params=w(A(L.params));const H=Zf(r,Ae({},x,{hash:Wg(V),path:L.path})),$=c.createHref(H);return $.startsWith("//")?xe(`Location "${x}" resolved to "${$}". A resolved location cannot start with multiple slashes.`):L.matched.length||xe(`No match found for location with path "${"path"in x?x.path:x}"`),Ae({fullPath:H,hash:V,query:r===Ma?zg(x.query):x.query||{}},L,{redirectedFrom:void 0,href:$})}function ee(x){return typeof x=="string"?Ur(i,x,b.value.path):Ae({},x)}function K(x,I){if(S!==x)return Wi(8,{from:I,to:x})}function oe(x){return _e(x)}function pe(x){return oe(Ae(ee(x),{replace:!0}))}function ye(x){const I=x.matched[x.matched.length-1];if(I&&I.redirect){const{redirect:D}=I;let L=typeof D=="function"?D(x):D;if(typeof L=="string"&&(L=L.includes("?")||L.includes("#")?L=ee(L):{path:L},L.params={}),!("path"in L)&&!("name"in L))throw xe(`Invalid redirect found:
${JSON.stringify(L,null,2)}
 when navigating to "${x.fullPath}". A redirect must contain a name or path. This will break in production.`),new Error("Invalid redirect");return Ae({query:x.query,hash:x.hash,params:"path"in L?{}:x.params},L)}}function _e(x,I){const D=S=Z(x),L=b.value,V=x.state,H=x.force,$=x.replace===!0,X=ye(D);if(X)return _e(Ae(ee(X),{state:typeof X=="object"?Ae({},V,X.state):V,force:H,replace:$}),I||D);const O=D;O.redirectedFrom=I;let R;return!H&&Ca(r,L,D)&&(R=Wi(16,{to:O,from:L}),f(L,L,!0,!1)),(R?Promise.resolve(R):le(O,L)).catch(M=>Dt(M)?Dt(M,2)?M:_(M):s(M,O,L)).then(M=>{if(M){if(Dt(M,2))return Ca(r,Z(M.to),O)&&I&&(I._count=I._count?I._count+1:1)>10?(xe(`Detected an infinite redirection in a navigation guard when going from "${L.fullPath}" to "${O.fullPath}". Aborting to avoid a Stack Overflow. This will break in production if not fixed.`),Promise.reject(new Error("Infinite redirect in navigation guard"))):_e(Ae({replace:$},ee(M.to),{state:typeof M.to=="object"?Ae({},V,M.to.state):V,force:H}),I||O)}else M=he(O,L,!0,$,V);return te(O,L,M),M})}function y(x,I){const D=K(x,I);return D?Promise.reject(D):Promise.resolve()}function le(x,I){let D;const[L,V,H]=fp(x,I);D=Gr(L.reverse(),"beforeRouteLeave",x,I);for(const X of L)X.leaveGuards.forEach(O=>{D.push($t(O,x,I))});const $=y.bind(null,x,I);return D.push($),Mi(D).then(()=>{D=[];for(const X of u.list())D.push($t(X,x,I));return D.push($),Mi(D)}).then(()=>{D=Gr(V,"beforeRouteUpdate",x,I);for(const X of V)X.updateGuards.forEach(O=>{D.push($t(O,x,I))});return D.push($),Mi(D)}).then(()=>{D=[];for(const X of x.matched)if(X.beforeEnter&&!I.matched.includes(X))if(lt(X.beforeEnter))for(const O of X.beforeEnter)D.push($t(O,x,I));else D.push($t(X.beforeEnter,x,I));return D.push($),Mi(D)}).then(()=>(x.matched.forEach(X=>X.enterCallbacks={}),D=Gr(H,"beforeRouteEnter",x,I),D.push($),Mi(D))).then(()=>{D=[];for(const X of g.list())D.push($t(X,x,I));return D.push($),Mi(D)}).catch(X=>Dt(X,8)?X:Promise.reject(X))}function te(x,I,D){for(const L of v.list())L(x,I,D)}function he(x,I,D,L,V){const H=K(x,I);if(H)return H;const $=I===Wt,X=Ft?history.state:{};D&&(L||$?c.replace(x.fullPath,Ae({scroll:$&&X&&X.scroll},V)):c.push(x.fullPath,V)),b.value=x,f(x,I,D,$),_()}let a;function o(){a||(a=c.listen((x,I,D)=>{if(!T.listening)return;const L=Z(x),V=ye(L);if(V){_e(Ae(V,{replace:!0}),L).catch(an);return}S=L;const H=b.value;Ft&&ag(Ta(H.fullPath,D.delta),Or()),le(L,H).catch($=>Dt($,12)?$:Dt($,2)?(_e($.to,L).then(X=>{Dt(X,20)&&!D.delta&&D.type===vn.pop&&c.go(-1,!1)}).catch(an),Promise.reject()):(D.delta&&c.go(-D.delta,!1),s($,L,H))).then($=>{$=$||he(L,H,!1),$&&(D.delta&&!Dt($,8)?c.go(-D.delta,!1):D.type===vn.pop&&Dt($,20)&&c.go(-1,!1)),te(L,H,$)}).catch(an)}))}let l=Ki(),d=Ki(),n;function s(x,I,D){_(x);const L=d.list();return L.length?L.forEach(V=>V(x,I,D)):(xe("uncaught error during route navigation:"),console.error(x)),Promise.reject(x)}function h(){return n&&b.value!==Wt?Promise.resolve():new Promise((x,I)=>{l.add([x,I])})}function _(x){return n||(n=!x,o(),l.list().forEach(([I,D])=>x?D(x):I()),l.reset()),x}function f(x,I,D,L){const{scrollBehavior:V}=e;if(!Ft||!V)return Promise.resolve();const H=!D&&lg(Ta(x.fullPath,0))||(L||!D)&&history.state&&history.state.scroll||null;return tr().then(()=>V(x,I,H)).then($=>$&&og($)).catch($=>s($,x,I))}const p=x=>c.go(x);let m;const C=new Set,T={currentRoute:b,listening:!0,addRoute:B,removeRoute:z,hasRoute:J,getRoutes:q,resolve:Z,options:e,push:oe,replace:pe,go:p,back:()=>p(-1),forward:()=>p(1),beforeEach:u.add,beforeResolve:g.add,afterEach:v.add,onError:d.add,isReady:h,install(x){const I=this;x.component("RouterLink",bn),x.component("RouterView",Oc),x.config.globalProperties.$router=I,Object.defineProperty(x.config.globalProperties,"$route",{enumerable:!0,get:()=>Ke(b)}),Ft&&!m&&b.value===Wt&&(m=!0,oe(c.location).catch(V=>{xe("Unexpected error when starting the router:",V)}));const D={};for(const V in Wt)D[V]=rt(()=>b.value[V]);x.provide(zs,I),x.provide(Ic,mt(D)),x.provide(_s,b);const L=x.unmount;C.add(x),x.unmount=function(){C.delete(x),C.size<1&&(S=Wt,a&&a(),a=null,b.value=Wt,m=!1,n=!1),L()},Ft&&rp(x,I,t)}};return T}function Mi(e){return e.reduce((t,i)=>t.then(()=>i()),Promise.resolve())}function fp(e,t){const i=[],r=[],c=[],u=Math.max(t.matched.length,e.matched.length);for(let g=0;g<u;g++){const v=t.matched[g];v&&(e.matched.find(S=>Zt(S,v))?r.push(v):i.push(v));const b=e.matched[g];b&&(t.matched.find(S=>Zt(S,b))||c.push(b))}return[i,r,c]}const gp=""+new URL("NULL.f6ddcc99.png",import.meta.url).href,pp=""+new URL("0004.22002e07.png",import.meta.url).href,_p=""+new URL("0003.1c605681.png",import.meta.url).href,mp=""+new URL("0002.a82265c8.png",import.meta.url).href,vp=""+new URL("0001.f5fd0884.png",import.meta.url).href,yp=""+new URL("0000.05e25c0c.png",import.meta.url).href,An=Df("counter",()=>{let e=mt([]),t=null,i=mt(new Map([["0000",{id:"0000",name:"apple",stock:40,price:10,locality:"USA",imgURL:[yp]}],["0001",{id:"0001",name:"banana",stock:40,price:11.1,locality:"USA_0",imgURL:[vp]}],["0002",{id:"0002",name:"car",stock:40,price:10,locality:"USA_1",imgURL:[mp]}],["0003",{id:"0003",name:"mineral water",stock:40,price:.5,locality:"USA_2",imgURL:[_p]}],["0004",{id:"0004",name:"Shower gel",stock:0,price:10,locality:"USA_3",imgURL:[pp]}]])),r=mt([]),c=mt([]);function u(Z){return i.has(Z)?i.get(Z):null}function g(Z,ee){u(Z).stock-=ee}function v(Z){let ee=c.find(K=>K.id===Z);return ee||null}function b(Z){let ee=!!r.find(K=>K.id===Z);if(ee){let K=r.find(oe=>oe.id===Z);for(let oe in r)r[oe].id===Z&&r.splice(oe,1);return r.unshift(K),!0}else{console.log("is_InScanList",ee);let K=u(Z);if(K===null)return console.log("Don't find item by id:"+Z+"in store."),i.set(Z,{id:Z,name:Z,stock:999,price:0,locality:"test for your scan",imgURL:[gp]}),!1;let oe=v(Z);oe===null?r.unshift({id:K.id,qty:1}):r.unshift({id:K.id,qty:oe.qty})}}function S(Z){for(let ee in r)r[ee].id===Z&&r.splice(ee,1)}function w(Z,ee){if(ee===0){J("The quantity cannot be 0");return}if(!!!c.find(oe=>oe.id===Z))c.push({id:Z,qty:ee});else for(let oe of c)oe.id===Z&&(oe.qty+=ee);J("Added [ "+ee+' ] "'+u(Z).name+'" to cart')}let E=Cn(0);Et(c,()=>{let Z=0;for(let ee of c){let K=u(ee.id).price;Z+=K*10**4*ee.qty/10**4}E.value=Z},{deep:!0}),Et(r,()=>{for(let Z in r)r[Z].qty===0&&r.splice(Z,1)},{deep:!0}),Et(c,()=>{for(let Z in c)c[Z].qty===0&&c.splice(Z,1)},{deep:!0});const A=mt(new Map([]));function B(){let Z=[];for(let oe of c){let pe={name:u(oe.id).name,qty:oe.qty,price:u(oe.id).price};Z.push(pe)}let ee=new Date,K={id:""+ee.getUTCMonth()+ee.getUTCFullYear()+ee.getUTCDate()+ee.getUTCHours()+ee.getUTCMinutes()+ee.getUTCSeconds()+(Math.random()+"").slice(2,8),amount:E.value,date:ee.getUTCMonth()+"/"+ee.getUTCFullYear()+"/"+ee.getUTCDate()+" "+ee.getUTCHours()+":"+ee.getUTCMinutes()+":"+ee.getUTCSeconds(),paymentMethod:"Visa",customerName:"Dynamsoft_Customer",status:!1,items:Z};return console.log(K),K}function z(Z){A.set(Z.id,Z)}function q(Z){return A.get(Z)}function J(Z){e.unshift({text:Z,time:new Date}),setTimeout(()=>{e.pop()},3e3)}return{message_list:e,dbrScanner:t,scanItemList:r,cartList:c,totalPrice_FromCartList:E,getItemById_FromStoreMap:u,operateItemStock_onStoreMap:g,delItemById_InScanList:S,addItemById_ToScanList:b,addItemById_ToCratList:w,setOrder_inOrderMap:z,getOrder_FromOrderMap:q,NewOrderDetail:B,showMessage:J}}),bp={class:"msg-list"},Sp=Nt({__name:"CompMsgBox",setup(e){const t=An();return(i,r)=>(Je(),dt("div",bp,[Pe(Hd,{name:"msg"},{default:Vi(()=>[(Je(!0),dt(We,null,Kr(Ke(t).message_list,c=>(Je(),dt("div",{class:"msg",key:c.time},Bi(c.text),1))),128))]),_:1})]))}});const xi=(e,t)=>{const i=e.__vccOpts||e;for(const[r,c]of t)i[r]=c;return i},Cp=xi(Sp,[["__scopeId","data-v-38fc2aa9"],["__file","C:/Users/Mccree/Desktop/works/web_projects/js_real_scene_1_demo/src/components/pubilc/CompMsgBox.vue"]]),wp=Nt({__name:"App",setup(e){return Fs(async()=>{try{await kt.loadWasm()}catch(t){let i;t.message.includes("network connection error")?i="Failed to connect to Dynamsoft License Server: network connection error. Check your Internet connection or contact Dynamsoft Support (support@dynamsoft.com) to acquire an offline license.":i=t.message||t,console.error(i),alert(i)}}),(t,i)=>(Je(),dt(We,null,[Me("div",null,[Pe(Ke(Oc))]),Pe(Cp)],64))}});const Tp=xi(wp,[["__file","C:/Users/Mccree/Desktop/works/web_projects/js_real_scene_1_demo/src/App.vue"]]),xp="modulepreload",Ep=function(e,t){return new URL(e,t).href},ja={},Zi=function(t,i,r){if(!i||i.length===0)return t();const c=document.getElementsByTagName("link");return Promise.all(i.map(u=>{if(u=Ep(u,r),u in ja)return;ja[u]=!0;const g=u.endsWith(".css"),v=g?'[rel="stylesheet"]':"";if(!!r)for(let w=c.length-1;w>=0;w--){const E=c[w];if(E.href===u&&(!g||E.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${u}"]${v}`))return;const S=document.createElement("link");if(S.rel=g?"stylesheet":xp,g||(S.as="script",S.crossOrigin=""),S.href=u,document.head.appendChild(S),g)return new Promise((w,E)=>{S.addEventListener("load",w),S.addEventListener("error",()=>E(new Error(`Unable to preload CSS for ${u}`)))})})).then(()=>t())},Ap=""+new URL("AD_1.eb8fc9d2.jpg",import.meta.url).href,Ip={class:"comp-item"},Op={class:"btn-info"},Rp=["src"],Dp={class:"discount"},Mp={class:"text-omit-1-lines"},Lp=Nt({__name:"CompItemBlock_1",props:{itemProp:{type:Object,required:!0}},setup(e){const t=e;return An(),(i,r)=>(Je(),dt("div",Ip,[Pe(Ke(bn),{to:{name:"info",params:{itemId:t.itemProp.id}}},{default:Vi(()=>[Me("div",Op,[Me("img",{src:t.itemProp.imgURL[0]},null,8,Rp),Me("div",Dp,[Me("span",null,"-"+Bi(Math.floor(Math.random()*100%40))+"%",1)])])]),_:1},8,["to"]),Me("span",Mp,Bi(t.itemProp.name),1),Me("p",null,"$ "+Bi(t.itemProp.price.toFixed(2)),1)]))}});const Pp=xi(Lp,[["__scopeId","data-v-baa6b3d9"],["__file","C:/Users/Mccree/Desktop/works/web_projects/js_real_scene_1_demo/src/components/home/CompItemBlock_1.vue"]]),kp={class:"comp-item"},Fp=["src"],Bp={class:"text-omit-1-lines"},jp=Nt({__name:"CompItemBlock_2",props:{itemProp:{type:Object,required:!0}},setup(e){const t=e;return An(),(i,r)=>(Je(),dt("div",kp,[Pe(Ke(bn),{class:"btn-info",to:{name:"info",params:{itemId:t.itemProp.id}}},{default:Vi(()=>[Me("img",{src:t.itemProp.imgURL[0]},null,8,Fp)]),_:1},8,["to"]),Me("span",Bp,Bi(t.itemProp.name),1),Me("p",null,"$ "+Bi(t.itemProp.price.toFixed(2)),1)]))}});const Np=xi(jp,[["__scopeId","data-v-b5ec2c63"],["__file","C:/Users/Mccree/Desktop/works/web_projects/js_real_scene_1_demo/src/components/home/CompItemBlock_2.vue"]]),Bc=e=>(Tl("data-v-270d5e41"),e=e(),xl(),e),Vp={class:"comp-content"},Up={class:"center"},Gp={href:"#",class:"btn-AD"},Wp=["src"],Hp={class:"show-area no-wrap"},Yp=Bc(()=>Me("p",null,"Flash Deals",-1)),Xp={class:"row-list"},$p={class:"show-area wrap"},zp=Bc(()=>Me("p",null,"Hot sale",-1)),qp={class:"row-list"},Jp=Nt({__name:"CompContent",setup(e){const t=An();let i=[t.getItemById_FromStoreMap("0000"),t.getItemById_FromStoreMap("0001"),t.getItemById_FromStoreMap("0004")],r=[t.getItemById_FromStoreMap("0002"),t.getItemById_FromStoreMap("0003"),t.getItemById_FromStoreMap("0002"),t.getItemById_FromStoreMap("0003")];return(c,u)=>(Je(),dt("div",Vp,[Me("div",Up,[Me("a",Gp,[Me("img",{src:Ap},null,8,Wp)])]),Me("div",Hp,[Yp,Me("div",Xp,[(Je(!0),dt(We,null,Kr(Ke(i),g=>(Je(),or(Pp,{key:g==null?void 0:g.id,itemProp:g},null,8,["itemProp"]))),128))])]),Me("div",$p,[zp,Me("div",qp,[(Je(!0),dt(We,null,Kr(Ke(r),g=>(Je(),or(Np,{key:g==null?void 0:g.id,itemProp:g},null,8,["itemProp"]))),128))])])]))}});const Kp=xi(Jp,[["__scopeId","data-v-270d5e41"],["__file","C:/Users/Mccree/Desktop/works/web_projects/js_real_scene_1_demo/src/components/home/CompContent.vue"]]),Qp=""+new URL("icon_cart.e1deafcd.svg",import.meta.url).href,Zp=""+new URL("icon_scan.9830e638.svg",import.meta.url).href,e_=e=>(Tl("data-v-ac33bae3"),e=e(),xl(),e),t_={class:"comp-nav-bar"},i_={class:"btn-scan"},n_=["src"],r_=e_(()=>Me("span",null,"Scan Barcode",-1)),s_={class:"btn-cart"},o_=["src"],a_={key:0,class:"dot"},l_=Nt({__name:"CompNavBar",setup(e){const t=An();return(i,r)=>(Je(),dt("div",t_,[Pe(Ke(bn),{to:"/scan"},{default:Vi(()=>[Me("div",i_,[Me("img",{class:"icon-scan",src:Zp},null,8,n_),r_])]),_:1}),Pe(Ke(bn),{to:"/cart"},{default:Vi(()=>[Me("div",s_,[Me("img",{src:Qp},null,8,o_),Ke(t).cartList.length!==0?(Je(),dt("div",a_)):rd("v-if",!0)])]),_:1})]))}});const c_=xi(l_,[["__scopeId","data-v-ac33bae3"],["__file","C:/Users/Mccree/Desktop/works/web_projects/js_real_scene_1_demo/src/components/home/CompNavBar.vue"]]),h_={class:"view-home"},u_=Nt({__name:"HomeView",setup(e){return(t,i)=>(Je(),dt("div",h_,[Pe(c_),Pe(Kp)]))}});const d_=xi(u_,[["__scopeId","data-v-b4e148ca"],["__file","C:/Users/Mccree/Desktop/works/web_projects/js_real_scene_1_demo/src/views/HomeView.vue"]]),f_=dp({history:fg("./"),routes:[{path:"/",name:"home",component:d_},{path:"/scan",name:"scan",component:()=>Zi(()=>import("./ScanView.fef60532.js"),["./ScanView.fef60532.js","./CompNavBar.d4a09a55.js","./CompNavBar.6906d40a.css","./ScanView.56cbe35a.css"],import.meta.url)},{path:"/cart",name:"cart",component:()=>Zi(()=>import("./CartView.7937ba12.js"),["./CartView.7937ba12.js","./CompNavBar.d4a09a55.js","./CompNavBar.6906d40a.css","./CartView.fa5a899d.css"],import.meta.url)},{path:"/info/:itemId",name:"info",component:()=>Zi(()=>import("./InfoView.df31fc07.js"),["./InfoView.df31fc07.js","./CompNavBar.d4a09a55.js","./CompNavBar.6906d40a.css","./InfoView.088e8ea5.css"],import.meta.url),props:!0},{path:"/payment/:orderId",name:"payment",component:()=>Zi(()=>import("./PaymentView.94297dc0.js"),["./PaymentView.94297dc0.js","./CompNavBar.d4a09a55.js","./CompNavBar.6906d40a.css","./PaymentView.9ec2a853.css"],import.meta.url),props:!0},{path:"/receipt/:orderId",name:"receipt",component:()=>Zi(()=>import("./ReceiptView.a615af29.js"),["./ReceiptView.a615af29.js","./CompNavBar.d4a09a55.js","./CompNavBar.6906d40a.css","./ReceiptView.e2b339fb.css"],import.meta.url),props:!0}]});const qs=Kd(Tp);qs.use(Af());qs.use(f_);qs.mount("#app");export{xt as A,nd as B,Wn as C,We as F,bn as R,xi as _,Pe as a,Ke as b,dt as c,Nt as d,Me as e,xl as f,Cn as g,Fs as h,En as i,Ml as j,rd as k,p_ as l,__ as m,rt as n,Je as o,Tl as p,kt as q,g_ as r,Kr as s,Bi as t,An as u,or as v,Vi as w,vs as x,Qp as y,f_ as z};
